25-01-17 16:23:47 | I | === Configurations ===
25-01-17 16:23:47 | I | LlmRunConfig(
25-01-17 16:23:47 | I |   model=LlmModelConfig(
25-01-17 16:23:47 | I |     name=tiny-llama-1.1b,
25-01-17 16:23:47 | I |     path=/data/gyy/TinyLlama,
25-01-17 16:23:47 | I |     root=/dataset/models,
25-01-17 16:23:47 | I |     local_path=/dataset/models/tiny/tiny-llama-1.1b,
25-01-17 16:23:47 | I |     local_root=/dataset/models,
25-01-17 16:23:47 | I |     family=tiny,
25-01-17 16:23:47 | I |     size=1.1),
25-01-17 16:23:47 | I |   eval=LlmEvalConfig(
25-01-17 16:23:47 | I |     num_gpus=1,
25-01-17 16:23:47 | I |     batch_size=8,
25-01-17 16:23:47 | I |     output_root=runs,
25-01-17 16:23:47 | I |     output_dirname=skip.y.[q]-krnl-rot-rodr.Seq.[fc2]-smth.xw.a0p3.b0p7.[AbsMax].[out+fc2].yx.a0p5.b0.[AbsMax].[qk]-pileval.128x1024.[0-0]-250117.162347,
25-01-17 16:23:47 | I |     attach_timestamp=True,
25-01-17 16:23:47 | I |     timestamp=250117.162347,
25-01-17 16:23:47 | I |     output_dirname_without_timestamp=skip.y.[q]-krnl-rot-rodr.Seq.[fc2]-smth.xw.a0p3.b0p7.[AbsMax].[out+fc2].yx.a0p5.b0.[AbsMax].[qk]-pileval.128x1024.[0-0],
25-01-17 16:23:47 | I |     tasks=['wikitext'],
25-01-17 16:23:47 | I |     max_seq_length=-4096,
25-01-17 16:23:47 | I |     evaluator=gptq),
25-01-17 16:23:47 | I |   calib=LlmCalibConfig(
25-01-17 16:23:47 | I |     data=pileval,
25-01-17 16:23:47 | I |     num_samples=128,
25-01-17 16:23:47 | I |     cache_root=runs,
25-01-17 16:23:47 | I |     cache_dirpath=runs/llm/cache/pileval.128x1024.[0-0],
25-01-17 16:23:47 | I |     dataset_path=mit-han-lab/pile-val-backup,
25-01-17 16:23:47 | I |     seq_length=1024,
25-01-17 16:23:47 | I |     min_seq_length=0,
25-01-17 16:23:47 | I |     max_seq_length=0,
25-01-17 16:23:47 | I |     local_dataset_path=/dataset/pile),
25-01-17 16:23:47 | I |   quant=LlmQuantConfig(
25-01-17 16:23:47 | I |     wgts=WeightQuantizerConfig(
25-01-17 16:23:47 | I |       dtype=zint4,
25-01-17 16:23:47 | I |       group_shapes=((1, -1, -1), (1, 128, -1)),
25-01-17 16:23:47 | I |       group_scale_dtypes=(torch.float16, sint8),
25-01-17 16:23:47 | I |       compute_dtype=sint8,
25-01-17 16:23:47 | I |       compute_group_level=0,
25-01-17 16:23:47 | I |       saturate_compute_dtype=False,
25-01-17 16:23:47 | I |       exponent_scaling_level=2,
25-01-17 16:23:47 | I |       skips=['embed', 'head', 'router'],
25-01-17 16:23:47 | I |       static=True,
25-01-17 16:23:47 | I |       calib_kernel=QuantizerKernelConfig(
25-01-17 16:23:47 | I |         _kernels={'proj_1st': QuantGPTQConfig(includes=['proj_1st', 'proj_2nd', 'proj_out', 'proj_qkv'], damp_percentage=0.01, block_size=128, num_inv_tries=250, hessian_block_size=512), 'proj_2nd': QuantGPTQConfig(includes=['proj_1st', 'proj_2nd', 'proj_out', 'proj_qkv'], damp_percentage=0.01, block_size=128, num_inv_tries=250, hessian_block_size=512), 'proj_out': QuantGPTQConfig(includes=['proj_1st', 'proj_2nd', 'proj_out', 'proj_qkv'], damp_percentage=0.01, block_size=128, num_inv_tries=250, hessian_block_size=512), 'proj_qkv': QuantGPTQConfig(includes=['proj_1st', 'proj_2nd', 'proj_out', 'proj_qkv'], damp_percentage=0.01, block_size=128, num_inv_tries=250, hessian_block_size=512)},
25-01-17 16:23:47 | I |         gptq=QuantGPTQConfig(
25-01-17 16:23:47 | I |           includes=['proj_1st', 'proj_2nd', 'proj_out', 'proj_qkv'],
25-01-17 16:23:47 | I |           damp_percentage=0.01,
25-01-17 16:23:47 | I |           block_size=128,
25-01-17 16:23:47 | I |           num_inv_tries=250,
25-01-17 16:23:47 | I |           hessian_block_size=512)),
25-01-17 16:23:47 | I |       calib_range=DynamicRangeCalibConfig(
25-01-17 16:23:47 | I |         degree=2,
25-01-17 16:23:47 | I |         skips=[],
25-01-17 16:23:47 | I |         objective=SearchBasedCalibObjective.OutputsError,
25-01-17 16:23:47 | I |         strategy=SearchBasedCalibStrategy.Manual,
25-01-17 16:23:47 | I |         granularity=SearchBasedCalibGranularity.Group,
25-01-17 16:23:47 | I |         element_batch_size=64,
25-01-17 16:23:47 | I |         sample_batch_size=-1,
25-01-17 16:23:47 | I |         element_size=512,
25-01-17 16:23:47 | I |         sample_size=-1,
25-01-17 16:23:47 | I |         pre_reshape=True,
25-01-17 16:23:47 | I |         outputs_device=cpu,
25-01-17 16:23:47 | I |         allow_kernel_calib=False,
25-01-17 16:23:47 | I |         ratio=1.0,
25-01-17 16:23:47 | I |         max_shrink=0.2,
25-01-17 16:23:47 | I |         max_expand=1.0,
25-01-17 16:23:47 | I |         num_grids=80)),
25-01-17 16:23:47 | I |     ipts=ActivationQuantizerConfig(
25-01-17 16:23:47 | I |       dtype=sint8,
25-01-17 16:23:47 | I |       group_shapes=((1, -1, -1),),
25-01-17 16:23:47 | I |       group_scale_dtypes=(torch.float16,),
25-01-17 16:23:47 | I |       compute_dtype=None,
25-01-17 16:23:47 | I |       compute_group_level=-1,
25-01-17 16:23:47 | I |       saturate_compute_dtype=False,
25-01-17 16:23:47 | I |       exponent_scaling_level=1,
25-01-17 16:23:47 | I |       skips=['embed', 'head', 'router'],
25-01-17 16:23:47 | I |       static=False,
25-01-17 16:23:47 | I |       calib_kernel=None,
25-01-17 16:23:47 | I |       calib_range=None),
25-01-17 16:23:47 | I |     opts=ActivationQuantizerConfig(
25-01-17 16:23:47 | I |       dtype=zint4,
25-01-17 16:23:47 | I |       group_shapes=((1, 128, -1),),
25-01-17 16:23:47 | I |       group_scale_dtypes=(torch.float16,),
25-01-17 16:23:47 | I |       compute_dtype=None,
25-01-17 16:23:47 | I |       compute_group_level=-1,
25-01-17 16:23:47 | I |       saturate_compute_dtype=False,
25-01-17 16:23:47 | I |       exponent_scaling_level=1,
25-01-17 16:23:47 | I |       skips=['attn_q'],
25-01-17 16:23:47 | I |       static=False,
25-01-17 16:23:47 | I |       calib_kernel=None,
25-01-17 16:23:47 | I |       calib_range=None),
25-01-17 16:23:47 | I |     rotation=QuantRotationConfig(
25-01-17 16:23:47 | I |       random=False,
25-01-17 16:23:47 | I |       transforms=[]),
25-01-17 16:23:47 | I |     reorder=QuantReorderConfig(
25-01-17 16:23:47 | I |       degree=2,
25-01-17 16:23:47 | I |       skips=['proj_out', 'proj_qkv', 'residual'],
25-01-17 16:23:47 | I |       objective=SearchBasedCalibObjective.OutputsError,
25-01-17 16:23:47 | I |       strategy=SearchBasedCalibStrategy.Manual,
25-01-17 16:23:47 | I |       granularity=SearchBasedCalibGranularity.Layer,
25-01-17 16:23:47 | I |       element_batch_size=-1,
25-01-17 16:23:47 | I |       sample_batch_size=-1,
25-01-17 16:23:47 | I |       element_size=-1,
25-01-17 16:23:47 | I |       sample_size=-1,
25-01-17 16:23:47 | I |       pre_reshape=True,
25-01-17 16:23:47 | I |       outputs_device=cpu,
25-01-17 16:23:47 | I |       allow_kernel_calib=False,
25-01-17 16:23:47 | I |       channel_metric=ChannelMetric.InputsAbsMax,
25-01-17 16:23:47 | I |       channel_index=ChannelIndex.Sequential,
25-01-17 16:23:47 | I |       dynamic=False),
25-01-17 16:23:47 | I |     smooth=QuantSmoothConfig(
25-01-17 16:23:47 | I |       xw=QuantSmoothCalibConfig(
25-01-17 16:23:47 | I |         degree=2,
25-01-17 16:23:47 | I |         skips=['proj_1st', 'proj_qkv'],
25-01-17 16:23:47 | I |         objective=SearchBasedCalibObjective.OutputsError,
25-01-17 16:23:47 | I |         strategy=SearchBasedCalibStrategy.Manual,
25-01-17 16:23:47 | I |         granularity=SearchBasedCalibGranularity.Layer,
25-01-17 16:23:47 | I |         element_batch_size=-1,
25-01-17 16:23:47 | I |         sample_batch_size=-1,
25-01-17 16:23:47 | I |         element_size=-1,
25-01-17 16:23:47 | I |         sample_size=-1,
25-01-17 16:23:47 | I |         pre_reshape=True,
25-01-17 16:23:47 | I |         outputs_device=cpu,
25-01-17 16:23:47 | I |         allow_kernel_calib=False,
25-01-17 16:23:47 | I |         ranges=[(<RangeMode.AbsMax: 1>, <RangeMode.AbsMax: 1>)],
25-01-17 16:23:47 | I |         x_ranges=[<RangeMode.AbsMax: 1>],
25-01-17 16:23:47 | I |         w_ranges=[<RangeMode.AbsMax: 1>],
25-01-17 16:23:47 | I |         alpha=0.3,
25-01-17 16:23:47 | I |         beta=0.7,
25-01-17 16:23:47 | I |         num_grids=20),
25-01-17 16:23:47 | I |       yx=QuantSmoothCalibConfig(
25-01-17 16:23:47 | I |         degree=2,
25-01-17 16:23:47 | I |         skips=[],
25-01-17 16:23:47 | I |         objective=SearchBasedCalibObjective.OutputsError,
25-01-17 16:23:47 | I |         strategy=SearchBasedCalibStrategy.Manual,
25-01-17 16:23:47 | I |         granularity=SearchBasedCalibGranularity.Layer,
25-01-17 16:23:47 | I |         element_batch_size=-1,
25-01-17 16:23:47 | I |         sample_batch_size=-1,
25-01-17 16:23:47 | I |         element_size=-1,
25-01-17 16:23:47 | I |         sample_size=-1,
25-01-17 16:23:47 | I |         pre_reshape=True,
25-01-17 16:23:47 | I |         outputs_device=cpu,
25-01-17 16:23:47 | I |         allow_kernel_calib=False,
25-01-17 16:23:47 | I |         ranges=[(<RangeMode.AbsMax: 1>, <RangeMode.AbsMax: 1>)],
25-01-17 16:23:47 | I |         x_ranges=[<RangeMode.AbsMax: 1>],
25-01-17 16:23:47 | I |         w_ranges=[<RangeMode.AbsMax: 1>],
25-01-17 16:23:47 | I |         alpha=0.5,
25-01-17 16:23:47 | I |         beta=0.0,
25-01-17 16:23:47 | I |         num_grids=20)),
25-01-17 16:23:47 | I |     bias_correction=False,
25-01-17 16:23:47 | I |     post_rotary=True,
25-01-17 16:23:47 | I |     develop_dtype=torch.float32,
25-01-17 16:23:47 | I |     select_wgts=None,
25-01-17 16:23:47 | I |     select_ipts=None,
25-01-17 16:23:47 | I |     select_opts=None,
25-01-17 16:23:47 | I |     keywords_i={'proj_qkv': ['q_proj', 'k_proj', 'v_proj'], 'proj_out': ['out_proj', 'o_proj'], 'proj_1st': ['fc1', 'up_proj', 'gate_proj', 'w1', 'w3'], 'proj_2nd': ['fc2', 'down_proj', 'w2'], 'head': ['output', 'score', 'qa_outputs'], 'embed': ['embed', 'lm_head', 'embed_out'], 'router': ['block_sparse_moe']},
25-01-17 16:23:47 | I |     keywords_w={'proj_qkv': ['q_proj', 'k_proj', 'v_proj'], 'proj_out': ['out_proj', 'o_proj'], 'proj_1st': ['fc1', 'up_proj', 'gate_proj', 'w1', 'w3'], 'proj_2nd': ['fc2', 'down_proj', 'w2'], 'head': ['output', 'score', 'qa_outputs'], 'embed': ['embed', 'lm_head', 'embed_out'], 'router': ['block_sparse_moe.gate']},
25-01-17 16:23:47 | I |     keywords_o={'attn_q': ['q_rotary_emb'], 'attn_k': ['k_rotary_emb'], 'attn_v': ['v_proj']},
25-01-17 16:23:47 | I |     module_types_i=(<class 'torch.nn.modules.linear.Linear'>, <class 'transformers.models.mixtral.modeling_mixtral.MixtralSparseMoeBlock'>),
25-01-17 16:23:47 | I |     module_types_w=(<class 'torch.nn.modules.linear.Linear'>,),
25-01-17 16:23:47 | I |     module_types_o=(<class 'torch.nn.modules.linear.Linear'>, <class 'lmquant.llm.nn.attention.RotaryEmbedding'>),
25-01-17 16:23:47 | I |     num_hidden_layers=-1),
25-01-17 16:23:47 | I |   seed=12345,
25-01-17 16:23:47 | I |   save_model=True,
25-01-17 16:23:47 | I |   output_dirpath=runs/llm/tiny/tiny-llama-1.1b/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/rot-reorder-smooth.xw.yx-w.static.kernel/skip.y.[q]-krnl-rot-rodr.Seq.[fc2]-smth.xw.a0p3.b0p7.[AbsMax].[out+fc2].yx.a0p5.b0.[AbsMax].[qk]-pileval.128x1024.[0-0]-250117.162347,
25-01-17 16:23:47 | I |   cache_dirpath=LlmQuantCachePath(rotation='runs/llm/cache/rotation/hadamard', reorder='runs/llm/cache/pileval.128x1024.[0-0]/reorder/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]', smooth='runs/llm/cache/pileval.128x1024.[0-0]/smooth/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]/smooth.xw.OutputsError.Manual.Layer.d2.en1.sn1-yx.OutputsError.Manual.Layer.d2.en1.sn1/smooth.xw.[x.AbsMax.w.AbsMax]-yx.[x.AbsMax.w.AbsMax]/smooth.xw.a0p3.b0p7-yx.a0p5.b0/smooth.xw.skip.[proj_1st+proj_qkv]-yx.skip.[]', wgts='runs/llm/cache/pileval.128x1024.[0-0]/wgts/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]/smooth.xw.OutputsError.Manual.Layer.d2.en1.sn1-yx.OutputsError.Manual.Layer.d2.en1.sn1/smooth.xw.[x.AbsMax.w.AbsMax]-yx.[x.AbsMax.w.AbsMax]/smooth.xw.a0p3.b0p7-yx.a0p5.b0/smooth.xw.skip.[proj_1st+proj_qkv]-yx.skip.[]/w.kernel.gptq.d0p01.b128/w.kernel.gptq.include.[proj_1st+proj_2nd+proj_out+proj_qkv]/w.range.OutputsError.Manual.Group.d2.e512.sn1/w.range.r.[1].static/w.range.skip.[]', acts=''),
25-01-17 16:23:47 | I |   cache_path=LlmQuantCachePath(rotation='runs/llm/cache/rotation/hadamard/tiny-llama-1.1b.pt', reorder='runs/llm/cache/pileval.128x1024.[0-0]/reorder/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]/tiny-llama-1.1b.pt', smooth='runs/llm/cache/pileval.128x1024.[0-0]/smooth/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]/smooth.xw.OutputsError.Manual.Layer.d2.en1.sn1-yx.OutputsError.Manual.Layer.d2.en1.sn1/smooth.xw.[x.AbsMax.w.AbsMax]-yx.[x.AbsMax.w.AbsMax]/smooth.xw.a0p3.b0p7-yx.a0p5.b0/smooth.xw.skip.[proj_1st+proj_qkv]-yx.skip.[]/tiny-llama-1.1b.pt', wgts='runs/llm/cache/pileval.128x1024.[0-0]/wgts/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]/smooth.xw.OutputsError.Manual.Layer.d2.en1.sn1-yx.OutputsError.Manual.Layer.d2.en1.sn1/smooth.xw.[x.AbsMax.w.AbsMax]-yx.[x.AbsMax.w.AbsMax]/smooth.xw.a0p3.b0p7-yx.a0p5.b0/smooth.xw.skip.[proj_1st+proj_qkv]-yx.skip.[]/w.kernel.gptq.d0p01.b128/w.kernel.gptq.include.[proj_1st+proj_2nd+proj_out+proj_qkv]/w.range.OutputsError.Manual.Group.d2.e512.sn1/w.range.r.[1].static/w.range.skip.[]/tiny-llama-1.1b.pt', acts=''),
25-01-17 16:23:47 | I |   fairseq_args=/data/gyy/lmquant-main/projects/llm/configs/fairseq_args_1.1b_with_preprocess.json,
25-01-17 16:23:47 | I |   gen_teacher_opts=False,
25-01-17 16:23:47 | I |   enable_cache=True,
25-01-17 16:23:47 | I |   with_preprocess=True)
25-01-17 16:23:47 | I | === Dumped Configurations ===
25-01-17 16:23:47 | I | { 'calib': { 'cache_root': 'runs',
25-01-17 16:23:47 | I |              'data': 'pileval',
25-01-17 16:23:47 | I |              'dataset_path': 'mit-han-lab/pile-val-backup',
25-01-17 16:23:47 | I |              'local_dataset_path': '/dataset/pile',
25-01-17 16:23:47 | I |              'max_seq_length': 0,
25-01-17 16:23:47 | I |              'min_seq_length': 0,
25-01-17 16:23:47 | I |              'num_samples': 128,
25-01-17 16:23:47 | I |              'seq_length': 1024},
25-01-17 16:23:47 | I |   'enable_cache': True,
25-01-17 16:23:47 | I |   'eval': { 'attach_timestamp': True,
25-01-17 16:23:47 | I |             'batch_size': 8,
25-01-17 16:23:47 | I |             'evaluator': 'gptq',
25-01-17 16:23:47 | I |             'max_seq_length': -4096,
25-01-17 16:23:47 | I |             'num_gpus': 1,
25-01-17 16:23:47 | I |             'output_dirname': 'skip.y.[q]-krnl-rot-rodr.Seq.[fc2]-smth.xw.a0p3.b0p7.[AbsMax].[out+fc2].yx.a0p5.b0.[AbsMax].[qk]-pileval.128x1024.[0-0]-250117.162347',
25-01-17 16:23:47 | I |             'output_root': 'runs',
25-01-17 16:23:47 | I |             'tasks': ['wikitext']},
25-01-17 16:23:47 | I |   'fairseq_args': '/data/gyy/lmquant-main/projects/llm/configs/fairseq_args_1.1b_with_preprocess.json',
25-01-17 16:23:47 | I |   'gen_teacher_opts': False,
25-01-17 16:23:47 | I |   'model': { 'local_path': '/dataset/models/tiny/tiny-llama-1.1b',
25-01-17 16:23:47 | I |              'local_root': '/dataset/models',
25-01-17 16:23:47 | I |              'name': 'tiny-llama-1.1b',
25-01-17 16:23:47 | I |              'path': '/data/gyy/TinyLlama',
25-01-17 16:23:47 | I |              'root': '/dataset/models'},
25-01-17 16:23:47 | I |   'quant': { 'bias_correction': False,
25-01-17 16:23:47 | I |              'develop_dtype': 'torch.float32',
25-01-17 16:23:47 | I |              'enable_reorder': True,
25-01-17 16:23:47 | I |              'enable_rotation': True,
25-01-17 16:23:47 | I |              'enable_select_ipts': False,
25-01-17 16:23:47 | I |              'enable_select_opts': False,
25-01-17 16:23:47 | I |              'enable_select_wgts': False,
25-01-17 16:23:47 | I |              'enable_smooth': True,
25-01-17 16:23:47 | I |              'ipts': { 'compute_dtype': None,
25-01-17 16:23:47 | I |                        'compute_group_level': -1,
25-01-17 16:23:47 | I |                        'dtype': 'sint8',
25-01-17 16:23:47 | I |                        'enable_calib_range': False,
25-01-17 16:23:47 | I |                        'group_scale_dtypes': ['torch.float16'],
25-01-17 16:23:47 | I |                        'group_shapes': [[1, -1, -1]],
25-01-17 16:23:47 | I |                        'saturate_compute_dtype': False,
25-01-17 16:23:47 | I |                        'skips': ['embed', 'head', 'router'],
25-01-17 16:23:47 | I |                        'static': False},
25-01-17 16:23:47 | I |              'opts': { 'compute_dtype': None,
25-01-17 16:23:47 | I |                        'compute_group_level': -1,
25-01-17 16:23:47 | I |                        'dtype': 'zint4',
25-01-17 16:23:47 | I |                        'enable_calib_range': False,
25-01-17 16:23:47 | I |                        'group_scale_dtypes': ['torch.float16'],
25-01-17 16:23:47 | I |                        'group_shapes': [[1, 128, -1]],
25-01-17 16:23:47 | I |                        'saturate_compute_dtype': False,
25-01-17 16:23:47 | I |                        'skips': ['attn_q'],
25-01-17 16:23:47 | I |                        'static': False},
25-01-17 16:23:47 | I |              'post_rotary': True,
25-01-17 16:23:47 | I |              'reorder': { 'allow_kernel_calib': False,
25-01-17 16:23:47 | I |                           'channel_index': 'Sequential',
25-01-17 16:23:47 | I |                           'channel_metric': 'InputsAbsMax',
25-01-17 16:23:47 | I |                           'degree': 2,
25-01-17 16:23:47 | I |                           'dynamic': False,
25-01-17 16:23:47 | I |                           'element_batch_size': -1,
25-01-17 16:23:47 | I |                           'element_size': -1,
25-01-17 16:23:47 | I |                           'outputs_device': 'cpu',
25-01-17 16:23:47 | I |                           'pre_reshape': True,
25-01-17 16:23:47 | I |                           'sample_batch_size': -1,
25-01-17 16:23:47 | I |                           'sample_size': -1,
25-01-17 16:23:47 | I |                           'skips': ['proj_out', 'proj_qkv', 'residual'],
25-01-17 16:23:47 | I |                           'strategy': 'Manual'},
25-01-17 16:23:47 | I |              'rotation': {'random': False, 'transforms': []},
25-01-17 16:23:47 | I |              'smooth': { 'enable_xw': True,
25-01-17 16:23:47 | I |                          'enable_yx': True,
25-01-17 16:23:47 | I |                          'xw': { 'allow_kernel_calib': False,
25-01-17 16:23:47 | I |                                  'alpha': 0.3,
25-01-17 16:23:47 | I |                                  'beta': 0.7,
25-01-17 16:23:47 | I |                                  'degree': 2,
25-01-17 16:23:47 | I |                                  'element_batch_size': -1,
25-01-17 16:23:47 | I |                                  'element_size': -1,
25-01-17 16:23:47 | I |                                  'granularity': 'Layer',
25-01-17 16:23:47 | I |                                  'num_grids': 20,
25-01-17 16:23:47 | I |                                  'objective': 'OutputsError',
25-01-17 16:23:47 | I |                                  'outputs_device': 'cpu',
25-01-17 16:23:47 | I |                                  'pre_reshape': True,
25-01-17 16:23:47 | I |                                  'ranges': [['AbsMax', 'AbsMax']],
25-01-17 16:23:47 | I |                                  'sample_batch_size': -1,
25-01-17 16:23:47 | I |                                  'sample_size': -1,
25-01-17 16:23:47 | I |                                  'skips': ['proj_1st', 'proj_qkv'],
25-01-17 16:23:47 | I |                                  'strategy': 'Manual'},
25-01-17 16:23:47 | I |                          'yx': { 'allow_kernel_calib': False,
25-01-17 16:23:47 | I |                                  'alpha': 0.5,
25-01-17 16:23:47 | I |                                  'beta': 0.0,
25-01-17 16:23:47 | I |                                  'degree': 2,
25-01-17 16:23:47 | I |                                  'element_batch_size': -1,
25-01-17 16:23:47 | I |                                  'element_size': -1,
25-01-17 16:23:47 | I |                                  'granularity': 'Layer',
25-01-17 16:23:47 | I |                                  'num_grids': 20,
25-01-17 16:23:47 | I |                                  'objective': 'OutputsError',
25-01-17 16:23:47 | I |                                  'outputs_device': 'cpu',
25-01-17 16:23:47 | I |                                  'pre_reshape': True,
25-01-17 16:23:47 | I |                                  'ranges': [['AbsMax', 'AbsMax']],
25-01-17 16:23:47 | I |                                  'sample_batch_size': -1,
25-01-17 16:23:47 | I |                                  'sample_size': -1,
25-01-17 16:23:47 | I |                                  'skips': [],
25-01-17 16:23:47 | I |                                  'strategy': 'Manual'}},
25-01-17 16:23:47 | I |              'wgts': { 'calib_kernel': { 'enable_gptq': True,
25-01-17 16:23:47 | I |                                          'gptq': { 'block_size': 128,
25-01-17 16:23:47 | I |                                                    'damp_percentage': 0.01,
25-01-17 16:23:47 | I |                                                    'hessian_block_size': 512,
25-01-17 16:23:47 | I |                                                    'includes': ['proj_1st', 'proj_2nd', 'proj_out', 'proj_qkv'],
25-01-17 16:23:47 | I |                                                    'num_inv_tries': 250}},
25-01-17 16:23:47 | I |                        'calib_range': { 'allow_kernel_calib': False,
25-01-17 16:23:47 | I |                                         'degree': 2,
25-01-17 16:23:47 | I |                                         'element_batch_size': 64,
25-01-17 16:23:47 | I |                                         'element_size': 512,
25-01-17 16:23:47 | I |                                         'granularity': 'Group',
25-01-17 16:23:47 | I |                                         'max_expand': 1.0,
25-01-17 16:23:47 | I |                                         'max_shrink': 0.2,
25-01-17 16:23:47 | I |                                         'num_grids': 80,
25-01-17 16:23:47 | I |                                         'objective': 'OutputsError',
25-01-17 16:23:47 | I |                                         'outputs_device': 'cpu',
25-01-17 16:23:47 | I |                                         'pre_reshape': True,
25-01-17 16:23:47 | I |                                         'ratio': 1.0,
25-01-17 16:23:47 | I |                                         'sample_batch_size': -1,
25-01-17 16:23:47 | I |                                         'sample_size': -1,
25-01-17 16:23:47 | I |                                         'skips': [],
25-01-17 16:23:47 | I |                                         'strategy': 'Manual'},
25-01-17 16:23:47 | I |                        'compute_dtype': 'sint8',
25-01-17 16:23:47 | I |                        'compute_group_level': 0,
25-01-17 16:23:47 | I |                        'dtype': 'zint4',
25-01-17 16:23:47 | I |                        'enable_calib_kernel': True,
25-01-17 16:23:47 | I |                        'enable_calib_range': True,
25-01-17 16:23:47 | I |                        'group_scale_dtypes': ['torch.float16', 'sint8'],
25-01-17 16:23:47 | I |                        'group_shapes': [[1, -1, -1], [1, 128, -1]],
25-01-17 16:23:47 | I |                        'saturate_compute_dtype': False,
25-01-17 16:23:47 | I |                        'skips': ['embed', 'head', 'router']}},
25-01-17 16:23:47 | I |   'save_model': True,
25-01-17 16:23:47 | I |   'seed': 12345,
25-01-17 16:23:47 | I |   'with_preprocess': True}
25-01-17 16:23:47 | I | === Output Directory ===
25-01-17 16:23:47 | I | runs/llm/tiny/tiny-llama-1.1b/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/rot-reorder-smooth.xw.yx-w.static.kernel/skip.y.[q]-krnl-rot-rodr.Seq.[fc2]-smth.xw.a0p3.b0p7.[AbsMax].[out+fc2].yx.a0p5.b0.[AbsMax].[qk]-pileval.128x1024.[0-0]-250117.162347
25-01-17 16:23:47 | I | === Start Evaluating ===
25-01-17 16:23:47 | I | * Building model tiny-llama-1.1b from /data/gyy/TinyLlama
25-01-17 16:23:47 | I | We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.0.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.1.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.2.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.3.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.4.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.5.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.6.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.7.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.8.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.9.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.10.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.11.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.12.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.13.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.14.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.15.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.16.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.17.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.18.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.19.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.20.self_attn
25-01-17 16:23:48 | I | - Patching LlamaSdpaAttention.forward in model.layers.21.self_attn
25-01-17 16:23:48 | I | * Development dtype is torch.float32
25-01-17 16:23:48 | I | * Rotating model
25-01-17 16:23:48 | I |   - Loading rotation from runs/llm/cache/rotation/hadamard/tiny-llama-1.1b.pt
25-01-17 16:23:48 | D |   - Transforming norm and linear in model.layers.0
25-01-17 16:23:49 | D |   - Transforming norm and linear in model.layers.1
25-01-17 16:23:49 | D |   - Transforming norm and linear in model.layers.2
25-01-17 16:23:49 | D |   - Transforming norm and linear in model.layers.3
25-01-17 16:23:49 | D |   - Transforming norm and linear in model.layers.4
25-01-17 16:23:50 | D |   - Transforming norm and linear in model.layers.5
25-01-17 16:23:50 | D |   - Transforming norm and linear in model.layers.6
25-01-17 16:23:50 | D |   - Transforming norm and linear in model.layers.7
25-01-17 16:23:50 | D |   - Transforming norm and linear in model.layers.8
25-01-17 16:23:50 | D |   - Transforming norm and linear in model.layers.9
25-01-17 16:23:51 | D |   - Transforming norm and linear in model.layers.10
25-01-17 16:23:51 | D |   - Transforming norm and linear in model.layers.11
25-01-17 16:23:51 | D |   - Transforming norm and linear in model.layers.12
25-01-17 16:23:51 | D |   - Transforming norm and linear in model.layers.13
25-01-17 16:23:51 | D |   - Transforming norm and linear in model.layers.14
25-01-17 16:23:52 | D |   - Transforming norm and linear in model.layers.15
25-01-17 16:23:52 | D |   - Transforming norm and linear in model.layers.16
25-01-17 16:23:52 | D |   - Transforming norm and linear in model.layers.17
25-01-17 16:23:52 | D |   - Transforming norm and linear in model.layers.18
25-01-17 16:23:53 | D |   - Transforming norm and linear in model.layers.19
25-01-17 16:23:53 | D |   - Transforming norm and linear in model.layers.20
25-01-17 16:23:53 | D |   - Transforming norm and linear in model.layers.21
25-01-17 16:23:53 | D |   - Transforming model.norm
25-01-17 16:23:53 | D |   - Rotating model.embed_tokens
25-01-17 16:23:53 | D |   - Rotating model.layers.0
25-01-17 16:23:53 | D |     - Rotating model.layers.0.self_attn.q_proj (in)
25-01-17 16:23:54 | D |     - Rotating model.layers.0.self_attn.k_proj (in)
25-01-17 16:23:54 | D |     - Rotating model.layers.0.self_attn.v_proj (in)
25-01-17 16:23:54 | D |     - Rotating model.layers.0.self_attn.o_proj (out)
25-01-17 16:23:54 | D |     - Rotating model.layers.0.proj_1st (in)
25-01-17 16:23:54 | D |     - Rotating model.layers.0.proj_2nd (out)
25-01-17 16:23:54 | D |   - Rotating model.layers.1
25-01-17 16:23:54 | D |     - Rotating model.layers.1.self_attn.q_proj (in)
25-01-17 16:23:54 | D |     - Rotating model.layers.1.self_attn.k_proj (in)
25-01-17 16:23:54 | D |     - Rotating model.layers.1.self_attn.v_proj (in)
25-01-17 16:23:54 | D |     - Rotating model.layers.1.self_attn.o_proj (out)
25-01-17 16:23:54 | D |     - Rotating model.layers.1.proj_1st (in)
25-01-17 16:23:54 | D |     - Rotating model.layers.1.proj_2nd (out)
25-01-17 16:23:54 | D |   - Rotating model.layers.2
25-01-17 16:23:54 | D |     - Rotating model.layers.2.self_attn.q_proj (in)
25-01-17 16:23:54 | D |     - Rotating model.layers.2.self_attn.k_proj (in)
25-01-17 16:23:54 | D |     - Rotating model.layers.2.self_attn.v_proj (in)
25-01-17 16:23:54 | D |     - Rotating model.layers.2.self_attn.o_proj (out)
25-01-17 16:23:54 | D |     - Rotating model.layers.2.proj_1st (in)
25-01-17 16:23:54 | D |     - Rotating model.layers.2.proj_2nd (out)
25-01-17 16:23:55 | D |   - Rotating model.layers.3
25-01-17 16:23:55 | D |     - Rotating model.layers.3.self_attn.q_proj (in)
25-01-17 16:23:55 | D |     - Rotating model.layers.3.self_attn.k_proj (in)
25-01-17 16:23:55 | D |     - Rotating model.layers.3.self_attn.v_proj (in)
25-01-17 16:23:55 | D |     - Rotating model.layers.3.self_attn.o_proj (out)
25-01-17 16:23:55 | D |     - Rotating model.layers.3.proj_1st (in)
25-01-17 16:23:55 | D |     - Rotating model.layers.3.proj_2nd (out)
25-01-17 16:23:55 | D |   - Rotating model.layers.4
25-01-17 16:23:55 | D |     - Rotating model.layers.4.self_attn.q_proj (in)
25-01-17 16:23:55 | D |     - Rotating model.layers.4.self_attn.k_proj (in)
25-01-17 16:23:55 | D |     - Rotating model.layers.4.self_attn.v_proj (in)
25-01-17 16:23:55 | D |     - Rotating model.layers.4.self_attn.o_proj (out)
25-01-17 16:23:55 | D |     - Rotating model.layers.4.proj_1st (in)
25-01-17 16:23:55 | D |     - Rotating model.layers.4.proj_2nd (out)
25-01-17 16:23:55 | D |   - Rotating model.layers.5
25-01-17 16:23:55 | D |     - Rotating model.layers.5.self_attn.q_proj (in)
25-01-17 16:23:55 | D |     - Rotating model.layers.5.self_attn.k_proj (in)
25-01-17 16:23:55 | D |     - Rotating model.layers.5.self_attn.v_proj (in)
25-01-17 16:23:55 | D |     - Rotating model.layers.5.self_attn.o_proj (out)
25-01-17 16:23:55 | D |     - Rotating model.layers.5.proj_1st (in)
25-01-17 16:23:55 | D |     - Rotating model.layers.5.proj_2nd (out)
25-01-17 16:23:56 | D |   - Rotating model.layers.6
25-01-17 16:23:56 | D |     - Rotating model.layers.6.self_attn.q_proj (in)
25-01-17 16:23:56 | D |     - Rotating model.layers.6.self_attn.k_proj (in)
25-01-17 16:23:56 | D |     - Rotating model.layers.6.self_attn.v_proj (in)
25-01-17 16:23:56 | D |     - Rotating model.layers.6.self_attn.o_proj (out)
25-01-17 16:23:56 | D |     - Rotating model.layers.6.proj_1st (in)
25-01-17 16:23:56 | D |     - Rotating model.layers.6.proj_2nd (out)
25-01-17 16:23:56 | D |   - Rotating model.layers.7
25-01-17 16:23:56 | D |     - Rotating model.layers.7.self_attn.q_proj (in)
25-01-17 16:23:56 | D |     - Rotating model.layers.7.self_attn.k_proj (in)
25-01-17 16:23:56 | D |     - Rotating model.layers.7.self_attn.v_proj (in)
25-01-17 16:23:56 | D |     - Rotating model.layers.7.self_attn.o_proj (out)
25-01-17 16:23:56 | D |     - Rotating model.layers.7.proj_1st (in)
25-01-17 16:23:56 | D |     - Rotating model.layers.7.proj_2nd (out)
25-01-17 16:23:56 | D |   - Rotating model.layers.8
25-01-17 16:23:56 | D |     - Rotating model.layers.8.self_attn.q_proj (in)
25-01-17 16:23:56 | D |     - Rotating model.layers.8.self_attn.k_proj (in)
25-01-17 16:23:56 | D |     - Rotating model.layers.8.self_attn.v_proj (in)
25-01-17 16:23:56 | D |     - Rotating model.layers.8.self_attn.o_proj (out)
25-01-17 16:23:56 | D |     - Rotating model.layers.8.proj_1st (in)
25-01-17 16:23:56 | D |     - Rotating model.layers.8.proj_2nd (out)
25-01-17 16:23:57 | D |   - Rotating model.layers.9
25-01-17 16:23:57 | D |     - Rotating model.layers.9.self_attn.q_proj (in)
25-01-17 16:23:57 | D |     - Rotating model.layers.9.self_attn.k_proj (in)
25-01-17 16:23:57 | D |     - Rotating model.layers.9.self_attn.v_proj (in)
25-01-17 16:23:57 | D |     - Rotating model.layers.9.self_attn.o_proj (out)
25-01-17 16:23:57 | D |     - Rotating model.layers.9.proj_1st (in)
25-01-17 16:23:57 | D |     - Rotating model.layers.9.proj_2nd (out)
25-01-17 16:23:57 | D |   - Rotating model.layers.10
25-01-17 16:23:57 | D |     - Rotating model.layers.10.self_attn.q_proj (in)
25-01-17 16:23:57 | D |     - Rotating model.layers.10.self_attn.k_proj (in)
25-01-17 16:23:57 | D |     - Rotating model.layers.10.self_attn.v_proj (in)
25-01-17 16:23:57 | D |     - Rotating model.layers.10.self_attn.o_proj (out)
25-01-17 16:23:57 | D |     - Rotating model.layers.10.proj_1st (in)
25-01-17 16:23:57 | D |     - Rotating model.layers.10.proj_2nd (out)
25-01-17 16:23:58 | D |   - Rotating model.layers.11
25-01-17 16:23:58 | D |     - Rotating model.layers.11.self_attn.q_proj (in)
25-01-17 16:23:58 | D |     - Rotating model.layers.11.self_attn.k_proj (in)
25-01-17 16:23:58 | D |     - Rotating model.layers.11.self_attn.v_proj (in)
25-01-17 16:23:58 | D |     - Rotating model.layers.11.self_attn.o_proj (out)
25-01-17 16:23:58 | D |     - Rotating model.layers.11.proj_1st (in)
25-01-17 16:23:58 | D |     - Rotating model.layers.11.proj_2nd (out)
25-01-17 16:23:58 | D |   - Rotating model.layers.12
25-01-17 16:23:58 | D |     - Rotating model.layers.12.self_attn.q_proj (in)
25-01-17 16:23:58 | D |     - Rotating model.layers.12.self_attn.k_proj (in)
25-01-17 16:23:58 | D |     - Rotating model.layers.12.self_attn.v_proj (in)
25-01-17 16:23:58 | D |     - Rotating model.layers.12.self_attn.o_proj (out)
25-01-17 16:23:58 | D |     - Rotating model.layers.12.proj_1st (in)
25-01-17 16:23:58 | D |     - Rotating model.layers.12.proj_2nd (out)
25-01-17 16:23:58 | D |   - Rotating model.layers.13
25-01-17 16:23:58 | D |     - Rotating model.layers.13.self_attn.q_proj (in)
25-01-17 16:23:58 | D |     - Rotating model.layers.13.self_attn.k_proj (in)
25-01-17 16:23:58 | D |     - Rotating model.layers.13.self_attn.v_proj (in)
25-01-17 16:23:58 | D |     - Rotating model.layers.13.self_attn.o_proj (out)
25-01-17 16:23:58 | D |     - Rotating model.layers.13.proj_1st (in)
25-01-17 16:23:58 | D |     - Rotating model.layers.13.proj_2nd (out)
25-01-17 16:23:59 | D |   - Rotating model.layers.14
25-01-17 16:23:59 | D |     - Rotating model.layers.14.self_attn.q_proj (in)
25-01-17 16:23:59 | D |     - Rotating model.layers.14.self_attn.k_proj (in)
25-01-17 16:23:59 | D |     - Rotating model.layers.14.self_attn.v_proj (in)
25-01-17 16:23:59 | D |     - Rotating model.layers.14.self_attn.o_proj (out)
25-01-17 16:23:59 | D |     - Rotating model.layers.14.proj_1st (in)
25-01-17 16:23:59 | D |     - Rotating model.layers.14.proj_2nd (out)
25-01-17 16:23:59 | D |   - Rotating model.layers.15
25-01-17 16:23:59 | D |     - Rotating model.layers.15.self_attn.q_proj (in)
25-01-17 16:23:59 | D |     - Rotating model.layers.15.self_attn.k_proj (in)
25-01-17 16:23:59 | D |     - Rotating model.layers.15.self_attn.v_proj (in)
25-01-17 16:23:59 | D |     - Rotating model.layers.15.self_attn.o_proj (out)
25-01-17 16:23:59 | D |     - Rotating model.layers.15.proj_1st (in)
25-01-17 16:23:59 | D |     - Rotating model.layers.15.proj_2nd (out)
25-01-17 16:23:59 | D |   - Rotating model.layers.16
25-01-17 16:23:59 | D |     - Rotating model.layers.16.self_attn.q_proj (in)
25-01-17 16:23:59 | D |     - Rotating model.layers.16.self_attn.k_proj (in)
25-01-17 16:23:59 | D |     - Rotating model.layers.16.self_attn.v_proj (in)
25-01-17 16:23:59 | D |     - Rotating model.layers.16.self_attn.o_proj (out)
25-01-17 16:23:59 | D |     - Rotating model.layers.16.proj_1st (in)
25-01-17 16:23:59 | D |     - Rotating model.layers.16.proj_2nd (out)
25-01-17 16:24:00 | D |   - Rotating model.layers.17
25-01-17 16:24:00 | D |     - Rotating model.layers.17.self_attn.q_proj (in)
25-01-17 16:24:00 | D |     - Rotating model.layers.17.self_attn.k_proj (in)
25-01-17 16:24:00 | D |     - Rotating model.layers.17.self_attn.v_proj (in)
25-01-17 16:24:00 | D |     - Rotating model.layers.17.self_attn.o_proj (out)
25-01-17 16:24:00 | D |     - Rotating model.layers.17.proj_1st (in)
25-01-17 16:24:00 | D |     - Rotating model.layers.17.proj_2nd (out)
25-01-17 16:24:00 | D |   - Rotating model.layers.18
25-01-17 16:24:00 | D |     - Rotating model.layers.18.self_attn.q_proj (in)
25-01-17 16:24:00 | D |     - Rotating model.layers.18.self_attn.k_proj (in)
25-01-17 16:24:00 | D |     - Rotating model.layers.18.self_attn.v_proj (in)
25-01-17 16:24:00 | D |     - Rotating model.layers.18.self_attn.o_proj (out)
25-01-17 16:24:00 | D |     - Rotating model.layers.18.proj_1st (in)
25-01-17 16:24:00 | D |     - Rotating model.layers.18.proj_2nd (out)
25-01-17 16:24:00 | D |   - Rotating model.layers.19
25-01-17 16:24:00 | D |     - Rotating model.layers.19.self_attn.q_proj (in)
25-01-17 16:24:00 | D |     - Rotating model.layers.19.self_attn.k_proj (in)
25-01-17 16:24:00 | D |     - Rotating model.layers.19.self_attn.v_proj (in)
25-01-17 16:24:00 | D |     - Rotating model.layers.19.self_attn.o_proj (out)
25-01-17 16:24:00 | D |     - Rotating model.layers.19.proj_1st (in)
25-01-17 16:24:00 | D |     - Rotating model.layers.19.proj_2nd (out)
25-01-17 16:24:01 | D |   - Rotating model.layers.20
25-01-17 16:24:01 | D |     - Rotating model.layers.20.self_attn.q_proj (in)
25-01-17 16:24:01 | D |     - Rotating model.layers.20.self_attn.k_proj (in)
25-01-17 16:24:01 | D |     - Rotating model.layers.20.self_attn.v_proj (in)
25-01-17 16:24:01 | D |     - Rotating model.layers.20.self_attn.o_proj (out)
25-01-17 16:24:01 | D |     - Rotating model.layers.20.proj_1st (in)
25-01-17 16:24:01 | D |     - Rotating model.layers.20.proj_2nd (out)
25-01-17 16:24:01 | D |   - Rotating model.layers.21
25-01-17 16:24:01 | D |     - Rotating model.layers.21.self_attn.q_proj (in)
25-01-17 16:24:01 | D |     - Rotating model.layers.21.self_attn.k_proj (in)
25-01-17 16:24:01 | D |     - Rotating model.layers.21.self_attn.v_proj (in)
25-01-17 16:24:01 | D |     - Rotating model.layers.21.self_attn.o_proj (out)
25-01-17 16:24:01 | D |     - Rotating model.layers.21.proj_1st (in)
25-01-17 16:24:01 | D |     - Rotating model.layers.21.proj_2nd (out)
25-01-17 16:24:01 | D |   - Rotating lm_head (in)
25-01-17 16:24:05 | I | We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.0.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.1.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.2.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.3.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.4.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.5.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.6.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.7.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.8.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.9.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.10.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.11.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.12.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.13.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.14.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.15.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.16.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.17.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.18.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.19.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.20.self_attn
25-01-17 16:24:06 | I | - Patching LlamaSdpaAttention.forward in model.layers.21.self_attn
25-01-17 16:24:06 | I | * Rotating model in float16 again
25-01-17 16:24:06 | D |   - Transforming norm and linear in model.layers.0
25-01-17 16:24:07 | D |   - Transforming norm and linear in model.layers.1
25-01-17 16:24:07 | D |   - Transforming norm and linear in model.layers.2
25-01-17 16:24:07 | D |   - Transforming norm and linear in model.layers.3
25-01-17 16:24:07 | D |   - Transforming norm and linear in model.layers.4
25-01-17 16:24:07 | D |   - Transforming norm and linear in model.layers.5
25-01-17 16:24:08 | D |   - Transforming norm and linear in model.layers.6
25-01-17 16:24:08 | D |   - Transforming norm and linear in model.layers.7
25-01-17 16:24:08 | D |   - Transforming norm and linear in model.layers.8
25-01-17 16:24:08 | D |   - Transforming norm and linear in model.layers.9
25-01-17 16:24:08 | D |   - Transforming norm and linear in model.layers.10
25-01-17 16:24:09 | D |   - Transforming norm and linear in model.layers.11
25-01-17 16:24:09 | D |   - Transforming norm and linear in model.layers.12
25-01-17 16:24:09 | D |   - Transforming norm and linear in model.layers.13
25-01-17 16:24:09 | D |   - Transforming norm and linear in model.layers.14
25-01-17 16:24:09 | D |   - Transforming norm and linear in model.layers.15
25-01-17 16:24:10 | D |   - Transforming norm and linear in model.layers.16
25-01-17 16:24:10 | D |   - Transforming norm and linear in model.layers.17
25-01-17 16:24:10 | D |   - Transforming norm and linear in model.layers.18
25-01-17 16:24:10 | D |   - Transforming norm and linear in model.layers.19
25-01-17 16:24:10 | D |   - Transforming norm and linear in model.layers.20
25-01-17 16:24:11 | D |   - Transforming norm and linear in model.layers.21
25-01-17 16:24:11 | D |   - Transforming model.norm
25-01-17 16:24:11 | D |   - Rotating model.embed_tokens
25-01-17 16:24:11 | D |   - Rotating model.layers.0
25-01-17 16:24:11 | D |     - Rotating model.layers.0.self_attn.q_proj (in)
25-01-17 16:24:11 | D |     - Rotating model.layers.0.self_attn.k_proj (in)
25-01-17 16:24:11 | D |     - Rotating model.layers.0.self_attn.v_proj (in)
25-01-17 16:24:11 | D |     - Rotating model.layers.0.self_attn.o_proj (out)
25-01-17 16:24:11 | D |     - Rotating model.layers.0.proj_1st (in)
25-01-17 16:24:11 | D |     - Rotating model.layers.0.proj_2nd (out)
25-01-17 16:24:12 | D |   - Rotating model.layers.1
25-01-17 16:24:12 | D |     - Rotating model.layers.1.self_attn.q_proj (in)
25-01-17 16:24:12 | D |     - Rotating model.layers.1.self_attn.k_proj (in)
25-01-17 16:24:12 | D |     - Rotating model.layers.1.self_attn.v_proj (in)
25-01-17 16:24:12 | D |     - Rotating model.layers.1.self_attn.o_proj (out)
25-01-17 16:24:12 | D |     - Rotating model.layers.1.proj_1st (in)
25-01-17 16:24:12 | D |     - Rotating model.layers.1.proj_2nd (out)
25-01-17 16:24:12 | D |   - Rotating model.layers.2
25-01-17 16:24:12 | D |     - Rotating model.layers.2.self_attn.q_proj (in)
25-01-17 16:24:12 | D |     - Rotating model.layers.2.self_attn.k_proj (in)
25-01-17 16:24:12 | D |     - Rotating model.layers.2.self_attn.v_proj (in)
25-01-17 16:24:12 | D |     - Rotating model.layers.2.self_attn.o_proj (out)
25-01-17 16:24:12 | D |     - Rotating model.layers.2.proj_1st (in)
25-01-17 16:24:12 | D |     - Rotating model.layers.2.proj_2nd (out)
25-01-17 16:24:12 | D |   - Rotating model.layers.3
25-01-17 16:24:12 | D |     - Rotating model.layers.3.self_attn.q_proj (in)
25-01-17 16:24:12 | D |     - Rotating model.layers.3.self_attn.k_proj (in)
25-01-17 16:24:12 | D |     - Rotating model.layers.3.self_attn.v_proj (in)
25-01-17 16:24:12 | D |     - Rotating model.layers.3.self_attn.o_proj (out)
25-01-17 16:24:12 | D |     - Rotating model.layers.3.proj_1st (in)
25-01-17 16:24:12 | D |     - Rotating model.layers.3.proj_2nd (out)
25-01-17 16:24:13 | D |   - Rotating model.layers.4
25-01-17 16:24:13 | D |     - Rotating model.layers.4.self_attn.q_proj (in)
25-01-17 16:24:13 | D |     - Rotating model.layers.4.self_attn.k_proj (in)
25-01-17 16:24:13 | D |     - Rotating model.layers.4.self_attn.v_proj (in)
25-01-17 16:24:13 | D |     - Rotating model.layers.4.self_attn.o_proj (out)
25-01-17 16:24:13 | D |     - Rotating model.layers.4.proj_1st (in)
25-01-17 16:24:13 | D |     - Rotating model.layers.4.proj_2nd (out)
25-01-17 16:24:13 | D |   - Rotating model.layers.5
25-01-17 16:24:13 | D |     - Rotating model.layers.5.self_attn.q_proj (in)
25-01-17 16:24:13 | D |     - Rotating model.layers.5.self_attn.k_proj (in)
25-01-17 16:24:13 | D |     - Rotating model.layers.5.self_attn.v_proj (in)
25-01-17 16:24:13 | D |     - Rotating model.layers.5.self_attn.o_proj (out)
25-01-17 16:24:13 | D |     - Rotating model.layers.5.proj_1st (in)
25-01-17 16:24:13 | D |     - Rotating model.layers.5.proj_2nd (out)
25-01-17 16:24:13 | D |   - Rotating model.layers.6
25-01-17 16:24:13 | D |     - Rotating model.layers.6.self_attn.q_proj (in)
25-01-17 16:24:13 | D |     - Rotating model.layers.6.self_attn.k_proj (in)
25-01-17 16:24:13 | D |     - Rotating model.layers.6.self_attn.v_proj (in)
25-01-17 16:24:13 | D |     - Rotating model.layers.6.self_attn.o_proj (out)
25-01-17 16:24:13 | D |     - Rotating model.layers.6.proj_1st (in)
25-01-17 16:24:13 | D |     - Rotating model.layers.6.proj_2nd (out)
25-01-17 16:24:14 | D |   - Rotating model.layers.7
25-01-17 16:24:14 | D |     - Rotating model.layers.7.self_attn.q_proj (in)
25-01-17 16:24:14 | D |     - Rotating model.layers.7.self_attn.k_proj (in)
25-01-17 16:24:14 | D |     - Rotating model.layers.7.self_attn.v_proj (in)
25-01-17 16:24:14 | D |     - Rotating model.layers.7.self_attn.o_proj (out)
25-01-17 16:24:14 | D |     - Rotating model.layers.7.proj_1st (in)
25-01-17 16:24:14 | D |     - Rotating model.layers.7.proj_2nd (out)
25-01-17 16:24:14 | D |   - Rotating model.layers.8
25-01-17 16:24:14 | D |     - Rotating model.layers.8.self_attn.q_proj (in)
25-01-17 16:24:14 | D |     - Rotating model.layers.8.self_attn.k_proj (in)
25-01-17 16:24:14 | D |     - Rotating model.layers.8.self_attn.v_proj (in)
25-01-17 16:24:14 | D |     - Rotating model.layers.8.self_attn.o_proj (out)
25-01-17 16:24:14 | D |     - Rotating model.layers.8.proj_1st (in)
25-01-17 16:24:14 | D |     - Rotating model.layers.8.proj_2nd (out)
25-01-17 16:24:14 | D |   - Rotating model.layers.9
25-01-17 16:24:14 | D |     - Rotating model.layers.9.self_attn.q_proj (in)
25-01-17 16:24:14 | D |     - Rotating model.layers.9.self_attn.k_proj (in)
25-01-17 16:24:14 | D |     - Rotating model.layers.9.self_attn.v_proj (in)
25-01-17 16:24:14 | D |     - Rotating model.layers.9.self_attn.o_proj (out)
25-01-17 16:24:14 | D |     - Rotating model.layers.9.proj_1st (in)
25-01-17 16:24:14 | D |     - Rotating model.layers.9.proj_2nd (out)
25-01-17 16:24:15 | D |   - Rotating model.layers.10
25-01-17 16:24:15 | D |     - Rotating model.layers.10.self_attn.q_proj (in)
25-01-17 16:24:15 | D |     - Rotating model.layers.10.self_attn.k_proj (in)
25-01-17 16:24:15 | D |     - Rotating model.layers.10.self_attn.v_proj (in)
25-01-17 16:24:15 | D |     - Rotating model.layers.10.self_attn.o_proj (out)
25-01-17 16:24:15 | D |     - Rotating model.layers.10.proj_1st (in)
25-01-17 16:24:15 | D |     - Rotating model.layers.10.proj_2nd (out)
25-01-17 16:24:15 | D |   - Rotating model.layers.11
25-01-17 16:24:15 | D |     - Rotating model.layers.11.self_attn.q_proj (in)
25-01-17 16:24:15 | D |     - Rotating model.layers.11.self_attn.k_proj (in)
25-01-17 16:24:15 | D |     - Rotating model.layers.11.self_attn.v_proj (in)
25-01-17 16:24:15 | D |     - Rotating model.layers.11.self_attn.o_proj (out)
25-01-17 16:24:15 | D |     - Rotating model.layers.11.proj_1st (in)
25-01-17 16:24:15 | D |     - Rotating model.layers.11.proj_2nd (out)
25-01-17 16:24:15 | D |   - Rotating model.layers.12
25-01-17 16:24:15 | D |     - Rotating model.layers.12.self_attn.q_proj (in)
25-01-17 16:24:15 | D |     - Rotating model.layers.12.self_attn.k_proj (in)
25-01-17 16:24:15 | D |     - Rotating model.layers.12.self_attn.v_proj (in)
25-01-17 16:24:15 | D |     - Rotating model.layers.12.self_attn.o_proj (out)
25-01-17 16:24:15 | D |     - Rotating model.layers.12.proj_1st (in)
25-01-17 16:24:15 | D |     - Rotating model.layers.12.proj_2nd (out)
25-01-17 16:24:16 | D |   - Rotating model.layers.13
25-01-17 16:24:16 | D |     - Rotating model.layers.13.self_attn.q_proj (in)
25-01-17 16:24:16 | D |     - Rotating model.layers.13.self_attn.k_proj (in)
25-01-17 16:24:16 | D |     - Rotating model.layers.13.self_attn.v_proj (in)
25-01-17 16:24:16 | D |     - Rotating model.layers.13.self_attn.o_proj (out)
25-01-17 16:24:16 | D |     - Rotating model.layers.13.proj_1st (in)
25-01-17 16:24:16 | D |     - Rotating model.layers.13.proj_2nd (out)
25-01-17 16:24:16 | D |   - Rotating model.layers.14
25-01-17 16:24:16 | D |     - Rotating model.layers.14.self_attn.q_proj (in)
25-01-17 16:24:16 | D |     - Rotating model.layers.14.self_attn.k_proj (in)
25-01-17 16:24:16 | D |     - Rotating model.layers.14.self_attn.v_proj (in)
25-01-17 16:24:16 | D |     - Rotating model.layers.14.self_attn.o_proj (out)
25-01-17 16:24:16 | D |     - Rotating model.layers.14.proj_1st (in)
25-01-17 16:24:16 | D |     - Rotating model.layers.14.proj_2nd (out)
25-01-17 16:24:17 | D |   - Rotating model.layers.15
25-01-17 16:24:17 | D |     - Rotating model.layers.15.self_attn.q_proj (in)
25-01-17 16:24:17 | D |     - Rotating model.layers.15.self_attn.k_proj (in)
25-01-17 16:24:17 | D |     - Rotating model.layers.15.self_attn.v_proj (in)
25-01-17 16:24:17 | D |     - Rotating model.layers.15.self_attn.o_proj (out)
25-01-17 16:24:17 | D |     - Rotating model.layers.15.proj_1st (in)
25-01-17 16:24:17 | D |     - Rotating model.layers.15.proj_2nd (out)
25-01-17 16:24:17 | D |   - Rotating model.layers.16
25-01-17 16:24:17 | D |     - Rotating model.layers.16.self_attn.q_proj (in)
25-01-17 16:24:17 | D |     - Rotating model.layers.16.self_attn.k_proj (in)
25-01-17 16:24:17 | D |     - Rotating model.layers.16.self_attn.v_proj (in)
25-01-17 16:24:17 | D |     - Rotating model.layers.16.self_attn.o_proj (out)
25-01-17 16:24:17 | D |     - Rotating model.layers.16.proj_1st (in)
25-01-17 16:24:17 | D |     - Rotating model.layers.16.proj_2nd (out)
25-01-17 16:24:17 | D |   - Rotating model.layers.17
25-01-17 16:24:17 | D |     - Rotating model.layers.17.self_attn.q_proj (in)
25-01-17 16:24:17 | D |     - Rotating model.layers.17.self_attn.k_proj (in)
25-01-17 16:24:17 | D |     - Rotating model.layers.17.self_attn.v_proj (in)
25-01-17 16:24:17 | D |     - Rotating model.layers.17.self_attn.o_proj (out)
25-01-17 16:24:17 | D |     - Rotating model.layers.17.proj_1st (in)
25-01-17 16:24:17 | D |     - Rotating model.layers.17.proj_2nd (out)
25-01-17 16:24:18 | D |   - Rotating model.layers.18
25-01-17 16:24:18 | D |     - Rotating model.layers.18.self_attn.q_proj (in)
25-01-17 16:24:18 | D |     - Rotating model.layers.18.self_attn.k_proj (in)
25-01-17 16:24:18 | D |     - Rotating model.layers.18.self_attn.v_proj (in)
25-01-17 16:24:18 | D |     - Rotating model.layers.18.self_attn.o_proj (out)
25-01-17 16:24:18 | D |     - Rotating model.layers.18.proj_1st (in)
25-01-17 16:24:18 | D |     - Rotating model.layers.18.proj_2nd (out)
25-01-17 16:24:18 | D |   - Rotating model.layers.19
25-01-17 16:24:18 | D |     - Rotating model.layers.19.self_attn.q_proj (in)
25-01-17 16:24:18 | D |     - Rotating model.layers.19.self_attn.k_proj (in)
25-01-17 16:24:18 | D |     - Rotating model.layers.19.self_attn.v_proj (in)
25-01-17 16:24:18 | D |     - Rotating model.layers.19.self_attn.o_proj (out)
25-01-17 16:24:18 | D |     - Rotating model.layers.19.proj_1st (in)
25-01-17 16:24:18 | D |     - Rotating model.layers.19.proj_2nd (out)
25-01-17 16:24:18 | D |   - Rotating model.layers.20
25-01-17 16:24:18 | D |     - Rotating model.layers.20.self_attn.q_proj (in)
25-01-17 16:24:18 | D |     - Rotating model.layers.20.self_attn.k_proj (in)
25-01-17 16:24:18 | D |     - Rotating model.layers.20.self_attn.v_proj (in)
25-01-17 16:24:18 | D |     - Rotating model.layers.20.self_attn.o_proj (out)
25-01-17 16:24:18 | D |     - Rotating model.layers.20.proj_1st (in)
25-01-17 16:24:18 | D |     - Rotating model.layers.20.proj_2nd (out)
25-01-17 16:24:19 | D |   - Rotating model.layers.21
25-01-17 16:24:19 | D |     - Rotating model.layers.21.self_attn.q_proj (in)
25-01-17 16:24:19 | D |     - Rotating model.layers.21.self_attn.k_proj (in)
25-01-17 16:24:19 | D |     - Rotating model.layers.21.self_attn.v_proj (in)
25-01-17 16:24:19 | D |     - Rotating model.layers.21.self_attn.o_proj (out)
25-01-17 16:24:19 | D |     - Rotating model.layers.21.proj_1st (in)
25-01-17 16:24:19 | D |     - Rotating model.layers.21.proj_2nd (out)
25-01-17 16:24:19 | D |   - Rotating lm_head (in)
25-01-17 16:24:21 | I | * Reordering channels
25-01-17 16:24:21 | I |   - Loading channel indices from runs/llm/cache/pileval.128x1024.[0-0]/reorder/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]/tiny-llama-1.1b.pt
25-01-17 16:24:21 | D |   Starting new HTTPS connection (1): hf-mirror.com:443
25-01-17 16:24:21 | D |   https://hf-mirror.com:443 "GET /api/datasets/mit-han-lab/pile-val-backup HTTP/11" 200 403
25-01-17 16:24:21 | D |   https://hf-mirror.com:443 "GET /api/datasets/mit-han-lab/pile-val-backup HTTP/11" 200 403
25-01-17 16:24:21 | D |   https://hf-mirror.com:443 "GET /api/datasets/mit-han-lab/pile-val-backup/revision/2f5e46ae6a69cf0dce4b12f78241c408936ca0e4 HTTP/11" 200 403
25-01-17 16:24:21 | W |   Repo card metadata block was not found. Setting CardData to empty.
25-01-17 16:24:22 | D |   https://hf-mirror.com:443 "HEAD /datasets/mit-han-lab/pile-val-backup/resolve/2f5e46ae6a69cf0dce4b12f78241c408936ca0e4/.huggingface.yaml HTTP/11" 404 0
25-01-17 16:24:22 | D |   Starting new HTTPS connection (1): datasets-server.hf-mirror.com:443
25-01-17 16:24:22 | D |   https://datasets-server.hf-mirror.com:443 "GET /info?dataset=mit-han-lab/pile-val-backup HTTP/11" 302 0
25-01-17 16:24:22 | D |   https://hf-mirror.com:443 "GET / HTTP/11" 200 None
25-01-17 16:24:22 | D |   https://hf-mirror.com:443 "GET /api/datasets/mit-han-lab/pile-val-backup/revision/2f5e46ae6a69cf0dce4b12f78241c408936ca0e4 HTTP/11" 200 403
25-01-17 16:24:23 | D |   https://hf-mirror.com:443 "GET /api/datasets/mit-han-lab/pile-val-backup/tree/2f5e46ae6a69cf0dce4b12f78241c408936ca0e4?recursive=False&expand=False HTTP/11" 200 418
25-01-17 16:24:23 | D |   https://hf-mirror.com:443 "GET /api/datasets/mit-han-lab/pile-val-backup/tree/2f5e46ae6a69cf0dce4b12f78241c408936ca0e4/data?recursive=False&expand=False HTTP/11" 404 79
25-01-17 16:24:23 | D |   Starting new HTTPS connection (1): hf-mirror.com:443
25-01-17 16:24:33 | W |   Using the latest cached version of the dataset since mit-han-lab/pile-val-backup couldn't be found on the Hugging Face Hub
25-01-17 16:24:33 | W |   Found the latest cached dataset configuration 'default' at /root/.cache/huggingface/datasets/mit-han-lab___pile-val-backup/default/0.0.0/2f5e46ae6a69cf0dce4b12f78241c408936ca0e4 (last modified on Fri Oct  4 03:54:04 2024).
25-01-17 16:24:33 | D |   Attempting to acquire lock 139804281764688 on /root/.cache/huggingface/datasets/_root_.cache_huggingface_datasets_mit-han-lab___pile-val-backup_default_0.0.0_2f5e46ae6a69cf0dce4b12f78241c408936ca0e4.lock
25-01-17 16:24:33 | D |   Lock 139804281764688 acquired on /root/.cache/huggingface/datasets/_root_.cache_huggingface_datasets_mit-han-lab___pile-val-backup_default_0.0.0_2f5e46ae6a69cf0dce4b12f78241c408936ca0e4.lock
25-01-17 16:24:33 | D |   open file: /root/.cache/huggingface/datasets/mit-han-lab___pile-val-backup/default/0.0.0/2f5e46ae6a69cf0dce4b12f78241c408936ca0e4/dataset_info.json
25-01-17 16:24:33 | D |   Attempting to release lock 139804281764688 on /root/.cache/huggingface/datasets/_root_.cache_huggingface_datasets_mit-han-lab___pile-val-backup_default_0.0.0_2f5e46ae6a69cf0dce4b12f78241c408936ca0e4.lock
25-01-17 16:24:33 | D |   Lock 139804281764688 released on /root/.cache/huggingface/datasets/_root_.cache_huggingface_datasets_mit-han-lab___pile-val-backup_default_0.0.0_2f5e46ae6a69cf0dce4b12f78241c408936ca0e4.lock
25-01-17 16:24:48 | D |   - Reordering module model.layers.0.mlp.down_proj
25-01-17 16:24:52 | D |   - Reordering module model.layers.1.mlp.down_proj
25-01-17 16:24:56 | D |   - Reordering module model.layers.2.mlp.down_proj
25-01-17 16:25:01 | D |   - Reordering module model.layers.3.mlp.down_proj
25-01-17 16:25:05 | D |   - Reordering module model.layers.4.mlp.down_proj
25-01-17 16:25:09 | D |   - Reordering module model.layers.5.mlp.down_proj
25-01-17 16:25:13 | D |   - Reordering module model.layers.6.mlp.down_proj
25-01-17 16:25:17 | D |   - Reordering module model.layers.7.mlp.down_proj
25-01-17 16:25:22 | D |   - Reordering module model.layers.8.mlp.down_proj
25-01-17 16:25:26 | D |   - Reordering module model.layers.9.mlp.down_proj
25-01-17 16:25:30 | D |   - Reordering module model.layers.10.mlp.down_proj
25-01-17 16:25:35 | D |   - Reordering module model.layers.11.mlp.down_proj
25-01-17 16:25:39 | D |   - Reordering module model.layers.12.mlp.down_proj
25-01-17 16:25:44 | D |   - Reordering module model.layers.13.mlp.down_proj
25-01-17 16:25:48 | D |   - Reordering module model.layers.14.mlp.down_proj
25-01-17 16:25:53 | D |   - Reordering module model.layers.15.mlp.down_proj
25-01-17 16:25:57 | D |   - Reordering module model.layers.16.mlp.down_proj
25-01-17 16:26:02 | D |   - Reordering module model.layers.17.mlp.down_proj
25-01-17 16:26:06 | D |   - Reordering module model.layers.18.mlp.down_proj
25-01-17 16:26:11 | D |   - Reordering module model.layers.19.mlp.down_proj
25-01-17 16:26:16 | D |   - Reordering module model.layers.20.mlp.down_proj
25-01-17 16:26:20 | D |   - Reordering module model.layers.21.mlp.down_proj
25-01-17 16:26:22 | D |   https://hf-mirror.com:443 "GET /api/datasets/mit-han-lab/pile-val-backup HTTP/11" 200 403
25-01-17 16:26:23 | D |   https://hf-mirror.com:443 "GET /api/datasets/mit-han-lab/pile-val-backup HTTP/11" 200 403
25-01-17 16:26:23 | W |   Repo card metadata block was not found. Setting CardData to empty.
25-01-17 16:26:23 | D |   https://hf-mirror.com:443 "HEAD /datasets/mit-han-lab/pile-val-backup/resolve/2f5e46ae6a69cf0dce4b12f78241c408936ca0e4/.huggingface.yaml HTTP/11" 404 0
25-01-17 16:26:23 | D |   https://datasets-server.hf-mirror.com:443 "GET /info?dataset=mit-han-lab/pile-val-backup HTTP/11" 302 0
25-01-17 16:26:23 | D |   https://hf-mirror.com:443 "GET / HTTP/11" 200 None
25-01-17 16:26:24 | D |   https://hf-mirror.com:443 "GET /api/datasets/mit-han-lab/pile-val-backup/tree/2f5e46ae6a69cf0dce4b12f78241c408936ca0e4/data?recursive=False&expand=False HTTP/11" 404 79
25-01-17 16:26:24 | D |   Starting new HTTPS connection (1): hf-mirror.com:443
25-01-17 16:26:24 | D |   https://hf-mirror.com:443 "GET /api/datasets/mit-han-lab/pile-val-backup/revision/2f5e46ae6a69cf0dce4b12f78241c408936ca0e4 HTTP/11" 200 403
25-01-17 16:26:24 | D |   https://hf-mirror.com:443 "HEAD /datasets/mit-han-lab/pile-val-backup/resolve/2f5e46ae6a69cf0dce4b12f78241c408936ca0e4/dataset_infos.json HTTP/11" 404 0
25-01-17 16:26:24 | D |   Attempting to acquire lock 139804322732864 on /root/.cache/huggingface/datasets/_root_.cache_huggingface_datasets_mit-han-lab___pile-val-backup_default_0.0.0_2f5e46ae6a69cf0dce4b12f78241c408936ca0e4.lock
25-01-17 16:26:24 | D |   Lock 139804322732864 acquired on /root/.cache/huggingface/datasets/_root_.cache_huggingface_datasets_mit-han-lab___pile-val-backup_default_0.0.0_2f5e46ae6a69cf0dce4b12f78241c408936ca0e4.lock
25-01-17 16:26:24 | D |   open file: /root/.cache/huggingface/datasets/mit-han-lab___pile-val-backup/default/0.0.0/2f5e46ae6a69cf0dce4b12f78241c408936ca0e4/dataset_info.json
25-01-17 16:26:24 | D |   Attempting to release lock 139804322732864 on /root/.cache/huggingface/datasets/_root_.cache_huggingface_datasets_mit-han-lab___pile-val-backup_default_0.0.0_2f5e46ae6a69cf0dce4b12f78241c408936ca0e4.lock
25-01-17 16:26:24 | D |   Lock 139804322732864 released on /root/.cache/huggingface/datasets/_root_.cache_huggingface_datasets_mit-han-lab___pile-val-backup_default_0.0.0_2f5e46ae6a69cf0dce4b12f78241c408936ca0e4.lock
25-01-17 16:26:24 | D |   Attempting to acquire lock 139804322554128 on /root/.cache/huggingface/datasets/mit-han-lab___pile-val-backup/default/0.0.0/2f5e46ae6a69cf0dce4b12f78241c408936ca0e4_builder.lock
25-01-17 16:26:24 | D |   Lock 139804322554128 acquired on /root/.cache/huggingface/datasets/mit-han-lab___pile-val-backup/default/0.0.0/2f5e46ae6a69cf0dce4b12f78241c408936ca0e4_builder.lock
25-01-17 16:26:24 | D |   open file: /root/.cache/huggingface/datasets/mit-han-lab___pile-val-backup/default/0.0.0/2f5e46ae6a69cf0dce4b12f78241c408936ca0e4/dataset_info.json
25-01-17 16:26:24 | D |   Attempting to release lock 139804322554128 on /root/.cache/huggingface/datasets/mit-han-lab___pile-val-backup/default/0.0.0/2f5e46ae6a69cf0dce4b12f78241c408936ca0e4_builder.lock
25-01-17 16:26:24 | D |   Lock 139804322554128 released on /root/.cache/huggingface/datasets/mit-han-lab___pile-val-backup/default/0.0.0/2f5e46ae6a69cf0dce4b12f78241c408936ca0e4_builder.lock
25-01-17 16:26:38 | D |   - Reordering module model.layers.0.mlp.down_proj
25-01-17 16:26:42 | D |   - Reordering module model.layers.1.mlp.down_proj
25-01-17 16:26:46 | D |   - Reordering module model.layers.2.mlp.down_proj
25-01-17 16:26:50 | D |   - Reordering module model.layers.3.mlp.down_proj
25-01-17 16:26:54 | D |   - Reordering module model.layers.4.mlp.down_proj
25-01-17 16:26:58 | D |   - Reordering module model.layers.5.mlp.down_proj
25-01-17 16:27:02 | D |   - Reordering module model.layers.6.mlp.down_proj
25-01-17 16:27:07 | D |   - Reordering module model.layers.7.mlp.down_proj
25-01-17 16:27:11 | D |   - Reordering module model.layers.8.mlp.down_proj
25-01-17 16:27:16 | D |   - Reordering module model.layers.9.mlp.down_proj
25-01-17 16:27:20 | D |   - Reordering module model.layers.10.mlp.down_proj
25-01-17 16:27:24 | D |   - Reordering module model.layers.11.mlp.down_proj
25-01-17 16:27:29 | D |   - Reordering module model.layers.12.mlp.down_proj
25-01-17 16:27:33 | D |   - Reordering module model.layers.13.mlp.down_proj
25-01-17 16:27:38 | D |   - Reordering module model.layers.14.mlp.down_proj
25-01-17 16:27:43 | D |   - Reordering module model.layers.15.mlp.down_proj
25-01-17 16:27:47 | D |   - Reordering module model.layers.16.mlp.down_proj
25-01-17 16:27:52 | D |   - Reordering module model.layers.17.mlp.down_proj
25-01-17 16:27:57 | D |   - Reordering module model.layers.18.mlp.down_proj
25-01-17 16:28:01 | D |   - Reordering module model.layers.19.mlp.down_proj
25-01-17 16:28:06 | D |   - Reordering module model.layers.20.mlp.down_proj
25-01-17 16:28:11 | D |   - Reordering module model.layers.21.mlp.down_proj
25-01-17 16:28:13 | I | * Smooth quantizing model
25-01-17 16:28:13 | I |   - Loading smooth scales from runs/llm/cache/pileval.128x1024.[0-0]/smooth/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]/smooth.xw.OutputsError.Manual.Layer.d2.en1.sn1-yx.OutputsError.Manual.Layer.d2.en1.sn1/smooth.xw.[x.AbsMax.w.AbsMax]-yx.[x.AbsMax.w.AbsMax]/smooth.xw.a0p3.b0p7-yx.a0p5.b0/smooth.xw.skip.[proj_1st+proj_qkv]-yx.skip.[]/tiny-llama-1.1b.pt
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.0
25-01-17 16:28:13 | D |     - model.layers.0.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.0.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.0.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.1
25-01-17 16:28:13 | D |     - model.layers.1.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.1.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.1.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.2
25-01-17 16:28:13 | D |     - model.layers.2.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.2.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.2.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.3
25-01-17 16:28:13 | D |     - model.layers.3.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.3.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.3.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.4
25-01-17 16:28:13 | D |     - model.layers.4.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.4.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.4.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.5
25-01-17 16:28:13 | D |     - model.layers.5.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.5.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.5.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.6
25-01-17 16:28:13 | D |     - model.layers.6.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.6.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.6.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.7
25-01-17 16:28:13 | D |     - model.layers.7.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.7.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.7.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.8
25-01-17 16:28:13 | D |     - model.layers.8.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.8.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.8.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.9
25-01-17 16:28:13 | D |     - model.layers.9.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.9.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.9.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.10
25-01-17 16:28:13 | D |     - model.layers.10.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.10.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.10.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.11
25-01-17 16:28:13 | D |     - model.layers.11.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.11.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.11.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.12
25-01-17 16:28:13 | D |     - model.layers.12.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.12.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.12.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.13
25-01-17 16:28:13 | D |     - model.layers.13.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.13.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.13.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.14
25-01-17 16:28:13 | D |     - model.layers.14.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.14.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.14.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.15
25-01-17 16:28:13 | D |     - model.layers.15.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.15.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.15.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.16
25-01-17 16:28:13 | D |     - model.layers.16.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.16.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.16.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.17
25-01-17 16:28:13 | D |     - model.layers.17.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.17.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.17.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.18
25-01-17 16:28:13 | D |     - model.layers.18.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.18.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.18.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.19
25-01-17 16:28:13 | D |     - model.layers.19.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.19.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.19.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.20
25-01-17 16:28:13 | D |     - model.layers.20.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.20.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.20.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | D |   - Smooth Quantizing Decoder Layer model.layers.21
25-01-17 16:28:13 | D |     - model.layers.21.self_attn.LlmModuleKey.ATTN_QK
25-01-17 16:28:13 | D |     - model.layers.21.self_attn.LlmModuleKey.PROJ_OUT
25-01-17 16:28:13 | D |     - model.layers.21.mlp.LlmModuleKey.PROJ_2ND
25-01-17 16:28:13 | I | * Begin to QAT
25-01-17 16:28:13 | D | Setting JobRuntime:name=UNKNOWN_NAME
25-01-17 16:28:13 | D | Setting JobRuntime:name=utils
25-01-17 16:28:15 | I | distributed init (rank 0): env://
25-01-17 16:28:15 | I | initialized host 3fb0cc53fbf9 as rank 0
25-01-17 16:28:15 | I | nvidia-smi stats: {'gpu_0_mem_used_gb': 3.677734375, 'gpu_1_mem_used_gb': 3.8046875, 'gpu_2_mem_used_gb': 0.0, 'gpu_3_mem_used_gb': 0.0, 'gpu_4_mem_used_gb': 6.61328125, 'gpu_5_mem_used_gb': 4.751953125, 'gpu_6_mem_used_gb': 4.576171875, 'gpu_7_mem_used_gb': 0.0}
25-01-17 16:28:15 | I | {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 1, 'log_format': 'simple', 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': 'layer_wise_quant', 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': True, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma', 'log_nvidia_smi': False}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None, 'is_moe': False, 'is_model_parallel': False}, 'distributed_training': {'_name': None, 'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'env://', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'pytorch_ddp', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'zero_group_size': -1, 'save_zero_ckpt_fast': False, 'fp16': True, 'memory_efficient_fp16': True, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False}, 'dataset': {'_name': None, 'num_workers': 1, 'num_workers_valid': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 32, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 1, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 32, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 100, 'stop_time_hours': 0.0, 'clip_norm': 2.0, 'sentence_avg': False, 'update_freq': [2], 'lr': [0.005], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 1000, 'keep_interval_updates': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': True, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_best_checkpoints': False, 'no_save_optimizer_state': False, 'no_save_optimizer_state_on_training_finished': False, 'symlink_best_and_last_checkpoints': False, 'best_checkpoint_metric': 'loss_valid', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 's3_upload_path': None, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 1}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'input_quant_method': '', 'input_bits': -1, 'weight_quant_method': '', 'weight_bits': -1, 'smoothquant': False, 'smoothquant_alpha': 0.5, 'smoothquant_bitnet': False, 'input_bits_post': 8, 'hadamard_group': -1, 'cal_input_stat': 'none', 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807, 'stats_path': None, 'max_valid_steps': None}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'llama_for_layer_wise_qat', 'load_ckpt': None, 'batch_size': 32, 'share_input_output_embed': False, 'sliding_window': None, 'rope_theta': 10000.0, 'checkpoint_activations': False, 'tokens_per_sample': 512, 'model_parallel_size': 1}, 'task': {'_name': 'kd', 'path_to_labels': None, 'data': '/data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b', 'tokens_per_sample': 512, 'batch_size_in_quant': 8, 'max_target_positions': None, 'llama_model': None, 'quant_acts_when_training': True, 'tiktoken_model': 'cl100k_base', 'batch_read_ahead': 1, 'pad_to_max_len': True, 'absolute_path': False, 'tokenizer_pad_to_multiple': 1, 'seed': 1, 'batch_size': 32}, 'criterion': {'_name': 'kl_divergence', 'sentence_avg': False}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9, 0.95)', 'adam_eps': 1e-06, 'weight_decay': 0.05, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'bf16': False, 'lr': [0.005], 'block_wise': False}, 'lr_scheduler': {'_name': 'polynomial_decay', 'warmup_updates': 50, 'force_anneal': None, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 300000.0, 'lr': [0.005]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None}
25-01-17 16:28:15 | I | LlamaModelDecoderLayer(
  (decoder): LlamaDecoderLayerInFairseq(
    (model): LlamaDecoderLayer(
      (self_attn): LlamaSdpaAttention(
        (q_proj): Linear(in_features=2048, out_features=2048, bias=False)
        (k_proj): Linear(in_features=2048, out_features=256, bias=False)
        (v_proj): Linear(in_features=2048, out_features=256, bias=False)
        (o_proj): Linear(in_features=2048, out_features=2048, bias=False)
        (rotary_emb): LlamaRotaryEmbedding()
        (q_rotary_emb): RotaryEmbedding()
        (k_rotary_emb): RotaryEmbedding()
      )
      (mlp): LlamaMLP(
        (gate_proj): Linear(in_features=2048, out_features=5632, bias=False)
        (up_proj): Linear(in_features=2048, out_features=5632, bias=False)
        (down_proj): Linear(in_features=5632, out_features=2048, bias=False)
        (act_fn): SiLU()
      )
      (input_layernorm): LlamaRMSNorm((2048,), eps=1e-05)
      (post_attention_layernorm): LlamaRMSNorm((2048,), eps=1e-05)
    )
  )
  (model): LlamaDecoderLayerInFairseq(
    (model): LlamaDecoderLayer(
      (self_attn): LlamaSdpaAttention(
        (q_proj): Linear(in_features=2048, out_features=2048, bias=False)
        (k_proj): Linear(in_features=2048, out_features=256, bias=False)
        (v_proj): Linear(in_features=2048, out_features=256, bias=False)
        (o_proj): Linear(in_features=2048, out_features=2048, bias=False)
        (rotary_emb): LlamaRotaryEmbedding()
        (q_rotary_emb): RotaryEmbedding()
        (k_rotary_emb): RotaryEmbedding()
      )
      (mlp): LlamaMLP(
        (gate_proj): Linear(in_features=2048, out_features=5632, bias=False)
        (up_proj): Linear(in_features=2048, out_features=5632, bias=False)
        (down_proj): Linear(in_features=5632, out_features=2048, bias=False)
        (act_fn): SiLU()
      )
      (input_layernorm): LlamaRMSNorm((2048,), eps=1e-05)
      (post_attention_layernorm): LlamaRMSNorm((2048,), eps=1e-05)
    )
  )
)
25-01-17 16:28:15 | I | task: KDTask
25-01-17 16:28:15 | I | model: LlamaModelDecoderLayer
25-01-17 16:28:15 | I | criterion: KLDivergenceCriterion
25-01-17 16:28:15 | I | num. non-expert model params: 44,044,288 (num. trained: 44,044,288)
25-01-17 16:28:15 | I | num. expert model params: 0 (num. trained: 0)
25-01-17 16:28:16 | I | nvidia-smi stats: {'gpu_0_mem_used_gb': 3.677734375, 'gpu_1_mem_used_gb': 3.8046875, 'gpu_2_mem_used_gb': 0.0, 'gpu_3_mem_used_gb': 0.0, 'gpu_4_mem_used_gb': 6.61328125, 'gpu_5_mem_used_gb': 4.751953125, 'gpu_6_mem_used_gb': 4.576171875, 'gpu_7_mem_used_gb': 0.0}
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.self_attn.q_proj.weight <- model.model.self_attn.q_proj.weight
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- decoder.model.self_attn.k_proj.bias
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- decoder.model.self_attn.v_proj.bias
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- decoder.model.self_attn.o_proj.bias
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- decoder.model.mlp.gate_proj.bias
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- decoder.model.mlp.up_proj.bias
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- decoder.model.mlp.down_proj.bias
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.self_attn.q_proj.bias
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.self_attn.k_proj.bias
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.self_attn.v_proj.bias
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.self_attn.o_proj.bias
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.mlp.gate_proj.bias
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.mlp.up_proj.bias
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.mlp.down_proj.bias
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.self_attn.k_proj.weight <- model.model.self_attn.k_proj.weight
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.self_attn.v_proj.weight <- model.model.self_attn.v_proj.weight
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.self_attn.o_proj.weight <- model.model.self_attn.o_proj.weight
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.mlp.gate_proj.weight <- model.model.mlp.gate_proj.weight
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.mlp.up_proj.weight <- model.model.mlp.up_proj.weight
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.mlp.down_proj.weight <- model.model.mlp.down_proj.weight
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.input_layernorm.weight <- model.model.input_layernorm.weight
25-01-17 16:28:16 | I | detected shared parameter: decoder.model.post_attention_layernorm.weight <- model.model.post_attention_layernorm.weight
25-01-17 16:28:16 | I | nvidia-smi stats: {'gpu_0_mem_used_gb': 3.677734375, 'gpu_1_mem_used_gb': 3.8046875, 'gpu_2_mem_used_gb': 0.0, 'gpu_3_mem_used_gb': 0.0, 'gpu_4_mem_used_gb': 6.615234375, 'gpu_5_mem_used_gb': 4.751953125, 'gpu_6_mem_used_gb': 4.576171875, 'gpu_7_mem_used_gb': 0.0}
25-01-17 16:28:16 | I | ***********************CUDA enviroments for all 1 workers***********************
25-01-17 16:28:16 | I | rank   0: capabilities =  8.6  ; total memory = 23.691 GB ; name = NVIDIA GeForce RTX 3090                 
25-01-17 16:28:16 | I | ***********************CUDA enviroments for all 1 workers***********************
25-01-17 16:28:16 | I | training on 1 devices (GPUs/TPUs)
25-01-17 16:28:16 | I | max tokens per GPU = None and batch size per GPU = 32
25-01-17 16:28:16 | I | nvidia-smi stats: {'gpu_0_mem_used_gb': 3.677734375, 'gpu_1_mem_used_gb': 3.8046875, 'gpu_2_mem_used_gb': 0.0, 'gpu_3_mem_used_gb': 0.0, 'gpu_4_mem_used_gb': 6.615234375, 'gpu_5_mem_used_gb': 4.751953125, 'gpu_6_mem_used_gb': 4.576171875, 'gpu_7_mem_used_gb': 0.0}
25-01-17 16:28:16 | I | loading train data for epoch 1
25-01-17 16:28:17 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/0.jsonl 
 ***
25-01-17 16:28:17 | I | *** 
 total_rows = 700 
 ***
25-01-17 16:28:17 | I | current row num = 0
25-01-17 16:28:17 | I | in forward_and_gen_teacher_outputs, Start iterating over samples
25-01-17 16:28:17 | I | current row num = 32
25-01-17 16:28:18 | I | current row num = 64
25-01-17 16:28:18 | I | current row num = 96
25-01-17 16:28:19 | I | current row num = 128
25-01-17 16:28:20 | I | current row num = 160
25-01-17 16:28:20 | I | current row num = 192
25-01-17 16:28:21 | I | current row num = 224
25-01-17 16:28:22 | I | current row num = 256
25-01-17 16:28:22 | I | current row num = 288
25-01-17 16:28:23 | I | current row num = 320
25-01-17 16:28:24 | I | current row num = 352
25-01-17 16:28:25 | I | current row num = 384
25-01-17 16:28:25 | I | current row num = 416
25-01-17 16:28:26 | I | current row num = 448
25-01-17 16:28:27 | I | current row num = 480
25-01-17 16:28:27 | I | current row num = 512
25-01-17 16:28:28 | I | current row num = 544
25-01-17 16:28:29 | I | current row num = 576
25-01-17 16:28:29 | I | current row num = 608
25-01-17 16:28:30 | I | current row num = 640
25-01-17 16:28:31 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/1.jsonl 
 ***
25-01-17 16:28:31 | I | *** 
 total_rows = 241 
 ***
25-01-17 16:28:31 | I | current row num = 0
25-01-17 16:28:32 | I | current row num = 32
25-01-17 16:28:32 | I | current row num = 64
25-01-17 16:28:33 | I | current row num = 96
25-01-17 16:28:34 | I | current row num = 128
25-01-17 16:28:34 | I | current row num = 160
25-01-17 16:28:35 | I | current row num = 192
25-01-17 16:28:36 | I | current row num = 224
25-01-17 16:28:38 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/2.jsonl 
 ***
25-01-17 16:28:38 | I | *** 
 total_rows = 509 
 ***
25-01-17 16:28:38 | I | current row num = 0
25-01-17 16:28:38 | I | current row num = 32
25-01-17 16:28:38 | I | current row num = 64
25-01-17 16:28:39 | I | current row num = 96
25-01-17 16:28:40 | I | current row num = 128
25-01-17 16:28:41 | I | current row num = 160
25-01-17 16:28:41 | I | current row num = 192
25-01-17 16:28:42 | I | current row num = 224
25-01-17 16:28:43 | I | current row num = 256
25-01-17 16:28:43 | I | current row num = 288
25-01-17 16:28:44 | I | current row num = 320
25-01-17 16:28:45 | I | current row num = 352
25-01-17 16:28:46 | I | current row num = 384
25-01-17 16:28:46 | I | current row num = 416
25-01-17 16:28:47 | I | current row num = 448
25-01-17 16:28:48 | I | current row num = 480
25-01-17 16:28:49 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/3.jsonl 
 ***
25-01-17 16:28:49 | I | *** 
 total_rows = 274 
 ***
25-01-17 16:28:49 | I | current row num = 0
25-01-17 16:28:49 | I | current row num = 32
25-01-17 16:28:50 | I | current row num = 64
25-01-17 16:28:51 | I | current row num = 96
25-01-17 16:28:51 | I | current row num = 128
25-01-17 16:28:54 | I | current row num = 160
25-01-17 16:28:54 | I | current row num = 192
25-01-17 16:28:56 | I | current row num = 224
25-01-17 16:28:57 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/4.jsonl 
 ***
25-01-17 16:28:57 | I | *** 
 total_rows = 191 
 ***
25-01-17 16:28:57 | I | current row num = 0
25-01-17 16:28:59 | I | current row num = 32
25-01-17 16:28:59 | I | current row num = 64
25-01-17 16:29:00 | I | current row num = 96
25-01-17 16:29:01 | I | current row num = 128
25-01-17 16:29:02 | I | current row num = 160
25-01-17 16:29:03 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/5.jsonl 
 ***
25-01-17 16:29:03 | I | *** 
 total_rows = 211 
 ***
25-01-17 16:29:03 | I | current row num = 0
25-01-17 16:29:03 | I | current row num = 32
25-01-17 16:29:04 | I | current row num = 64
25-01-17 16:29:05 | I | current row num = 96
25-01-17 16:29:05 | I | current row num = 128
25-01-17 16:29:06 | I | current row num = 160
25-01-17 16:29:07 | I | current row num = 192
25-01-17 16:29:08 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/6.jsonl 
 ***
25-01-17 16:29:08 | I | *** 
 total_rows = 241 
 ***
25-01-17 16:29:08 | I | current row num = 0
25-01-17 16:29:08 | I | current row num = 32
25-01-17 16:29:09 | I | current row num = 64
25-01-17 16:29:10 | I | current row num = 96
25-01-17 16:29:11 | I | current row num = 128
25-01-17 16:29:11 | I | current row num = 160
25-01-17 16:29:12 | I | current row num = 192
25-01-17 16:29:15 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/7.jsonl 
 ***
25-01-17 16:29:15 | I | *** 
 total_rows = 279 
 ***
25-01-17 16:29:15 | I | current row num = 0
25-01-17 16:29:15 | I | current row num = 32
25-01-17 16:29:16 | I | current row num = 64
25-01-17 16:29:17 | I | current row num = 96
25-01-17 16:29:18 | I | current row num = 128
25-01-17 16:29:19 | I | current row num = 160
25-01-17 16:29:21 | I | current row num = 192
25-01-17 16:29:23 | I | current row num = 224
25-01-17 16:29:24 | I | current row num = 256
25-01-17 16:29:25 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/8.jsonl 
 ***
25-01-17 16:29:25 | I | *** 
 total_rows = 186 
 ***
25-01-17 16:29:25 | I | current row num = 0
25-01-17 16:29:26 | I | current row num = 32
25-01-17 16:29:26 | I | current row num = 64
25-01-17 16:29:27 | I | current row num = 96
25-01-17 16:29:28 | I | current row num = 128
25-01-17 16:29:30 | I | current row num = 160
25-01-17 16:29:32 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/9.jsonl 
 ***
25-01-17 16:29:32 | I | *** 
 total_rows = 770 
 ***
25-01-17 16:29:32 | I | current row num = 0
25-01-17 16:29:32 | I | current row num = 32
25-01-17 16:29:33 | I | current row num = 64
25-01-17 16:29:34 | I | current row num = 96
25-01-17 16:29:35 | I | current row num = 128
25-01-17 16:29:36 | I | current row num = 160
25-01-17 16:29:36 | I | current row num = 192
25-01-17 16:29:37 | I | current row num = 224
25-01-17 16:29:38 | I | current row num = 256
25-01-17 16:29:40 | I | current row num = 288
25-01-17 16:29:41 | I | current row num = 320
25-01-17 16:29:43 | I | current row num = 352
25-01-17 16:29:44 | I | current row num = 384
25-01-17 16:29:45 | I | current row num = 416
25-01-17 16:29:46 | I | current row num = 448
25-01-17 16:29:47 | I | current row num = 480
25-01-17 16:29:47 | I | current row num = 512
25-01-17 16:29:48 | I | current row num = 544
25-01-17 16:29:49 | I | current row num = 576
25-01-17 16:29:50 | I | current row num = 608
25-01-17 16:29:50 | I | current row num = 640
25-01-17 16:29:51 | I | current row num = 672
25-01-17 16:29:52 | I | current row num = 704
25-01-17 16:29:54 | I | current row num = 736
25-01-17 16:29:55 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/10.jsonl 
 ***
25-01-17 16:29:55 | I | *** 
 total_rows = 271 
 ***
25-01-17 16:29:55 | I | current row num = 0
25-01-17 16:29:56 | I | current row num = 32
25-01-17 16:29:56 | I | current row num = 64
25-01-17 16:29:57 | I | current row num = 96
25-01-17 16:29:58 | I | current row num = 128
25-01-17 16:29:58 | I | current row num = 160
25-01-17 16:29:59 | I | current row num = 192
25-01-17 16:30:02 | I | current row num = 224
25-01-17 16:30:02 | I | current row num = 256
25-01-17 16:30:04 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/11.jsonl 
 ***
25-01-17 16:30:04 | I | *** 
 total_rows = 273 
 ***
25-01-17 16:30:04 | I | current row num = 0
25-01-17 16:30:04 | I | current row num = 32
25-01-17 16:30:05 | I | current row num = 64
25-01-17 16:30:05 | I | current row num = 96
25-01-17 16:30:06 | I | current row num = 128
25-01-17 16:30:07 | I | current row num = 160
25-01-17 16:30:08 | I | current row num = 192
25-01-17 16:30:08 | I | current row num = 224
25-01-17 16:30:10 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/12.jsonl 
 ***
25-01-17 16:30:10 | I | *** 
 total_rows = 301 
 ***
25-01-17 16:30:10 | I | current row num = 0
25-01-17 16:30:11 | I | current row num = 32
25-01-17 16:30:13 | I | current row num = 64
25-01-17 16:30:14 | I | current row num = 96
25-01-17 16:30:15 | I | current row num = 128
25-01-17 16:30:16 | I | current row num = 160
25-01-17 16:30:16 | I | current row num = 192
25-01-17 16:30:17 | I | current row num = 224
25-01-17 16:30:18 | I | current row num = 256
25-01-17 16:30:19 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/13.jsonl 
 ***
25-01-17 16:30:19 | I | *** 
 total_rows = 239 
 ***
25-01-17 16:30:19 | I | current row num = 0
25-01-17 16:30:19 | I | current row num = 32
25-01-17 16:30:20 | I | current row num = 64
25-01-17 16:30:21 | I | current row num = 96
25-01-17 16:30:23 | I | current row num = 128
25-01-17 16:30:24 | I | current row num = 160
25-01-17 16:30:25 | I | current row num = 192
25-01-17 16:30:26 | I | current row num = 224
25-01-17 16:30:27 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/14.jsonl 
 ***
25-01-17 16:30:27 | I | *** 
 total_rows = 262 
 ***
25-01-17 16:30:27 | I | current row num = 0
25-01-17 16:30:27 | I | current row num = 32
25-01-17 16:30:28 | I | current row num = 64
25-01-17 16:30:28 | I | current row num = 96
25-01-17 16:30:29 | I | current row num = 128
25-01-17 16:30:30 | I | current row num = 160
25-01-17 16:30:31 | I | current row num = 192
25-01-17 16:30:31 | I | current row num = 224
25-01-17 16:30:33 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/15.jsonl 
 ***
25-01-17 16:30:33 | I | *** 
 total_rows = 253 
 ***
25-01-17 16:30:33 | I | current row num = 0
25-01-17 16:30:33 | I | current row num = 32
25-01-17 16:30:34 | I | current row num = 64
25-01-17 16:30:34 | I | current row num = 96
25-01-17 16:30:35 | I | current row num = 128
25-01-17 16:30:36 | I | current row num = 160
25-01-17 16:30:36 | I | current row num = 192
25-01-17 16:30:37 | I | current row num = 224
25-01-17 16:30:41 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/16.jsonl 
 ***
25-01-17 16:30:41 | I | *** 
 total_rows = 523 
 ***
25-01-17 16:30:41 | I | current row num = 0
25-01-17 16:30:41 | I | current row num = 32
25-01-17 16:30:42 | I | current row num = 64
25-01-17 16:30:42 | I | current row num = 96
25-01-17 16:30:43 | I | current row num = 128
25-01-17 16:30:44 | I | current row num = 160
25-01-17 16:30:45 | I | current row num = 192
25-01-17 16:30:45 | I | current row num = 224
25-01-17 16:30:46 | I | current row num = 256
25-01-17 16:30:47 | I | current row num = 288
25-01-17 16:30:47 | I | current row num = 320
25-01-17 16:30:48 | I | current row num = 352
25-01-17 16:30:49 | I | current row num = 384
25-01-17 16:30:50 | I | current row num = 416
25-01-17 16:30:50 | I | current row num = 448
25-01-17 16:30:51 | I | current row num = 480
25-01-17 16:30:52 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/17.jsonl 
 ***
25-01-17 16:30:52 | I | *** 
 total_rows = 251 
 ***
25-01-17 16:30:52 | I | current row num = 0
25-01-17 16:30:53 | I | current row num = 32
25-01-17 16:30:54 | I | current row num = 64
25-01-17 16:30:54 | I | current row num = 96
25-01-17 16:30:55 | I | current row num = 128
25-01-17 16:30:56 | I | current row num = 160
25-01-17 16:30:56 | I | current row num = 192
25-01-17 16:30:57 | I | current row num = 224
25-01-17 16:30:58 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/18.jsonl 
 ***
25-01-17 16:30:58 | I | *** 
 total_rows = 274 
 ***
25-01-17 16:30:58 | I | current row num = 0
25-01-17 16:30:59 | I | current row num = 32
25-01-17 16:30:59 | I | current row num = 64
25-01-17 16:31:02 | I | current row num = 96
25-01-17 16:31:03 | I | current row num = 128
25-01-17 16:31:03 | I | current row num = 160
25-01-17 16:31:04 | I | current row num = 192
25-01-17 16:31:06 | I | current row num = 224
25-01-17 16:31:07 | I | current row num = 256
25-01-17 16:31:08 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/19.jsonl 
 ***
25-01-17 16:31:08 | I | *** 
 total_rows = 315 
 ***
25-01-17 16:31:08 | I | current row num = 0
25-01-17 16:31:09 | I | current row num = 32
25-01-17 16:31:09 | I | current row num = 64
25-01-17 16:31:10 | I | current row num = 96
25-01-17 16:31:12 | I | current row num = 128
25-01-17 16:31:13 | I | current row num = 160
25-01-17 16:31:14 | I | current row num = 192
25-01-17 16:31:15 | I | current row num = 224
25-01-17 16:31:15 | I | current row num = 256
25-01-17 16:31:16 | I | current row num = 288
25-01-17 16:31:17 | I | current row num = 320
25-01-17 16:31:18 | I | loading train data for epoch 1
25-01-17 16:31:19 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/0.jsonl 
 ***
25-01-17 16:31:19 | I | *** 
 total_rows = 700 
 ***
25-01-17 16:31:19 | I | current row num = 0
25-01-17 16:31:19 | I | in forward_and_gen_args_and_kwargs, Start iterating over samples
25-01-17 16:31:19 | I | current row num = 32
25-01-17 16:31:19 | I | current row num = 64
25-01-17 16:31:20 | I | current row num = 96
25-01-17 16:31:21 | I | current row num = 128
25-01-17 16:31:22 | I | current row num = 160
25-01-17 16:31:22 | I | current row num = 192
25-01-17 16:31:23 | I | current row num = 224
25-01-17 16:31:24 | I | current row num = 256
25-01-17 16:31:24 | I | current row num = 288
25-01-17 16:31:25 | I | current row num = 320
25-01-17 16:31:26 | I | current row num = 352
25-01-17 16:31:27 | I | current row num = 384
25-01-17 16:31:27 | I | current row num = 416
25-01-17 16:31:28 | I | current row num = 448
25-01-17 16:31:29 | I | current row num = 480
25-01-17 16:31:29 | I | current row num = 512
25-01-17 16:31:30 | I | current row num = 544
25-01-17 16:31:33 | I | current row num = 576
25-01-17 16:31:33 | I | current row num = 608
25-01-17 16:31:34 | I | current row num = 640
25-01-17 16:31:35 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/1.jsonl 
 ***
25-01-17 16:31:35 | I | *** 
 total_rows = 241 
 ***
25-01-17 16:31:35 | I | current row num = 0
25-01-17 16:31:37 | I | current row num = 32
25-01-17 16:31:38 | I | current row num = 64
25-01-17 16:31:38 | I | current row num = 96
25-01-17 16:31:39 | I | current row num = 128
25-01-17 16:31:40 | I | current row num = 160
25-01-17 16:31:40 | I | current row num = 192
25-01-17 16:31:41 | I | current row num = 224
25-01-17 16:31:44 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/2.jsonl 
 ***
25-01-17 16:31:44 | I | *** 
 total_rows = 509 
 ***
25-01-17 16:31:44 | I | current row num = 0
25-01-17 16:31:44 | I | current row num = 32
25-01-17 16:31:45 | I | current row num = 64
25-01-17 16:31:46 | I | current row num = 96
25-01-17 16:31:46 | I | current row num = 128
25-01-17 16:31:47 | I | current row num = 160
25-01-17 16:31:48 | I | current row num = 192
25-01-17 16:31:49 | I | current row num = 224
25-01-17 16:31:50 | I | current row num = 256
25-01-17 16:31:52 | I | current row num = 288
25-01-17 16:31:53 | I | current row num = 320
25-01-17 16:31:54 | I | current row num = 352
25-01-17 16:31:54 | I | current row num = 384
25-01-17 16:31:55 | I | current row num = 416
25-01-17 16:31:56 | I | current row num = 448
25-01-17 16:31:56 | I | current row num = 480
25-01-17 16:31:58 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/3.jsonl 
 ***
25-01-17 16:31:58 | I | *** 
 total_rows = 274 
 ***
25-01-17 16:31:58 | I | current row num = 0
25-01-17 16:32:00 | I | current row num = 32
25-01-17 16:32:00 | I | current row num = 64
25-01-17 16:32:01 | I | current row num = 96
25-01-17 16:32:02 | I | current row num = 128
25-01-17 16:32:02 | I | current row num = 160
25-01-17 16:32:03 | I | current row num = 192
25-01-17 16:32:04 | I | current row num = 224
25-01-17 16:32:05 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/4.jsonl 
 ***
25-01-17 16:32:05 | I | *** 
 total_rows = 191 
 ***
25-01-17 16:32:05 | I | current row num = 0
25-01-17 16:32:05 | I | current row num = 32
25-01-17 16:32:06 | I | current row num = 64
25-01-17 16:32:07 | I | current row num = 96
25-01-17 16:32:07 | I | current row num = 128
25-01-17 16:32:10 | I | current row num = 160
25-01-17 16:32:11 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/5.jsonl 
 ***
25-01-17 16:32:11 | I | *** 
 total_rows = 211 
 ***
25-01-17 16:32:11 | I | current row num = 0
25-01-17 16:32:12 | I | current row num = 32
25-01-17 16:32:13 | I | current row num = 64
25-01-17 16:32:13 | I | current row num = 96
25-01-17 16:32:14 | I | current row num = 128
25-01-17 16:32:15 | I | current row num = 160
25-01-17 16:32:16 | I | current row num = 192
25-01-17 16:32:17 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/6.jsonl 
 ***
25-01-17 16:32:17 | I | *** 
 total_rows = 241 
 ***
25-01-17 16:32:17 | I | current row num = 0
25-01-17 16:32:17 | I | current row num = 32
25-01-17 16:32:18 | I | current row num = 64
25-01-17 16:32:18 | I | current row num = 96
25-01-17 16:32:19 | I | current row num = 128
25-01-17 16:32:20 | I | current row num = 160
25-01-17 16:32:22 | I | current row num = 192
25-01-17 16:32:23 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/7.jsonl 
 ***
25-01-17 16:32:23 | I | *** 
 total_rows = 279 
 ***
25-01-17 16:32:23 | I | current row num = 0
25-01-17 16:32:24 | I | current row num = 32
25-01-17 16:32:26 | I | current row num = 64
25-01-17 16:32:27 | I | current row num = 96
25-01-17 16:32:27 | I | current row num = 128
25-01-17 16:32:28 | I | current row num = 160
25-01-17 16:32:29 | I | current row num = 192
25-01-17 16:32:30 | I | current row num = 224
25-01-17 16:32:30 | I | current row num = 256
25-01-17 16:32:32 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/8.jsonl 
 ***
25-01-17 16:32:32 | I | *** 
 total_rows = 186 
 ***
25-01-17 16:32:32 | I | current row num = 0
25-01-17 16:32:32 | I | current row num = 32
25-01-17 16:32:33 | I | current row num = 64
25-01-17 16:32:33 | I | current row num = 96
25-01-17 16:32:34 | I | current row num = 128
25-01-17 16:32:35 | I | current row num = 160
25-01-17 16:32:37 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/9.jsonl 
 ***
25-01-17 16:32:37 | I | *** 
 total_rows = 770 
 ***
25-01-17 16:32:37 | I | current row num = 0
25-01-17 16:32:37 | I | current row num = 32
25-01-17 16:32:40 | I | current row num = 64
25-01-17 16:32:40 | I | current row num = 96
25-01-17 16:32:41 | I | current row num = 128
25-01-17 16:32:42 | I | current row num = 160
25-01-17 16:32:43 | I | current row num = 192
25-01-17 16:32:43 | I | current row num = 224
25-01-17 16:32:44 | I | current row num = 256
25-01-17 16:32:45 | I | current row num = 288
25-01-17 16:32:46 | I | current row num = 320
25-01-17 16:32:46 | I | current row num = 352
25-01-17 16:32:47 | I | current row num = 384
25-01-17 16:32:50 | I | current row num = 416
25-01-17 16:32:50 | I | current row num = 448
25-01-17 16:32:51 | I | current row num = 480
25-01-17 16:32:52 | I | current row num = 512
25-01-17 16:32:52 | I | current row num = 544
25-01-17 16:32:53 | I | current row num = 576
25-01-17 16:32:54 | I | current row num = 608
25-01-17 16:32:55 | I | current row num = 640
25-01-17 16:32:55 | I | current row num = 672
25-01-17 16:32:56 | I | current row num = 704
25-01-17 16:32:57 | I | current row num = 736
25-01-17 16:32:59 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/10.jsonl 
 ***
25-01-17 16:32:59 | I | *** 
 total_rows = 271 
 ***
25-01-17 16:32:59 | I | current row num = 0
25-01-17 16:32:59 | I | current row num = 32
25-01-17 16:33:00 | I | current row num = 64
25-01-17 16:33:00 | I | current row num = 96
25-01-17 16:33:01 | I | current row num = 128
25-01-17 16:33:02 | I | current row num = 160
25-01-17 16:33:03 | I | current row num = 192
25-01-17 16:33:04 | I | current row num = 224
25-01-17 16:33:05 | I | current row num = 256
25-01-17 16:33:07 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/11.jsonl 
 ***
25-01-17 16:33:07 | I | *** 
 total_rows = 273 
 ***
25-01-17 16:33:07 | I | current row num = 0
25-01-17 16:33:07 | I | current row num = 32
25-01-17 16:33:08 | I | current row num = 64
25-01-17 16:33:08 | I | current row num = 96
25-01-17 16:33:09 | I | current row num = 128
25-01-17 16:33:10 | I | current row num = 160
25-01-17 16:33:11 | I | current row num = 192
25-01-17 16:33:12 | I | current row num = 224
25-01-17 16:33:13 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/12.jsonl 
 ***
25-01-17 16:33:13 | I | *** 
 total_rows = 301 
 ***
25-01-17 16:33:13 | I | current row num = 0
25-01-17 16:33:15 | I | current row num = 32
25-01-17 16:33:16 | I | current row num = 64
25-01-17 16:33:16 | I | current row num = 96
25-01-17 16:33:17 | I | current row num = 128
25-01-17 16:33:18 | I | current row num = 160
25-01-17 16:33:20 | I | current row num = 192
25-01-17 16:33:20 | I | current row num = 224
25-01-17 16:33:21 | I | current row num = 256
25-01-17 16:33:22 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/13.jsonl 
 ***
25-01-17 16:33:22 | I | *** 
 total_rows = 239 
 ***
25-01-17 16:33:22 | I | current row num = 0
25-01-17 16:33:23 | I | current row num = 32
25-01-17 16:33:23 | I | current row num = 64
25-01-17 16:33:24 | I | current row num = 96
25-01-17 16:33:25 | I | current row num = 128
25-01-17 16:33:25 | I | current row num = 160
25-01-17 16:33:26 | I | current row num = 192
25-01-17 16:33:29 | I | current row num = 224
25-01-17 16:33:30 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/14.jsonl 
 ***
25-01-17 16:33:30 | I | *** 
 total_rows = 262 
 ***
25-01-17 16:33:30 | I | current row num = 0
25-01-17 16:33:30 | I | current row num = 32
25-01-17 16:33:31 | I | current row num = 64
25-01-17 16:33:32 | I | current row num = 96
25-01-17 16:33:33 | I | current row num = 128
25-01-17 16:33:34 | I | current row num = 160
25-01-17 16:33:36 | I | current row num = 192
25-01-17 16:33:37 | I | current row num = 224
25-01-17 16:33:38 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/15.jsonl 
 ***
25-01-17 16:33:38 | I | *** 
 total_rows = 253 
 ***
25-01-17 16:33:38 | I | current row num = 0
25-01-17 16:33:39 | I | current row num = 32
25-01-17 16:33:39 | I | current row num = 64
25-01-17 16:33:40 | I | current row num = 96
25-01-17 16:33:41 | I | current row num = 128
25-01-17 16:33:42 | I | current row num = 160
25-01-17 16:33:42 | I | current row num = 192
25-01-17 16:33:43 | I | current row num = 224
25-01-17 16:33:45 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/16.jsonl 
 ***
25-01-17 16:33:45 | I | *** 
 total_rows = 523 
 ***
25-01-17 16:33:45 | I | current row num = 0
25-01-17 16:33:45 | I | current row num = 32
25-01-17 16:33:48 | I | current row num = 64
25-01-17 16:33:48 | I | current row num = 96
25-01-17 16:33:49 | I | current row num = 128
25-01-17 16:33:50 | I | current row num = 160
25-01-17 16:33:51 | I | current row num = 192
25-01-17 16:33:51 | I | current row num = 224
25-01-17 16:33:52 | I | current row num = 256
25-01-17 16:33:53 | I | current row num = 288
25-01-17 16:33:54 | I | current row num = 320
25-01-17 16:33:54 | I | current row num = 352
25-01-17 16:33:55 | I | current row num = 384
25-01-17 16:33:56 | I | current row num = 416
25-01-17 16:33:56 | I | current row num = 448
25-01-17 16:33:57 | I | current row num = 480
25-01-17 16:33:58 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/17.jsonl 
 ***
25-01-17 16:33:58 | I | *** 
 total_rows = 251 
 ***
25-01-17 16:33:58 | I | current row num = 0
25-01-17 16:33:59 | I | current row num = 32
25-01-17 16:34:00 | I | current row num = 64
25-01-17 16:34:00 | I | current row num = 96
25-01-17 16:34:01 | I | current row num = 128
25-01-17 16:34:02 | I | current row num = 160
25-01-17 16:34:03 | I | current row num = 192
25-01-17 16:34:03 | I | current row num = 224
25-01-17 16:34:05 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/18.jsonl 
 ***
25-01-17 16:34:05 | I | *** 
 total_rows = 274 
 ***
25-01-17 16:34:05 | I | current row num = 0
25-01-17 16:34:05 | I | current row num = 32
25-01-17 16:34:06 | I | current row num = 64
25-01-17 16:34:08 | I | current row num = 96
25-01-17 16:34:09 | I | current row num = 128
25-01-17 16:34:10 | I | current row num = 160
25-01-17 16:34:10 | I | current row num = 192
25-01-17 16:34:11 | I | current row num = 224
25-01-17 16:34:12 | I | current row num = 256
25-01-17 16:34:13 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/19.jsonl 
 ***
25-01-17 16:34:13 | I | *** 
 total_rows = 315 
 ***
25-01-17 16:34:13 | I | current row num = 0
25-01-17 16:34:14 | I | current row num = 32
25-01-17 16:34:16 | I | current row num = 64
25-01-17 16:34:17 | I | current row num = 96
25-01-17 16:34:17 | I | current row num = 128
25-01-17 16:34:18 | I | current row num = 160
25-01-17 16:34:19 | I | current row num = 192
25-01-17 16:34:21 | I | current row num = 224
25-01-17 16:34:22 | I | current row num = 256
25-01-17 16:34:23 | I | current row num = 288
25-01-17 16:34:23 | I | current row num = 320
25-01-17 16:34:24 | I | No existing checkpoint found checkpoints/checkpoint_last.pt
25-01-17 16:34:24 | I | loading train data for epoch 1
25-01-17 16:34:24 | I | loading valid data for epoch 1
25-01-17 16:34:29 | I | begin training epoch 1
25-01-17 16:34:29 | I | Start iterating over samples
25-01-17 16:34:29 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:34:29 | I | in layer model.layers.4
25-01-17 16:34:29 | I | quantizing weights for layer model.layers.4
25-01-17 16:34:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:30 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:30 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:30 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:34:30 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:34:31 | I |       - range scale = [    1.0000]
25-01-17 16:34:31 | I |         sum  error  = [    0.2383]
25-01-17 16:34:31 | I |         best error  = [    0.2383]
25-01-17 16:34:31 | I |     + error = [0.2383]
25-01-17 16:34:31 | I |       - range scale = [    1.0000]
25-01-17 16:34:31 | I |         sum  error  = [    2.6087]
25-01-17 16:34:31 | I |         best error  = [    2.6087]
25-01-17 16:34:31 | I |     + error = [2.6087]
25-01-17 16:34:32 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:34:32 | I |       - range scale = [    1.0000]
25-01-17 16:34:32 | I |         sum  error  = [    0.2245]
25-01-17 16:34:32 | I |         best error  = [    0.2245]
25-01-17 16:34:32 | I |     + error = [0.2245]
25-01-17 16:34:33 | I |       - range scale = [    1.0000]
25-01-17 16:34:33 | I |         sum  error  = [    2.6010]
25-01-17 16:34:33 | I |         best error  = [    2.6010]
25-01-17 16:34:33 | I |     + error = [2.6010]
25-01-17 16:34:33 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:34:34 | I |       - range scale = [    1.0000]
25-01-17 16:34:34 | I |         sum  error  = [    0.0932]
25-01-17 16:34:34 | I |         best error  = [    0.0932]
25-01-17 16:34:34 | I |     + error = [0.0932]
25-01-17 16:34:34 | I |       - range scale = [    1.0000]
25-01-17 16:34:34 | I |         sum  error  = [    1.0524]
25-01-17 16:34:34 | I |         best error  = [    1.0524]
25-01-17 16:34:34 | I |     + error = [1.0524]
25-01-17 16:34:35 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:34:35 | I |       - range scale = [    1.0000]
25-01-17 16:34:35 | I |         sum  error  = [    0.1195]
25-01-17 16:34:35 | I |         best error  = [    0.1195]
25-01-17 16:34:35 | I |     + error = [0.1195]
25-01-17 16:34:36 | I |       - range scale = [    1.0000]
25-01-17 16:34:36 | I |         sum  error  = [    1.3002]
25-01-17 16:34:36 | I |         best error  = [    1.3002]
25-01-17 16:34:36 | I |     + error = [1.3002]
25-01-17 16:34:36 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:34:37 | I |       - range scale = [    1.0000]
25-01-17 16:34:37 | I |         sum  error  = [    0.4795]
25-01-17 16:34:37 | I |         best error  = [    0.4795]
25-01-17 16:34:37 | I |     + error = [0.4795]
25-01-17 16:34:38 | I |       - range scale = [    1.0000]
25-01-17 16:34:38 | I |         sum  error  = [    5.4604]
25-01-17 16:34:38 | I |         best error  = [    5.4604]
25-01-17 16:34:38 | I |     + error = [5.4604]
25-01-17 16:34:38 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:34:38 | I |       - range scale = [    1.0000]
25-01-17 16:34:38 | I |         sum  error  = [    2.5745]
25-01-17 16:34:38 | I |         best error  = [    2.5745]
25-01-17 16:34:38 | I |     + error = [2.5745]
25-01-17 16:34:39 | I |       - range scale = [    1.0000]
25-01-17 16:34:39 | I |         sum  error  = [   29.2885]
25-01-17 16:34:39 | I |         best error  = [   29.2885]
25-01-17 16:34:39 | I |     + error = [29.2885]
25-01-17 16:34:39 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:34:40 | I |       - range scale = [    1.0000]
25-01-17 16:34:40 | I |         sum  error  = [    0.1971]
25-01-17 16:34:40 | I |         best error  = [    0.1971]
25-01-17 16:34:40 | I |     + error = [0.1971]
25-01-17 16:34:41 | I |       - range scale = [    1.0000]
25-01-17 16:34:41 | I |         sum  error  = [    1.7600]
25-01-17 16:34:41 | I |         best error  = [    1.7600]
25-01-17 16:34:41 | I |     + error = [1.7600]
25-01-17 16:34:41 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:34:42 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:34:44 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:34:45 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:34:47 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:34:48 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:34:50 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:34:53 | I | quantizing activations for layer model.layers.4
25-01-17 16:34:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:56 | I | forward this layer
25-01-17 16:34:56 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/00.pt
25-01-17 16:34:56 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/00.pt
25-01-17 16:34:56 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:34:56 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:34:56 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:34:56 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:34:56 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:34:56 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:34:56 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:34:56 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:34:56 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:34:56 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:34:56 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:34:56 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:34:56 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:34:56 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:34:56 | I | in layer model.layers.4
25-01-17 16:34:56 | I | quantizing weights for layer model.layers.4
25-01-17 16:34:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:57 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:57 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:57 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:57 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:34:57 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:34:58 | I |       - range scale = [    1.0000]
25-01-17 16:34:58 | I |         sum  error  = [    0.2476]
25-01-17 16:34:58 | I |         best error  = [    0.2476]
25-01-17 16:34:58 | I |     + error = [0.2476]
25-01-17 16:34:58 | I |       - range scale = [    1.0000]
25-01-17 16:34:58 | I |         sum  error  = [    2.6963]
25-01-17 16:34:58 | I |         best error  = [    2.6963]
25-01-17 16:34:58 | I |     + error = [2.6963]
25-01-17 16:34:59 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:34:59 | I |       - range scale = [    1.0000]
25-01-17 16:34:59 | I |         sum  error  = [    0.2232]
25-01-17 16:34:59 | I |         best error  = [    0.2232]
25-01-17 16:34:59 | I |     + error = [0.2232]
25-01-17 16:35:00 | I |       - range scale = [    1.0000]
25-01-17 16:35:00 | I |         sum  error  = [    2.4737]
25-01-17 16:35:00 | I |         best error  = [    2.4737]
25-01-17 16:35:00 | I |     + error = [2.4737]
25-01-17 16:35:00 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:35:01 | I |       - range scale = [    1.0000]
25-01-17 16:35:01 | I |         sum  error  = [    0.0927]
25-01-17 16:35:01 | I |         best error  = [    0.0927]
25-01-17 16:35:01 | I |     + error = [0.0927]
25-01-17 16:35:01 | I |       - range scale = [    1.0000]
25-01-17 16:35:01 | I |         sum  error  = [    1.0555]
25-01-17 16:35:01 | I |         best error  = [    1.0555]
25-01-17 16:35:01 | I |     + error = [1.0555]
25-01-17 16:35:02 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:35:02 | I |       - range scale = [    1.0000]
25-01-17 16:35:02 | I |         sum  error  = [    0.1123]
25-01-17 16:35:02 | I |         best error  = [    0.1123]
25-01-17 16:35:02 | I |     + error = [0.1123]
25-01-17 16:35:03 | I |       - range scale = [    1.0000]
25-01-17 16:35:03 | I |         sum  error  = [    1.2214]
25-01-17 16:35:03 | I |         best error  = [    1.2214]
25-01-17 16:35:03 | I |     + error = [1.2214]
25-01-17 16:35:03 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:35:04 | I |       - range scale = [    1.0000]
25-01-17 16:35:04 | I |         sum  error  = [    0.4788]
25-01-17 16:35:04 | I |         best error  = [    0.4788]
25-01-17 16:35:04 | I |     + error = [0.4788]
25-01-17 16:35:05 | I |       - range scale = [    1.0000]
25-01-17 16:35:05 | I |         sum  error  = [    5.4595]
25-01-17 16:35:05 | I |         best error  = [    5.4595]
25-01-17 16:35:05 | I |     + error = [5.4595]
25-01-17 16:35:05 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:35:05 | I |       - range scale = [    1.0000]
25-01-17 16:35:05 | I |         sum  error  = [    2.5763]
25-01-17 16:35:05 | I |         best error  = [    2.5763]
25-01-17 16:35:05 | I |     + error = [2.5763]
25-01-17 16:35:06 | I |       - range scale = [    1.0000]
25-01-17 16:35:06 | I |         sum  error  = [   29.2799]
25-01-17 16:35:06 | I |         best error  = [   29.2799]
25-01-17 16:35:06 | I |     + error = [29.2799]
25-01-17 16:35:06 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:35:07 | I |       - range scale = [    1.0000]
25-01-17 16:35:07 | I |         sum  error  = [    0.1968]
25-01-17 16:35:07 | I |         best error  = [    0.1968]
25-01-17 16:35:07 | I |     + error = [0.1968]
25-01-17 16:35:08 | I |       - range scale = [    1.0000]
25-01-17 16:35:08 | I |         sum  error  = [    1.7581]
25-01-17 16:35:08 | I |         best error  = [    1.7581]
25-01-17 16:35:08 | I |     + error = [1.7581]
25-01-17 16:35:08 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:35:09 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:35:11 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:35:12 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:35:14 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:35:15 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:35:16 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:35:20 | I | quantizing activations for layer model.layers.4
25-01-17 16:35:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:22 | I | forward this layer
25-01-17 16:35:22 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/01.pt
25-01-17 16:35:22 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/01.pt
25-01-17 16:35:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:35:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:35:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:35:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:35:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:35:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:35:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:35:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:35:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:35:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:35:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:35:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:35:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:35:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:35:23 | I | [0] done with optimizer step
25-01-17 16:35:23 | I | epoch 001:      1 / 409600000 loss=9.6163e-06, loss_sum=0.218416, wps=0, ups=0, wpb=32768, bsz=64, num_updates=1, lr=0.0001, gnorm=0.004, clip=0, loss_scale=128, train_wall=54, cuda_gb_allocated=11.7, cuda_gb_reserved=13.1, cuda_gb_free=12, wall=427
25-01-17 16:35:23 | I | begin validation on "valid" subset on rank 0
25-01-17 16:35:23 | I | got valid iterator on "valid" subset on rank 0
25-01-17 16:35:23 | I | Valid: Start iterating over samples
25-01-17 16:35:23 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:35:23 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:35:23 | I | - Evaluator: gptq
25-01-17 16:35:23 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:35:23 | I | - Batch_size: 8
25-01-17 16:35:23 | I |   + Max_seq_length: 2048
25-01-17 16:35:41 | I |     - Results:
25-01-17 16:35:41 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:35:41 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:35:41 | I |       |wikitext |      1|word_perplexity|7.7075|±  |7.7075|
25-01-17 16:35:41 | I |       |val_valid|      1|word_perplexity|7.4136|±  |7.4136|
25-01-17 16:35:41 | I |       
25-01-17 16:35:41 | I | in valid, quantize current layer weights
25-01-17 16:35:42 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 16:35:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:57 | I |       - range scale = [    1.0000]
25-01-17 16:35:57 | I |         sum  error  = [    0.6607]
25-01-17 16:35:57 | I |         best error  = [    0.6607]
25-01-17 16:35:57 | I |     + error = [0.6607]
25-01-17 16:35:58 | I |       - range scale = [    1.0000]
25-01-17 16:35:58 | I |         sum  error  = [    7.3391]
25-01-17 16:35:58 | I |         best error  = [    7.3391]
25-01-17 16:35:58 | I |     + error = [7.3391]
25-01-17 16:35:59 | I |       - range scale = [    1.0000]
25-01-17 16:35:59 | I |         sum  error  = [    0.6556]
25-01-17 16:35:59 | I |         best error  = [    0.6556]
25-01-17 16:35:59 | I |     + error = [0.6556]
25-01-17 16:36:00 | I |       - range scale = [    1.0000]
25-01-17 16:36:00 | I |         sum  error  = [    7.1260]
25-01-17 16:36:00 | I |         best error  = [    7.1260]
25-01-17 16:36:00 | I |     + error = [7.1260]
25-01-17 16:36:01 | I |       - range scale = [    1.0000]
25-01-17 16:36:01 | I |         sum  error  = [    0.0937]
25-01-17 16:36:01 | I |         best error  = [    0.0937]
25-01-17 16:36:01 | I |     + error = [0.0937]
25-01-17 16:36:01 | I |       - range scale = [    1.0000]
25-01-17 16:36:01 | I |         sum  error  = [    1.0592]
25-01-17 16:36:01 | I |         best error  = [    1.0592]
25-01-17 16:36:01 | I |     + error = [1.0592]
25-01-17 16:36:02 | I |       - range scale = [    1.0000]
25-01-17 16:36:02 | I |         sum  error  = [    0.0961]
25-01-17 16:36:02 | I |         best error  = [    0.0961]
25-01-17 16:36:02 | I |     + error = [0.0961]
25-01-17 16:36:03 | I |       - range scale = [    1.0000]
25-01-17 16:36:03 | I |         sum  error  = [    1.0476]
25-01-17 16:36:03 | I |         best error  = [    1.0476]
25-01-17 16:36:03 | I |     + error = [1.0476]
25-01-17 16:36:04 | I |       - range scale = [    1.0000]
25-01-17 16:36:04 | I |         sum  error  = [    0.4814]
25-01-17 16:36:04 | I |         best error  = [    0.4814]
25-01-17 16:36:04 | I |     + error = [0.4814]
25-01-17 16:36:04 | I |       - range scale = [    1.0000]
25-01-17 16:36:04 | I |         sum  error  = [    5.5039]
25-01-17 16:36:04 | I |         best error  = [    5.5039]
25-01-17 16:36:04 | I |     + error = [5.5039]
25-01-17 16:36:05 | I |       - range scale = [    1.0000]
25-01-17 16:36:05 | I |         sum  error  = [    2.5866]
25-01-17 16:36:05 | I |         best error  = [    2.5866]
25-01-17 16:36:05 | I |     + error = [2.5866]
25-01-17 16:36:06 | I |       - range scale = [    1.0000]
25-01-17 16:36:06 | I |         sum  error  = [   29.4842]
25-01-17 16:36:06 | I |         best error  = [   29.4842]
25-01-17 16:36:06 | I |     + error = [29.4842]
25-01-17 16:36:07 | I |       - range scale = [    1.0000]
25-01-17 16:36:07 | I |         sum  error  = [    0.1927]
25-01-17 16:36:07 | I |         best error  = [    0.1927]
25-01-17 16:36:07 | I |     + error = [0.1927]
25-01-17 16:36:08 | I |       - range scale = [    1.0000]
25-01-17 16:36:08 | I |         sum  error  = [    1.7468]
25-01-17 16:36:08 | I |         best error  = [    1.7468]
25-01-17 16:36:08 | I |     + error = [1.7468]
25-01-17 16:36:21 | I | in valid, quantize current layer acts
25-01-17 16:36:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:27 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 16:36:27 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:36:27 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:36:27 | I | - Evaluator: gptq
25-01-17 16:36:27 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:36:27 | I | - Batch_size: 8
25-01-17 16:36:27 | I |   + Max_seq_length: 2048
25-01-17 16:36:46 | I |     - Results:
25-01-17 16:36:46 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:36:46 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:36:46 | I |       |wikitext |      1|word_perplexity|7.7269|±  |7.7269|
25-01-17 16:36:46 | I |       |val_valid|      1|word_perplexity|7.4364|±  |7.4364|
25-01-17 16:36:46 | I |       
25-01-17 16:36:48 | W | Criterion.reduce_metrics did not log a 'loss_valid' value, which may break some functionality
25-01-17 16:36:59 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.616, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.13, wps=36746.9, wpb=4058.2, bsz=2, num_updates=1, lmquant_ppl_wikitext_all_quanted=7.70752, lmquant_ppl_val_all_quanted=7.41357, lmquant_ppl_wikitext_partly_quanted=7.72689, lmquant_ppl_val_partly_quanted=7.43637
25-01-17 16:36:59 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.616 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.13 | wps 36746.9 | wpb 4058.2 | bsz 2 | num_updates 1 | lmquant_ppl_wikitext_all_quanted 7.70752 | lmquant_ppl_val_all_quanted 7.41357 | lmquant_ppl_wikitext_partly_quanted 7.72689 | lmquant_ppl_val_partly_quanted 7.43637
25-01-17 16:37:00 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:37:00 | I | in layer model.layers.4
25-01-17 16:37:00 | I | quantizing weights for layer model.layers.4
25-01-17 16:37:00 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:00 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:00 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:00 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:01 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:37:01 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:37:01 | I |       - range scale = [    1.0000]
25-01-17 16:37:01 | I |         sum  error  = [    0.2427]
25-01-17 16:37:01 | I |         best error  = [    0.2427]
25-01-17 16:37:01 | I |     + error = [0.2427]
25-01-17 16:37:02 | I |       - range scale = [    1.0000]
25-01-17 16:37:02 | I |         sum  error  = [    2.6529]
25-01-17 16:37:02 | I |         best error  = [    2.6529]
25-01-17 16:37:02 | I |     + error = [2.6529]
25-01-17 16:37:02 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:37:03 | I |       - range scale = [    1.0000]
25-01-17 16:37:03 | I |         sum  error  = [    0.2241]
25-01-17 16:37:03 | I |         best error  = [    0.2241]
25-01-17 16:37:03 | I |     + error = [0.2241]
25-01-17 16:37:04 | I |       - range scale = [    1.0000]
25-01-17 16:37:04 | I |         sum  error  = [    2.4566]
25-01-17 16:37:04 | I |         best error  = [    2.4566]
25-01-17 16:37:04 | I |     + error = [2.4566]
25-01-17 16:37:04 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:37:04 | I |       - range scale = [    1.0000]
25-01-17 16:37:04 | I |         sum  error  = [    0.0934]
25-01-17 16:37:04 | I |         best error  = [    0.0934]
25-01-17 16:37:04 | I |     + error = [0.0934]
25-01-17 16:37:05 | I |       - range scale = [    1.0000]
25-01-17 16:37:05 | I |         sum  error  = [    1.0538]
25-01-17 16:37:05 | I |         best error  = [    1.0538]
25-01-17 16:37:05 | I |     + error = [1.0538]
25-01-17 16:37:05 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:37:06 | I |       - range scale = [    1.0000]
25-01-17 16:37:06 | I |         sum  error  = [    0.1154]
25-01-17 16:37:06 | I |         best error  = [    0.1154]
25-01-17 16:37:06 | I |     + error = [0.1154]
25-01-17 16:37:07 | I |       - range scale = [    1.0000]
25-01-17 16:37:07 | I |         sum  error  = [    1.2490]
25-01-17 16:37:07 | I |         best error  = [    1.2490]
25-01-17 16:37:07 | I |     + error = [1.2490]
25-01-17 16:37:07 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:37:08 | I |       - range scale = [    1.0000]
25-01-17 16:37:08 | I |         sum  error  = [    0.4785]
25-01-17 16:37:08 | I |         best error  = [    0.4785]
25-01-17 16:37:08 | I |     + error = [0.4785]
25-01-17 16:37:08 | I |       - range scale = [    1.0000]
25-01-17 16:37:08 | I |         sum  error  = [    5.4621]
25-01-17 16:37:08 | I |         best error  = [    5.4621]
25-01-17 16:37:08 | I |     + error = [5.4621]
25-01-17 16:37:08 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:37:09 | I |       - range scale = [    1.0000]
25-01-17 16:37:09 | I |         sum  error  = [    2.5798]
25-01-17 16:37:09 | I |         best error  = [    2.5798]
25-01-17 16:37:09 | I |     + error = [2.5798]
25-01-17 16:37:10 | I |       - range scale = [    1.0000]
25-01-17 16:37:10 | I |         sum  error  = [   29.2912]
25-01-17 16:37:10 | I |         best error  = [   29.2912]
25-01-17 16:37:10 | I |     + error = [29.2912]
25-01-17 16:37:10 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:37:11 | I |       - range scale = [    1.0000]
25-01-17 16:37:11 | I |         sum  error  = [    0.2036]
25-01-17 16:37:11 | I |         best error  = [    0.2036]
25-01-17 16:37:11 | I |     + error = [0.2036]
25-01-17 16:37:11 | I |       - range scale = [    1.0000]
25-01-17 16:37:11 | I |         sum  error  = [    1.8187]
25-01-17 16:37:11 | I |         best error  = [    1.8187]
25-01-17 16:37:11 | I |     + error = [1.8187]
25-01-17 16:37:12 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:37:13 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:37:14 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:37:16 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:37:17 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:37:19 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:37:20 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:37:23 | I | quantizing activations for layer model.layers.4
25-01-17 16:37:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:26 | I | forward this layer
25-01-17 16:37:26 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/02.pt
25-01-17 16:37:26 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/02.pt
25-01-17 16:37:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:37:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:37:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:37:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:37:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:37:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:37:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:37:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:37:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:37:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:37:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:37:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:37:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:37:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:37:26 | I | in layer model.layers.4
25-01-17 16:37:26 | I | quantizing weights for layer model.layers.4
25-01-17 16:37:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:27 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:37:27 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:37:28 | I |       - range scale = [    1.0000]
25-01-17 16:37:28 | I |         sum  error  = [    0.2411]
25-01-17 16:37:28 | I |         best error  = [    0.2411]
25-01-17 16:37:28 | I |     + error = [0.2411]
25-01-17 16:37:29 | I |       - range scale = [    1.0000]
25-01-17 16:37:29 | I |         sum  error  = [    2.6139]
25-01-17 16:37:29 | I |         best error  = [    2.6139]
25-01-17 16:37:29 | I |     + error = [2.6139]
25-01-17 16:37:29 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:37:30 | I |       - range scale = [    1.0000]
25-01-17 16:37:30 | I |         sum  error  = [    0.2185]
25-01-17 16:37:30 | I |         best error  = [    0.2185]
25-01-17 16:37:30 | I |     + error = [0.2185]
25-01-17 16:37:30 | I |       - range scale = [    1.0000]
25-01-17 16:37:30 | I |         sum  error  = [    2.4407]
25-01-17 16:37:30 | I |         best error  = [    2.4407]
25-01-17 16:37:30 | I |     + error = [2.4407]
25-01-17 16:37:30 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:37:31 | I |       - range scale = [    1.0000]
25-01-17 16:37:31 | I |         sum  error  = [    0.0932]
25-01-17 16:37:31 | I |         best error  = [    0.0932]
25-01-17 16:37:31 | I |     + error = [0.0932]
25-01-17 16:37:32 | I |       - range scale = [    1.0000]
25-01-17 16:37:32 | I |         sum  error  = [    1.0527]
25-01-17 16:37:32 | I |         best error  = [    1.0527]
25-01-17 16:37:32 | I |     + error = [1.0527]
25-01-17 16:37:32 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:37:33 | I |       - range scale = [    1.0000]
25-01-17 16:37:33 | I |         sum  error  = [    0.1113]
25-01-17 16:37:33 | I |         best error  = [    0.1113]
25-01-17 16:37:33 | I |     + error = [0.1113]
25-01-17 16:37:33 | I |       - range scale = [    1.0000]
25-01-17 16:37:33 | I |         sum  error  = [    1.2103]
25-01-17 16:37:33 | I |         best error  = [    1.2103]
25-01-17 16:37:33 | I |     + error = [1.2103]
25-01-17 16:37:33 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:37:34 | I |       - range scale = [    1.0000]
25-01-17 16:37:34 | I |         sum  error  = [    0.4788]
25-01-17 16:37:34 | I |         best error  = [    0.4788]
25-01-17 16:37:34 | I |     + error = [0.4788]
25-01-17 16:37:35 | I |       - range scale = [    1.0000]
25-01-17 16:37:35 | I |         sum  error  = [    5.4594]
25-01-17 16:37:35 | I |         best error  = [    5.4594]
25-01-17 16:37:35 | I |     + error = [5.4594]
25-01-17 16:37:35 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:37:36 | I |       - range scale = [    1.0000]
25-01-17 16:37:36 | I |         sum  error  = [    2.5790]
25-01-17 16:37:36 | I |         best error  = [    2.5790]
25-01-17 16:37:36 | I |     + error = [2.5790]
25-01-17 16:37:36 | I |       - range scale = [    1.0000]
25-01-17 16:37:36 | I |         sum  error  = [   29.2852]
25-01-17 16:37:36 | I |         best error  = [   29.2852]
25-01-17 16:37:36 | I |     + error = [29.2852]
25-01-17 16:37:37 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:37:37 | I |       - range scale = [    1.0000]
25-01-17 16:37:37 | I |         sum  error  = [    0.1974]
25-01-17 16:37:37 | I |         best error  = [    0.1974]
25-01-17 16:37:37 | I |     + error = [0.1974]
25-01-17 16:37:38 | I |       - range scale = [    1.0000]
25-01-17 16:37:38 | I |         sum  error  = [    1.7669]
25-01-17 16:37:38 | I |         best error  = [    1.7669]
25-01-17 16:37:38 | I |     + error = [1.7669]
25-01-17 16:37:38 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:37:40 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:37:41 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:37:42 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:37:44 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:37:45 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:37:47 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:37:50 | I | quantizing activations for layer model.layers.4
25-01-17 16:37:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:52 | I | forward this layer
25-01-17 16:37:52 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/03.pt
25-01-17 16:37:52 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/03.pt
25-01-17 16:37:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:37:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:37:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:37:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:37:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:37:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:37:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:37:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:37:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:37:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:37:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:37:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:37:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:37:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:37:53 | I | [1] done with optimizer step
25-01-17 16:37:53 | I | epoch 001:      2 / 409600000 loss=9.1243e-06, loss_sum=0.207241, wps=218.5, ups=0.01, wpb=32768, bsz=64, num_updates=2, lr=0.0002, gnorm=0, clip=0, loss_scale=128, train_wall=53, cuda_gb_allocated=12.1, cuda_gb_reserved=13.6, cuda_gb_free=11.6, wall=577
25-01-17 16:37:53 | I | begin validation on "valid" subset on rank 0
25-01-17 16:37:53 | I | got valid iterator on "valid" subset on rank 0
25-01-17 16:37:53 | I | Valid: Start iterating over samples
25-01-17 16:37:53 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:37:53 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:37:53 | I | - Evaluator: gptq
25-01-17 16:37:53 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:37:53 | I | - Batch_size: 8
25-01-17 16:37:53 | I |   + Max_seq_length: 2048
25-01-17 16:38:10 | I |     - Results:
25-01-17 16:38:10 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:38:10 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:38:10 | I |       |wikitext |      1|word_perplexity|7.7075|±  |7.7075|
25-01-17 16:38:10 | I |       |val_valid|      1|word_perplexity|7.4136|±  |7.4136|
25-01-17 16:38:10 | I |       
25-01-17 16:38:10 | I | in valid, quantize current layer weights
25-01-17 16:38:11 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:25 | I |       - range scale = [    1.0000]
25-01-17 16:38:25 | I |         sum  error  = [    0.6607]
25-01-17 16:38:25 | I |         best error  = [    0.6607]
25-01-17 16:38:25 | I |     + error = [0.6607]
25-01-17 16:38:26 | I |       - range scale = [    1.0000]
25-01-17 16:38:26 | I |         sum  error  = [    7.3391]
25-01-17 16:38:26 | I |         best error  = [    7.3391]
25-01-17 16:38:26 | I |     + error = [7.3391]
25-01-17 16:38:27 | I |       - range scale = [    1.0000]
25-01-17 16:38:27 | I |         sum  error  = [    0.6556]
25-01-17 16:38:27 | I |         best error  = [    0.6556]
25-01-17 16:38:27 | I |     + error = [0.6556]
25-01-17 16:38:28 | I |       - range scale = [    1.0000]
25-01-17 16:38:28 | I |         sum  error  = [    7.1260]
25-01-17 16:38:28 | I |         best error  = [    7.1260]
25-01-17 16:38:28 | I |     + error = [7.1260]
25-01-17 16:38:29 | I |       - range scale = [    1.0000]
25-01-17 16:38:29 | I |         sum  error  = [    0.0937]
25-01-17 16:38:29 | I |         best error  = [    0.0937]
25-01-17 16:38:29 | I |     + error = [0.0937]
25-01-17 16:38:30 | I |       - range scale = [    1.0000]
25-01-17 16:38:30 | I |         sum  error  = [    1.0592]
25-01-17 16:38:30 | I |         best error  = [    1.0592]
25-01-17 16:38:30 | I |     + error = [1.0592]
25-01-17 16:38:31 | I |       - range scale = [    1.0000]
25-01-17 16:38:31 | I |         sum  error  = [    0.0961]
25-01-17 16:38:31 | I |         best error  = [    0.0961]
25-01-17 16:38:31 | I |     + error = [0.0961]
25-01-17 16:38:31 | I |       - range scale = [    1.0000]
25-01-17 16:38:31 | I |         sum  error  = [    1.0476]
25-01-17 16:38:31 | I |         best error  = [    1.0476]
25-01-17 16:38:31 | I |     + error = [1.0476]
25-01-17 16:38:32 | I |       - range scale = [    1.0000]
25-01-17 16:38:32 | I |         sum  error  = [    0.4814]
25-01-17 16:38:32 | I |         best error  = [    0.4814]
25-01-17 16:38:32 | I |     + error = [0.4814]
25-01-17 16:38:33 | I |       - range scale = [    1.0000]
25-01-17 16:38:33 | I |         sum  error  = [    5.5039]
25-01-17 16:38:33 | I |         best error  = [    5.5039]
25-01-17 16:38:33 | I |     + error = [5.5039]
25-01-17 16:38:34 | I |       - range scale = [    1.0000]
25-01-17 16:38:34 | I |         sum  error  = [    2.5866]
25-01-17 16:38:34 | I |         best error  = [    2.5866]
25-01-17 16:38:34 | I |     + error = [2.5866]
25-01-17 16:38:35 | I |       - range scale = [    1.0000]
25-01-17 16:38:35 | I |         sum  error  = [   29.4842]
25-01-17 16:38:35 | I |         best error  = [   29.4842]
25-01-17 16:38:35 | I |     + error = [29.4842]
25-01-17 16:38:36 | I |       - range scale = [    1.0000]
25-01-17 16:38:36 | I |         sum  error  = [    0.1927]
25-01-17 16:38:36 | I |         best error  = [    0.1927]
25-01-17 16:38:36 | I |     + error = [0.1927]
25-01-17 16:38:36 | I |       - range scale = [    1.0000]
25-01-17 16:38:36 | I |         sum  error  = [    1.7468]
25-01-17 16:38:36 | I |         best error  = [    1.7468]
25-01-17 16:38:36 | I |     + error = [1.7468]
25-01-17 16:38:49 | I | in valid, quantize current layer acts
25-01-17 16:38:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:55 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 16:38:55 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:38:55 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:38:55 | I | - Evaluator: gptq
25-01-17 16:38:55 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:38:55 | I | - Batch_size: 8
25-01-17 16:38:55 | I |   + Max_seq_length: 2048
25-01-17 16:39:15 | I |     - Results:
25-01-17 16:39:15 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:39:15 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:39:15 | I |       |wikitext |      1|word_perplexity|7.7269|±  |7.7269|
25-01-17 16:39:15 | I |       |val_valid|      1|word_perplexity|7.4364|±  |7.4364|
25-01-17 16:39:15 | I |       
25-01-17 16:39:28 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.616, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.13, wps=36633.2, wpb=4058.2, bsz=2, num_updates=2, lmquant_ppl_wikitext_all_quanted=7.70752, lmquant_ppl_val_all_quanted=7.41357, lmquant_ppl_wikitext_partly_quanted=7.72689, lmquant_ppl_val_partly_quanted=7.43637
25-01-17 16:39:28 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.616 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.13 | wps 36633.2 | wpb 4058.2 | bsz 2 | num_updates 2 | lmquant_ppl_wikitext_all_quanted 7.70752 | lmquant_ppl_val_all_quanted 7.41357 | lmquant_ppl_wikitext_partly_quanted 7.72689 | lmquant_ppl_val_partly_quanted 7.43637
25-01-17 16:39:28 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:39:28 | I | in layer model.layers.4
25-01-17 16:39:28 | I | quantizing weights for layer model.layers.4
25-01-17 16:39:28 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:28 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:28 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:29 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:39:29 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:39:30 | I |       - range scale = [    1.0000]
25-01-17 16:39:30 | I |         sum  error  = [    0.2386]
25-01-17 16:39:30 | I |         best error  = [    0.2386]
25-01-17 16:39:30 | I |     + error = [0.2386]
25-01-17 16:39:30 | I |       - range scale = [    1.0000]
25-01-17 16:39:30 | I |         sum  error  = [    2.5987]
25-01-17 16:39:30 | I |         best error  = [    2.5987]
25-01-17 16:39:30 | I |     + error = [2.5987]
25-01-17 16:39:30 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:39:31 | I |       - range scale = [    1.0000]
25-01-17 16:39:31 | I |         sum  error  = [    0.2234]
25-01-17 16:39:31 | I |         best error  = [    0.2234]
25-01-17 16:39:31 | I |     + error = [0.2234]
25-01-17 16:39:32 | I |       - range scale = [    1.0000]
25-01-17 16:39:32 | I |         sum  error  = [    2.4335]
25-01-17 16:39:32 | I |         best error  = [    2.4335]
25-01-17 16:39:32 | I |     + error = [2.4335]
25-01-17 16:39:32 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:39:33 | I |       - range scale = [    1.0000]
25-01-17 16:39:33 | I |         sum  error  = [    0.0933]
25-01-17 16:39:33 | I |         best error  = [    0.0933]
25-01-17 16:39:33 | I |     + error = [0.0933]
25-01-17 16:39:34 | I |       - range scale = [    1.0000]
25-01-17 16:39:34 | I |         sum  error  = [    1.0520]
25-01-17 16:39:34 | I |         best error  = [    1.0520]
25-01-17 16:39:34 | I |     + error = [1.0520]
25-01-17 16:39:34 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:39:35 | I |       - range scale = [    1.0000]
25-01-17 16:39:35 | I |         sum  error  = [    0.1099]
25-01-17 16:39:35 | I |         best error  = [    0.1099]
25-01-17 16:39:35 | I |     + error = [0.1099]
25-01-17 16:39:35 | I |       - range scale = [    1.0000]
25-01-17 16:39:35 | I |         sum  error  = [    1.2004]
25-01-17 16:39:35 | I |         best error  = [    1.2004]
25-01-17 16:39:35 | I |     + error = [1.2004]
25-01-17 16:39:35 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:39:36 | I |       - range scale = [    1.0000]
25-01-17 16:39:36 | I |         sum  error  = [    0.4784]
25-01-17 16:39:36 | I |         best error  = [    0.4784]
25-01-17 16:39:36 | I |     + error = [0.4784]
25-01-17 16:39:37 | I |       - range scale = [    1.0000]
25-01-17 16:39:37 | I |         sum  error  = [    5.4603]
25-01-17 16:39:37 | I |         best error  = [    5.4603]
25-01-17 16:39:37 | I |     + error = [5.4603]
25-01-17 16:39:37 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:39:38 | I |       - range scale = [    1.0000]
25-01-17 16:39:38 | I |         sum  error  = [    2.5798]
25-01-17 16:39:38 | I |         best error  = [    2.5798]
25-01-17 16:39:38 | I |     + error = [2.5798]
25-01-17 16:39:38 | I |       - range scale = [    1.0000]
25-01-17 16:39:38 | I |         sum  error  = [   29.2795]
25-01-17 16:39:38 | I |         best error  = [   29.2795]
25-01-17 16:39:38 | I |     + error = [29.2795]
25-01-17 16:39:39 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:39:39 | I |       - range scale = [    1.0000]
25-01-17 16:39:39 | I |         sum  error  = [    0.1936]
25-01-17 16:39:39 | I |         best error  = [    0.1936]
25-01-17 16:39:39 | I |     + error = [0.1936]
25-01-17 16:39:40 | I |       - range scale = [    1.0000]
25-01-17 16:39:40 | I |         sum  error  = [    1.7303]
25-01-17 16:39:40 | I |         best error  = [    1.7303]
25-01-17 16:39:40 | I |     + error = [1.7303]
25-01-17 16:39:40 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:39:42 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:39:43 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:39:44 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:39:46 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:39:47 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:39:48 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:39:52 | I | quantizing activations for layer model.layers.4
25-01-17 16:39:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:54 | I | forward this layer
25-01-17 16:39:54 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/04.pt
25-01-17 16:39:54 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/04.pt
25-01-17 16:39:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:39:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:39:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:39:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:39:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:39:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:39:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:39:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:39:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:39:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:39:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:39:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:39:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:39:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:39:55 | I | in layer model.layers.4
25-01-17 16:39:55 | I | quantizing weights for layer model.layers.4
25-01-17 16:39:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:56 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:39:56 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:39:56 | I |       - range scale = [    1.0000]
25-01-17 16:39:56 | I |         sum  error  = [    0.2405]
25-01-17 16:39:56 | I |         best error  = [    0.2405]
25-01-17 16:39:56 | I |     + error = [0.2405]
25-01-17 16:39:57 | I |       - range scale = [    1.0000]
25-01-17 16:39:57 | I |         sum  error  = [    2.6618]
25-01-17 16:39:57 | I |         best error  = [    2.6618]
25-01-17 16:39:57 | I |     + error = [2.6618]
25-01-17 16:39:57 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:39:58 | I |       - range scale = [    1.0000]
25-01-17 16:39:58 | I |         sum  error  = [    0.2187]
25-01-17 16:39:58 | I |         best error  = [    0.2187]
25-01-17 16:39:58 | I |     + error = [0.2187]
25-01-17 16:39:59 | I |       - range scale = [    1.0000]
25-01-17 16:39:59 | I |         sum  error  = [    2.4497]
25-01-17 16:39:59 | I |         best error  = [    2.4497]
25-01-17 16:39:59 | I |     + error = [2.4497]
25-01-17 16:39:59 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:39:59 | I |       - range scale = [    1.0000]
25-01-17 16:39:59 | I |         sum  error  = [    0.0932]
25-01-17 16:39:59 | I |         best error  = [    0.0932]
25-01-17 16:39:59 | I |     + error = [0.0932]
25-01-17 16:40:00 | I |       - range scale = [    1.0000]
25-01-17 16:40:00 | I |         sum  error  = [    1.0530]
25-01-17 16:40:00 | I |         best error  = [    1.0530]
25-01-17 16:40:00 | I |     + error = [1.0530]
25-01-17 16:40:00 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:40:01 | I |       - range scale = [    1.0000]
25-01-17 16:40:01 | I |         sum  error  = [    0.1201]
25-01-17 16:40:01 | I |         best error  = [    0.1201]
25-01-17 16:40:01 | I |     + error = [0.1201]
25-01-17 16:40:02 | I |       - range scale = [    1.0000]
25-01-17 16:40:02 | I |         sum  error  = [    1.3083]
25-01-17 16:40:02 | I |         best error  = [    1.3083]
25-01-17 16:40:02 | I |     + error = [1.3083]
25-01-17 16:40:02 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:40:03 | I |       - range scale = [    1.0000]
25-01-17 16:40:03 | I |         sum  error  = [    0.4786]
25-01-17 16:40:03 | I |         best error  = [    0.4786]
25-01-17 16:40:03 | I |     + error = [0.4786]
25-01-17 16:40:03 | I |       - range scale = [    1.0000]
25-01-17 16:40:03 | I |         sum  error  = [    5.4617]
25-01-17 16:40:03 | I |         best error  = [    5.4617]
25-01-17 16:40:03 | I |     + error = [5.4617]
25-01-17 16:40:03 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:40:04 | I |       - range scale = [    1.0000]
25-01-17 16:40:04 | I |         sum  error  = [    2.5736]
25-01-17 16:40:04 | I |         best error  = [    2.5736]
25-01-17 16:40:04 | I |     + error = [2.5736]
25-01-17 16:40:05 | I |       - range scale = [    1.0000]
25-01-17 16:40:05 | I |         sum  error  = [   29.2816]
25-01-17 16:40:05 | I |         best error  = [   29.2816]
25-01-17 16:40:05 | I |     + error = [29.2816]
25-01-17 16:40:05 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:40:06 | I |       - range scale = [    1.0000]
25-01-17 16:40:06 | I |         sum  error  = [    0.2011]
25-01-17 16:40:06 | I |         best error  = [    0.2011]
25-01-17 16:40:06 | I |     + error = [0.2011]
25-01-17 16:40:06 | I |       - range scale = [    1.0000]
25-01-17 16:40:06 | I |         sum  error  = [    1.7948]
25-01-17 16:40:06 | I |         best error  = [    1.7948]
25-01-17 16:40:06 | I |     + error = [1.7948]
25-01-17 16:40:07 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:40:08 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:40:09 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:40:11 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:40:12 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:40:14 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:40:15 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:40:18 | I | quantizing activations for layer model.layers.4
25-01-17 16:40:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:21 | I | forward this layer
25-01-17 16:40:21 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/05.pt
25-01-17 16:40:21 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/05.pt
25-01-17 16:40:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:40:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:40:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:40:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:40:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:40:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:40:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:40:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:40:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:40:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:40:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:40:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:40:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:40:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:40:21 | I | [2] done with optimizer step
25-01-17 16:40:21 | I | epoch 001:      3 / 409600000 loss=9.3799e-06, loss_sum=0.213047, wps=221, ups=0.01, wpb=32768, bsz=64, num_updates=3, lr=0.0003, gnorm=0, clip=0, loss_scale=128, train_wall=53, cuda_gb_allocated=12.1, cuda_gb_reserved=13.6, cuda_gb_free=11.6, wall=725
25-01-17 16:40:21 | I | begin validation on "valid" subset on rank 0
25-01-17 16:40:21 | I | got valid iterator on "valid" subset on rank 0
25-01-17 16:40:21 | I | Valid: Start iterating over samples
25-01-17 16:40:21 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:40:21 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:40:21 | I | - Evaluator: gptq
25-01-17 16:40:21 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:40:21 | I | - Batch_size: 8
25-01-17 16:40:21 | I |   + Max_seq_length: 2048
25-01-17 16:40:39 | I |     - Results:
25-01-17 16:40:39 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:40:39 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:40:39 | I |       |wikitext |      1|word_perplexity|7.7075|±  |7.7075|
25-01-17 16:40:39 | I |       |val_valid|      1|word_perplexity|7.4136|±  |7.4136|
25-01-17 16:40:39 | I |       
25-01-17 16:40:39 | I | in valid, quantize current layer weights
25-01-17 16:40:39 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 16:40:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:56 | I |       - range scale = [    1.0000]
25-01-17 16:40:56 | I |         sum  error  = [    0.6607]
25-01-17 16:40:56 | I |         best error  = [    0.6607]
25-01-17 16:40:56 | I |     + error = [0.6607]
25-01-17 16:40:57 | I |       - range scale = [    1.0000]
25-01-17 16:40:57 | I |         sum  error  = [    7.3391]
25-01-17 16:40:57 | I |         best error  = [    7.3391]
25-01-17 16:40:57 | I |     + error = [7.3391]
25-01-17 16:40:58 | I |       - range scale = [    1.0000]
25-01-17 16:40:58 | I |         sum  error  = [    0.6556]
25-01-17 16:40:58 | I |         best error  = [    0.6556]
25-01-17 16:40:58 | I |     + error = [0.6556]
25-01-17 16:40:59 | I |       - range scale = [    1.0000]
25-01-17 16:40:59 | I |         sum  error  = [    7.1260]
25-01-17 16:40:59 | I |         best error  = [    7.1260]
25-01-17 16:40:59 | I |     + error = [7.1260]
25-01-17 16:41:00 | I |       - range scale = [    1.0000]
25-01-17 16:41:00 | I |         sum  error  = [    0.0937]
25-01-17 16:41:00 | I |         best error  = [    0.0937]
25-01-17 16:41:00 | I |     + error = [0.0937]
25-01-17 16:41:00 | I |       - range scale = [    1.0000]
25-01-17 16:41:00 | I |         sum  error  = [    1.0592]
25-01-17 16:41:00 | I |         best error  = [    1.0592]
25-01-17 16:41:00 | I |     + error = [1.0592]
25-01-17 16:41:01 | I |       - range scale = [    1.0000]
25-01-17 16:41:01 | I |         sum  error  = [    0.0961]
25-01-17 16:41:01 | I |         best error  = [    0.0961]
25-01-17 16:41:01 | I |     + error = [0.0961]
25-01-17 16:41:02 | I |       - range scale = [    1.0000]
25-01-17 16:41:02 | I |         sum  error  = [    1.0476]
25-01-17 16:41:02 | I |         best error  = [    1.0476]
25-01-17 16:41:02 | I |     + error = [1.0476]
25-01-17 16:41:03 | I |       - range scale = [    1.0000]
25-01-17 16:41:03 | I |         sum  error  = [    0.4814]
25-01-17 16:41:03 | I |         best error  = [    0.4814]
25-01-17 16:41:03 | I |     + error = [0.4814]
25-01-17 16:41:03 | I |       - range scale = [    1.0000]
25-01-17 16:41:03 | I |         sum  error  = [    5.5039]
25-01-17 16:41:03 | I |         best error  = [    5.5039]
25-01-17 16:41:03 | I |     + error = [5.5039]
25-01-17 16:41:04 | I |       - range scale = [    1.0000]
25-01-17 16:41:04 | I |         sum  error  = [    2.5866]
25-01-17 16:41:04 | I |         best error  = [    2.5866]
25-01-17 16:41:04 | I |     + error = [2.5866]
25-01-17 16:41:05 | I |       - range scale = [    1.0000]
25-01-17 16:41:05 | I |         sum  error  = [   29.4842]
25-01-17 16:41:05 | I |         best error  = [   29.4842]
25-01-17 16:41:05 | I |     + error = [29.4842]
25-01-17 16:41:06 | I |       - range scale = [    1.0000]
25-01-17 16:41:06 | I |         sum  error  = [    0.1927]
25-01-17 16:41:06 | I |         best error  = [    0.1927]
25-01-17 16:41:06 | I |     + error = [0.1927]
25-01-17 16:41:07 | I |       - range scale = [    1.0000]
25-01-17 16:41:07 | I |         sum  error  = [    1.7468]
25-01-17 16:41:07 | I |         best error  = [    1.7468]
25-01-17 16:41:07 | I |     + error = [1.7468]
25-01-17 16:41:20 | I | in valid, quantize current layer acts
25-01-17 16:41:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:27 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 16:41:27 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:41:27 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:41:27 | I | - Evaluator: gptq
25-01-17 16:41:27 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:41:27 | I | - Batch_size: 8
25-01-17 16:41:27 | I |   + Max_seq_length: 2048
25-01-17 16:41:46 | I |     - Results:
25-01-17 16:41:46 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:41:46 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:41:46 | I |       |wikitext |      1|word_perplexity|7.7269|±  |7.7269|
25-01-17 16:41:46 | I |       |val_valid|      1|word_perplexity|7.4364|±  |7.4364|
25-01-17 16:41:46 | I |       
25-01-17 16:42:00 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.616, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.13, wps=36572.5, wpb=4058.2, bsz=2, num_updates=3, lmquant_ppl_wikitext_all_quanted=7.70752, lmquant_ppl_val_all_quanted=7.41357, lmquant_ppl_wikitext_partly_quanted=7.72689, lmquant_ppl_val_partly_quanted=7.43637
25-01-17 16:42:00 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.616 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.13 | wps 36572.5 | wpb 4058.2 | bsz 2 | num_updates 3 | lmquant_ppl_wikitext_all_quanted 7.70752 | lmquant_ppl_val_all_quanted 7.41357 | lmquant_ppl_wikitext_partly_quanted 7.72689 | lmquant_ppl_val_partly_quanted 7.43637
25-01-17 16:42:00 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:42:00 | I | in layer model.layers.4
25-01-17 16:42:00 | I | quantizing weights for layer model.layers.4
25-01-17 16:42:00 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:00 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:00 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:00 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:01 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:42:01 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:42:01 | I |       - range scale = [    1.0000]
25-01-17 16:42:01 | I |         sum  error  = [    0.2490]
25-01-17 16:42:01 | I |         best error  = [    0.2490]
25-01-17 16:42:01 | I |     + error = [0.2490]
25-01-17 16:42:02 | I |       - range scale = [    1.0000]
25-01-17 16:42:02 | I |         sum  error  = [    2.8525]
25-01-17 16:42:02 | I |         best error  = [    2.8525]
25-01-17 16:42:02 | I |     + error = [2.8525]
25-01-17 16:42:02 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:42:03 | I |       - range scale = [    1.0000]
25-01-17 16:42:03 | I |         sum  error  = [    0.2209]
25-01-17 16:42:03 | I |         best error  = [    0.2209]
25-01-17 16:42:03 | I |     + error = [0.2209]
25-01-17 16:42:04 | I |       - range scale = [    1.0000]
25-01-17 16:42:04 | I |         sum  error  = [    2.6313]
25-01-17 16:42:04 | I |         best error  = [    2.6313]
25-01-17 16:42:04 | I |     + error = [2.6313]
25-01-17 16:42:04 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:42:05 | I |       - range scale = [    1.0000]
25-01-17 16:42:05 | I |         sum  error  = [    0.0933]
25-01-17 16:42:05 | I |         best error  = [    0.0933]
25-01-17 16:42:05 | I |     + error = [0.0933]
25-01-17 16:42:05 | I |       - range scale = [    1.0000]
25-01-17 16:42:05 | I |         sum  error  = [    1.0533]
25-01-17 16:42:05 | I |         best error  = [    1.0533]
25-01-17 16:42:05 | I |     + error = [1.0533]
25-01-17 16:42:05 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:42:06 | I |       - range scale = [    1.0000]
25-01-17 16:42:06 | I |         sum  error  = [    0.1132]
25-01-17 16:42:06 | I |         best error  = [    0.1132]
25-01-17 16:42:06 | I |     + error = [0.1132]
25-01-17 16:42:07 | I |       - range scale = [    1.0000]
25-01-17 16:42:07 | I |         sum  error  = [    1.2302]
25-01-17 16:42:07 | I |         best error  = [    1.2302]
25-01-17 16:42:07 | I |     + error = [1.2302]
25-01-17 16:42:07 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:42:08 | I |       - range scale = [    1.0000]
25-01-17 16:42:08 | I |         sum  error  = [    0.4778]
25-01-17 16:42:08 | I |         best error  = [    0.4778]
25-01-17 16:42:08 | I |     + error = [0.4778]
25-01-17 16:42:08 | I |       - range scale = [    1.0000]
25-01-17 16:42:08 | I |         sum  error  = [    5.4580]
25-01-17 16:42:08 | I |         best error  = [    5.4580]
25-01-17 16:42:08 | I |     + error = [5.4580]
25-01-17 16:42:09 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:42:09 | I |       - range scale = [    1.0000]
25-01-17 16:42:09 | I |         sum  error  = [    2.5719]
25-01-17 16:42:09 | I |         best error  = [    2.5719]
25-01-17 16:42:09 | I |     + error = [2.5719]
25-01-17 16:42:10 | I |       - range scale = [    1.0000]
25-01-17 16:42:10 | I |         sum  error  = [   29.2812]
25-01-17 16:42:10 | I |         best error  = [   29.2812]
25-01-17 16:42:10 | I |     + error = [29.2812]
25-01-17 16:42:10 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:42:11 | I |       - range scale = [    1.0000]
25-01-17 16:42:11 | I |         sum  error  = [    0.2020]
25-01-17 16:42:11 | I |         best error  = [    0.2020]
25-01-17 16:42:11 | I |     + error = [0.2020]
25-01-17 16:42:11 | I |       - range scale = [    1.0000]
25-01-17 16:42:11 | I |         sum  error  = [    1.8148]
25-01-17 16:42:11 | I |         best error  = [    1.8148]
25-01-17 16:42:11 | I |     + error = [1.8148]
25-01-17 16:42:12 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:42:13 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:42:14 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:42:16 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:42:17 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:42:19 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:42:20 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:42:23 | I | quantizing activations for layer model.layers.4
25-01-17 16:42:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:26 | I | forward this layer
25-01-17 16:42:26 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/06.pt
25-01-17 16:42:26 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/06.pt
25-01-17 16:42:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:42:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:42:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:42:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:42:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:42:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:42:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:42:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:42:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:42:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:42:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:42:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:42:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:42:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:42:26 | I | in layer model.layers.4
25-01-17 16:42:26 | I | quantizing weights for layer model.layers.4
25-01-17 16:42:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:27 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:42:27 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:42:28 | I |       - range scale = [    1.0000]
25-01-17 16:42:28 | I |         sum  error  = [    0.2562]
25-01-17 16:42:28 | I |         best error  = [    0.2562]
25-01-17 16:42:28 | I |     + error = [0.2562]
25-01-17 16:42:29 | I |       - range scale = [    1.0000]
25-01-17 16:42:29 | I |         sum  error  = [    2.8695]
25-01-17 16:42:29 | I |         best error  = [    2.8695]
25-01-17 16:42:29 | I |     + error = [2.8695]
25-01-17 16:42:29 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:42:30 | I |       - range scale = [    1.0000]
25-01-17 16:42:30 | I |         sum  error  = [    0.2342]
25-01-17 16:42:30 | I |         best error  = [    0.2342]
25-01-17 16:42:30 | I |     + error = [0.2342]
25-01-17 16:42:30 | I |       - range scale = [    1.0000]
25-01-17 16:42:30 | I |         sum  error  = [    2.9431]
25-01-17 16:42:30 | I |         best error  = [    2.9431]
25-01-17 16:42:30 | I |     + error = [2.9431]
25-01-17 16:42:30 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:42:31 | I |       - range scale = [    1.0000]
25-01-17 16:42:31 | I |         sum  error  = [    0.0928]
25-01-17 16:42:31 | I |         best error  = [    0.0928]
25-01-17 16:42:31 | I |     + error = [0.0928]
25-01-17 16:42:32 | I |       - range scale = [    1.0000]
25-01-17 16:42:32 | I |         sum  error  = [    1.0519]
25-01-17 16:42:32 | I |         best error  = [    1.0519]
25-01-17 16:42:32 | I |     + error = [1.0519]
25-01-17 16:42:32 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:42:33 | I |       - range scale = [    1.0000]
25-01-17 16:42:33 | I |         sum  error  = [    0.1230]
25-01-17 16:42:33 | I |         best error  = [    0.1230]
25-01-17 16:42:33 | I |     + error = [0.1230]
25-01-17 16:42:33 | I |       - range scale = [    1.0000]
25-01-17 16:42:33 | I |         sum  error  = [    1.3466]
25-01-17 16:42:33 | I |         best error  = [    1.3466]
25-01-17 16:42:33 | I |     + error = [1.3466]
25-01-17 16:42:33 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:42:34 | I |       - range scale = [    1.0000]
25-01-17 16:42:34 | I |         sum  error  = [    0.4785]
25-01-17 16:42:34 | I |         best error  = [    0.4785]
25-01-17 16:42:34 | I |     + error = [0.4785]
25-01-17 16:42:35 | I |       - range scale = [    1.0000]
25-01-17 16:42:35 | I |         sum  error  = [    5.4640]
25-01-17 16:42:35 | I |         best error  = [    5.4640]
25-01-17 16:42:35 | I |     + error = [5.4640]
25-01-17 16:42:35 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:42:36 | I |       - range scale = [    1.0000]
25-01-17 16:42:36 | I |         sum  error  = [    2.5731]
25-01-17 16:42:36 | I |         best error  = [    2.5731]
25-01-17 16:42:36 | I |     + error = [2.5731]
25-01-17 16:42:36 | I |       - range scale = [    1.0000]
25-01-17 16:42:36 | I |         sum  error  = [   29.2963]
25-01-17 16:42:36 | I |         best error  = [   29.2963]
25-01-17 16:42:36 | I |     + error = [29.2963]
25-01-17 16:42:37 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:42:37 | I |       - range scale = [    1.0000]
25-01-17 16:42:37 | I |         sum  error  = [    0.1992]
25-01-17 16:42:37 | I |         best error  = [    0.1992]
25-01-17 16:42:37 | I |     + error = [0.1992]
25-01-17 16:42:38 | I |       - range scale = [    1.0000]
25-01-17 16:42:38 | I |         sum  error  = [    1.8149]
25-01-17 16:42:38 | I |         best error  = [    1.8149]
25-01-17 16:42:38 | I |     + error = [1.8149]
25-01-17 16:42:38 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:42:40 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:42:41 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:42:42 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:42:44 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:42:45 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:42:46 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:42:50 | I | quantizing activations for layer model.layers.4
25-01-17 16:42:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:52 | I | forward this layer
25-01-17 16:42:52 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/07.pt
25-01-17 16:42:52 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/07.pt
25-01-17 16:42:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:42:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:42:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:42:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:42:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:42:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:42:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:42:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:42:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:42:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:42:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:42:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:42:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:42:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:42:53 | I | [3] done with optimizer step
25-01-17 16:42:53 | I | epoch 001:      4 / 409600000 loss=1.00586e-05, loss_sum=0.228461, wps=216.1, ups=0.01, wpb=32768, bsz=64, num_updates=4, lr=0.0004, gnorm=0, clip=0, loss_scale=128, train_wall=53, cuda_gb_allocated=12.1, cuda_gb_reserved=13.6, cuda_gb_free=11.6, wall=877
25-01-17 16:42:53 | I | begin validation on "valid" subset on rank 0
25-01-17 16:42:53 | I | got valid iterator on "valid" subset on rank 0
25-01-17 16:42:53 | I | Valid: Start iterating over samples
25-01-17 16:42:53 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:42:53 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:42:53 | I | - Evaluator: gptq
25-01-17 16:42:53 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:42:53 | I | - Batch_size: 8
25-01-17 16:42:53 | I |   + Max_seq_length: 2048
25-01-17 16:43:10 | I |     - Results:
25-01-17 16:43:10 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:43:10 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:43:10 | I |       |wikitext |      1|word_perplexity|7.7075|±  |7.7075|
25-01-17 16:43:10 | I |       |val_valid|      1|word_perplexity|7.4136|±  |7.4136|
25-01-17 16:43:10 | I |       
25-01-17 16:43:10 | I | in valid, quantize current layer weights
25-01-17 16:43:11 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:25 | I |       - range scale = [    1.0000]
25-01-17 16:43:25 | I |         sum  error  = [    0.6607]
25-01-17 16:43:25 | I |         best error  = [    0.6607]
25-01-17 16:43:25 | I |     + error = [0.6607]
25-01-17 16:43:26 | I |       - range scale = [    1.0000]
25-01-17 16:43:26 | I |         sum  error  = [    7.3391]
25-01-17 16:43:26 | I |         best error  = [    7.3391]
25-01-17 16:43:26 | I |     + error = [7.3391]
25-01-17 16:43:28 | I |       - range scale = [    1.0000]
25-01-17 16:43:28 | I |         sum  error  = [    0.6556]
25-01-17 16:43:28 | I |         best error  = [    0.6556]
25-01-17 16:43:28 | I |     + error = [0.6556]
25-01-17 16:43:29 | I |       - range scale = [    1.0000]
25-01-17 16:43:29 | I |         sum  error  = [    7.1260]
25-01-17 16:43:29 | I |         best error  = [    7.1260]
25-01-17 16:43:29 | I |     + error = [7.1260]
25-01-17 16:43:29 | I |       - range scale = [    1.0000]
25-01-17 16:43:29 | I |         sum  error  = [    0.0937]
25-01-17 16:43:30 | I |         best error  = [    0.0937]
25-01-17 16:43:30 | I |     + error = [0.0937]
25-01-17 16:43:30 | I |       - range scale = [    1.0000]
25-01-17 16:43:30 | I |         sum  error  = [    1.0592]
25-01-17 16:43:30 | I |         best error  = [    1.0592]
25-01-17 16:43:30 | I |     + error = [1.0592]
25-01-17 16:43:31 | I |       - range scale = [    1.0000]
25-01-17 16:43:31 | I |         sum  error  = [    0.0961]
25-01-17 16:43:31 | I |         best error  = [    0.0961]
25-01-17 16:43:31 | I |     + error = [0.0961]
25-01-17 16:43:32 | I |       - range scale = [    1.0000]
25-01-17 16:43:32 | I |         sum  error  = [    1.0476]
25-01-17 16:43:32 | I |         best error  = [    1.0476]
25-01-17 16:43:32 | I |     + error = [1.0476]
25-01-17 16:43:33 | I |       - range scale = [    1.0000]
25-01-17 16:43:33 | I |         sum  error  = [    0.4814]
25-01-17 16:43:33 | I |         best error  = [    0.4814]
25-01-17 16:43:33 | I |     + error = [0.4814]
25-01-17 16:43:33 | I |       - range scale = [    1.0000]
25-01-17 16:43:33 | I |         sum  error  = [    5.5039]
25-01-17 16:43:33 | I |         best error  = [    5.5039]
25-01-17 16:43:33 | I |     + error = [5.5039]
25-01-17 16:43:34 | I |       - range scale = [    1.0000]
25-01-17 16:43:34 | I |         sum  error  = [    2.5866]
25-01-17 16:43:34 | I |         best error  = [    2.5866]
25-01-17 16:43:34 | I |     + error = [2.5866]
25-01-17 16:43:35 | I |       - range scale = [    1.0000]
25-01-17 16:43:35 | I |         sum  error  = [   29.4842]
25-01-17 16:43:35 | I |         best error  = [   29.4842]
25-01-17 16:43:35 | I |     + error = [29.4842]
25-01-17 16:43:36 | I |       - range scale = [    1.0000]
25-01-17 16:43:36 | I |         sum  error  = [    0.1927]
25-01-17 16:43:36 | I |         best error  = [    0.1927]
25-01-17 16:43:36 | I |     + error = [0.1927]
25-01-17 16:43:37 | I |       - range scale = [    1.0000]
25-01-17 16:43:37 | I |         sum  error  = [    1.7468]
25-01-17 16:43:37 | I |         best error  = [    1.7468]
25-01-17 16:43:37 | I |     + error = [1.7468]
25-01-17 16:43:49 | I | in valid, quantize current layer acts
25-01-17 16:43:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:56 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 16:43:56 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:43:56 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:43:56 | I | - Evaluator: gptq
25-01-17 16:43:56 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:43:56 | I | - Batch_size: 8
25-01-17 16:43:56 | I |   + Max_seq_length: 2048
25-01-17 16:44:15 | I |     - Results:
25-01-17 16:44:15 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:44:15 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:44:15 | I |       |wikitext |      1|word_perplexity|7.7269|±  |7.7269|
25-01-17 16:44:15 | I |       |val_valid|      1|word_perplexity|7.4364|±  |7.4364|
25-01-17 16:44:15 | I |       
25-01-17 16:44:28 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.616, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.13, wps=36557.5, wpb=4058.2, bsz=2, num_updates=4, lmquant_ppl_wikitext_all_quanted=7.70752, lmquant_ppl_val_all_quanted=7.41357, lmquant_ppl_wikitext_partly_quanted=7.72689, lmquant_ppl_val_partly_quanted=7.43637
25-01-17 16:44:28 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.616 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.13 | wps 36557.5 | wpb 4058.2 | bsz 2 | num_updates 4 | lmquant_ppl_wikitext_all_quanted 7.70752 | lmquant_ppl_val_all_quanted 7.41357 | lmquant_ppl_wikitext_partly_quanted 7.72689 | lmquant_ppl_val_partly_quanted 7.43637
25-01-17 16:44:29 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:44:29 | I | in layer model.layers.4
25-01-17 16:44:29 | I | quantizing weights for layer model.layers.4
25-01-17 16:44:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:30 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:44:30 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:44:30 | I |       - range scale = [    1.0000]
25-01-17 16:44:30 | I |         sum  error  = [    0.2444]
25-01-17 16:44:30 | I |         best error  = [    0.2444]
25-01-17 16:44:30 | I |     + error = [0.2444]
25-01-17 16:44:31 | I |       - range scale = [    1.0000]
25-01-17 16:44:31 | I |         sum  error  = [    2.7733]
25-01-17 16:44:31 | I |         best error  = [    2.7733]
25-01-17 16:44:31 | I |     + error = [2.7733]
25-01-17 16:44:31 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:44:32 | I |       - range scale = [    1.0000]
25-01-17 16:44:32 | I |         sum  error  = [    0.2275]
25-01-17 16:44:32 | I |         best error  = [    0.2275]
25-01-17 16:44:32 | I |     + error = [0.2275]
25-01-17 16:44:33 | I |       - range scale = [    1.0000]
25-01-17 16:44:33 | I |         sum  error  = [    2.7941]
25-01-17 16:44:33 | I |         best error  = [    2.7941]
25-01-17 16:44:33 | I |     + error = [2.7941]
25-01-17 16:44:33 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:44:33 | I |       - range scale = [    1.0000]
25-01-17 16:44:33 | I |         sum  error  = [    0.0930]
25-01-17 16:44:33 | I |         best error  = [    0.0930]
25-01-17 16:44:33 | I |     + error = [0.0930]
25-01-17 16:44:34 | I |       - range scale = [    1.0000]
25-01-17 16:44:34 | I |         sum  error  = [    1.0520]
25-01-17 16:44:34 | I |         best error  = [    1.0520]
25-01-17 16:44:34 | I |     + error = [1.0520]
25-01-17 16:44:34 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:44:35 | I |       - range scale = [    1.0000]
25-01-17 16:44:35 | I |         sum  error  = [    0.1125]
25-01-17 16:44:35 | I |         best error  = [    0.1125]
25-01-17 16:44:35 | I |     + error = [0.1125]
25-01-17 16:44:36 | I |       - range scale = [    1.0000]
25-01-17 16:44:36 | I |         sum  error  = [    1.2299]
25-01-17 16:44:36 | I |         best error  = [    1.2299]
25-01-17 16:44:36 | I |     + error = [1.2299]
25-01-17 16:44:36 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:44:36 | I |       - range scale = [    1.0000]
25-01-17 16:44:36 | I |         sum  error  = [    0.4789]
25-01-17 16:44:36 | I |         best error  = [    0.4789]
25-01-17 16:44:36 | I |     + error = [0.4789]
25-01-17 16:44:37 | I |       - range scale = [    1.0000]
25-01-17 16:44:37 | I |         sum  error  = [    5.4640]
25-01-17 16:44:37 | I |         best error  = [    5.4640]
25-01-17 16:44:37 | I |     + error = [5.4640]
25-01-17 16:44:37 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:44:38 | I |       - range scale = [    1.0000]
25-01-17 16:44:38 | I |         sum  error  = [    2.5705]
25-01-17 16:44:38 | I |         best error  = [    2.5705]
25-01-17 16:44:38 | I |     + error = [2.5705]
25-01-17 16:44:39 | I |       - range scale = [    1.0000]
25-01-17 16:44:39 | I |         sum  error  = [   29.2794]
25-01-17 16:44:39 | I |         best error  = [   29.2794]
25-01-17 16:44:39 | I |     + error = [29.2794]
25-01-17 16:44:39 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:44:40 | I |       - range scale = [    1.0000]
25-01-17 16:44:40 | I |         sum  error  = [    0.1906]
25-01-17 16:44:40 | I |         best error  = [    0.1906]
25-01-17 16:44:40 | I |     + error = [0.1906]
25-01-17 16:44:40 | I |       - range scale = [    1.0000]
25-01-17 16:44:40 | I |         sum  error  = [    1.7145]
25-01-17 16:44:40 | I |         best error  = [    1.7145]
25-01-17 16:44:40 | I |     + error = [1.7145]
25-01-17 16:44:41 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:44:42 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:44:43 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:44:45 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:44:46 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:44:47 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:44:49 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:44:52 | I | quantizing activations for layer model.layers.4
25-01-17 16:44:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:55 | I | forward this layer
25-01-17 16:44:55 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/08.pt
25-01-17 16:44:55 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/08.pt
25-01-17 16:44:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:44:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:44:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:44:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:44:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:44:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:44:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:44:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:44:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:44:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:44:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:44:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:44:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:44:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:44:55 | I | in layer model.layers.4
25-01-17 16:44:55 | I | quantizing weights for layer model.layers.4
25-01-17 16:44:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:56 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:44:56 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:44:57 | I |       - range scale = [    1.0000]
25-01-17 16:44:57 | I |         sum  error  = [    0.2505]
25-01-17 16:44:57 | I |         best error  = [    0.2505]
25-01-17 16:44:57 | I |     + error = [0.2505]
25-01-17 16:44:58 | I |       - range scale = [    1.0000]
25-01-17 16:44:58 | I |         sum  error  = [    2.8333]
25-01-17 16:44:58 | I |         best error  = [    2.8333]
25-01-17 16:44:58 | I |     + error = [2.8333]
25-01-17 16:44:58 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:44:58 | I |       - range scale = [    1.0000]
25-01-17 16:44:58 | I |         sum  error  = [    0.2417]
25-01-17 16:44:58 | I |         best error  = [    0.2417]
25-01-17 16:44:58 | I |     + error = [0.2417]
25-01-17 16:44:59 | I |       - range scale = [    1.0000]
25-01-17 16:44:59 | I |         sum  error  = [    2.7313]
25-01-17 16:44:59 | I |         best error  = [    2.7313]
25-01-17 16:44:59 | I |     + error = [2.7313]
25-01-17 16:44:59 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:45:00 | I |       - range scale = [    1.0000]
25-01-17 16:45:00 | I |         sum  error  = [    0.0926]
25-01-17 16:45:00 | I |         best error  = [    0.0926]
25-01-17 16:45:00 | I |     + error = [0.0926]
25-01-17 16:45:01 | I |       - range scale = [    1.0000]
25-01-17 16:45:01 | I |         sum  error  = [    1.0530]
25-01-17 16:45:01 | I |         best error  = [    1.0530]
25-01-17 16:45:01 | I |     + error = [1.0530]
25-01-17 16:45:01 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:45:02 | I |       - range scale = [    1.0000]
25-01-17 16:45:02 | I |         sum  error  = [    0.1222]
25-01-17 16:45:02 | I |         best error  = [    0.1222]
25-01-17 16:45:02 | I |     + error = [0.1222]
25-01-17 16:45:02 | I |       - range scale = [    1.0000]
25-01-17 16:45:02 | I |         sum  error  = [    1.3416]
25-01-17 16:45:02 | I |         best error  = [    1.3416]
25-01-17 16:45:02 | I |     + error = [1.3416]
25-01-17 16:45:02 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:45:03 | I |       - range scale = [    1.0000]
25-01-17 16:45:03 | I |         sum  error  = [    0.4785]
25-01-17 16:45:03 | I |         best error  = [    0.4785]
25-01-17 16:45:03 | I |     + error = [0.4785]
25-01-17 16:45:04 | I |       - range scale = [    1.0000]
25-01-17 16:45:04 | I |         sum  error  = [    5.4669]
25-01-17 16:45:04 | I |         best error  = [    5.4669]
25-01-17 16:45:04 | I |     + error = [5.4669]
25-01-17 16:45:04 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:45:05 | I |       - range scale = [    1.0000]
25-01-17 16:45:05 | I |         sum  error  = [    2.5706]
25-01-17 16:45:05 | I |         best error  = [    2.5706]
25-01-17 16:45:05 | I |     + error = [2.5706]
25-01-17 16:45:05 | I |       - range scale = [    1.0000]
25-01-17 16:45:05 | I |         sum  error  = [   29.2958]
25-01-17 16:45:05 | I |         best error  = [   29.2958]
25-01-17 16:45:05 | I |     + error = [29.2958]
25-01-17 16:45:06 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:45:06 | I |       - range scale = [    1.0000]
25-01-17 16:45:06 | I |         sum  error  = [    0.1976]
25-01-17 16:45:06 | I |         best error  = [    0.1976]
25-01-17 16:45:06 | I |     + error = [0.1976]
25-01-17 16:45:07 | I |       - range scale = [    1.0000]
25-01-17 16:45:07 | I |         sum  error  = [    1.7812]
25-01-17 16:45:07 | I |         best error  = [    1.7812]
25-01-17 16:45:07 | I |     + error = [1.7812]
25-01-17 16:45:07 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:45:09 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:45:10 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:45:11 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:45:13 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:45:14 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:45:15 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:45:19 | I | quantizing activations for layer model.layers.4
25-01-17 16:45:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:21 | I | forward this layer
25-01-17 16:45:21 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/09.pt
25-01-17 16:45:21 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/09.pt
25-01-17 16:45:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:45:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:45:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:45:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:45:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:45:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:45:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:45:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:45:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:45:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:45:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:45:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:45:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:45:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:45:21 | I | [4] done with optimizer step
25-01-17 16:45:21 | I | epoch 001:      5 / 409600000 loss=1.05052e-05, loss_sum=0.238605, wps=220.2, ups=0.01, wpb=32768, bsz=64, num_updates=5, lr=0.0005, gnorm=0, clip=0, loss_scale=128, train_wall=53, cuda_gb_allocated=12.1, cuda_gb_reserved=13.6, cuda_gb_free=11.6, wall=1026
25-01-17 16:45:21 | I | begin validation on "valid" subset on rank 0
25-01-17 16:45:21 | I | got valid iterator on "valid" subset on rank 0
25-01-17 16:45:21 | I | Valid: Start iterating over samples
25-01-17 16:45:21 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:45:21 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:45:21 | I | - Evaluator: gptq
25-01-17 16:45:21 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:45:21 | I | - Batch_size: 8
25-01-17 16:45:21 | I |   + Max_seq_length: 2048
25-01-17 16:45:39 | I |     - Results:
25-01-17 16:45:39 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:45:39 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:45:39 | I |       |wikitext |      1|word_perplexity|7.7075|±  |7.7075|
25-01-17 16:45:39 | I |       |val_valid|      1|word_perplexity|7.4136|±  |7.4136|
25-01-17 16:45:39 | I |       
25-01-17 16:45:39 | I | in valid, quantize current layer weights
25-01-17 16:45:40 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 16:45:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:55 | I |       - range scale = [    1.0000]
25-01-17 16:45:55 | I |         sum  error  = [    0.6607]
25-01-17 16:45:55 | I |         best error  = [    0.6607]
25-01-17 16:45:55 | I |     + error = [0.6607]
25-01-17 16:45:56 | I |       - range scale = [    1.0000]
25-01-17 16:45:56 | I |         sum  error  = [    7.3391]
25-01-17 16:45:56 | I |         best error  = [    7.3391]
25-01-17 16:45:56 | I |     + error = [7.3391]
25-01-17 16:45:57 | I |       - range scale = [    1.0000]
25-01-17 16:45:57 | I |         sum  error  = [    0.6556]
25-01-17 16:45:57 | I |         best error  = [    0.6556]
25-01-17 16:45:57 | I |     + error = [0.6556]
25-01-17 16:45:58 | I |       - range scale = [    1.0000]
25-01-17 16:45:58 | I |         sum  error  = [    7.1260]
25-01-17 16:45:58 | I |         best error  = [    7.1260]
25-01-17 16:45:58 | I |     + error = [7.1260]
25-01-17 16:45:59 | I |       - range scale = [    1.0000]
25-01-17 16:45:59 | I |         sum  error  = [    0.0937]
25-01-17 16:45:59 | I |         best error  = [    0.0937]
25-01-17 16:45:59 | I |     + error = [0.0937]
25-01-17 16:45:59 | I |       - range scale = [    1.0000]
25-01-17 16:45:59 | I |         sum  error  = [    1.0592]
25-01-17 16:45:59 | I |         best error  = [    1.0592]
25-01-17 16:45:59 | I |     + error = [1.0592]
25-01-17 16:46:00 | I |       - range scale = [    1.0000]
25-01-17 16:46:00 | I |         sum  error  = [    0.0961]
25-01-17 16:46:00 | I |         best error  = [    0.0961]
25-01-17 16:46:00 | I |     + error = [0.0961]
25-01-17 16:46:01 | I |       - range scale = [    1.0000]
25-01-17 16:46:01 | I |         sum  error  = [    1.0476]
25-01-17 16:46:01 | I |         best error  = [    1.0476]
25-01-17 16:46:01 | I |     + error = [1.0476]
25-01-17 16:46:02 | I |       - range scale = [    1.0000]
25-01-17 16:46:02 | I |         sum  error  = [    0.4814]
25-01-17 16:46:02 | I |         best error  = [    0.4814]
25-01-17 16:46:02 | I |     + error = [0.4814]
25-01-17 16:46:03 | I |       - range scale = [    1.0000]
25-01-17 16:46:03 | I |         sum  error  = [    5.5039]
25-01-17 16:46:03 | I |         best error  = [    5.5039]
25-01-17 16:46:03 | I |     + error = [5.5039]
25-01-17 16:46:04 | I |       - range scale = [    1.0000]
25-01-17 16:46:04 | I |         sum  error  = [    2.5866]
25-01-17 16:46:04 | I |         best error  = [    2.5866]
25-01-17 16:46:04 | I |     + error = [2.5866]
25-01-17 16:46:04 | I |       - range scale = [    1.0000]
25-01-17 16:46:04 | I |         sum  error  = [   29.4842]
25-01-17 16:46:04 | I |         best error  = [   29.4842]
25-01-17 16:46:04 | I |     + error = [29.4842]
25-01-17 16:46:05 | I |       - range scale = [    1.0000]
25-01-17 16:46:05 | I |         sum  error  = [    0.1927]
25-01-17 16:46:05 | I |         best error  = [    0.1927]
25-01-17 16:46:05 | I |     + error = [0.1927]
25-01-17 16:46:06 | I |       - range scale = [    1.0000]
25-01-17 16:46:06 | I |         sum  error  = [    1.7468]
25-01-17 16:46:06 | I |         best error  = [    1.7468]
25-01-17 16:46:06 | I |     + error = [1.7468]
25-01-17 16:46:19 | I | in valid, quantize current layer acts
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:25 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 16:46:25 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:46:25 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:46:25 | I | - Evaluator: gptq
25-01-17 16:46:25 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:46:25 | I | - Batch_size: 8
25-01-17 16:46:25 | I |   + Max_seq_length: 2048
25-01-17 16:46:45 | I |     - Results:
25-01-17 16:46:45 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:46:45 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:46:45 | I |       |wikitext |      1|word_perplexity|7.7269|±  |7.7269|
25-01-17 16:46:45 | I |       |val_valid|      1|word_perplexity|7.4364|±  |7.4364|
25-01-17 16:46:45 | I |       
25-01-17 16:46:58 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.616, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.13, wps=36518.6, wpb=4058.2, bsz=2, num_updates=5, lmquant_ppl_wikitext_all_quanted=7.70752, lmquant_ppl_val_all_quanted=7.41357, lmquant_ppl_wikitext_partly_quanted=7.72689, lmquant_ppl_val_partly_quanted=7.43637
25-01-17 16:46:58 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.616 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.13 | wps 36518.6 | wpb 4058.2 | bsz 2 | num_updates 5 | lmquant_ppl_wikitext_all_quanted 7.70752 | lmquant_ppl_val_all_quanted 7.41357 | lmquant_ppl_wikitext_partly_quanted 7.72689 | lmquant_ppl_val_partly_quanted 7.43637
25-01-17 16:46:58 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:46:58 | I | in layer model.layers.4
25-01-17 16:46:58 | I | quantizing weights for layer model.layers.4
25-01-17 16:46:58 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:58 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:59 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:59 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:59 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:46:59 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:47:00 | I |       - range scale = [    1.0000]
25-01-17 16:47:00 | I |         sum  error  = [    0.2384]
25-01-17 16:47:00 | I |         best error  = [    0.2384]
25-01-17 16:47:00 | I |     + error = [0.2384]
25-01-17 16:47:00 | I |       - range scale = [    1.0000]
25-01-17 16:47:00 | I |         sum  error  = [    2.6556]
25-01-17 16:47:00 | I |         best error  = [    2.6556]
25-01-17 16:47:00 | I |     + error = [2.6556]
25-01-17 16:47:01 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:47:01 | I |       - range scale = [    1.0000]
25-01-17 16:47:01 | I |         sum  error  = [    0.2181]
25-01-17 16:47:01 | I |         best error  = [    0.2181]
25-01-17 16:47:01 | I |     + error = [0.2181]
25-01-17 16:47:02 | I |       - range scale = [    1.0000]
25-01-17 16:47:02 | I |         sum  error  = [    2.5683]
25-01-17 16:47:02 | I |         best error  = [    2.5683]
25-01-17 16:47:02 | I |     + error = [2.5683]
25-01-17 16:47:02 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:47:03 | I |       - range scale = [    1.0000]
25-01-17 16:47:03 | I |         sum  error  = [    0.0934]
25-01-17 16:47:03 | I |         best error  = [    0.0934]
25-01-17 16:47:03 | I |     + error = [0.0934]
25-01-17 16:47:03 | I |       - range scale = [    1.0000]
25-01-17 16:47:03 | I |         sum  error  = [    1.0516]
25-01-17 16:47:03 | I |         best error  = [    1.0516]
25-01-17 16:47:03 | I |     + error = [1.0516]
25-01-17 16:47:04 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:47:04 | I |       - range scale = [    1.0000]
25-01-17 16:47:04 | I |         sum  error  = [    0.1141]
25-01-17 16:47:04 | I |         best error  = [    0.1141]
25-01-17 16:47:04 | I |     + error = [0.1141]
25-01-17 16:47:05 | I |       - range scale = [    1.0000]
25-01-17 16:47:05 | I |         sum  error  = [    1.2400]
25-01-17 16:47:05 | I |         best error  = [    1.2400]
25-01-17 16:47:05 | I |     + error = [1.2400]
25-01-17 16:47:05 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:47:06 | I |       - range scale = [    1.0000]
25-01-17 16:47:06 | I |         sum  error  = [    0.4782]
25-01-17 16:47:06 | I |         best error  = [    0.4782]
25-01-17 16:47:06 | I |     + error = [0.4782]
25-01-17 16:47:07 | I |       - range scale = [    1.0000]
25-01-17 16:47:07 | I |         sum  error  = [    5.4639]
25-01-17 16:47:07 | I |         best error  = [    5.4639]
25-01-17 16:47:07 | I |     + error = [5.4639]
25-01-17 16:47:07 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:47:07 | I |       - range scale = [    1.0000]
25-01-17 16:47:07 | I |         sum  error  = [    2.5731]
25-01-17 16:47:07 | I |         best error  = [    2.5731]
25-01-17 16:47:07 | I |     + error = [2.5731]
25-01-17 16:47:08 | I |       - range scale = [    1.0000]
25-01-17 16:47:08 | I |         sum  error  = [   29.2865]
25-01-17 16:47:08 | I |         best error  = [   29.2865]
25-01-17 16:47:08 | I |     + error = [29.2865]
25-01-17 16:47:08 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:47:09 | I |       - range scale = [    1.0000]
25-01-17 16:47:09 | I |         sum  error  = [    0.1949]
25-01-17 16:47:09 | I |         best error  = [    0.1949]
25-01-17 16:47:09 | I |     + error = [0.1949]
25-01-17 16:47:10 | I |       - range scale = [    1.0000]
25-01-17 16:47:10 | I |         sum  error  = [    1.7600]
25-01-17 16:47:10 | I |         best error  = [    1.7600]
25-01-17 16:47:10 | I |     + error = [1.7600]
25-01-17 16:47:10 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:47:11 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:47:13 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:47:14 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:47:16 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:47:17 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:47:18 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:47:22 | I | quantizing activations for layer model.layers.4
25-01-17 16:47:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:25 | I | forward this layer
25-01-17 16:47:25 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/10.pt
25-01-17 16:47:25 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/10.pt
25-01-17 16:47:25 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:47:25 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:47:25 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:47:25 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:47:25 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:47:25 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:47:25 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:47:25 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:47:25 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:47:25 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:47:25 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:47:25 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:47:25 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:47:25 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:47:25 | I | in layer model.layers.4
25-01-17 16:47:25 | I | quantizing weights for layer model.layers.4
25-01-17 16:47:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:26 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:26 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:26 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:47:26 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:47:27 | I |       - range scale = [    1.0000]
25-01-17 16:47:27 | I |         sum  error  = [    0.2695]
25-01-17 16:47:27 | I |         best error  = [    0.2695]
25-01-17 16:47:27 | I |     + error = [0.2695]
25-01-17 16:47:27 | I |       - range scale = [    1.0000]
25-01-17 16:47:27 | I |         sum  error  = [    2.8865]
25-01-17 16:47:27 | I |         best error  = [    2.8865]
25-01-17 16:47:27 | I |     + error = [2.8865]
25-01-17 16:47:28 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:47:28 | I |       - range scale = [    1.0000]
25-01-17 16:47:28 | I |         sum  error  = [    0.2235]
25-01-17 16:47:28 | I |         best error  = [    0.2235]
25-01-17 16:47:28 | I |     + error = [0.2235]
25-01-17 16:47:29 | I |       - range scale = [    1.0000]
25-01-17 16:47:29 | I |         sum  error  = [    2.7884]
25-01-17 16:47:29 | I |         best error  = [    2.7884]
25-01-17 16:47:29 | I |     + error = [2.7884]
25-01-17 16:47:29 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:47:30 | I |       - range scale = [    1.0000]
25-01-17 16:47:30 | I |         sum  error  = [    0.0927]
25-01-17 16:47:30 | I |         best error  = [    0.0927]
25-01-17 16:47:30 | I |     + error = [0.0927]
25-01-17 16:47:30 | I |       - range scale = [    1.0000]
25-01-17 16:47:30 | I |         sum  error  = [    1.0516]
25-01-17 16:47:30 | I |         best error  = [    1.0516]
25-01-17 16:47:30 | I |     + error = [1.0516]
25-01-17 16:47:31 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:47:31 | I |       - range scale = [    1.0000]
25-01-17 16:47:31 | I |         sum  error  = [    0.1139]
25-01-17 16:47:31 | I |         best error  = [    0.1139]
25-01-17 16:47:31 | I |     + error = [0.1139]
25-01-17 16:47:32 | I |       - range scale = [    1.0000]
25-01-17 16:47:32 | I |         sum  error  = [    1.2428]
25-01-17 16:47:32 | I |         best error  = [    1.2428]
25-01-17 16:47:32 | I |     + error = [1.2428]
25-01-17 16:47:32 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:47:33 | I |       - range scale = [    1.0000]
25-01-17 16:47:33 | I |         sum  error  = [    0.4788]
25-01-17 16:47:33 | I |         best error  = [    0.4788]
25-01-17 16:47:33 | I |     + error = [0.4788]
25-01-17 16:47:34 | I |       - range scale = [    1.0000]
25-01-17 16:47:34 | I |         sum  error  = [    5.4638]
25-01-17 16:47:34 | I |         best error  = [    5.4638]
25-01-17 16:47:34 | I |     + error = [5.4638]
25-01-17 16:47:34 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:47:35 | I |       - range scale = [    1.0000]
25-01-17 16:47:35 | I |         sum  error  = [    2.5807]
25-01-17 16:47:35 | I |         best error  = [    2.5807]
25-01-17 16:47:35 | I |     + error = [2.5807]
25-01-17 16:47:35 | I |       - range scale = [    1.0000]
25-01-17 16:47:35 | I |         sum  error  = [   29.2734]
25-01-17 16:47:35 | I |         best error  = [   29.2734]
25-01-17 16:47:35 | I |     + error = [29.2734]
25-01-17 16:47:36 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:47:36 | I |       - range scale = [    1.0000]
25-01-17 16:47:36 | I |         sum  error  = [    0.2202]
25-01-17 16:47:36 | I |         best error  = [    0.2202]
25-01-17 16:47:36 | I |     + error = [0.2202]
25-01-17 16:47:37 | I |       - range scale = [    1.0000]
25-01-17 16:47:37 | I |         sum  error  = [    1.9230]
25-01-17 16:47:37 | I |         best error  = [    1.9230]
25-01-17 16:47:37 | I |     + error = [1.9230]
25-01-17 16:47:37 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:47:39 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:47:40 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:47:41 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:47:43 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:47:44 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:47:46 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:47:49 | I | quantizing activations for layer model.layers.4
25-01-17 16:47:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:52 | I | forward this layer
25-01-17 16:47:52 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/11.pt
25-01-17 16:47:52 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/11.pt
25-01-17 16:47:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:47:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:47:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:47:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:47:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:47:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:47:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:47:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:47:52 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:47:52 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:47:52 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:47:52 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:47:52 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:47:52 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:47:52 | I | [5] done with optimizer step
25-01-17 16:47:52 | I | epoch 001:      6 / 409600000 loss=9.9971e-06, loss_sum=0.227065, wps=217.9, ups=0.01, wpb=32768, bsz=64, num_updates=6, lr=0.0006, gnorm=0, clip=0, loss_scale=128, train_wall=54, cuda_gb_allocated=12.1, cuda_gb_reserved=13.6, cuda_gb_free=11.6, wall=1176
25-01-17 16:47:52 | I | begin validation on "valid" subset on rank 0
25-01-17 16:47:52 | I | got valid iterator on "valid" subset on rank 0
25-01-17 16:47:52 | I | Valid: Start iterating over samples
25-01-17 16:47:52 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:47:52 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:47:52 | I | - Evaluator: gptq
25-01-17 16:47:52 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:47:52 | I | - Batch_size: 8
25-01-17 16:47:52 | I |   + Max_seq_length: 2048
25-01-17 16:48:10 | I |     - Results:
25-01-17 16:48:10 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:48:10 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:48:10 | I |       |wikitext |      1|word_perplexity|7.7075|±  |7.7075|
25-01-17 16:48:10 | I |       |val_valid|      1|word_perplexity|7.4136|±  |7.4136|
25-01-17 16:48:10 | I |       
25-01-17 16:48:10 | I | in valid, quantize current layer weights
25-01-17 16:48:10 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:25 | I |       - range scale = [    1.0000]
25-01-17 16:48:25 | I |         sum  error  = [    0.6607]
25-01-17 16:48:25 | I |         best error  = [    0.6607]
25-01-17 16:48:25 | I |     + error = [0.6607]
25-01-17 16:48:26 | I |       - range scale = [    1.0000]
25-01-17 16:48:26 | I |         sum  error  = [    7.3391]
25-01-17 16:48:26 | I |         best error  = [    7.3391]
25-01-17 16:48:26 | I |     + error = [7.3391]
25-01-17 16:48:27 | I |       - range scale = [    1.0000]
25-01-17 16:48:27 | I |         sum  error  = [    0.6556]
25-01-17 16:48:27 | I |         best error  = [    0.6556]
25-01-17 16:48:27 | I |     + error = [0.6556]
25-01-17 16:48:28 | I |       - range scale = [    1.0000]
25-01-17 16:48:28 | I |         sum  error  = [    7.1260]
25-01-17 16:48:28 | I |         best error  = [    7.1260]
25-01-17 16:48:28 | I |     + error = [7.1260]
25-01-17 16:48:29 | I |       - range scale = [    1.0000]
25-01-17 16:48:29 | I |         sum  error  = [    0.0937]
25-01-17 16:48:29 | I |         best error  = [    0.0937]
25-01-17 16:48:29 | I |     + error = [0.0937]
25-01-17 16:48:30 | I |       - range scale = [    1.0000]
25-01-17 16:48:30 | I |         sum  error  = [    1.0592]
25-01-17 16:48:30 | I |         best error  = [    1.0592]
25-01-17 16:48:30 | I |     + error = [1.0592]
25-01-17 16:48:31 | I |       - range scale = [    1.0000]
25-01-17 16:48:31 | I |         sum  error  = [    0.0961]
25-01-17 16:48:31 | I |         best error  = [    0.0961]
25-01-17 16:48:31 | I |     + error = [0.0961]
25-01-17 16:48:31 | I |       - range scale = [    1.0000]
25-01-17 16:48:31 | I |         sum  error  = [    1.0476]
25-01-17 16:48:31 | I |         best error  = [    1.0476]
25-01-17 16:48:31 | I |     + error = [1.0476]
25-01-17 16:48:32 | I |       - range scale = [    1.0000]
25-01-17 16:48:32 | I |         sum  error  = [    0.4814]
25-01-17 16:48:32 | I |         best error  = [    0.4814]
25-01-17 16:48:32 | I |     + error = [0.4814]
25-01-17 16:48:33 | I |       - range scale = [    1.0000]
25-01-17 16:48:33 | I |         sum  error  = [    5.5039]
25-01-17 16:48:33 | I |         best error  = [    5.5039]
25-01-17 16:48:33 | I |     + error = [5.5039]
25-01-17 16:48:34 | I |       - range scale = [    1.0000]
25-01-17 16:48:34 | I |         sum  error  = [    2.5866]
25-01-17 16:48:34 | I |         best error  = [    2.5866]
25-01-17 16:48:34 | I |     + error = [2.5866]
25-01-17 16:48:35 | I |       - range scale = [    1.0000]
25-01-17 16:48:35 | I |         sum  error  = [   29.4842]
25-01-17 16:48:35 | I |         best error  = [   29.4842]
25-01-17 16:48:35 | I |     + error = [29.4842]
25-01-17 16:48:36 | I |       - range scale = [    1.0000]
25-01-17 16:48:36 | I |         sum  error  = [    0.1927]
25-01-17 16:48:36 | I |         best error  = [    0.1927]
25-01-17 16:48:36 | I |     + error = [0.1927]
25-01-17 16:48:36 | I |       - range scale = [    1.0000]
25-01-17 16:48:36 | I |         sum  error  = [    1.7468]
25-01-17 16:48:36 | I |         best error  = [    1.7468]
25-01-17 16:48:36 | I |     + error = [1.7468]
25-01-17 16:48:49 | I | in valid, quantize current layer acts
25-01-17 16:48:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:56 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 16:48:56 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:48:56 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:48:56 | I | - Evaluator: gptq
25-01-17 16:48:56 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:48:56 | I | - Batch_size: 8
25-01-17 16:48:56 | I |   + Max_seq_length: 2048
25-01-17 16:49:15 | I |     - Results:
25-01-17 16:49:15 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:49:15 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:49:15 | I |       |wikitext |      1|word_perplexity|7.7269|±  |7.7269|
25-01-17 16:49:15 | I |       |val_valid|      1|word_perplexity|7.4364|±  |7.4364|
25-01-17 16:49:15 | I |       
25-01-17 16:49:28 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.616, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.13, wps=36463.9, wpb=4058.2, bsz=2, num_updates=6, lmquant_ppl_wikitext_all_quanted=7.70752, lmquant_ppl_val_all_quanted=7.41357, lmquant_ppl_wikitext_partly_quanted=7.72689, lmquant_ppl_val_partly_quanted=7.43637
25-01-17 16:49:28 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.616 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.13 | wps 36463.9 | wpb 4058.2 | bsz 2 | num_updates 6 | lmquant_ppl_wikitext_all_quanted 7.70752 | lmquant_ppl_val_all_quanted 7.41357 | lmquant_ppl_wikitext_partly_quanted 7.72689 | lmquant_ppl_val_partly_quanted 7.43637
25-01-17 16:49:28 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:49:28 | I | in layer model.layers.4
25-01-17 16:49:28 | I | quantizing weights for layer model.layers.4
25-01-17 16:49:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:30 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:49:30 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:49:30 | I |       - range scale = [    1.0000]
25-01-17 16:49:30 | I |         sum  error  = [    0.2820]
25-01-17 16:49:30 | I |         best error  = [    0.2820]
25-01-17 16:49:30 | I |     + error = [0.2820]
25-01-17 16:49:31 | I |       - range scale = [    1.0000]
25-01-17 16:49:31 | I |         sum  error  = [    2.9826]
25-01-17 16:49:31 | I |         best error  = [    2.9826]
25-01-17 16:49:31 | I |     + error = [2.9826]
25-01-17 16:49:31 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:49:32 | I |       - range scale = [    1.0000]
25-01-17 16:49:32 | I |         sum  error  = [    0.2361]
25-01-17 16:49:32 | I |         best error  = [    0.2361]
25-01-17 16:49:32 | I |     + error = [0.2361]
25-01-17 16:49:33 | I |       - range scale = [    1.0000]
25-01-17 16:49:33 | I |         sum  error  = [    2.8470]
25-01-17 16:49:33 | I |         best error  = [    2.8470]
25-01-17 16:49:33 | I |     + error = [2.8470]
25-01-17 16:49:33 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:49:33 | I |       - range scale = [    1.0000]
25-01-17 16:49:33 | I |         sum  error  = [    0.0926]
25-01-17 16:49:33 | I |         best error  = [    0.0926]
25-01-17 16:49:33 | I |     + error = [0.0926]
25-01-17 16:49:34 | I |       - range scale = [    1.0000]
25-01-17 16:49:34 | I |         sum  error  = [    1.0533]
25-01-17 16:49:34 | I |         best error  = [    1.0533]
25-01-17 16:49:34 | I |     + error = [1.0533]
25-01-17 16:49:34 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:49:35 | I |       - range scale = [    1.0000]
25-01-17 16:49:35 | I |         sum  error  = [    0.1167]
25-01-17 16:49:35 | I |         best error  = [    0.1167]
25-01-17 16:49:35 | I |     + error = [0.1167]
25-01-17 16:49:36 | I |       - range scale = [    1.0000]
25-01-17 16:49:36 | I |         sum  error  = [    1.2714]
25-01-17 16:49:36 | I |         best error  = [    1.2714]
25-01-17 16:49:36 | I |     + error = [1.2714]
25-01-17 16:49:36 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:49:36 | I |       - range scale = [    1.0000]
25-01-17 16:49:36 | I |         sum  error  = [    0.4795]
25-01-17 16:49:36 | I |         best error  = [    0.4795]
25-01-17 16:49:36 | I |     + error = [0.4795]
25-01-17 16:49:37 | I |       - range scale = [    1.0000]
25-01-17 16:49:37 | I |         sum  error  = [    5.4652]
25-01-17 16:49:37 | I |         best error  = [    5.4652]
25-01-17 16:49:37 | I |     + error = [5.4652]
25-01-17 16:49:37 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:49:38 | I |       - range scale = [    1.0000]
25-01-17 16:49:38 | I |         sum  error  = [    2.5838]
25-01-17 16:49:38 | I |         best error  = [    2.5838]
25-01-17 16:49:38 | I |     + error = [2.5838]
25-01-17 16:49:39 | I |       - range scale = [    1.0000]
25-01-17 16:49:39 | I |         sum  error  = [   29.2691]
25-01-17 16:49:39 | I |         best error  = [   29.2691]
25-01-17 16:49:39 | I |     + error = [29.2691]
25-01-17 16:49:39 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:49:40 | I |       - range scale = [    1.0000]
25-01-17 16:49:40 | I |         sum  error  = [    0.2344]
25-01-17 16:49:40 | I |         best error  = [    0.2344]
25-01-17 16:49:40 | I |     + error = [0.2344]
25-01-17 16:49:40 | I |       - range scale = [    1.0000]
25-01-17 16:49:40 | I |         sum  error  = [    2.0266]
25-01-17 16:49:40 | I |         best error  = [    2.0266]
25-01-17 16:49:40 | I |     + error = [2.0266]
25-01-17 16:49:41 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:49:42 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:49:43 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:49:45 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:49:46 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:49:48 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:49:49 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:49:52 | I | quantizing activations for layer model.layers.4
25-01-17 16:49:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:55 | I | forward this layer
25-01-17 16:49:55 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/12.pt
25-01-17 16:49:55 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/12.pt
25-01-17 16:49:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:49:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:49:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:49:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:49:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:49:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:49:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:49:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:49:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:49:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:49:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:49:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:49:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:49:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:49:55 | I | in layer model.layers.4
25-01-17 16:49:55 | I | quantizing weights for layer model.layers.4
25-01-17 16:49:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:56 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:49:56 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:49:57 | I |       - range scale = [    1.0000]
25-01-17 16:49:57 | I |         sum  error  = [    0.2847]
25-01-17 16:49:57 | I |         best error  = [    0.2847]
25-01-17 16:49:57 | I |     + error = [0.2847]
25-01-17 16:49:58 | I |       - range scale = [    1.0000]
25-01-17 16:49:58 | I |         sum  error  = [    3.0389]
25-01-17 16:49:58 | I |         best error  = [    3.0389]
25-01-17 16:49:58 | I |     + error = [3.0389]
25-01-17 16:49:58 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:49:59 | I |       - range scale = [    1.0000]
25-01-17 16:49:59 | I |         sum  error  = [    0.2321]
25-01-17 16:49:59 | I |         best error  = [    0.2321]
25-01-17 16:49:59 | I |     + error = [0.2321]
25-01-17 16:49:59 | I |       - range scale = [    1.0000]
25-01-17 16:49:59 | I |         sum  error  = [    2.8397]
25-01-17 16:49:59 | I |         best error  = [    2.8397]
25-01-17 16:49:59 | I |     + error = [2.8397]
25-01-17 16:49:59 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:50:00 | I |       - range scale = [    1.0000]
25-01-17 16:50:00 | I |         sum  error  = [    0.0927]
25-01-17 16:50:00 | I |         best error  = [    0.0927]
25-01-17 16:50:00 | I |     + error = [0.0927]
25-01-17 16:50:01 | I |       - range scale = [    1.0000]
25-01-17 16:50:01 | I |         sum  error  = [    1.0522]
25-01-17 16:50:01 | I |         best error  = [    1.0522]
25-01-17 16:50:01 | I |     + error = [1.0522]
25-01-17 16:50:01 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:50:02 | I |       - range scale = [    1.0000]
25-01-17 16:50:02 | I |         sum  error  = [    0.1190]
25-01-17 16:50:02 | I |         best error  = [    0.1190]
25-01-17 16:50:02 | I |     + error = [0.1190]
25-01-17 16:50:02 | I |       - range scale = [    1.0000]
25-01-17 16:50:02 | I |         sum  error  = [    1.2991]
25-01-17 16:50:02 | I |         best error  = [    1.2991]
25-01-17 16:50:02 | I |     + error = [1.2991]
25-01-17 16:50:03 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:50:03 | I |       - range scale = [    1.0000]
25-01-17 16:50:03 | I |         sum  error  = [    0.4793]
25-01-17 16:50:03 | I |         best error  = [    0.4793]
25-01-17 16:50:03 | I |     + error = [0.4793]
25-01-17 16:50:04 | I |       - range scale = [    1.0000]
25-01-17 16:50:04 | I |         sum  error  = [    5.4662]
25-01-17 16:50:04 | I |         best error  = [    5.4662]
25-01-17 16:50:04 | I |     + error = [5.4662]
25-01-17 16:50:04 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:50:05 | I |       - range scale = [    1.0000]
25-01-17 16:50:05 | I |         sum  error  = [    2.5850]
25-01-17 16:50:05 | I |         best error  = [    2.5850]
25-01-17 16:50:05 | I |     + error = [2.5850]
25-01-17 16:50:06 | I |       - range scale = [    1.0000]
25-01-17 16:50:06 | I |         sum  error  = [   29.2690]
25-01-17 16:50:06 | I |         best error  = [   29.2690]
25-01-17 16:50:06 | I |     + error = [29.2690]
25-01-17 16:50:06 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:50:06 | I |       - range scale = [    1.0000]
25-01-17 16:50:06 | I |         sum  error  = [    0.2327]
25-01-17 16:50:06 | I |         best error  = [    0.2327]
25-01-17 16:50:06 | I |     + error = [0.2327]
25-01-17 16:50:07 | I |       - range scale = [    1.0000]
25-01-17 16:50:07 | I |         sum  error  = [    2.0196]
25-01-17 16:50:07 | I |         best error  = [    2.0196]
25-01-17 16:50:07 | I |     + error = [2.0196]
25-01-17 16:50:07 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:50:09 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:50:10 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:50:11 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:50:13 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:50:14 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:50:16 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:50:19 | I | quantizing activations for layer model.layers.4
25-01-17 16:50:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:22 | I | forward this layer
25-01-17 16:50:22 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/13.pt
25-01-17 16:50:22 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/13.pt
25-01-17 16:50:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:50:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:50:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:50:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:50:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:50:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:50:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:50:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:50:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:50:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:50:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:50:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:50:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:50:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:50:22 | I | [6] done with optimizer step
25-01-17 16:50:22 | I | epoch 001:      7 / 409600000 loss=9.1711e-06, loss_sum=0.208303, wps=218.5, ups=0.01, wpb=32768, bsz=64, num_updates=7, lr=0.0007, gnorm=0, clip=0, loss_scale=128, train_wall=53, cuda_gb_allocated=12.1, cuda_gb_reserved=13.6, cuda_gb_free=11.6, wall=1326
25-01-17 16:50:22 | I | begin validation on "valid" subset on rank 0
25-01-17 16:50:22 | I | got valid iterator on "valid" subset on rank 0
25-01-17 16:50:22 | I | Valid: Start iterating over samples
25-01-17 16:50:22 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:50:22 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:50:22 | I | - Evaluator: gptq
25-01-17 16:50:22 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:50:22 | I | - Batch_size: 8
25-01-17 16:50:22 | I |   + Max_seq_length: 2048
25-01-17 16:50:40 | I |     - Results:
25-01-17 16:50:40 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:50:40 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:50:40 | I |       |wikitext |      1|word_perplexity|7.7075|±  |7.7075|
25-01-17 16:50:40 | I |       |val_valid|      1|word_perplexity|7.4136|±  |7.4136|
25-01-17 16:50:40 | I |       
25-01-17 16:50:40 | I | in valid, quantize current layer weights
25-01-17 16:50:40 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:54 | I |       - range scale = [    1.0000]
25-01-17 16:50:54 | I |         sum  error  = [    0.6607]
25-01-17 16:50:54 | I |         best error  = [    0.6607]
25-01-17 16:50:54 | I |     + error = [0.6607]
25-01-17 16:50:55 | I |       - range scale = [    1.0000]
25-01-17 16:50:55 | I |         sum  error  = [    7.3391]
25-01-17 16:50:55 | I |         best error  = [    7.3391]
25-01-17 16:50:55 | I |     + error = [7.3391]
25-01-17 16:50:56 | I |       - range scale = [    1.0000]
25-01-17 16:50:56 | I |         sum  error  = [    0.6556]
25-01-17 16:50:56 | I |         best error  = [    0.6556]
25-01-17 16:50:56 | I |     + error = [0.6556]
25-01-17 16:50:57 | I |       - range scale = [    1.0000]
25-01-17 16:50:57 | I |         sum  error  = [    7.1260]
25-01-17 16:50:57 | I |         best error  = [    7.1260]
25-01-17 16:50:57 | I |     + error = [7.1260]
25-01-17 16:50:58 | I |       - range scale = [    1.0000]
25-01-17 16:50:58 | I |         sum  error  = [    0.0937]
25-01-17 16:50:58 | I |         best error  = [    0.0937]
25-01-17 16:50:58 | I |     + error = [0.0937]
25-01-17 16:50:59 | I |       - range scale = [    1.0000]
25-01-17 16:50:59 | I |         sum  error  = [    1.0592]
25-01-17 16:50:59 | I |         best error  = [    1.0592]
25-01-17 16:50:59 | I |     + error = [1.0592]
25-01-17 16:51:00 | I |       - range scale = [    1.0000]
25-01-17 16:51:00 | I |         sum  error  = [    0.0961]
25-01-17 16:51:00 | I |         best error  = [    0.0961]
25-01-17 16:51:00 | I |     + error = [0.0961]
25-01-17 16:51:01 | I |       - range scale = [    1.0000]
25-01-17 16:51:01 | I |         sum  error  = [    1.0476]
25-01-17 16:51:01 | I |         best error  = [    1.0476]
25-01-17 16:51:01 | I |     + error = [1.0476]
25-01-17 16:51:01 | I |       - range scale = [    1.0000]
25-01-17 16:51:01 | I |         sum  error  = [    0.4814]
25-01-17 16:51:01 | I |         best error  = [    0.4814]
25-01-17 16:51:01 | I |     + error = [0.4814]
25-01-17 16:51:02 | I |       - range scale = [    1.0000]
25-01-17 16:51:02 | I |         sum  error  = [    5.5039]
25-01-17 16:51:02 | I |         best error  = [    5.5039]
25-01-17 16:51:02 | I |     + error = [5.5039]
25-01-17 16:51:03 | I |       - range scale = [    1.0000]
25-01-17 16:51:03 | I |         sum  error  = [    2.5866]
25-01-17 16:51:03 | I |         best error  = [    2.5866]
25-01-17 16:51:03 | I |     + error = [2.5866]
25-01-17 16:51:04 | I |       - range scale = [    1.0000]
25-01-17 16:51:04 | I |         sum  error  = [   29.4842]
25-01-17 16:51:04 | I |         best error  = [   29.4842]
25-01-17 16:51:04 | I |     + error = [29.4842]
25-01-17 16:51:05 | I |       - range scale = [    1.0000]
25-01-17 16:51:05 | I |         sum  error  = [    0.1927]
25-01-17 16:51:05 | I |         best error  = [    0.1927]
25-01-17 16:51:05 | I |     + error = [0.1927]
25-01-17 16:51:05 | I |       - range scale = [    1.0000]
25-01-17 16:51:05 | I |         sum  error  = [    1.7468]
25-01-17 16:51:05 | I |         best error  = [    1.7468]
25-01-17 16:51:05 | I |     + error = [1.7468]
25-01-17 16:51:18 | I | in valid, quantize current layer acts
25-01-17 16:51:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:24 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 16:51:24 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:51:24 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:51:24 | I | - Evaluator: gptq
25-01-17 16:51:24 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:51:24 | I | - Batch_size: 8
25-01-17 16:51:24 | I |   + Max_seq_length: 2048
25-01-17 16:51:44 | I |     - Results:
25-01-17 16:51:44 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:51:44 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:51:44 | I |       |wikitext |      1|word_perplexity|7.7269|±  |7.7269|
25-01-17 16:51:44 | I |       |val_valid|      1|word_perplexity|7.4364|±  |7.4364|
25-01-17 16:51:44 | I |       
25-01-17 16:51:57 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.616, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.13, wps=36535.9, wpb=4058.2, bsz=2, num_updates=7, lmquant_ppl_wikitext_all_quanted=7.70752, lmquant_ppl_val_all_quanted=7.41357, lmquant_ppl_wikitext_partly_quanted=7.72689, lmquant_ppl_val_partly_quanted=7.43637
25-01-17 16:51:57 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.616 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.13 | wps 36535.9 | wpb 4058.2 | bsz 2 | num_updates 7 | lmquant_ppl_wikitext_all_quanted 7.70752 | lmquant_ppl_val_all_quanted 7.41357 | lmquant_ppl_wikitext_partly_quanted 7.72689 | lmquant_ppl_val_partly_quanted 7.43637
25-01-17 16:51:57 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:51:57 | I | in layer model.layers.4
25-01-17 16:51:57 | I | quantizing weights for layer model.layers.4
25-01-17 16:51:58 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:58 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:58 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:58 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:58 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:51:58 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:51:59 | I |       - range scale = [    1.0000]
25-01-17 16:51:59 | I |         sum  error  = [    0.2730]
25-01-17 16:51:59 | I |         best error  = [    0.2730]
25-01-17 16:51:59 | I |     + error = [0.2730]
25-01-17 16:52:00 | I |       - range scale = [    1.0000]
25-01-17 16:52:00 | I |         sum  error  = [    2.9553]
25-01-17 16:52:00 | I |         best error  = [    2.9553]
25-01-17 16:52:00 | I |     + error = [2.9553]
25-01-17 16:52:00 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:52:01 | I |       - range scale = [    1.0000]
25-01-17 16:52:01 | I |         sum  error  = [    0.2288]
25-01-17 16:52:01 | I |         best error  = [    0.2288]
25-01-17 16:52:01 | I |     + error = [0.2288]
25-01-17 16:52:01 | I |       - range scale = [    1.0000]
25-01-17 16:52:01 | I |         sum  error  = [    2.7507]
25-01-17 16:52:01 | I |         best error  = [    2.7507]
25-01-17 16:52:01 | I |     + error = [2.7507]
25-01-17 16:52:02 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:52:02 | I |       - range scale = [    1.0000]
25-01-17 16:52:02 | I |         sum  error  = [    0.0920]
25-01-17 16:52:02 | I |         best error  = [    0.0920]
25-01-17 16:52:02 | I |     + error = [0.0920]
25-01-17 16:52:03 | I |       - range scale = [    1.0000]
25-01-17 16:52:03 | I |         sum  error  = [    1.0514]
25-01-17 16:52:03 | I |         best error  = [    1.0514]
25-01-17 16:52:03 | I |     + error = [1.0514]
25-01-17 16:52:03 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:52:04 | I |       - range scale = [    1.0000]
25-01-17 16:52:04 | I |         sum  error  = [    0.1146]
25-01-17 16:52:04 | I |         best error  = [    0.1146]
25-01-17 16:52:04 | I |     + error = [0.1146]
25-01-17 16:52:04 | I |       - range scale = [    1.0000]
25-01-17 16:52:04 | I |         sum  error  = [    1.2484]
25-01-17 16:52:04 | I |         best error  = [    1.2484]
25-01-17 16:52:04 | I |     + error = [1.2484]
25-01-17 16:52:05 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:52:05 | I |       - range scale = [    1.0000]
25-01-17 16:52:05 | I |         sum  error  = [    0.4791]
25-01-17 16:52:05 | I |         best error  = [    0.4791]
25-01-17 16:52:05 | I |     + error = [0.4791]
25-01-17 16:52:06 | I |       - range scale = [    1.0000]
25-01-17 16:52:06 | I |         sum  error  = [    5.4638]
25-01-17 16:52:06 | I |         best error  = [    5.4638]
25-01-17 16:52:06 | I |     + error = [5.4638]
25-01-17 16:52:06 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:52:07 | I |       - range scale = [    1.0000]
25-01-17 16:52:07 | I |         sum  error  = [    2.5824]
25-01-17 16:52:07 | I |         best error  = [    2.5824]
25-01-17 16:52:07 | I |     + error = [2.5824]
25-01-17 16:52:08 | I |       - range scale = [    1.0000]
25-01-17 16:52:08 | I |         sum  error  = [   29.2704]
25-01-17 16:52:08 | I |         best error  = [   29.2704]
25-01-17 16:52:08 | I |     + error = [29.2704]
25-01-17 16:52:08 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:52:08 | I |       - range scale = [    1.0000]
25-01-17 16:52:08 | I |         sum  error  = [    0.2277]
25-01-17 16:52:08 | I |         best error  = [    0.2277]
25-01-17 16:52:08 | I |     + error = [0.2277]
25-01-17 16:52:09 | I |       - range scale = [    1.0000]
25-01-17 16:52:09 | I |         sum  error  = [    1.9753]
25-01-17 16:52:09 | I |         best error  = [    1.9753]
25-01-17 16:52:09 | I |     + error = [1.9753]
25-01-17 16:52:09 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:52:11 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:52:12 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:52:14 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:52:15 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:52:16 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:52:18 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:52:21 | I | quantizing activations for layer model.layers.4
25-01-17 16:52:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:24 | I | forward this layer
25-01-17 16:52:24 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/14.pt
25-01-17 16:52:24 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/14.pt
25-01-17 16:52:24 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:52:24 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:52:24 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:52:24 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:52:24 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:52:24 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:52:24 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:52:24 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:52:24 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:52:24 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:52:24 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:52:24 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:52:24 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:52:24 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:52:24 | I | in layer model.layers.4
25-01-17 16:52:24 | I | quantizing weights for layer model.layers.4
25-01-17 16:52:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:25 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:25 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:52:25 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:52:26 | I |       - range scale = [    1.0000]
25-01-17 16:52:26 | I |         sum  error  = [    0.2748]
25-01-17 16:52:26 | I |         best error  = [    0.2748]
25-01-17 16:52:26 | I |     + error = [0.2748]
25-01-17 16:52:26 | I |       - range scale = [    1.0000]
25-01-17 16:52:26 | I |         sum  error  = [    3.0343]
25-01-17 16:52:26 | I |         best error  = [    3.0343]
25-01-17 16:52:26 | I |     + error = [3.0343]
25-01-17 16:52:27 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:52:27 | I |       - range scale = [    1.0000]
25-01-17 16:52:27 | I |         sum  error  = [    0.2320]
25-01-17 16:52:27 | I |         best error  = [    0.2320]
25-01-17 16:52:27 | I |     + error = [0.2320]
25-01-17 16:52:28 | I |       - range scale = [    1.0000]
25-01-17 16:52:28 | I |         sum  error  = [    2.8782]
25-01-17 16:52:28 | I |         best error  = [    2.8782]
25-01-17 16:52:28 | I |     + error = [2.8782]
25-01-17 16:52:28 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:52:29 | I |       - range scale = [    1.0000]
25-01-17 16:52:29 | I |         sum  error  = [    0.0925]
25-01-17 16:52:29 | I |         best error  = [    0.0925]
25-01-17 16:52:29 | I |     + error = [0.0925]
25-01-17 16:52:30 | I |       - range scale = [    1.0000]
25-01-17 16:52:30 | I |         sum  error  = [    1.0536]
25-01-17 16:52:30 | I |         best error  = [    1.0536]
25-01-17 16:52:30 | I |     + error = [1.0536]
25-01-17 16:52:30 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:52:30 | I |       - range scale = [    1.0000]
25-01-17 16:52:30 | I |         sum  error  = [    0.1097]
25-01-17 16:52:30 | I |         best error  = [    0.1097]
25-01-17 16:52:30 | I |     + error = [0.1097]
25-01-17 16:52:31 | I |       - range scale = [    1.0000]
25-01-17 16:52:31 | I |         sum  error  = [    1.1943]
25-01-17 16:52:31 | I |         best error  = [    1.1943]
25-01-17 16:52:31 | I |     + error = [1.1943]
25-01-17 16:52:31 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:52:32 | I |       - range scale = [    1.0000]
25-01-17 16:52:32 | I |         sum  error  = [    0.4786]
25-01-17 16:52:32 | I |         best error  = [    0.4786]
25-01-17 16:52:32 | I |     + error = [0.4786]
25-01-17 16:52:33 | I |       - range scale = [    1.0000]
25-01-17 16:52:33 | I |         sum  error  = [    5.4666]
25-01-17 16:52:33 | I |         best error  = [    5.4666]
25-01-17 16:52:33 | I |     + error = [5.4666]
25-01-17 16:52:33 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:52:34 | I |       - range scale = [    1.0000]
25-01-17 16:52:34 | I |         sum  error  = [    2.5806]
25-01-17 16:52:34 | I |         best error  = [    2.5806]
25-01-17 16:52:34 | I |     + error = [2.5806]
25-01-17 16:52:34 | I |       - range scale = [    1.0000]
25-01-17 16:52:34 | I |         sum  error  = [   29.2684]
25-01-17 16:52:34 | I |         best error  = [   29.2684]
25-01-17 16:52:34 | I |     + error = [29.2684]
25-01-17 16:52:34 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:52:35 | I |       - range scale = [    1.0000]
25-01-17 16:52:35 | I |         sum  error  = [    0.2181]
25-01-17 16:52:35 | I |         best error  = [    0.2181]
25-01-17 16:52:35 | I |     + error = [0.2181]
25-01-17 16:52:36 | I |       - range scale = [    1.0000]
25-01-17 16:52:36 | I |         sum  error  = [    1.9120]
25-01-17 16:52:36 | I |         best error  = [    1.9120]
25-01-17 16:52:36 | I |     + error = [1.9120]
25-01-17 16:52:36 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:52:37 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:52:39 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:52:40 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:52:42 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:52:43 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:52:44 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:52:48 | I | quantizing activations for layer model.layers.4
25-01-17 16:52:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:50 | I | forward this layer
25-01-17 16:52:50 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/15.pt
25-01-17 16:52:50 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/15.pt
25-01-17 16:52:51 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:52:51 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:52:51 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:52:51 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:52:51 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:52:51 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:52:51 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:52:51 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:52:51 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:52:51 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:52:51 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:52:51 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:52:51 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:52:51 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:52:51 | I | [7] done with optimizer step
25-01-17 16:52:51 | I | epoch 001:      8 / 409600000 loss=9.1671e-06, loss_sum=0.208212, wps=220.1, ups=0.01, wpb=32768, bsz=64, num_updates=8, lr=0.0008, gnorm=0, clip=0, loss_scale=128, train_wall=53, cuda_gb_allocated=12.1, cuda_gb_reserved=13.6, cuda_gb_free=11.6, wall=1475
25-01-17 16:52:51 | I | begin validation on "valid" subset on rank 0
25-01-17 16:52:51 | I | got valid iterator on "valid" subset on rank 0
25-01-17 16:52:51 | I | Valid: Start iterating over samples
25-01-17 16:52:51 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:52:51 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:52:51 | I | - Evaluator: gptq
25-01-17 16:52:51 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:52:51 | I | - Batch_size: 8
25-01-17 16:52:51 | I |   + Max_seq_length: 2048
25-01-17 16:53:08 | I |     - Results:
25-01-17 16:53:08 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:53:08 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:53:08 | I |       |wikitext |      1|word_perplexity|7.7075|±  |7.7075|
25-01-17 16:53:08 | I |       |val_valid|      1|word_perplexity|7.4136|±  |7.4136|
25-01-17 16:53:08 | I |       
25-01-17 16:53:08 | I | in valid, quantize current layer weights
25-01-17 16:53:10 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:24 | I |       - range scale = [    1.0000]
25-01-17 16:53:24 | I |         sum  error  = [    0.6607]
25-01-17 16:53:24 | I |         best error  = [    0.6607]
25-01-17 16:53:24 | I |     + error = [0.6607]
25-01-17 16:53:25 | I |       - range scale = [    1.0000]
25-01-17 16:53:25 | I |         sum  error  = [    7.3391]
25-01-17 16:53:25 | I |         best error  = [    7.3391]
25-01-17 16:53:25 | I |     + error = [7.3391]
25-01-17 16:53:26 | I |       - range scale = [    1.0000]
25-01-17 16:53:26 | I |         sum  error  = [    0.6556]
25-01-17 16:53:26 | I |         best error  = [    0.6556]
25-01-17 16:53:26 | I |     + error = [0.6556]
25-01-17 16:53:27 | I |       - range scale = [    1.0000]
25-01-17 16:53:27 | I |         sum  error  = [    7.1260]
25-01-17 16:53:27 | I |         best error  = [    7.1260]
25-01-17 16:53:27 | I |     + error = [7.1260]
25-01-17 16:53:28 | I |       - range scale = [    1.0000]
25-01-17 16:53:28 | I |         sum  error  = [    0.0937]
25-01-17 16:53:28 | I |         best error  = [    0.0937]
25-01-17 16:53:28 | I |     + error = [0.0937]
25-01-17 16:53:29 | I |       - range scale = [    1.0000]
25-01-17 16:53:29 | I |         sum  error  = [    1.0592]
25-01-17 16:53:29 | I |         best error  = [    1.0592]
25-01-17 16:53:29 | I |     + error = [1.0592]
25-01-17 16:53:30 | I |       - range scale = [    1.0000]
25-01-17 16:53:30 | I |         sum  error  = [    0.0961]
25-01-17 16:53:30 | I |         best error  = [    0.0961]
25-01-17 16:53:30 | I |     + error = [0.0961]
25-01-17 16:53:30 | I |       - range scale = [    1.0000]
25-01-17 16:53:30 | I |         sum  error  = [    1.0476]
25-01-17 16:53:30 | I |         best error  = [    1.0476]
25-01-17 16:53:30 | I |     + error = [1.0476]
25-01-17 16:53:31 | I |       - range scale = [    1.0000]
25-01-17 16:53:31 | I |         sum  error  = [    0.4814]
25-01-17 16:53:31 | I |         best error  = [    0.4814]
25-01-17 16:53:31 | I |     + error = [0.4814]
25-01-17 16:53:32 | I |       - range scale = [    1.0000]
25-01-17 16:53:32 | I |         sum  error  = [    5.5039]
25-01-17 16:53:32 | I |         best error  = [    5.5039]
25-01-17 16:53:32 | I |     + error = [5.5039]
25-01-17 16:53:33 | I |       - range scale = [    1.0000]
25-01-17 16:53:33 | I |         sum  error  = [    2.5866]
25-01-17 16:53:33 | I |         best error  = [    2.5866]
25-01-17 16:53:33 | I |     + error = [2.5866]
25-01-17 16:53:33 | I |       - range scale = [    1.0000]
25-01-17 16:53:33 | I |         sum  error  = [   29.4842]
25-01-17 16:53:33 | I |         best error  = [   29.4842]
25-01-17 16:53:33 | I |     + error = [29.4842]
25-01-17 16:53:34 | I |       - range scale = [    1.0000]
25-01-17 16:53:34 | I |         sum  error  = [    0.1927]
25-01-17 16:53:34 | I |         best error  = [    0.1927]
25-01-17 16:53:34 | I |     + error = [0.1927]
25-01-17 16:53:35 | I |       - range scale = [    1.0000]
25-01-17 16:53:35 | I |         sum  error  = [    1.7468]
25-01-17 16:53:35 | I |         best error  = [    1.7468]
25-01-17 16:53:35 | I |     + error = [1.7468]
25-01-17 16:53:47 | I | in valid, quantize current layer acts
25-01-17 16:53:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:54 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 16:53:54 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:53:54 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:53:54 | I | - Evaluator: gptq
25-01-17 16:53:54 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:53:54 | I | - Batch_size: 8
25-01-17 16:53:54 | I |   + Max_seq_length: 2048
25-01-17 16:54:13 | I |     - Results:
25-01-17 16:54:13 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:54:13 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:54:13 | I |       |wikitext |      1|word_perplexity|7.7269|±  |7.7269|
25-01-17 16:54:13 | I |       |val_valid|      1|word_perplexity|7.4364|±  |7.4364|
25-01-17 16:54:13 | I |       
25-01-17 16:54:27 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.616, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.13, wps=36630, wpb=4058.2, bsz=2, num_updates=8, lmquant_ppl_wikitext_all_quanted=7.70752, lmquant_ppl_val_all_quanted=7.41357, lmquant_ppl_wikitext_partly_quanted=7.72689, lmquant_ppl_val_partly_quanted=7.43637
25-01-17 16:54:27 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.616 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.13 | wps 36630 | wpb 4058.2 | bsz 2 | num_updates 8 | lmquant_ppl_wikitext_all_quanted 7.70752 | lmquant_ppl_val_all_quanted 7.41357 | lmquant_ppl_wikitext_partly_quanted 7.72689 | lmquant_ppl_val_partly_quanted 7.43637
25-01-17 16:54:27 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:54:27 | I | in layer model.layers.4
25-01-17 16:54:27 | I | quantizing weights for layer model.layers.4
25-01-17 16:54:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:28 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:54:28 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:54:28 | I |       - range scale = [    1.0000]
25-01-17 16:54:28 | I |         sum  error  = [    0.2715]
25-01-17 16:54:28 | I |         best error  = [    0.2715]
25-01-17 16:54:28 | I |     + error = [0.2715]
25-01-17 16:54:29 | I |       - range scale = [    1.0000]
25-01-17 16:54:29 | I |         sum  error  = [    2.8881]
25-01-17 16:54:29 | I |         best error  = [    2.8881]
25-01-17 16:54:29 | I |     + error = [2.8881]
25-01-17 16:54:29 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:54:30 | I |       - range scale = [    1.0000]
25-01-17 16:54:30 | I |         sum  error  = [    0.2238]
25-01-17 16:54:30 | I |         best error  = [    0.2238]
25-01-17 16:54:30 | I |     + error = [0.2238]
25-01-17 16:54:31 | I |       - range scale = [    1.0000]
25-01-17 16:54:31 | I |         sum  error  = [    2.6981]
25-01-17 16:54:31 | I |         best error  = [    2.6981]
25-01-17 16:54:31 | I |     + error = [2.6981]
25-01-17 16:54:31 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:54:32 | I |       - range scale = [    1.0000]
25-01-17 16:54:32 | I |         sum  error  = [    0.0929]
25-01-17 16:54:32 | I |         best error  = [    0.0929]
25-01-17 16:54:32 | I |     + error = [0.0929]
25-01-17 16:54:32 | I |       - range scale = [    1.0000]
25-01-17 16:54:32 | I |         sum  error  = [    1.0523]
25-01-17 16:54:32 | I |         best error  = [    1.0523]
25-01-17 16:54:32 | I |     + error = [1.0523]
25-01-17 16:54:33 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:54:33 | I |       - range scale = [    1.0000]
25-01-17 16:54:33 | I |         sum  error  = [    0.1147]
25-01-17 16:54:33 | I |         best error  = [    0.1147]
25-01-17 16:54:33 | I |     + error = [0.1147]
25-01-17 16:54:34 | I |       - range scale = [    1.0000]
25-01-17 16:54:34 | I |         sum  error  = [    1.2492]
25-01-17 16:54:34 | I |         best error  = [    1.2492]
25-01-17 16:54:34 | I |     + error = [1.2492]
25-01-17 16:54:34 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:54:35 | I |       - range scale = [    1.0000]
25-01-17 16:54:35 | I |         sum  error  = [    0.4797]
25-01-17 16:54:35 | I |         best error  = [    0.4797]
25-01-17 16:54:35 | I |     + error = [0.4797]
25-01-17 16:54:35 | I |       - range scale = [    1.0000]
25-01-17 16:54:35 | I |         sum  error  = [    5.4652]
25-01-17 16:54:35 | I |         best error  = [    5.4652]
25-01-17 16:54:35 | I |     + error = [5.4652]
25-01-17 16:54:36 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:54:36 | I |       - range scale = [    1.0000]
25-01-17 16:54:36 | I |         sum  error  = [    2.5818]
25-01-17 16:54:36 | I |         best error  = [    2.5818]
25-01-17 16:54:36 | I |     + error = [2.5818]
25-01-17 16:54:37 | I |       - range scale = [    1.0000]
25-01-17 16:54:37 | I |         sum  error  = [   29.2699]
25-01-17 16:54:37 | I |         best error  = [   29.2699]
25-01-17 16:54:37 | I |     + error = [29.2699]
25-01-17 16:54:37 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:54:38 | I |       - range scale = [    1.0000]
25-01-17 16:54:38 | I |         sum  error  = [    0.2294]
25-01-17 16:54:38 | I |         best error  = [    0.2294]
25-01-17 16:54:38 | I |     + error = [0.2294]
25-01-17 16:54:39 | I |       - range scale = [    1.0000]
25-01-17 16:54:39 | I |         sum  error  = [    1.9971]
25-01-17 16:54:39 | I |         best error  = [    1.9971]
25-01-17 16:54:39 | I |     + error = [1.9971]
25-01-17 16:54:39 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:54:40 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:54:42 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:54:43 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:54:44 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:54:46 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:54:47 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:54:50 | I | quantizing activations for layer model.layers.4
25-01-17 16:54:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:53 | I | forward this layer
25-01-17 16:54:53 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/16.pt
25-01-17 16:54:53 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/16.pt
25-01-17 16:54:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:54:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:54:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:54:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:54:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:54:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:54:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:54:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:54:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:54:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:54:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:54:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:54:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:54:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:54:53 | I | in layer model.layers.4
25-01-17 16:54:53 | I | quantizing weights for layer model.layers.4
25-01-17 16:54:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:54 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:54:54 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:54:55 | I |       - range scale = [    1.0000]
25-01-17 16:54:55 | I |         sum  error  = [    0.2531]
25-01-17 16:54:55 | I |         best error  = [    0.2531]
25-01-17 16:54:55 | I |     + error = [0.2531]
25-01-17 16:54:56 | I |       - range scale = [    1.0000]
25-01-17 16:54:56 | I |         sum  error  = [    2.7752]
25-01-17 16:54:56 | I |         best error  = [    2.7752]
25-01-17 16:54:56 | I |     + error = [2.7752]
25-01-17 16:54:56 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:54:56 | I |       - range scale = [    1.0000]
25-01-17 16:54:56 | I |         sum  error  = [    0.2310]
25-01-17 16:54:56 | I |         best error  = [    0.2310]
25-01-17 16:54:56 | I |     + error = [0.2310]
25-01-17 16:54:57 | I |       - range scale = [    1.0000]
25-01-17 16:54:57 | I |         sum  error  = [    2.5889]
25-01-17 16:54:57 | I |         best error  = [    2.5889]
25-01-17 16:54:57 | I |     + error = [2.5889]
25-01-17 16:54:57 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:54:58 | I |       - range scale = [    1.0000]
25-01-17 16:54:58 | I |         sum  error  = [    0.0926]
25-01-17 16:54:58 | I |         best error  = [    0.0926]
25-01-17 16:54:58 | I |     + error = [0.0926]
25-01-17 16:54:59 | I |       - range scale = [    1.0000]
25-01-17 16:54:59 | I |         sum  error  = [    1.0525]
25-01-17 16:54:59 | I |         best error  = [    1.0525]
25-01-17 16:54:59 | I |     + error = [1.0525]
25-01-17 16:54:59 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:55:00 | I |       - range scale = [    1.0000]
25-01-17 16:55:00 | I |         sum  error  = [    0.1126]
25-01-17 16:55:00 | I |         best error  = [    0.1126]
25-01-17 16:55:00 | I |     + error = [0.1126]
25-01-17 16:55:00 | I |       - range scale = [    1.0000]
25-01-17 16:55:00 | I |         sum  error  = [    1.2248]
25-01-17 16:55:00 | I |         best error  = [    1.2248]
25-01-17 16:55:00 | I |     + error = [1.2248]
25-01-17 16:55:00 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:55:01 | I |       - range scale = [    1.0000]
25-01-17 16:55:01 | I |         sum  error  = [    0.4783]
25-01-17 16:55:01 | I |         best error  = [    0.4783]
25-01-17 16:55:01 | I |     + error = [0.4783]
25-01-17 16:55:02 | I |       - range scale = [    1.0000]
25-01-17 16:55:02 | I |         sum  error  = [    5.4656]
25-01-17 16:55:02 | I |         best error  = [    5.4656]
25-01-17 16:55:02 | I |     + error = [5.4656]
25-01-17 16:55:02 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:55:03 | I |       - range scale = [    1.0000]
25-01-17 16:55:03 | I |         sum  error  = [    2.5787]
25-01-17 16:55:03 | I |         best error  = [    2.5787]
25-01-17 16:55:03 | I |     + error = [2.5787]
25-01-17 16:55:04 | I |       - range scale = [    1.0000]
25-01-17 16:55:04 | I |         sum  error  = [   29.2772]
25-01-17 16:55:04 | I |         best error  = [   29.2772]
25-01-17 16:55:04 | I |     + error = [29.2772]
25-01-17 16:55:04 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:55:04 | I |       - range scale = [    1.0000]
25-01-17 16:55:04 | I |         sum  error  = [    0.2146]
25-01-17 16:55:04 | I |         best error  = [    0.2146]
25-01-17 16:55:04 | I |     + error = [0.2146]
25-01-17 16:55:05 | I |       - range scale = [    1.0000]
25-01-17 16:55:05 | I |         sum  error  = [    1.8952]
25-01-17 16:55:05 | I |         best error  = [    1.8952]
25-01-17 16:55:05 | I |     + error = [1.8952]
25-01-17 16:55:05 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:55:07 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:55:08 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:55:10 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:55:11 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:55:12 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:55:14 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:55:17 | I | quantizing activations for layer model.layers.4
25-01-17 16:55:17 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:20 | I | forward this layer
25-01-17 16:55:20 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/17.pt
25-01-17 16:55:20 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/17.pt
25-01-17 16:55:20 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:55:20 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:55:20 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:55:20 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:55:20 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:55:20 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:55:20 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:55:20 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:55:20 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:55:20 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:55:20 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:55:20 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:55:20 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:55:20 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:55:20 | I | [8] done with optimizer step
25-01-17 16:55:20 | I | epoch 001:      9 / 409600000 loss=9.6501e-06, loss_sum=0.219183, wps=219.8, ups=0.01, wpb=32768, bsz=64, num_updates=9, lr=0.0009, gnorm=0, clip=0, loss_scale=128, train_wall=53, cuda_gb_allocated=12.1, cuda_gb_reserved=13.6, cuda_gb_free=11.6, wall=1624
25-01-17 16:55:20 | I | begin validation on "valid" subset on rank 0
25-01-17 16:55:20 | I | got valid iterator on "valid" subset on rank 0
25-01-17 16:55:20 | I | Valid: Start iterating over samples
25-01-17 16:55:20 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:55:20 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:55:20 | I | - Evaluator: gptq
25-01-17 16:55:20 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:55:20 | I | - Batch_size: 8
25-01-17 16:55:20 | I |   + Max_seq_length: 2048
25-01-17 16:55:38 | I |     - Results:
25-01-17 16:55:38 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:55:38 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:55:38 | I |       |wikitext |      1|word_perplexity|7.7075|±  |7.7075|
25-01-17 16:55:38 | I |       |val_valid|      1|word_perplexity|7.4136|±  |7.4136|
25-01-17 16:55:38 | I |       
25-01-17 16:55:38 | I | in valid, quantize current layer weights
25-01-17 16:55:39 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:53 | I |       - range scale = [    1.0000]
25-01-17 16:55:53 | I |         sum  error  = [    0.6607]
25-01-17 16:55:53 | I |         best error  = [    0.6607]
25-01-17 16:55:53 | I |     + error = [0.6607]
25-01-17 16:55:54 | I |       - range scale = [    1.0000]
25-01-17 16:55:54 | I |         sum  error  = [    7.3391]
25-01-17 16:55:54 | I |         best error  = [    7.3391]
25-01-17 16:55:54 | I |     + error = [7.3391]
25-01-17 16:55:55 | I |       - range scale = [    1.0000]
25-01-17 16:55:55 | I |         sum  error  = [    0.6556]
25-01-17 16:55:55 | I |         best error  = [    0.6556]
25-01-17 16:55:55 | I |     + error = [0.6556]
25-01-17 16:55:56 | I |       - range scale = [    1.0000]
25-01-17 16:55:56 | I |         sum  error  = [    7.1260]
25-01-17 16:55:56 | I |         best error  = [    7.1260]
25-01-17 16:55:56 | I |     + error = [7.1260]
25-01-17 16:55:57 | I |       - range scale = [    1.0000]
25-01-17 16:55:57 | I |         sum  error  = [    0.0937]
25-01-17 16:55:57 | I |         best error  = [    0.0937]
25-01-17 16:55:57 | I |     + error = [0.0937]
25-01-17 16:55:58 | I |       - range scale = [    1.0000]
25-01-17 16:55:58 | I |         sum  error  = [    1.0592]
25-01-17 16:55:58 | I |         best error  = [    1.0592]
25-01-17 16:55:58 | I |     + error = [1.0592]
25-01-17 16:55:59 | I |       - range scale = [    1.0000]
25-01-17 16:55:59 | I |         sum  error  = [    0.0961]
25-01-17 16:55:59 | I |         best error  = [    0.0961]
25-01-17 16:55:59 | I |     + error = [0.0961]
25-01-17 16:55:59 | I |       - range scale = [    1.0000]
25-01-17 16:55:59 | I |         sum  error  = [    1.0476]
25-01-17 16:55:59 | I |         best error  = [    1.0476]
25-01-17 16:55:59 | I |     + error = [1.0476]
25-01-17 16:56:00 | I |       - range scale = [    1.0000]
25-01-17 16:56:00 | I |         sum  error  = [    0.4814]
25-01-17 16:56:00 | I |         best error  = [    0.4814]
25-01-17 16:56:00 | I |     + error = [0.4814]
25-01-17 16:56:01 | I |       - range scale = [    1.0000]
25-01-17 16:56:01 | I |         sum  error  = [    5.5039]
25-01-17 16:56:01 | I |         best error  = [    5.5039]
25-01-17 16:56:01 | I |     + error = [5.5039]
25-01-17 16:56:02 | I |       - range scale = [    1.0000]
25-01-17 16:56:02 | I |         sum  error  = [    2.5866]
25-01-17 16:56:02 | I |         best error  = [    2.5866]
25-01-17 16:56:02 | I |     + error = [2.5866]
25-01-17 16:56:02 | I |       - range scale = [    1.0000]
25-01-17 16:56:02 | I |         sum  error  = [   29.4842]
25-01-17 16:56:02 | I |         best error  = [   29.4842]
25-01-17 16:56:02 | I |     + error = [29.4842]
25-01-17 16:56:03 | I |       - range scale = [    1.0000]
25-01-17 16:56:03 | I |         sum  error  = [    0.1927]
25-01-17 16:56:03 | I |         best error  = [    0.1927]
25-01-17 16:56:03 | I |     + error = [0.1927]
25-01-17 16:56:04 | I |       - range scale = [    1.0000]
25-01-17 16:56:04 | I |         sum  error  = [    1.7468]
25-01-17 16:56:04 | I |         best error  = [    1.7468]
25-01-17 16:56:04 | I |     + error = [1.7468]
25-01-17 16:56:17 | I | in valid, quantize current layer acts
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:23 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 16:56:23 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:56:23 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:56:23 | I | - Evaluator: gptq
25-01-17 16:56:23 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:56:23 | I | - Batch_size: 8
25-01-17 16:56:23 | I |   + Max_seq_length: 2048
25-01-17 16:56:43 | I |     - Results:
25-01-17 16:56:43 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:56:43 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:56:43 | I |       |wikitext |      1|word_perplexity|7.7269|±  |7.7269|
25-01-17 16:56:43 | I |       |val_valid|      1|word_perplexity|7.4364|±  |7.4364|
25-01-17 16:56:43 | I |       
25-01-17 16:56:56 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.616, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.13, wps=36582.6, wpb=4058.2, bsz=2, num_updates=9, lmquant_ppl_wikitext_all_quanted=7.70752, lmquant_ppl_val_all_quanted=7.41357, lmquant_ppl_wikitext_partly_quanted=7.72689, lmquant_ppl_val_partly_quanted=7.43637
25-01-17 16:56:56 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.616 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.13 | wps 36582.6 | wpb 4058.2 | bsz 2 | num_updates 9 | lmquant_ppl_wikitext_all_quanted 7.70752 | lmquant_ppl_val_all_quanted 7.41357 | lmquant_ppl_wikitext_partly_quanted 7.72689 | lmquant_ppl_val_partly_quanted 7.43637
25-01-17 16:56:56 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:56:56 | I | in layer model.layers.4
25-01-17 16:56:56 | I | quantizing weights for layer model.layers.4
25-01-17 16:56:57 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:57 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:57 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:57 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:57 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:56:57 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:56:58 | I |       - range scale = [    1.0000]
25-01-17 16:56:58 | I |         sum  error  = [    0.3134]
25-01-17 16:56:58 | I |         best error  = [    0.3134]
25-01-17 16:56:58 | I |     + error = [0.3134]
25-01-17 16:56:59 | I |       - range scale = [    1.0000]
25-01-17 16:56:59 | I |         sum  error  = [    3.7771]
25-01-17 16:56:59 | I |         best error  = [    3.7771]
25-01-17 16:56:59 | I |     + error = [3.7771]
25-01-17 16:56:59 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:57:00 | I |       - range scale = [    1.0000]
25-01-17 16:57:00 | I |         sum  error  = [    0.3002]
25-01-17 16:57:00 | I |         best error  = [    0.3002]
25-01-17 16:57:00 | I |     + error = [0.3002]
25-01-17 16:57:00 | I |       - range scale = [    1.0000]
25-01-17 16:57:00 | I |         sum  error  = [    3.4701]
25-01-17 16:57:00 | I |         best error  = [    3.4701]
25-01-17 16:57:00 | I |     + error = [3.4701]
25-01-17 16:57:01 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:57:01 | I |       - range scale = [    1.0000]
25-01-17 16:57:01 | I |         sum  error  = [    0.0923]
25-01-17 16:57:01 | I |         best error  = [    0.0923]
25-01-17 16:57:01 | I |     + error = [0.0923]
25-01-17 16:57:02 | I |       - range scale = [    1.0000]
25-01-17 16:57:02 | I |         sum  error  = [    1.0574]
25-01-17 16:57:02 | I |         best error  = [    1.0574]
25-01-17 16:57:02 | I |     + error = [1.0574]
25-01-17 16:57:02 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:57:03 | I |       - range scale = [    1.0000]
25-01-17 16:57:03 | I |         sum  error  = [    0.1404]
25-01-17 16:57:03 | I |         best error  = [    0.1404]
25-01-17 16:57:03 | I |     + error = [0.1404]
25-01-17 16:57:03 | I |       - range scale = [    1.0000]
25-01-17 16:57:03 | I |         sum  error  = [    1.5268]
25-01-17 16:57:03 | I |         best error  = [    1.5268]
25-01-17 16:57:03 | I |     + error = [1.5268]
25-01-17 16:57:04 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:57:04 | I |       - range scale = [    1.0000]
25-01-17 16:57:04 | I |         sum  error  = [    0.4780]
25-01-17 16:57:04 | I |         best error  = [    0.4780]
25-01-17 16:57:04 | I |     + error = [0.4780]
25-01-17 16:57:05 | I |       - range scale = [    1.0000]
25-01-17 16:57:05 | I |         sum  error  = [    5.4620]
25-01-17 16:57:05 | I |         best error  = [    5.4620]
25-01-17 16:57:05 | I |     + error = [5.4620]
25-01-17 16:57:05 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:57:06 | I |       - range scale = [    1.0000]
25-01-17 16:57:06 | I |         sum  error  = [    2.5696]
25-01-17 16:57:06 | I |         best error  = [    2.5696]
25-01-17 16:57:06 | I |     + error = [2.5696]
25-01-17 16:57:07 | I |       - range scale = [    1.0000]
25-01-17 16:57:07 | I |         sum  error  = [   29.3129]
25-01-17 16:57:07 | I |         best error  = [   29.3129]
25-01-17 16:57:07 | I |     + error = [29.3129]
25-01-17 16:57:07 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:57:08 | I |       - range scale = [    1.0000]
25-01-17 16:57:08 | I |         sum  error  = [    0.1929]
25-01-17 16:57:08 | I |         best error  = [    0.1929]
25-01-17 16:57:08 | I |     + error = [0.1929]
25-01-17 16:57:08 | I |       - range scale = [    1.0000]
25-01-17 16:57:08 | I |         sum  error  = [    1.7571]
25-01-17 16:57:08 | I |         best error  = [    1.7571]
25-01-17 16:57:08 | I |     + error = [1.7571]
25-01-17 16:57:08 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:57:10 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:57:11 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:57:13 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:57:14 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:57:15 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:57:17 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:57:20 | I | quantizing activations for layer model.layers.4
25-01-17 16:57:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:23 | I | forward this layer
25-01-17 16:57:23 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/18.pt
25-01-17 16:57:23 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/18.pt
25-01-17 16:57:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:57:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:57:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:57:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:57:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:57:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:57:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:57:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:57:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:57:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:57:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:57:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:57:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:57:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:57:23 | I | in layer model.layers.4
25-01-17 16:57:23 | I | quantizing weights for layer model.layers.4
25-01-17 16:57:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:24 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:57:24 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:57:25 | I |       - range scale = [    1.0000]
25-01-17 16:57:25 | I |         sum  error  = [    0.2641]
25-01-17 16:57:25 | I |         best error  = [    0.2641]
25-01-17 16:57:25 | I |     + error = [0.2641]
25-01-17 16:57:25 | I |       - range scale = [    1.0000]
25-01-17 16:57:25 | I |         sum  error  = [    3.0988]
25-01-17 16:57:25 | I |         best error  = [    3.0988]
25-01-17 16:57:25 | I |     + error = [3.0988]
25-01-17 16:57:26 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:57:26 | I |       - range scale = [    1.0000]
25-01-17 16:57:26 | I |         sum  error  = [    0.2455]
25-01-17 16:57:26 | I |         best error  = [    0.2455]
25-01-17 16:57:26 | I |     + error = [0.2455]
25-01-17 16:57:27 | I |       - range scale = [    1.0000]
25-01-17 16:57:27 | I |         sum  error  = [    3.0516]
25-01-17 16:57:27 | I |         best error  = [    3.0516]
25-01-17 16:57:27 | I |     + error = [3.0516]
25-01-17 16:57:27 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:57:28 | I |       - range scale = [    1.0000]
25-01-17 16:57:28 | I |         sum  error  = [    0.0930]
25-01-17 16:57:28 | I |         best error  = [    0.0930]
25-01-17 16:57:28 | I |     + error = [0.0930]
25-01-17 16:57:28 | I |       - range scale = [    1.0000]
25-01-17 16:57:28 | I |         sum  error  = [    1.0534]
25-01-17 16:57:28 | I |         best error  = [    1.0534]
25-01-17 16:57:28 | I |     + error = [1.0534]
25-01-17 16:57:29 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:57:29 | I |       - range scale = [    1.0000]
25-01-17 16:57:29 | I |         sum  error  = [    0.1165]
25-01-17 16:57:29 | I |         best error  = [    0.1165]
25-01-17 16:57:29 | I |     + error = [0.1165]
25-01-17 16:57:30 | I |       - range scale = [    1.0000]
25-01-17 16:57:30 | I |         sum  error  = [    1.2755]
25-01-17 16:57:30 | I |         best error  = [    1.2755]
25-01-17 16:57:30 | I |     + error = [1.2755]
25-01-17 16:57:30 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:57:31 | I |       - range scale = [    1.0000]
25-01-17 16:57:31 | I |         sum  error  = [    0.4784]
25-01-17 16:57:31 | I |         best error  = [    0.4784]
25-01-17 16:57:31 | I |     + error = [0.4784]
25-01-17 16:57:32 | I |       - range scale = [    1.0000]
25-01-17 16:57:32 | I |         sum  error  = [    5.4635]
25-01-17 16:57:32 | I |         best error  = [    5.4635]
25-01-17 16:57:32 | I |     + error = [5.4635]
25-01-17 16:57:32 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:57:32 | I |       - range scale = [    1.0000]
25-01-17 16:57:32 | I |         sum  error  = [    2.5715]
25-01-17 16:57:32 | I |         best error  = [    2.5715]
25-01-17 16:57:32 | I |     + error = [2.5715]
25-01-17 16:57:33 | I |       - range scale = [    1.0000]
25-01-17 16:57:33 | I |         sum  error  = [   29.2830]
25-01-17 16:57:33 | I |         best error  = [   29.2830]
25-01-17 16:57:33 | I |     + error = [29.2830]
25-01-17 16:57:33 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:57:34 | I |       - range scale = [    1.0000]
25-01-17 16:57:34 | I |         sum  error  = [    0.1936]
25-01-17 16:57:34 | I |         best error  = [    0.1936]
25-01-17 16:57:34 | I |     + error = [0.1936]
25-01-17 16:57:35 | I |       - range scale = [    1.0000]
25-01-17 16:57:35 | I |         sum  error  = [    1.7435]
25-01-17 16:57:35 | I |         best error  = [    1.7435]
25-01-17 16:57:35 | I |     + error = [1.7435]
25-01-17 16:57:35 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:57:36 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:57:38 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:57:39 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:57:41 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:57:42 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:57:43 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:57:47 | I | quantizing activations for layer model.layers.4
25-01-17 16:57:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:49 | I | forward this layer
25-01-17 16:57:49 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/19.pt
25-01-17 16:57:49 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/19.pt
25-01-17 16:57:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:57:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:57:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:57:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:57:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:57:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:57:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:57:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:57:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:57:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:57:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:57:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:57:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:57:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:57:49 | I | [9] done with optimizer step
25-01-17 16:57:49 | I | epoch 001:     10 / 409600000 loss=1.13166e-05, loss_sum=0.257035, wps=218.9, ups=0.01, wpb=32768, bsz=64, num_updates=10, lr=0.001, gnorm=0, clip=0, loss_scale=128, train_wall=53, cuda_gb_allocated=12.1, cuda_gb_reserved=13.6, cuda_gb_free=11.6, wall=1774
25-01-17 16:57:49 | I | begin validation on "valid" subset on rank 0
25-01-17 16:57:49 | I | got valid iterator on "valid" subset on rank 0
25-01-17 16:57:49 | I | Valid: Start iterating over samples
25-01-17 16:57:49 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:57:50 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:57:50 | I | - Evaluator: gptq
25-01-17 16:57:50 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:57:50 | I | - Batch_size: 8
25-01-17 16:57:50 | I |   + Max_seq_length: 2048
25-01-17 16:58:07 | I |     - Results:
25-01-17 16:58:07 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:58:07 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:58:07 | I |       |wikitext |      1|word_perplexity|7.7075|±  |7.7075|
25-01-17 16:58:07 | I |       |val_valid|      1|word_perplexity|7.4136|±  |7.4136|
25-01-17 16:58:07 | I |       
25-01-17 16:58:07 | I | in valid, quantize current layer weights
25-01-17 16:58:08 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:22 | I |       - range scale = [    1.0000]
25-01-17 16:58:22 | I |         sum  error  = [    0.6607]
25-01-17 16:58:22 | I |         best error  = [    0.6607]
25-01-17 16:58:22 | I |     + error = [0.6607]
25-01-17 16:58:23 | I |       - range scale = [    1.0000]
25-01-17 16:58:23 | I |         sum  error  = [    7.3391]
25-01-17 16:58:23 | I |         best error  = [    7.3391]
25-01-17 16:58:23 | I |     + error = [7.3391]
25-01-17 16:58:24 | I |       - range scale = [    1.0000]
25-01-17 16:58:24 | I |         sum  error  = [    0.6556]
25-01-17 16:58:24 | I |         best error  = [    0.6556]
25-01-17 16:58:24 | I |     + error = [0.6556]
25-01-17 16:58:25 | I |       - range scale = [    1.0000]
25-01-17 16:58:25 | I |         sum  error  = [    7.1260]
25-01-17 16:58:25 | I |         best error  = [    7.1260]
25-01-17 16:58:25 | I |     + error = [7.1260]
25-01-17 16:58:26 | I |       - range scale = [    1.0000]
25-01-17 16:58:26 | I |         sum  error  = [    0.0937]
25-01-17 16:58:26 | I |         best error  = [    0.0937]
25-01-17 16:58:26 | I |     + error = [0.0937]
25-01-17 16:58:27 | I |       - range scale = [    1.0000]
25-01-17 16:58:27 | I |         sum  error  = [    1.0592]
25-01-17 16:58:27 | I |         best error  = [    1.0592]
25-01-17 16:58:27 | I |     + error = [1.0592]
25-01-17 16:58:28 | I |       - range scale = [    1.0000]
25-01-17 16:58:28 | I |         sum  error  = [    0.0961]
25-01-17 16:58:28 | I |         best error  = [    0.0961]
25-01-17 16:58:28 | I |     + error = [0.0961]
25-01-17 16:58:29 | I |       - range scale = [    1.0000]
25-01-17 16:58:29 | I |         sum  error  = [    1.0476]
25-01-17 16:58:29 | I |         best error  = [    1.0476]
25-01-17 16:58:29 | I |     + error = [1.0476]
25-01-17 16:58:29 | I |       - range scale = [    1.0000]
25-01-17 16:58:29 | I |         sum  error  = [    0.4814]
25-01-17 16:58:29 | I |         best error  = [    0.4814]
25-01-17 16:58:29 | I |     + error = [0.4814]
25-01-17 16:58:30 | I |       - range scale = [    1.0000]
25-01-17 16:58:30 | I |         sum  error  = [    5.5039]
25-01-17 16:58:30 | I |         best error  = [    5.5039]
25-01-17 16:58:30 | I |     + error = [5.5039]
25-01-17 16:58:31 | I |       - range scale = [    1.0000]
25-01-17 16:58:31 | I |         sum  error  = [    2.5866]
25-01-17 16:58:31 | I |         best error  = [    2.5866]
25-01-17 16:58:31 | I |     + error = [2.5866]
25-01-17 16:58:32 | I |       - range scale = [    1.0000]
25-01-17 16:58:32 | I |         sum  error  = [   29.4842]
25-01-17 16:58:32 | I |         best error  = [   29.4842]
25-01-17 16:58:32 | I |     + error = [29.4842]
25-01-17 16:58:33 | I |       - range scale = [    1.0000]
25-01-17 16:58:33 | I |         sum  error  = [    0.1927]
25-01-17 16:58:33 | I |         best error  = [    0.1927]
25-01-17 16:58:33 | I |     + error = [0.1927]
25-01-17 16:58:33 | I |       - range scale = [    1.0000]
25-01-17 16:58:33 | I |         sum  error  = [    1.7468]
25-01-17 16:58:33 | I |         best error  = [    1.7468]
25-01-17 16:58:33 | I |     + error = [1.7468]
25-01-17 16:58:46 | I | in valid, quantize current layer acts
25-01-17 16:58:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:53 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 16:58:53 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:58:53 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:58:53 | I | - Evaluator: gptq
25-01-17 16:58:53 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:58:53 | I | - Batch_size: 8
25-01-17 16:58:53 | I |   + Max_seq_length: 2048
25-01-17 16:59:12 | I |     - Results:
25-01-17 16:59:12 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:59:12 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:59:12 | I |       |wikitext |      1|word_perplexity|7.7269|±  |7.7269|
25-01-17 16:59:12 | I |       |val_valid|      1|word_perplexity|7.4364|±  |7.4364|
25-01-17 16:59:12 | I |       
25-01-17 16:59:25 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.616, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.13, wps=36601.7, wpb=4058.2, bsz=2, num_updates=10, lmquant_ppl_wikitext_all_quanted=7.70752, lmquant_ppl_val_all_quanted=7.41357, lmquant_ppl_wikitext_partly_quanted=7.72689, lmquant_ppl_val_partly_quanted=7.43637
25-01-17 16:59:25 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.616 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.13 | wps 36601.7 | wpb 4058.2 | bsz 2 | num_updates 10 | lmquant_ppl_wikitext_all_quanted 7.70752 | lmquant_ppl_val_all_quanted 7.41357 | lmquant_ppl_wikitext_partly_quanted 7.72689 | lmquant_ppl_val_partly_quanted 7.43637
25-01-17 16:59:25 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:59:25 | I | in layer model.layers.4
25-01-17 16:59:25 | I | quantizing weights for layer model.layers.4
25-01-17 16:59:26 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:26 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:26 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:26 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:26 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:59:26 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:59:27 | I |       - range scale = [    1.0000]
25-01-17 16:59:27 | I |         sum  error  = [    0.2412]
25-01-17 16:59:27 | I |         best error  = [    0.2412]
25-01-17 16:59:27 | I |     + error = [0.2412]
25-01-17 16:59:28 | I |       - range scale = [    1.0000]
25-01-17 16:59:28 | I |         sum  error  = [    2.7914]
25-01-17 16:59:28 | I |         best error  = [    2.7914]
25-01-17 16:59:28 | I |     + error = [2.7914]
25-01-17 16:59:28 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:59:29 | I |       - range scale = [    1.0000]
25-01-17 16:59:29 | I |         sum  error  = [    0.2228]
25-01-17 16:59:29 | I |         best error  = [    0.2228]
25-01-17 16:59:29 | I |     + error = [0.2228]
25-01-17 16:59:29 | I |       - range scale = [    1.0000]
25-01-17 16:59:29 | I |         sum  error  = [    2.8096]
25-01-17 16:59:29 | I |         best error  = [    2.8096]
25-01-17 16:59:29 | I |     + error = [2.8096]
25-01-17 16:59:30 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:59:30 | I |       - range scale = [    1.0000]
25-01-17 16:59:30 | I |         sum  error  = [    0.0927]
25-01-17 16:59:30 | I |         best error  = [    0.0927]
25-01-17 16:59:30 | I |     + error = [0.0927]
25-01-17 16:59:31 | I |       - range scale = [    1.0000]
25-01-17 16:59:31 | I |         sum  error  = [    1.0521]
25-01-17 16:59:31 | I |         best error  = [    1.0521]
25-01-17 16:59:31 | I |     + error = [1.0521]
25-01-17 16:59:31 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:59:32 | I |       - range scale = [    1.0000]
25-01-17 16:59:32 | I |         sum  error  = [    0.1117]
25-01-17 16:59:32 | I |         best error  = [    0.1117]
25-01-17 16:59:32 | I |     + error = [0.1117]
25-01-17 16:59:32 | I |       - range scale = [    1.0000]
25-01-17 16:59:32 | I |         sum  error  = [    1.2154]
25-01-17 16:59:32 | I |         best error  = [    1.2154]
25-01-17 16:59:32 | I |     + error = [1.2154]
25-01-17 16:59:33 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:59:33 | I |       - range scale = [    1.0000]
25-01-17 16:59:33 | I |         sum  error  = [    0.4779]
25-01-17 16:59:33 | I |         best error  = [    0.4779]
25-01-17 16:59:33 | I |     + error = [0.4779]
25-01-17 16:59:34 | I |       - range scale = [    1.0000]
25-01-17 16:59:34 | I |         sum  error  = [    5.4628]
25-01-17 16:59:34 | I |         best error  = [    5.4628]
25-01-17 16:59:34 | I |     + error = [5.4628]
25-01-17 16:59:34 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:59:35 | I |       - range scale = [    1.0000]
25-01-17 16:59:35 | I |         sum  error  = [    2.5692]
25-01-17 16:59:35 | I |         best error  = [    2.5692]
25-01-17 16:59:35 | I |     + error = [2.5692]
25-01-17 16:59:36 | I |       - range scale = [    1.0000]
25-01-17 16:59:36 | I |         sum  error  = [   29.2755]
25-01-17 16:59:36 | I |         best error  = [   29.2755]
25-01-17 16:59:36 | I |     + error = [29.2755]
25-01-17 16:59:36 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:59:37 | I |       - range scale = [    1.0000]
25-01-17 16:59:37 | I |         sum  error  = [    0.1942]
25-01-17 16:59:37 | I |         best error  = [    0.1942]
25-01-17 16:59:37 | I |     + error = [0.1942]
25-01-17 16:59:37 | I |       - range scale = [    1.0000]
25-01-17 16:59:37 | I |         sum  error  = [    1.7803]
25-01-17 16:59:37 | I |         best error  = [    1.7803]
25-01-17 16:59:37 | I |     + error = [1.7803]
25-01-17 16:59:38 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:59:39 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:59:40 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:59:42 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:59:43 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:59:45 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:59:46 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:59:49 | I | quantizing activations for layer model.layers.4
25-01-17 16:59:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:52 | I | forward this layer
25-01-17 16:59:52 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/20.pt
25-01-17 16:59:52 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/20.pt
25-01-17 16:59:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:59:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:59:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:59:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:59:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:59:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:59:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:59:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:59:52 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:59:52 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:59:52 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:59:52 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:59:52 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:59:52 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:59:52 | I | in layer model.layers.4
25-01-17 16:59:52 | I | quantizing weights for layer model.layers.4
25-01-17 16:59:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:53 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:59:53 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:59:54 | I |       - range scale = [    1.0000]
25-01-17 16:59:54 | I |         sum  error  = [    0.2554]
25-01-17 16:59:54 | I |         best error  = [    0.2554]
25-01-17 16:59:54 | I |     + error = [0.2554]
25-01-17 16:59:54 | I |       - range scale = [    1.0000]
25-01-17 16:59:54 | I |         sum  error  = [    2.9286]
25-01-17 16:59:54 | I |         best error  = [    2.9286]
25-01-17 16:59:54 | I |     + error = [2.9286]
25-01-17 16:59:55 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:59:55 | I |       - range scale = [    1.0000]
25-01-17 16:59:55 | I |         sum  error  = [    0.2527]
25-01-17 16:59:55 | I |         best error  = [    0.2527]
25-01-17 16:59:55 | I |     + error = [0.2527]
25-01-17 16:59:56 | I |       - range scale = [    1.0000]
25-01-17 16:59:56 | I |         sum  error  = [    3.1093]
25-01-17 16:59:56 | I |         best error  = [    3.1093]
25-01-17 16:59:56 | I |     + error = [3.1093]
25-01-17 16:59:56 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:59:57 | I |       - range scale = [    1.0000]
25-01-17 16:59:57 | I |         sum  error  = [    0.0929]
25-01-17 16:59:57 | I |         best error  = [    0.0929]
25-01-17 16:59:57 | I |     + error = [0.0929]
25-01-17 16:59:58 | I |       - range scale = [    1.0000]
25-01-17 16:59:58 | I |         sum  error  = [    1.0536]
25-01-17 16:59:58 | I |         best error  = [    1.0536]
25-01-17 16:59:58 | I |     + error = [1.0536]
25-01-17 16:59:58 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:59:58 | I |       - range scale = [    1.0000]
25-01-17 16:59:58 | I |         sum  error  = [    0.1138]
25-01-17 16:59:58 | I |         best error  = [    0.1138]
25-01-17 16:59:58 | I |     + error = [0.1138]
25-01-17 16:59:59 | I |       - range scale = [    1.0000]
25-01-17 16:59:59 | I |         sum  error  = [    1.2339]
25-01-17 16:59:59 | I |         best error  = [    1.2339]
25-01-17 16:59:59 | I |     + error = [1.2339]
25-01-17 16:59:59 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:00:00 | I |       - range scale = [    1.0000]
25-01-17 17:00:00 | I |         sum  error  = [    0.4787]
25-01-17 17:00:00 | I |         best error  = [    0.4787]
25-01-17 17:00:00 | I |     + error = [0.4787]
25-01-17 17:00:01 | I |       - range scale = [    1.0000]
25-01-17 17:00:01 | I |         sum  error  = [    5.4621]
25-01-17 17:00:01 | I |         best error  = [    5.4621]
25-01-17 17:00:01 | I |     + error = [5.4621]
25-01-17 17:00:01 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:00:02 | I |       - range scale = [    1.0000]
25-01-17 17:00:02 | I |         sum  error  = [    2.5711]
25-01-17 17:00:02 | I |         best error  = [    2.5711]
25-01-17 17:00:02 | I |     + error = [2.5711]
25-01-17 17:00:02 | I |       - range scale = [    1.0000]
25-01-17 17:00:02 | I |         sum  error  = [   29.2771]
25-01-17 17:00:02 | I |         best error  = [   29.2771]
25-01-17 17:00:02 | I |     + error = [29.2771]
25-01-17 17:00:03 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:00:03 | I |       - range scale = [    1.0000]
25-01-17 17:00:03 | I |         sum  error  = [    0.2053]
25-01-17 17:00:03 | I |         best error  = [    0.2053]
25-01-17 17:00:03 | I |     + error = [0.2053]
25-01-17 17:00:04 | I |       - range scale = [    1.0000]
25-01-17 17:00:04 | I |         sum  error  = [    1.8381]
25-01-17 17:00:04 | I |         best error  = [    1.8381]
25-01-17 17:00:04 | I |     + error = [1.8381]
25-01-17 17:00:04 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:00:06 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:00:07 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:00:09 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:00:10 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:00:11 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:00:13 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:00:16 | I | quantizing activations for layer model.layers.4
25-01-17 17:00:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:19 | I | forward this layer
25-01-17 17:00:19 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/21.pt
25-01-17 17:00:19 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/21.pt
25-01-17 17:00:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:00:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:00:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:00:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:00:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:00:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:00:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:00:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:00:19 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:00:19 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:00:19 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:00:19 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:00:19 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:00:19 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:00:19 | I | [10] done with optimizer step
25-01-17 17:00:19 | I | epoch 001:     11 / 409600000 loss=1.11661e-05, loss_sum=0.253616, wps=219.2, ups=0.01, wpb=32768, bsz=64, num_updates=11, lr=0.0011, gnorm=0, clip=0, loss_scale=128, train_wall=54, cuda_gb_allocated=12.1, cuda_gb_reserved=13.6, cuda_gb_free=11.6, wall=1923
25-01-17 17:00:19 | I | begin validation on "valid" subset on rank 0
25-01-17 17:00:19 | I | got valid iterator on "valid" subset on rank 0
25-01-17 17:00:19 | I | Valid: Start iterating over samples
25-01-17 17:00:19 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:00:19 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:00:19 | I | - Evaluator: gptq
25-01-17 17:00:19 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:00:19 | I | - Batch_size: 8
25-01-17 17:00:19 | I |   + Max_seq_length: 2048
25-01-17 17:00:37 | I |     - Results:
25-01-17 17:00:37 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:00:37 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:00:37 | I |       |wikitext |      1|word_perplexity|7.7075|±  |7.7075|
25-01-17 17:00:37 | I |       |val_valid|      1|word_perplexity|7.4136|±  |7.4136|
25-01-17 17:00:37 | I |       
25-01-17 17:00:37 | I | in valid, quantize current layer weights
25-01-17 17:00:38 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 17:00:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:52 | I |       - range scale = [    1.0000]
25-01-17 17:00:52 | I |         sum  error  = [    0.6607]
25-01-17 17:00:52 | I |         best error  = [    0.6607]
25-01-17 17:00:52 | I |     + error = [0.6607]
25-01-17 17:00:53 | I |       - range scale = [    1.0000]
25-01-17 17:00:53 | I |         sum  error  = [    7.3391]
25-01-17 17:00:53 | I |         best error  = [    7.3391]
25-01-17 17:00:53 | I |     + error = [7.3391]
25-01-17 17:00:54 | I |       - range scale = [    1.0000]
25-01-17 17:00:54 | I |         sum  error  = [    0.6556]
25-01-17 17:00:54 | I |         best error  = [    0.6556]
25-01-17 17:00:54 | I |     + error = [0.6556]
25-01-17 17:00:55 | I |       - range scale = [    1.0000]
25-01-17 17:00:55 | I |         sum  error  = [    7.1260]
25-01-17 17:00:55 | I |         best error  = [    7.1260]
25-01-17 17:00:55 | I |     + error = [7.1260]
25-01-17 17:00:56 | I |       - range scale = [    1.0000]
25-01-17 17:00:56 | I |         sum  error  = [    0.0937]
25-01-17 17:00:56 | I |         best error  = [    0.0937]
25-01-17 17:00:56 | I |     + error = [0.0937]
25-01-17 17:00:57 | I |       - range scale = [    1.0000]
25-01-17 17:00:57 | I |         sum  error  = [    1.0592]
25-01-17 17:00:57 | I |         best error  = [    1.0592]
25-01-17 17:00:57 | I |     + error = [1.0592]
25-01-17 17:00:58 | I |       - range scale = [    1.0000]
25-01-17 17:00:58 | I |         sum  error  = [    0.0961]
25-01-17 17:00:58 | I |         best error  = [    0.0961]
25-01-17 17:00:58 | I |     + error = [0.0961]
25-01-17 17:00:58 | I |       - range scale = [    1.0000]
25-01-17 17:00:58 | I |         sum  error  = [    1.0476]
25-01-17 17:00:58 | I |         best error  = [    1.0476]
25-01-17 17:00:58 | I |     + error = [1.0476]
25-01-17 17:00:59 | I |       - range scale = [    1.0000]
25-01-17 17:00:59 | I |         sum  error  = [    0.4814]
25-01-17 17:00:59 | I |         best error  = [    0.4814]
25-01-17 17:00:59 | I |     + error = [0.4814]
25-01-17 17:01:00 | I |       - range scale = [    1.0000]
25-01-17 17:01:00 | I |         sum  error  = [    5.5039]
25-01-17 17:01:00 | I |         best error  = [    5.5039]
25-01-17 17:01:00 | I |     + error = [5.5039]
25-01-17 17:01:01 | I |       - range scale = [    1.0000]
25-01-17 17:01:01 | I |         sum  error  = [    2.5866]
25-01-17 17:01:01 | I |         best error  = [    2.5866]
25-01-17 17:01:01 | I |     + error = [2.5866]
25-01-17 17:01:02 | I |       - range scale = [    1.0000]
25-01-17 17:01:02 | I |         sum  error  = [   29.4842]
25-01-17 17:01:02 | I |         best error  = [   29.4842]
25-01-17 17:01:02 | I |     + error = [29.4842]
25-01-17 17:01:02 | I |       - range scale = [    1.0000]
25-01-17 17:01:02 | I |         sum  error  = [    0.1927]
25-01-17 17:01:02 | I |         best error  = [    0.1927]
25-01-17 17:01:02 | I |     + error = [0.1927]
25-01-17 17:01:03 | I |       - range scale = [    1.0000]
25-01-17 17:01:03 | I |         sum  error  = [    1.7468]
25-01-17 17:01:03 | I |         best error  = [    1.7468]
25-01-17 17:01:03 | I |     + error = [1.7468]
25-01-17 17:01:16 | I | in valid, quantize current layer acts
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:22 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 17:01:22 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:01:22 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:01:22 | I | - Evaluator: gptq
25-01-17 17:01:22 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:01:22 | I | - Batch_size: 8
25-01-17 17:01:22 | I |   + Max_seq_length: 2048
25-01-17 17:01:42 | I |     - Results:
25-01-17 17:01:42 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:01:42 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:01:42 | I |       |wikitext |      1|word_perplexity|7.7269|±  |7.7269|
25-01-17 17:01:42 | I |       |val_valid|      1|word_perplexity|7.4364|±  |7.4364|
25-01-17 17:01:42 | I |       
25-01-17 17:01:55 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.616, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.13, wps=36487.4, wpb=4058.2, bsz=2, num_updates=11, lmquant_ppl_wikitext_all_quanted=7.70752, lmquant_ppl_val_all_quanted=7.41357, lmquant_ppl_wikitext_partly_quanted=7.72689, lmquant_ppl_val_partly_quanted=7.43637
25-01-17 17:01:55 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.616 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.13 | wps 36487.4 | wpb 4058.2 | bsz 2 | num_updates 11 | lmquant_ppl_wikitext_all_quanted 7.70752 | lmquant_ppl_val_all_quanted 7.41357 | lmquant_ppl_wikitext_partly_quanted 7.72689 | lmquant_ppl_val_partly_quanted 7.43637
25-01-17 17:01:55 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:01:55 | I | in layer model.layers.4
25-01-17 17:01:55 | I | quantizing weights for layer model.layers.4
25-01-17 17:01:56 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:56 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:56 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:56 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:56 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:01:56 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:01:57 | I |       - range scale = [    1.0000]
25-01-17 17:01:57 | I |         sum  error  = [    0.2504]
25-01-17 17:01:57 | I |         best error  = [    0.2504]
25-01-17 17:01:57 | I |     + error = [0.2504]
25-01-17 17:01:58 | I |       - range scale = [    1.0000]
25-01-17 17:01:58 | I |         sum  error  = [    2.8062]
25-01-17 17:01:58 | I |         best error  = [    2.8062]
25-01-17 17:01:58 | I |     + error = [2.8062]
25-01-17 17:01:58 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:01:59 | I |       - range scale = [    1.0000]
25-01-17 17:01:59 | I |         sum  error  = [    0.2342]
25-01-17 17:01:59 | I |         best error  = [    0.2342]
25-01-17 17:01:59 | I |     + error = [0.2342]
25-01-17 17:01:59 | I |       - range scale = [    1.0000]
25-01-17 17:01:59 | I |         sum  error  = [    2.7827]
25-01-17 17:01:59 | I |         best error  = [    2.7827]
25-01-17 17:01:59 | I |     + error = [2.7827]
25-01-17 17:02:00 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:02:00 | I |       - range scale = [    1.0000]
25-01-17 17:02:00 | I |         sum  error  = [    0.0931]
25-01-17 17:02:00 | I |         best error  = [    0.0931]
25-01-17 17:02:00 | I |     + error = [0.0931]
25-01-17 17:02:01 | I |       - range scale = [    1.0000]
25-01-17 17:02:01 | I |         sum  error  = [    1.0544]
25-01-17 17:02:01 | I |         best error  = [    1.0544]
25-01-17 17:02:01 | I |     + error = [1.0544]
25-01-17 17:02:01 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:02:02 | I |       - range scale = [    1.0000]
25-01-17 17:02:02 | I |         sum  error  = [    0.1220]
25-01-17 17:02:02 | I |         best error  = [    0.1220]
25-01-17 17:02:02 | I |     + error = [0.1220]
25-01-17 17:02:02 | I |       - range scale = [    1.0000]
25-01-17 17:02:02 | I |         sum  error  = [    1.3347]
25-01-17 17:02:02 | I |         best error  = [    1.3347]
25-01-17 17:02:02 | I |     + error = [1.3347]
25-01-17 17:02:03 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:02:03 | I |       - range scale = [    1.0000]
25-01-17 17:02:03 | I |         sum  error  = [    0.4781]
25-01-17 17:02:03 | I |         best error  = [    0.4781]
25-01-17 17:02:03 | I |     + error = [0.4781]
25-01-17 17:02:04 | I |       - range scale = [    1.0000]
25-01-17 17:02:04 | I |         sum  error  = [    5.4643]
25-01-17 17:02:04 | I |         best error  = [    5.4643]
25-01-17 17:02:04 | I |     + error = [5.4643]
25-01-17 17:02:04 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:02:05 | I |       - range scale = [    1.0000]
25-01-17 17:02:05 | I |         sum  error  = [    2.5695]
25-01-17 17:02:05 | I |         best error  = [    2.5695]
25-01-17 17:02:05 | I |     + error = [2.5695]
25-01-17 17:02:06 | I |       - range scale = [    1.0000]
25-01-17 17:02:06 | I |         sum  error  = [   29.2757]
25-01-17 17:02:06 | I |         best error  = [   29.2757]
25-01-17 17:02:06 | I |     + error = [29.2757]
25-01-17 17:02:06 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:02:06 | I |       - range scale = [    1.0000]
25-01-17 17:02:06 | I |         sum  error  = [    0.2065]
25-01-17 17:02:06 | I |         best error  = [    0.2065]
25-01-17 17:02:06 | I |     + error = [0.2065]
25-01-17 17:02:07 | I |       - range scale = [    1.0000]
25-01-17 17:02:07 | I |         sum  error  = [    1.8722]
25-01-17 17:02:07 | I |         best error  = [    1.8722]
25-01-17 17:02:07 | I |     + error = [1.8722]
25-01-17 17:02:07 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:02:09 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:02:10 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:02:12 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:02:13 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:02:14 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:02:16 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:02:19 | I | quantizing activations for layer model.layers.4
25-01-17 17:02:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:22 | I | forward this layer
25-01-17 17:02:22 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/22.pt
25-01-17 17:02:22 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/22.pt
25-01-17 17:02:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:02:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:02:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:02:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:02:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:02:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:02:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:02:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:02:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:02:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:02:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:02:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:02:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:02:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:02:22 | I | in layer model.layers.4
25-01-17 17:02:22 | I | quantizing weights for layer model.layers.4
25-01-17 17:02:22 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:22 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:23 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:23 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:23 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:02:23 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:02:24 | I |       - range scale = [    1.0000]
25-01-17 17:02:24 | I |         sum  error  = [    0.2520]
25-01-17 17:02:24 | I |         best error  = [    0.2520]
25-01-17 17:02:24 | I |     + error = [0.2520]
25-01-17 17:02:24 | I |       - range scale = [    1.0000]
25-01-17 17:02:24 | I |         sum  error  = [    2.9125]
25-01-17 17:02:24 | I |         best error  = [    2.9125]
25-01-17 17:02:24 | I |     + error = [2.9125]
25-01-17 17:02:24 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:02:25 | I |       - range scale = [    1.0000]
25-01-17 17:02:25 | I |         sum  error  = [    0.2455]
25-01-17 17:02:25 | I |         best error  = [    0.2455]
25-01-17 17:02:25 | I |     + error = [0.2455]
25-01-17 17:02:26 | I |       - range scale = [    1.0000]
25-01-17 17:02:26 | I |         sum  error  = [    2.9419]
25-01-17 17:02:26 | I |         best error  = [    2.9419]
25-01-17 17:02:26 | I |     + error = [2.9419]
25-01-17 17:02:26 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:02:27 | I |       - range scale = [    1.0000]
25-01-17 17:02:27 | I |         sum  error  = [    0.0922]
25-01-17 17:02:27 | I |         best error  = [    0.0922]
25-01-17 17:02:27 | I |     + error = [0.0922]
25-01-17 17:02:27 | I |       - range scale = [    1.0000]
25-01-17 17:02:27 | I |         sum  error  = [    1.0502]
25-01-17 17:02:27 | I |         best error  = [    1.0502]
25-01-17 17:02:27 | I |     + error = [1.0502]
25-01-17 17:02:28 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:02:28 | I |       - range scale = [    1.0000]
25-01-17 17:02:28 | I |         sum  error  = [    0.1173]
25-01-17 17:02:28 | I |         best error  = [    0.1173]
25-01-17 17:02:28 | I |     + error = [0.1173]
25-01-17 17:02:29 | I |       - range scale = [    1.0000]
25-01-17 17:02:29 | I |         sum  error  = [    1.2745]
25-01-17 17:02:29 | I |         best error  = [    1.2745]
25-01-17 17:02:29 | I |     + error = [1.2745]
25-01-17 17:02:29 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:02:30 | I |       - range scale = [    1.0000]
25-01-17 17:02:30 | I |         sum  error  = [    0.4773]
25-01-17 17:02:30 | I |         best error  = [    0.4773]
25-01-17 17:02:30 | I |     + error = [0.4773]
25-01-17 17:02:31 | I |       - range scale = [    1.0000]
25-01-17 17:02:31 | I |         sum  error  = [    5.4574]
25-01-17 17:02:31 | I |         best error  = [    5.4574]
25-01-17 17:02:31 | I |     + error = [5.4574]
25-01-17 17:02:31 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:02:31 | I |       - range scale = [    1.0000]
25-01-17 17:02:31 | I |         sum  error  = [    2.5680]
25-01-17 17:02:31 | I |         best error  = [    2.5680]
25-01-17 17:02:31 | I |     + error = [2.5680]
25-01-17 17:02:32 | I |       - range scale = [    1.0000]
25-01-17 17:02:32 | I |         sum  error  = [   29.2550]
25-01-17 17:02:32 | I |         best error  = [   29.2550]
25-01-17 17:02:32 | I |     + error = [29.2550]
25-01-17 17:02:32 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:02:33 | I |       - range scale = [    1.0000]
25-01-17 17:02:33 | I |         sum  error  = [    0.1946]
25-01-17 17:02:33 | I |         best error  = [    0.1946]
25-01-17 17:02:33 | I |     + error = [0.1946]
25-01-17 17:02:34 | I |       - range scale = [    1.0000]
25-01-17 17:02:34 | I |         sum  error  = [    1.7571]
25-01-17 17:02:34 | I |         best error  = [    1.7571]
25-01-17 17:02:34 | I |     + error = [1.7571]
25-01-17 17:02:34 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:02:35 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:02:37 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:02:38 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:02:40 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:02:41 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:02:43 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:02:46 | I | quantizing activations for layer model.layers.4
25-01-17 17:02:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:48 | I | forward this layer
25-01-17 17:02:48 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/23.pt
25-01-17 17:02:48 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/23.pt
25-01-17 17:02:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:02:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:02:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:02:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:02:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:02:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:02:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:02:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:02:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:02:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:02:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:02:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:02:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:02:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:02:49 | I | [11] done with optimizer step
25-01-17 17:02:49 | I | epoch 001:     12 / 409600000 loss=1.09547e-05, loss_sum=0.248815, wps=218.9, ups=0.01, wpb=32768, bsz=64, num_updates=12, lr=0.0012, gnorm=0, clip=0, loss_scale=128, train_wall=53, cuda_gb_allocated=12.1, cuda_gb_reserved=13.6, cuda_gb_free=11.6, wall=2073
25-01-17 17:02:49 | I | begin validation on "valid" subset on rank 0
25-01-17 17:02:49 | I | got valid iterator on "valid" subset on rank 0
25-01-17 17:02:49 | I | Valid: Start iterating over samples
25-01-17 17:02:49 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:02:49 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:02:49 | I | - Evaluator: gptq
25-01-17 17:02:49 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:02:49 | I | - Batch_size: 8
25-01-17 17:02:49 | I |   + Max_seq_length: 2048
25-01-17 17:03:06 | I |     - Results:
25-01-17 17:03:06 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:03:06 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:03:06 | I |       |wikitext |      1|word_perplexity|7.7075|±  |7.7075|
25-01-17 17:03:06 | I |       |val_valid|      1|word_perplexity|7.4136|±  |7.4136|
25-01-17 17:03:06 | I |       
25-01-17 17:03:06 | I | in valid, quantize current layer weights
25-01-17 17:03:07 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:21 | I |       - range scale = [    1.0000]
25-01-17 17:03:21 | I |         sum  error  = [    0.6607]
25-01-17 17:03:21 | I |         best error  = [    0.6607]
25-01-17 17:03:21 | I |     + error = [0.6607]
25-01-17 17:03:22 | I |       - range scale = [    1.0000]
25-01-17 17:03:22 | I |         sum  error  = [    7.3391]
25-01-17 17:03:22 | I |         best error  = [    7.3391]
25-01-17 17:03:22 | I |     + error = [7.3391]
25-01-17 17:03:23 | I |       - range scale = [    1.0000]
25-01-17 17:03:23 | I |         sum  error  = [    0.6556]
25-01-17 17:03:23 | I |         best error  = [    0.6556]
25-01-17 17:03:23 | I |     + error = [0.6556]
25-01-17 17:03:24 | I |       - range scale = [    1.0000]
25-01-17 17:03:24 | I |         sum  error  = [    7.1260]
25-01-17 17:03:24 | I |         best error  = [    7.1260]
25-01-17 17:03:24 | I |     + error = [7.1260]
25-01-17 17:03:25 | I |       - range scale = [    1.0000]
25-01-17 17:03:25 | I |         sum  error  = [    0.0937]
25-01-17 17:03:25 | I |         best error  = [    0.0937]
25-01-17 17:03:25 | I |     + error = [0.0937]
25-01-17 17:03:26 | I |       - range scale = [    1.0000]
25-01-17 17:03:26 | I |         sum  error  = [    1.0592]
25-01-17 17:03:26 | I |         best error  = [    1.0592]
25-01-17 17:03:26 | I |     + error = [1.0592]
25-01-17 17:03:27 | I |       - range scale = [    1.0000]
25-01-17 17:03:27 | I |         sum  error  = [    0.0961]
25-01-17 17:03:27 | I |         best error  = [    0.0961]
25-01-17 17:03:27 | I |     + error = [0.0961]
25-01-17 17:03:27 | I |       - range scale = [    1.0000]
25-01-17 17:03:27 | I |         sum  error  = [    1.0476]
25-01-17 17:03:27 | I |         best error  = [    1.0476]
25-01-17 17:03:27 | I |     + error = [1.0476]
25-01-17 17:03:28 | I |       - range scale = [    1.0000]
25-01-17 17:03:28 | I |         sum  error  = [    0.4814]
25-01-17 17:03:28 | I |         best error  = [    0.4814]
25-01-17 17:03:28 | I |     + error = [0.4814]
25-01-17 17:03:29 | I |       - range scale = [    1.0000]
25-01-17 17:03:29 | I |         sum  error  = [    5.5039]
25-01-17 17:03:29 | I |         best error  = [    5.5039]
25-01-17 17:03:29 | I |     + error = [5.5039]
25-01-17 17:03:30 | I |       - range scale = [    1.0000]
25-01-17 17:03:30 | I |         sum  error  = [    2.5866]
25-01-17 17:03:30 | I |         best error  = [    2.5866]
25-01-17 17:03:30 | I |     + error = [2.5866]
25-01-17 17:03:30 | I |       - range scale = [    1.0000]
25-01-17 17:03:30 | I |         sum  error  = [   29.4842]
25-01-17 17:03:30 | I |         best error  = [   29.4842]
25-01-17 17:03:30 | I |     + error = [29.4842]
25-01-17 17:03:31 | I |       - range scale = [    1.0000]
25-01-17 17:03:31 | I |         sum  error  = [    0.1927]
25-01-17 17:03:31 | I |         best error  = [    0.1927]
25-01-17 17:03:31 | I |     + error = [0.1927]
25-01-17 17:03:32 | I |       - range scale = [    1.0000]
25-01-17 17:03:32 | I |         sum  error  = [    1.7468]
25-01-17 17:03:32 | I |         best error  = [    1.7468]
25-01-17 17:03:32 | I |     + error = [1.7468]
25-01-17 17:03:44 | I | in valid, quantize current layer acts
25-01-17 17:03:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:51 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 17:03:51 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:03:51 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:03:51 | I | - Evaluator: gptq
25-01-17 17:03:51 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:03:51 | I | - Batch_size: 8
25-01-17 17:03:51 | I |   + Max_seq_length: 2048
25-01-17 17:04:10 | I |     - Results:
25-01-17 17:04:10 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:04:10 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:04:10 | I |       |wikitext |      1|word_perplexity|7.7269|±  |7.7269|
25-01-17 17:04:10 | I |       |val_valid|      1|word_perplexity|7.4364|±  |7.4364|
25-01-17 17:04:10 | I |       
25-01-17 17:04:24 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.616, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.13, wps=36256.1, wpb=4058.2, bsz=2, num_updates=12, lmquant_ppl_wikitext_all_quanted=7.70752, lmquant_ppl_val_all_quanted=7.41357, lmquant_ppl_wikitext_partly_quanted=7.72689, lmquant_ppl_val_partly_quanted=7.43637
25-01-17 17:04:24 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.616 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.13 | wps 36256.1 | wpb 4058.2 | bsz 2 | num_updates 12 | lmquant_ppl_wikitext_all_quanted 7.70752 | lmquant_ppl_val_all_quanted 7.41357 | lmquant_ppl_wikitext_partly_quanted 7.72689 | lmquant_ppl_val_partly_quanted 7.43637
25-01-17 17:04:24 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:04:24 | I | in layer model.layers.4
25-01-17 17:04:24 | I | quantizing weights for layer model.layers.4
25-01-17 17:04:24 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:24 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:24 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:24 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:25 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:04:25 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:04:25 | I |       - range scale = [    1.0000]
25-01-17 17:04:25 | I |         sum  error  = [    0.2570]
25-01-17 17:04:25 | I |         best error  = [    0.2570]
25-01-17 17:04:25 | I |     + error = [0.2570]
25-01-17 17:04:26 | I |       - range scale = [    1.0000]
25-01-17 17:04:26 | I |         sum  error  = [    3.0410]
25-01-17 17:04:26 | I |         best error  = [    3.0410]
25-01-17 17:04:26 | I |     + error = [3.0410]
25-01-17 17:04:26 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:04:27 | I |       - range scale = [    1.0000]
25-01-17 17:04:27 | I |         sum  error  = [    0.2310]
25-01-17 17:04:27 | I |         best error  = [    0.2310]
25-01-17 17:04:27 | I |     + error = [0.2310]
25-01-17 17:04:28 | I |       - range scale = [    1.0000]
25-01-17 17:04:28 | I |         sum  error  = [    2.8800]
25-01-17 17:04:28 | I |         best error  = [    2.8800]
25-01-17 17:04:28 | I |     + error = [2.8800]
25-01-17 17:04:28 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:04:29 | I |       - range scale = [    1.0000]
25-01-17 17:04:29 | I |         sum  error  = [    0.0930]
25-01-17 17:04:29 | I |         best error  = [    0.0930]
25-01-17 17:04:29 | I |     + error = [0.0930]
25-01-17 17:04:29 | I |       - range scale = [    1.0000]
25-01-17 17:04:29 | I |         sum  error  = [    1.0532]
25-01-17 17:04:29 | I |         best error  = [    1.0532]
25-01-17 17:04:29 | I |     + error = [1.0532]
25-01-17 17:04:29 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:04:30 | I |       - range scale = [    1.0000]
25-01-17 17:04:30 | I |         sum  error  = [    0.1163]
25-01-17 17:04:30 | I |         best error  = [    0.1163]
25-01-17 17:04:30 | I |     + error = [0.1163]
25-01-17 17:04:31 | I |       - range scale = [    1.0000]
25-01-17 17:04:31 | I |         sum  error  = [    1.2717]
25-01-17 17:04:31 | I |         best error  = [    1.2717]
25-01-17 17:04:31 | I |     + error = [1.2717]
25-01-17 17:04:31 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:04:32 | I |       - range scale = [    1.0000]
25-01-17 17:04:32 | I |         sum  error  = [    0.4790]
25-01-17 17:04:32 | I |         best error  = [    0.4790]
25-01-17 17:04:32 | I |     + error = [0.4790]
25-01-17 17:04:32 | I |       - range scale = [    1.0000]
25-01-17 17:04:32 | I |         sum  error  = [    5.4634]
25-01-17 17:04:32 | I |         best error  = [    5.4634]
25-01-17 17:04:32 | I |     + error = [5.4634]
25-01-17 17:04:33 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:04:33 | I |       - range scale = [    1.0000]
25-01-17 17:04:33 | I |         sum  error  = [    2.5657]
25-01-17 17:04:33 | I |         best error  = [    2.5657]
25-01-17 17:04:33 | I |     + error = [2.5657]
25-01-17 17:04:34 | I |       - range scale = [    1.0000]
25-01-17 17:04:34 | I |         sum  error  = [   29.2863]
25-01-17 17:04:34 | I |         best error  = [   29.2863]
25-01-17 17:04:34 | I |     + error = [29.2863]
25-01-17 17:04:34 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:04:35 | I |       - range scale = [    1.0000]
25-01-17 17:04:35 | I |         sum  error  = [    0.1926]
25-01-17 17:04:35 | I |         best error  = [    0.1926]
25-01-17 17:04:35 | I |     + error = [0.1926]
25-01-17 17:04:36 | I |       - range scale = [    1.0000]
25-01-17 17:04:36 | I |         sum  error  = [    1.7543]
25-01-17 17:04:36 | I |         best error  = [    1.7543]
25-01-17 17:04:36 | I |     + error = [1.7543]
25-01-17 17:04:36 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:04:37 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:04:39 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:04:40 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:04:41 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:04:43 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:04:44 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:04:48 | I | quantizing activations for layer model.layers.4
25-01-17 17:04:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:50 | I | forward this layer
25-01-17 17:04:50 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/24.pt
25-01-17 17:04:50 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/24.pt
25-01-17 17:04:50 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:04:50 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:04:50 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:04:50 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:04:50 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:04:50 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:04:50 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:04:50 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:04:50 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:04:50 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:04:50 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:04:50 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:04:50 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:04:50 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:04:50 | I | in layer model.layers.4
25-01-17 17:04:50 | I | quantizing weights for layer model.layers.4
25-01-17 17:04:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:51 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:04:51 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:04:52 | I |       - range scale = [    1.0000]
25-01-17 17:04:52 | I |         sum  error  = [    0.2359]
25-01-17 17:04:52 | I |         best error  = [    0.2359]
25-01-17 17:04:52 | I |     + error = [0.2359]
25-01-17 17:04:53 | I |       - range scale = [    1.0000]
25-01-17 17:04:53 | I |         sum  error  = [    2.7304]
25-01-17 17:04:53 | I |         best error  = [    2.7304]
25-01-17 17:04:53 | I |     + error = [2.7304]
25-01-17 17:04:53 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:04:54 | I |       - range scale = [    1.0000]
25-01-17 17:04:54 | I |         sum  error  = [    0.2139]
25-01-17 17:04:54 | I |         best error  = [    0.2139]
25-01-17 17:04:54 | I |     + error = [0.2139]
25-01-17 17:04:54 | I |       - range scale = [    1.0000]
25-01-17 17:04:54 | I |         sum  error  = [    2.5545]
25-01-17 17:04:54 | I |         best error  = [    2.5545]
25-01-17 17:04:54 | I |     + error = [2.5545]
25-01-17 17:04:55 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:04:55 | I |       - range scale = [    1.0000]
25-01-17 17:04:55 | I |         sum  error  = [    0.0933]
25-01-17 17:04:55 | I |         best error  = [    0.0933]
25-01-17 17:04:55 | I |     + error = [0.0933]
25-01-17 17:04:56 | I |       - range scale = [    1.0000]
25-01-17 17:04:56 | I |         sum  error  = [    1.0544]
25-01-17 17:04:56 | I |         best error  = [    1.0544]
25-01-17 17:04:56 | I |     + error = [1.0544]
25-01-17 17:04:56 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:04:57 | I |       - range scale = [    1.0000]
25-01-17 17:04:57 | I |         sum  error  = [    0.1065]
25-01-17 17:04:57 | I |         best error  = [    0.1065]
25-01-17 17:04:57 | I |     + error = [0.1065]
25-01-17 17:04:57 | I |       - range scale = [    1.0000]
25-01-17 17:04:57 | I |         sum  error  = [    1.1646]
25-01-17 17:04:57 | I |         best error  = [    1.1646]
25-01-17 17:04:57 | I |     + error = [1.1646]
25-01-17 17:04:58 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:04:58 | I |       - range scale = [    1.0000]
25-01-17 17:04:58 | I |         sum  error  = [    0.4788]
25-01-17 17:04:58 | I |         best error  = [    0.4788]
25-01-17 17:04:58 | I |     + error = [0.4788]
25-01-17 17:04:59 | I |       - range scale = [    1.0000]
25-01-17 17:04:59 | I |         sum  error  = [    5.4646]
25-01-17 17:04:59 | I |         best error  = [    5.4646]
25-01-17 17:04:59 | I |     + error = [5.4646]
25-01-17 17:04:59 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:05:00 | I |       - range scale = [    1.0000]
25-01-17 17:05:00 | I |         sum  error  = [    2.5716]
25-01-17 17:05:00 | I |         best error  = [    2.5716]
25-01-17 17:05:00 | I |     + error = [2.5716]
25-01-17 17:05:01 | I |       - range scale = [    1.0000]
25-01-17 17:05:01 | I |         sum  error  = [   29.2983]
25-01-17 17:05:01 | I |         best error  = [   29.2983]
25-01-17 17:05:01 | I |     + error = [29.2983]
25-01-17 17:05:01 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:05:01 | I |       - range scale = [    1.0000]
25-01-17 17:05:01 | I |         sum  error  = [    0.1984]
25-01-17 17:05:01 | I |         best error  = [    0.1984]
25-01-17 17:05:01 | I |     + error = [0.1984]
25-01-17 17:05:02 | I |       - range scale = [    1.0000]
25-01-17 17:05:02 | I |         sum  error  = [    1.8095]
25-01-17 17:05:02 | I |         best error  = [    1.8095]
25-01-17 17:05:02 | I |     + error = [1.8095]
25-01-17 17:05:02 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:05:04 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:05:05 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:05:07 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:05:08 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:05:09 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:05:11 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:05:14 | I | quantizing activations for layer model.layers.4
25-01-17 17:05:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:17 | I | forward this layer
25-01-17 17:05:17 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/25.pt
25-01-17 17:05:17 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/25.pt
25-01-17 17:05:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:05:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:05:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:05:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:05:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:05:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:05:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:05:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:05:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:05:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:05:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:05:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:05:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:05:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:05:17 | I | [12] done with optimizer step
25-01-17 17:05:17 | I | epoch 001:     13 / 409600000 loss=9.7416e-06, loss_sum=0.221262, wps=221.1, ups=0.01, wpb=32768, bsz=64, num_updates=13, lr=0.0013, gnorm=0, clip=0, loss_scale=128, train_wall=53, cuda_gb_allocated=12.1, cuda_gb_reserved=13.6, cuda_gb_free=11.6, wall=2221
25-01-17 17:05:17 | I | begin validation on "valid" subset on rank 0
25-01-17 17:05:17 | I | got valid iterator on "valid" subset on rank 0
25-01-17 17:05:17 | I | Valid: Start iterating over samples
25-01-17 17:05:17 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:05:17 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:05:17 | I | - Evaluator: gptq
25-01-17 17:05:17 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:05:17 | I | - Batch_size: 8
25-01-17 17:05:17 | I |   + Max_seq_length: 2048
25-01-17 17:05:35 | I |     - Results:
25-01-17 17:05:35 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:05:35 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:05:35 | I |       |wikitext |      1|word_perplexity|7.7075|±  |7.7075|
25-01-17 17:05:35 | I |       |val_valid|      1|word_perplexity|7.4136|±  |7.4136|
25-01-17 17:05:35 | I |       
25-01-17 17:05:35 | I | in valid, quantize current layer weights
25-01-17 17:05:35 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 17:05:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:50 | I |       - range scale = [    1.0000]
25-01-17 17:05:50 | I |         sum  error  = [    0.6607]
25-01-17 17:05:50 | I |         best error  = [    0.6607]
25-01-17 17:05:50 | I |     + error = [0.6607]
25-01-17 17:05:51 | I |       - range scale = [    1.0000]
25-01-17 17:05:51 | I |         sum  error  = [    7.3391]
25-01-17 17:05:51 | I |         best error  = [    7.3391]
25-01-17 17:05:51 | I |     + error = [7.3391]
25-01-17 17:05:52 | I |       - range scale = [    1.0000]
25-01-17 17:05:52 | I |         sum  error  = [    0.6556]
25-01-17 17:05:52 | I |         best error  = [    0.6556]
25-01-17 17:05:52 | I |     + error = [0.6556]
25-01-17 17:05:53 | I |       - range scale = [    1.0000]
25-01-17 17:05:53 | I |         sum  error  = [    7.1260]
25-01-17 17:05:53 | I |         best error  = [    7.1260]
25-01-17 17:05:53 | I |     + error = [7.1260]
25-01-17 17:05:54 | I |       - range scale = [    1.0000]
25-01-17 17:05:54 | I |         sum  error  = [    0.0937]
25-01-17 17:05:54 | I |         best error  = [    0.0937]
25-01-17 17:05:54 | I |     + error = [0.0937]
25-01-17 17:05:55 | I |       - range scale = [    1.0000]
25-01-17 17:05:55 | I |         sum  error  = [    1.0592]
25-01-17 17:05:55 | I |         best error  = [    1.0592]
25-01-17 17:05:55 | I |     + error = [1.0592]
25-01-17 17:05:56 | I |       - range scale = [    1.0000]
25-01-17 17:05:56 | I |         sum  error  = [    0.0961]
25-01-17 17:05:56 | I |         best error  = [    0.0961]
25-01-17 17:05:56 | I |     + error = [0.0961]
25-01-17 17:05:56 | I |       - range scale = [    1.0000]
25-01-17 17:05:56 | I |         sum  error  = [    1.0476]
25-01-17 17:05:56 | I |         best error  = [    1.0476]
25-01-17 17:05:56 | I |     + error = [1.0476]
25-01-17 17:05:57 | I |       - range scale = [    1.0000]
25-01-17 17:05:57 | I |         sum  error  = [    0.4814]
25-01-17 17:05:57 | I |         best error  = [    0.4814]
25-01-17 17:05:57 | I |     + error = [0.4814]
25-01-17 17:05:58 | I |       - range scale = [    1.0000]
25-01-17 17:05:58 | I |         sum  error  = [    5.5039]
25-01-17 17:05:58 | I |         best error  = [    5.5039]
25-01-17 17:05:58 | I |     + error = [5.5039]
25-01-17 17:05:59 | I |       - range scale = [    1.0000]
25-01-17 17:05:59 | I |         sum  error  = [    2.5866]
25-01-17 17:05:59 | I |         best error  = [    2.5866]
25-01-17 17:05:59 | I |     + error = [2.5866]
25-01-17 17:05:59 | I |       - range scale = [    1.0000]
25-01-17 17:05:59 | I |         sum  error  = [   29.4842]
25-01-17 17:05:59 | I |         best error  = [   29.4842]
25-01-17 17:05:59 | I |     + error = [29.4842]
25-01-17 17:06:00 | I |       - range scale = [    1.0000]
25-01-17 17:06:00 | I |         sum  error  = [    0.1927]
25-01-17 17:06:00 | I |         best error  = [    0.1927]
25-01-17 17:06:00 | I |     + error = [0.1927]
25-01-17 17:06:01 | I |       - range scale = [    1.0000]
25-01-17 17:06:01 | I |         sum  error  = [    1.7468]
25-01-17 17:06:01 | I |         best error  = [    1.7468]
25-01-17 17:06:01 | I |     + error = [1.7468]
25-01-17 17:06:14 | I | in valid, quantize current layer acts
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:20 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 17:06:20 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:06:20 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:06:20 | I | - Evaluator: gptq
25-01-17 17:06:20 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:06:20 | I | - Batch_size: 8
25-01-17 17:06:20 | I |   + Max_seq_length: 2048
25-01-17 17:06:40 | I |     - Results:
25-01-17 17:06:40 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:06:40 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:06:40 | I |       |wikitext |      1|word_perplexity|7.7269|±  |7.7269|
25-01-17 17:06:40 | I |       |val_valid|      1|word_perplexity|7.4364|±  |7.4364|
25-01-17 17:06:40 | I |       
25-01-17 17:06:53 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.616, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.13, wps=36445.3, wpb=4058.2, bsz=2, num_updates=13, lmquant_ppl_wikitext_all_quanted=7.70752, lmquant_ppl_val_all_quanted=7.41357, lmquant_ppl_wikitext_partly_quanted=7.72689, lmquant_ppl_val_partly_quanted=7.43637
25-01-17 17:06:53 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.616 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.13 | wps 36445.3 | wpb 4058.2 | bsz 2 | num_updates 13 | lmquant_ppl_wikitext_all_quanted 7.70752 | lmquant_ppl_val_all_quanted 7.41357 | lmquant_ppl_wikitext_partly_quanted 7.72689 | lmquant_ppl_val_partly_quanted 7.43637
25-01-17 17:06:53 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:06:53 | I | in layer model.layers.4
25-01-17 17:06:53 | I | quantizing weights for layer model.layers.4
25-01-17 17:06:54 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:54 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:54 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:54 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:54 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:06:54 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:06:55 | I |       - range scale = [    1.0000]
25-01-17 17:06:55 | I |         sum  error  = [    0.2416]
25-01-17 17:06:55 | I |         best error  = [    0.2416]
25-01-17 17:06:55 | I |     + error = [0.2416]
25-01-17 17:06:56 | I |       - range scale = [    1.0000]
25-01-17 17:06:56 | I |         sum  error  = [    2.7620]
25-01-17 17:06:56 | I |         best error  = [    2.7620]
25-01-17 17:06:56 | I |     + error = [2.7620]
25-01-17 17:06:56 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:06:57 | I |       - range scale = [    1.0000]
25-01-17 17:06:57 | I |         sum  error  = [    0.2294]
25-01-17 17:06:57 | I |         best error  = [    0.2294]
25-01-17 17:06:57 | I |     + error = [0.2294]
25-01-17 17:06:57 | I |       - range scale = [    1.0000]
25-01-17 17:06:57 | I |         sum  error  = [    2.7112]
25-01-17 17:06:57 | I |         best error  = [    2.7112]
25-01-17 17:06:57 | I |     + error = [2.7112]
25-01-17 17:06:58 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:06:58 | I |       - range scale = [    1.0000]
25-01-17 17:06:58 | I |         sum  error  = [    0.0935]
25-01-17 17:06:58 | I |         best error  = [    0.0935]
25-01-17 17:06:58 | I |     + error = [0.0935]
25-01-17 17:06:59 | I |       - range scale = [    1.0000]
25-01-17 17:06:59 | I |         sum  error  = [    1.0526]
25-01-17 17:06:59 | I |         best error  = [    1.0526]
25-01-17 17:06:59 | I |     + error = [1.0526]
25-01-17 17:06:59 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:07:00 | I |       - range scale = [    1.0000]
25-01-17 17:07:00 | I |         sum  error  = [    0.1170]
25-01-17 17:07:00 | I |         best error  = [    0.1170]
25-01-17 17:07:00 | I |     + error = [0.1170]
25-01-17 17:07:00 | I |       - range scale = [    1.0000]
25-01-17 17:07:00 | I |         sum  error  = [    1.2755]
25-01-17 17:07:00 | I |         best error  = [    1.2755]
25-01-17 17:07:00 | I |     + error = [1.2755]
25-01-17 17:07:01 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:07:01 | I |       - range scale = [    1.0000]
25-01-17 17:07:01 | I |         sum  error  = [    0.4784]
25-01-17 17:07:01 | I |         best error  = [    0.4784]
25-01-17 17:07:01 | I |     + error = [0.4784]
25-01-17 17:07:02 | I |       - range scale = [    1.0000]
25-01-17 17:07:02 | I |         sum  error  = [    5.4632]
25-01-17 17:07:02 | I |         best error  = [    5.4632]
25-01-17 17:07:02 | I |     + error = [5.4632]
25-01-17 17:07:02 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:07:03 | I |       - range scale = [    1.0000]
25-01-17 17:07:03 | I |         sum  error  = [    2.5717]
25-01-17 17:07:03 | I |         best error  = [    2.5717]
25-01-17 17:07:03 | I |     + error = [2.5717]
25-01-17 17:07:04 | I |       - range scale = [    1.0000]
25-01-17 17:07:04 | I |         sum  error  = [   29.3033]
25-01-17 17:07:04 | I |         best error  = [   29.3033]
25-01-17 17:07:04 | I |     + error = [29.3033]
25-01-17 17:07:04 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:07:05 | I |       - range scale = [    1.0000]
25-01-17 17:07:05 | I |         sum  error  = [    0.2010]
25-01-17 17:07:05 | I |         best error  = [    0.2010]
25-01-17 17:07:05 | I |     + error = [0.2010]
25-01-17 17:07:05 | I |       - range scale = [    1.0000]
25-01-17 17:07:05 | I |         sum  error  = [    1.8174]
25-01-17 17:07:05 | I |         best error  = [    1.8174]
25-01-17 17:07:05 | I |     + error = [1.8174]
25-01-17 17:07:05 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:07:07 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:07:08 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:07:10 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:07:11 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:07:13 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:07:14 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:07:17 | I | quantizing activations for layer model.layers.4
25-01-17 17:07:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:20 | I | forward this layer
25-01-17 17:07:20 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/26.pt
25-01-17 17:07:20 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/26.pt
25-01-17 17:07:20 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:07:20 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:07:20 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:07:20 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:07:20 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:07:20 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:07:20 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:07:20 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:07:20 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:07:20 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:07:20 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:07:20 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:07:20 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:07:20 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:07:20 | I | in layer model.layers.4
25-01-17 17:07:20 | I | quantizing weights for layer model.layers.4
25-01-17 17:07:21 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:21 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:21 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:21 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:21 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:07:21 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:07:22 | I |       - range scale = [    1.0000]
25-01-17 17:07:22 | I |         sum  error  = [    0.2585]
25-01-17 17:07:22 | I |         best error  = [    0.2585]
25-01-17 17:07:22 | I |     + error = [0.2585]
25-01-17 17:07:23 | I |       - range scale = [    1.0000]
25-01-17 17:07:23 | I |         sum  error  = [    2.9500]
25-01-17 17:07:23 | I |         best error  = [    2.9500]
25-01-17 17:07:23 | I |     + error = [2.9500]
25-01-17 17:07:23 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:07:23 | I |       - range scale = [    1.0000]
25-01-17 17:07:23 | I |         sum  error  = [    0.2314]
25-01-17 17:07:23 | I |         best error  = [    0.2314]
25-01-17 17:07:23 | I |     + error = [0.2314]
25-01-17 17:07:24 | I |       - range scale = [    1.0000]
25-01-17 17:07:24 | I |         sum  error  = [    2.6936]
25-01-17 17:07:24 | I |         best error  = [    2.6936]
25-01-17 17:07:24 | I |     + error = [2.6936]
25-01-17 17:07:24 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:07:25 | I |       - range scale = [    1.0000]
25-01-17 17:07:25 | I |         sum  error  = [    0.0923]
25-01-17 17:07:25 | I |         best error  = [    0.0923]
25-01-17 17:07:25 | I |     + error = [0.0923]
25-01-17 17:07:26 | I |       - range scale = [    1.0000]
25-01-17 17:07:26 | I |         sum  error  = [    1.0525]
25-01-17 17:07:26 | I |         best error  = [    1.0525]
25-01-17 17:07:26 | I |     + error = [1.0525]
25-01-17 17:07:26 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:07:27 | I |       - range scale = [    1.0000]
25-01-17 17:07:27 | I |         sum  error  = [    0.1102]
25-01-17 17:07:27 | I |         best error  = [    0.1102]
25-01-17 17:07:27 | I |     + error = [0.1102]
25-01-17 17:07:27 | I |       - range scale = [    1.0000]
25-01-17 17:07:27 | I |         sum  error  = [    1.2022]
25-01-17 17:07:27 | I |         best error  = [    1.2022]
25-01-17 17:07:27 | I |     + error = [1.2022]
25-01-17 17:07:27 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:07:28 | I |       - range scale = [    1.0000]
25-01-17 17:07:28 | I |         sum  error  = [    0.4781]
25-01-17 17:07:28 | I |         best error  = [    0.4781]
25-01-17 17:07:28 | I |     + error = [0.4781]
25-01-17 17:07:29 | I |       - range scale = [    1.0000]
25-01-17 17:07:29 | I |         sum  error  = [    5.4635]
25-01-17 17:07:29 | I |         best error  = [    5.4635]
25-01-17 17:07:29 | I |     + error = [5.4635]
25-01-17 17:07:29 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:07:30 | I |       - range scale = [    1.0000]
25-01-17 17:07:30 | I |         sum  error  = [    2.5753]
25-01-17 17:07:30 | I |         best error  = [    2.5753]
25-01-17 17:07:30 | I |     + error = [2.5753]
25-01-17 17:07:30 | I |       - range scale = [    1.0000]
25-01-17 17:07:30 | I |         sum  error  = [   29.2843]
25-01-17 17:07:30 | I |         best error  = [   29.2843]
25-01-17 17:07:30 | I |     + error = [29.2843]
25-01-17 17:07:31 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:07:31 | I |       - range scale = [    1.0000]
25-01-17 17:07:31 | I |         sum  error  = [    0.1942]
25-01-17 17:07:31 | I |         best error  = [    0.1942]
25-01-17 17:07:31 | I |     + error = [0.1942]
25-01-17 17:07:32 | I |       - range scale = [    1.0000]
25-01-17 17:07:32 | I |         sum  error  = [    1.7437]
25-01-17 17:07:32 | I |         best error  = [    1.7437]
25-01-17 17:07:32 | I |     + error = [1.7437]
25-01-17 17:07:32 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:07:34 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:07:35 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:07:37 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:07:38 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:07:39 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:07:41 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:07:44 | I | quantizing activations for layer model.layers.4
25-01-17 17:07:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:47 | I | forward this layer
25-01-17 17:07:47 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/27.pt
25-01-17 17:07:47 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/27.pt
25-01-17 17:07:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:07:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:07:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:07:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:07:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:07:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:07:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:07:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:07:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:07:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:07:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:07:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:07:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:07:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:07:47 | I | [13] done with optimizer step
25-01-17 17:07:47 | I | epoch 001:     14 / 409600000 loss=1.0381e-05, loss_sum=0.235784, wps=218.1, ups=0.01, wpb=32768, bsz=64, num_updates=14, lr=0.0014, gnorm=0, clip=0, loss_scale=128, train_wall=54, cuda_gb_allocated=12.1, cuda_gb_reserved=13.6, cuda_gb_free=11.6, wall=2371
25-01-17 17:07:47 | I | begin validation on "valid" subset on rank 0
25-01-17 17:07:47 | I | got valid iterator on "valid" subset on rank 0
25-01-17 17:07:47 | I | Valid: Start iterating over samples
25-01-17 17:07:47 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:07:47 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:07:47 | I | - Evaluator: gptq
25-01-17 17:07:47 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:07:47 | I | - Batch_size: 8
25-01-17 17:07:47 | I |   + Max_seq_length: 2048
25-01-17 17:08:05 | I |     - Results:
25-01-17 17:08:05 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:08:05 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:08:05 | I |       |wikitext |      1|word_perplexity|7.7075|±  |7.7075|
25-01-17 17:08:05 | I |       |val_valid|      1|word_perplexity|7.4136|±  |7.4136|
25-01-17 17:08:05 | I |       
25-01-17 17:08:05 | I | in valid, quantize current layer weights
25-01-17 17:08:06 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 17:08:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:20 | I |       - range scale = [    1.0000]
25-01-17 17:08:20 | I |         sum  error  = [    0.6607]
25-01-17 17:08:20 | I |         best error  = [    0.6607]
25-01-17 17:08:20 | I |     + error = [0.6607]
25-01-17 17:08:21 | I |       - range scale = [    1.0000]
25-01-17 17:08:21 | I |         sum  error  = [    7.3391]
25-01-17 17:08:21 | I |         best error  = [    7.3391]
25-01-17 17:08:21 | I |     + error = [7.3391]
25-01-17 17:08:22 | I |       - range scale = [    1.0000]
25-01-17 17:08:22 | I |         sum  error  = [    0.6556]
25-01-17 17:08:22 | I |         best error  = [    0.6556]
25-01-17 17:08:22 | I |     + error = [0.6556]
25-01-17 17:08:23 | I |       - range scale = [    1.0000]
25-01-17 17:08:23 | I |         sum  error  = [    7.1260]
25-01-17 17:08:23 | I |         best error  = [    7.1260]
25-01-17 17:08:23 | I |     + error = [7.1260]
25-01-17 17:08:24 | I |       - range scale = [    1.0000]
25-01-17 17:08:24 | I |         sum  error  = [    0.0937]
25-01-17 17:08:24 | I |         best error  = [    0.0937]
25-01-17 17:08:24 | I |     + error = [0.0937]
25-01-17 17:08:24 | I |       - range scale = [    1.0000]
25-01-17 17:08:24 | I |         sum  error  = [    1.0592]
25-01-17 17:08:24 | I |         best error  = [    1.0592]
25-01-17 17:08:24 | I |     + error = [1.0592]
25-01-17 17:08:25 | I |       - range scale = [    1.0000]
25-01-17 17:08:25 | I |         sum  error  = [    0.0961]
25-01-17 17:08:25 | I |         best error  = [    0.0961]
25-01-17 17:08:25 | I |     + error = [0.0961]
25-01-17 17:08:26 | I |       - range scale = [    1.0000]
25-01-17 17:08:26 | I |         sum  error  = [    1.0476]
25-01-17 17:08:26 | I |         best error  = [    1.0476]
25-01-17 17:08:26 | I |     + error = [1.0476]
25-01-17 17:08:27 | I |       - range scale = [    1.0000]
25-01-17 17:08:27 | I |         sum  error  = [    0.4814]
25-01-17 17:08:27 | I |         best error  = [    0.4814]
25-01-17 17:08:27 | I |     + error = [0.4814]
25-01-17 17:08:28 | I |       - range scale = [    1.0000]
25-01-17 17:08:28 | I |         sum  error  = [    5.5039]
25-01-17 17:08:28 | I |         best error  = [    5.5039]
25-01-17 17:08:28 | I |     + error = [5.5039]
25-01-17 17:08:28 | I |       - range scale = [    1.0000]
25-01-17 17:08:28 | I |         sum  error  = [    2.5866]
25-01-17 17:08:28 | I |         best error  = [    2.5866]
25-01-17 17:08:28 | I |     + error = [2.5866]
25-01-17 17:08:29 | I |       - range scale = [    1.0000]
25-01-17 17:08:29 | I |         sum  error  = [   29.4842]
25-01-17 17:08:29 | I |         best error  = [   29.4842]
25-01-17 17:08:29 | I |     + error = [29.4842]
25-01-17 17:08:30 | I |       - range scale = [    1.0000]
25-01-17 17:08:30 | I |         sum  error  = [    0.1927]
25-01-17 17:08:30 | I |         best error  = [    0.1927]
25-01-17 17:08:30 | I |     + error = [0.1927]
25-01-17 17:08:31 | I |       - range scale = [    1.0000]
25-01-17 17:08:31 | I |         sum  error  = [    1.7468]
25-01-17 17:08:31 | I |         best error  = [    1.7468]
25-01-17 17:08:31 | I |     + error = [1.7468]
25-01-17 17:08:43 | I | in valid, quantize current layer acts
25-01-17 17:08:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:50 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 17:08:50 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:08:50 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:08:50 | I | - Evaluator: gptq
25-01-17 17:08:50 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:08:50 | I | - Batch_size: 8
25-01-17 17:08:50 | I |   + Max_seq_length: 2048
25-01-17 17:09:09 | I |     - Results:
25-01-17 17:09:09 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:09:09 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:09:09 | I |       |wikitext |      1|word_perplexity|7.7269|±  |7.7269|
25-01-17 17:09:09 | I |       |val_valid|      1|word_perplexity|7.4364|±  |7.4364|
25-01-17 17:09:09 | I |       
25-01-17 17:09:22 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.616, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.13, wps=36401, wpb=4058.2, bsz=2, num_updates=14, lmquant_ppl_wikitext_all_quanted=7.70752, lmquant_ppl_val_all_quanted=7.41357, lmquant_ppl_wikitext_partly_quanted=7.72689, lmquant_ppl_val_partly_quanted=7.43637
25-01-17 17:09:22 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.616 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.13 | wps 36401 | wpb 4058.2 | bsz 2 | num_updates 14 | lmquant_ppl_wikitext_all_quanted 7.70752 | lmquant_ppl_val_all_quanted 7.41357 | lmquant_ppl_wikitext_partly_quanted 7.72689 | lmquant_ppl_val_partly_quanted 7.43637
25-01-17 17:09:23 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:09:23 | I | in layer model.layers.4
25-01-17 17:09:23 | I | quantizing weights for layer model.layers.4
25-01-17 17:09:23 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:23 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:23 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:23 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:24 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:09:24 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:09:24 | I |       - range scale = [    1.0000]
25-01-17 17:09:24 | I |         sum  error  = [    0.2781]
25-01-17 17:09:24 | I |         best error  = [    0.2781]
25-01-17 17:09:24 | I |     + error = [0.2781]
25-01-17 17:09:25 | I |       - range scale = [    1.0000]
25-01-17 17:09:25 | I |         sum  error  = [    3.2472]
25-01-17 17:09:25 | I |         best error  = [    3.2472]
25-01-17 17:09:25 | I |     + error = [3.2472]
25-01-17 17:09:25 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:09:26 | I |       - range scale = [    1.0000]
25-01-17 17:09:26 | I |         sum  error  = [    0.2513]
25-01-17 17:09:26 | I |         best error  = [    0.2513]
25-01-17 17:09:26 | I |     + error = [0.2513]
25-01-17 17:09:27 | I |       - range scale = [    1.0000]
25-01-17 17:09:27 | I |         sum  error  = [    3.0223]
25-01-17 17:09:27 | I |         best error  = [    3.0223]
25-01-17 17:09:27 | I |     + error = [3.0223]
25-01-17 17:09:27 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:09:27 | I |       - range scale = [    1.0000]
25-01-17 17:09:27 | I |         sum  error  = [    0.0936]
25-01-17 17:09:27 | I |         best error  = [    0.0936]
25-01-17 17:09:27 | I |     + error = [0.0936]
25-01-17 17:09:28 | I |       - range scale = [    1.0000]
25-01-17 17:09:28 | I |         sum  error  = [    1.0545]
25-01-17 17:09:28 | I |         best error  = [    1.0545]
25-01-17 17:09:28 | I |     + error = [1.0545]
25-01-17 17:09:28 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:09:29 | I |       - range scale = [    1.0000]
25-01-17 17:09:29 | I |         sum  error  = [    0.1220]
25-01-17 17:09:29 | I |         best error  = [    0.1220]
25-01-17 17:09:29 | I |     + error = [0.1220]
25-01-17 17:09:30 | I |       - range scale = [    1.0000]
25-01-17 17:09:30 | I |         sum  error  = [    1.3210]
25-01-17 17:09:30 | I |         best error  = [    1.3210]
25-01-17 17:09:30 | I |     + error = [1.3210]
25-01-17 17:09:30 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:09:30 | I |       - range scale = [    1.0000]
25-01-17 17:09:30 | I |         sum  error  = [    0.4779]
25-01-17 17:09:30 | I |         best error  = [    0.4779]
25-01-17 17:09:30 | I |     + error = [0.4779]
25-01-17 17:09:31 | I |       - range scale = [    1.0000]
25-01-17 17:09:31 | I |         sum  error  = [    5.4672]
25-01-17 17:09:31 | I |         best error  = [    5.4672]
25-01-17 17:09:31 | I |     + error = [5.4672]
25-01-17 17:09:31 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:09:32 | I |       - range scale = [    1.0000]
25-01-17 17:09:32 | I |         sum  error  = [    2.5738]
25-01-17 17:09:32 | I |         best error  = [    2.5738]
25-01-17 17:09:32 | I |     + error = [2.5738]
25-01-17 17:09:33 | I |       - range scale = [    1.0000]
25-01-17 17:09:33 | I |         sum  error  = [   29.3017]
25-01-17 17:09:33 | I |         best error  = [   29.3017]
25-01-17 17:09:33 | I |     + error = [29.3017]
25-01-17 17:09:33 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:09:34 | I |       - range scale = [    1.0000]
25-01-17 17:09:34 | I |         sum  error  = [    0.2008]
25-01-17 17:09:34 | I |         best error  = [    0.2008]
25-01-17 17:09:34 | I |     + error = [0.2008]
25-01-17 17:09:34 | I |       - range scale = [    1.0000]
25-01-17 17:09:34 | I |         sum  error  = [    1.8169]
25-01-17 17:09:34 | I |         best error  = [    1.8169]
25-01-17 17:09:34 | I |     + error = [1.8169]
25-01-17 17:09:35 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:09:36 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:09:37 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:09:39 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:09:40 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:09:42 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:09:43 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:09:46 | I | quantizing activations for layer model.layers.4
25-01-17 17:09:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:49 | I | forward this layer
25-01-17 17:09:49 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/28.pt
25-01-17 17:09:49 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/28.pt
25-01-17 17:09:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:09:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:09:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:09:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:09:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:09:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:09:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:09:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:09:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:09:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:09:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:09:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:09:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:09:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:09:49 | I | in layer model.layers.4
25-01-17 17:09:49 | I | quantizing weights for layer model.layers.4
25-01-17 17:09:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:50 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:09:50 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:09:51 | I |       - range scale = [    1.0000]
25-01-17 17:09:51 | I |         sum  error  = [    0.2391]
25-01-17 17:09:51 | I |         best error  = [    0.2391]
25-01-17 17:09:51 | I |     + error = [0.2391]
25-01-17 17:09:51 | I |       - range scale = [    1.0000]
25-01-17 17:09:51 | I |         sum  error  = [    2.7759]
25-01-17 17:09:51 | I |         best error  = [    2.7759]
25-01-17 17:09:51 | I |     + error = [2.7759]
25-01-17 17:09:52 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:09:52 | I |       - range scale = [    1.0000]
25-01-17 17:09:52 | I |         sum  error  = [    0.2239]
25-01-17 17:09:52 | I |         best error  = [    0.2239]
25-01-17 17:09:52 | I |     + error = [0.2239]
25-01-17 17:09:53 | I |       - range scale = [    1.0000]
25-01-17 17:09:53 | I |         sum  error  = [    2.8799]
25-01-17 17:09:53 | I |         best error  = [    2.8799]
25-01-17 17:09:53 | I |     + error = [2.8799]
25-01-17 17:09:53 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:09:54 | I |       - range scale = [    1.0000]
25-01-17 17:09:54 | I |         sum  error  = [    0.0938]
25-01-17 17:09:54 | I |         best error  = [    0.0938]
25-01-17 17:09:54 | I |     + error = [0.0938]
25-01-17 17:09:54 | I |       - range scale = [    1.0000]
25-01-17 17:09:54 | I |         sum  error  = [    1.0570]
25-01-17 17:09:54 | I |         best error  = [    1.0570]
25-01-17 17:09:54 | I |     + error = [1.0570]
25-01-17 17:09:55 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:09:55 | I |       - range scale = [    1.0000]
25-01-17 17:09:55 | I |         sum  error  = [    0.1133]
25-01-17 17:09:55 | I |         best error  = [    0.1133]
25-01-17 17:09:55 | I |     + error = [0.1133]
25-01-17 17:09:56 | I |       - range scale = [    1.0000]
25-01-17 17:09:56 | I |         sum  error  = [    1.2455]
25-01-17 17:09:56 | I |         best error  = [    1.2455]
25-01-17 17:09:56 | I |     + error = [1.2455]
25-01-17 17:09:56 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:09:57 | I |       - range scale = [    1.0000]
25-01-17 17:09:57 | I |         sum  error  = [    0.4780]
25-01-17 17:09:57 | I |         best error  = [    0.4780]
25-01-17 17:09:57 | I |     + error = [0.4780]
25-01-17 17:09:58 | I |       - range scale = [    1.0000]
25-01-17 17:09:58 | I |         sum  error  = [    5.4652]
25-01-17 17:09:58 | I |         best error  = [    5.4652]
25-01-17 17:09:58 | I |     + error = [5.4652]
25-01-17 17:09:58 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:09:58 | I |       - range scale = [    1.0000]
25-01-17 17:09:58 | I |         sum  error  = [    2.5696]
25-01-17 17:09:58 | I |         best error  = [    2.5696]
25-01-17 17:09:58 | I |     + error = [2.5696]
25-01-17 17:09:59 | I |       - range scale = [    1.0000]
25-01-17 17:09:59 | I |         sum  error  = [   29.3186]
25-01-17 17:09:59 | I |         best error  = [   29.3186]
25-01-17 17:09:59 | I |     + error = [29.3186]
25-01-17 17:09:59 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:10:00 | I |       - range scale = [    1.0000]
25-01-17 17:10:00 | I |         sum  error  = [    0.1965]
25-01-17 17:10:00 | I |         best error  = [    0.1965]
25-01-17 17:10:00 | I |     + error = [0.1965]
25-01-17 17:10:01 | I |       - range scale = [    1.0000]
25-01-17 17:10:01 | I |         sum  error  = [    1.7865]
25-01-17 17:10:01 | I |         best error  = [    1.7865]
25-01-17 17:10:01 | I |     + error = [1.7865]
25-01-17 17:10:01 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:10:02 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:10:04 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:10:05 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:10:07 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:10:08 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:10:09 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:10:13 | I | quantizing activations for layer model.layers.4
25-01-17 17:10:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:15 | I | forward this layer
25-01-17 17:10:15 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/29.pt
25-01-17 17:10:15 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/29.pt
25-01-17 17:10:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:10:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:10:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:10:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:10:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:10:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:10:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:10:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:10:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:10:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:10:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:10:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:10:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:10:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:10:15 | I | [14] done with optimizer step
25-01-17 17:10:16 | I | epoch 001:     15 / 409600000 loss=8.7112e-06, loss_sum=0.197859, wps=220.8, ups=0.01, wpb=32768, bsz=64, num_updates=15, lr=0.0015, gnorm=0, clip=0, loss_scale=128, train_wall=53, cuda_gb_allocated=12.1, cuda_gb_reserved=13.6, cuda_gb_free=11.6, wall=2520
25-01-17 17:10:16 | I | begin validation on "valid" subset on rank 0
25-01-17 17:10:16 | I | got valid iterator on "valid" subset on rank 0
25-01-17 17:10:16 | I | Valid: Start iterating over samples
25-01-17 17:10:16 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:10:16 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:10:16 | I | - Evaluator: gptq
25-01-17 17:10:16 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:10:16 | I | - Batch_size: 8
25-01-17 17:10:16 | I |   + Max_seq_length: 2048
25-01-17 17:10:33 | I |     - Results:
25-01-17 17:10:33 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:10:33 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:10:33 | I |       |wikitext |      1|word_perplexity|7.7075|±  |7.7075|
25-01-17 17:10:33 | I |       |val_valid|      1|word_perplexity|7.4136|±  |7.4136|
25-01-17 17:10:33 | I |       
25-01-17 17:10:33 | I | in valid, quantize current layer weights
25-01-17 17:10:34 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I |       - range scale = [    1.0000]
25-01-17 17:10:48 | I |         sum  error  = [    0.6607]
25-01-17 17:10:48 | I |         best error  = [    0.6607]
25-01-17 17:10:48 | I |     + error = [0.6607]
25-01-17 17:10:49 | I |       - range scale = [    1.0000]
25-01-17 17:10:49 | I |         sum  error  = [    7.3391]
25-01-17 17:10:49 | I |         best error  = [    7.3391]
25-01-17 17:10:49 | I |     + error = [7.3391]
25-01-17 17:10:51 | I |       - range scale = [    1.0000]
25-01-17 17:10:51 | I |         sum  error  = [    0.6556]
25-01-17 17:10:51 | I |         best error  = [    0.6556]
25-01-17 17:10:51 | I |     + error = [0.6556]
25-01-17 17:10:51 | I |       - range scale = [    1.0000]
25-01-17 17:10:51 | I |         sum  error  = [    7.1260]
25-01-17 17:10:51 | I |         best error  = [    7.1260]
25-01-17 17:10:51 | I |     + error = [7.1260]
25-01-17 17:10:52 | I |       - range scale = [    1.0000]
25-01-17 17:10:52 | I |         sum  error  = [    0.0937]
25-01-17 17:10:52 | I |         best error  = [    0.0937]
25-01-17 17:10:52 | I |     + error = [0.0937]
25-01-17 17:10:53 | I |       - range scale = [    1.0000]
25-01-17 17:10:53 | I |         sum  error  = [    1.0592]
25-01-17 17:10:53 | I |         best error  = [    1.0592]
25-01-17 17:10:53 | I |     + error = [1.0592]
25-01-17 17:10:54 | I |       - range scale = [    1.0000]
25-01-17 17:10:54 | I |         sum  error  = [    0.0961]
25-01-17 17:10:54 | I |         best error  = [    0.0961]
25-01-17 17:10:54 | I |     + error = [0.0961]
25-01-17 17:10:55 | I |       - range scale = [    1.0000]
25-01-17 17:10:55 | I |         sum  error  = [    1.0476]
25-01-17 17:10:55 | I |         best error  = [    1.0476]
25-01-17 17:10:55 | I |     + error = [1.0476]
25-01-17 17:10:55 | I |       - range scale = [    1.0000]
25-01-17 17:10:55 | I |         sum  error  = [    0.4814]
25-01-17 17:10:55 | I |         best error  = [    0.4814]
25-01-17 17:10:55 | I |     + error = [0.4814]
25-01-17 17:10:56 | I |       - range scale = [    1.0000]
25-01-17 17:10:56 | I |         sum  error  = [    5.5039]
25-01-17 17:10:56 | I |         best error  = [    5.5039]
25-01-17 17:10:56 | I |     + error = [5.5039]
25-01-17 17:10:57 | I |       - range scale = [    1.0000]
25-01-17 17:10:57 | I |         sum  error  = [    2.5866]
25-01-17 17:10:57 | I |         best error  = [    2.5866]
25-01-17 17:10:57 | I |     + error = [2.5866]
25-01-17 17:10:58 | I |       - range scale = [    1.0000]
25-01-17 17:10:58 | I |         sum  error  = [   29.4842]
25-01-17 17:10:58 | I |         best error  = [   29.4842]
25-01-17 17:10:58 | I |     + error = [29.4842]
25-01-17 17:10:59 | I |       - range scale = [    1.0000]
25-01-17 17:10:59 | I |         sum  error  = [    0.1927]
25-01-17 17:10:59 | I |         best error  = [    0.1927]
25-01-17 17:10:59 | I |     + error = [0.1927]
25-01-17 17:10:59 | I |       - range scale = [    1.0000]
25-01-17 17:10:59 | I |         sum  error  = [    1.7468]
25-01-17 17:10:59 | I |         best error  = [    1.7468]
25-01-17 17:10:59 | I |     + error = [1.7468]
25-01-17 17:11:12 | I | in valid, quantize current layer acts
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 17:11:18 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:11:18 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:11:18 | I | - Evaluator: gptq
25-01-17 17:11:18 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:11:18 | I | - Batch_size: 8
25-01-17 17:11:18 | I |   + Max_seq_length: 2048
25-01-17 17:11:38 | I |     - Results:
25-01-17 17:11:38 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:11:38 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:11:38 | I |       |wikitext |      1|word_perplexity|7.7269|±  |7.7269|
25-01-17 17:11:38 | I |       |val_valid|      1|word_perplexity|7.4364|±  |7.4364|
25-01-17 17:11:38 | I |       
25-01-17 17:11:51 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.616, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.13, wps=36481.2, wpb=4058.2, bsz=2, num_updates=15, lmquant_ppl_wikitext_all_quanted=7.70752, lmquant_ppl_val_all_quanted=7.41357, lmquant_ppl_wikitext_partly_quanted=7.72689, lmquant_ppl_val_partly_quanted=7.43637
25-01-17 17:11:51 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.616 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.13 | wps 36481.2 | wpb 4058.2 | bsz 2 | num_updates 15 | lmquant_ppl_wikitext_all_quanted 7.70752 | lmquant_ppl_val_all_quanted 7.41357 | lmquant_ppl_wikitext_partly_quanted 7.72689 | lmquant_ppl_val_partly_quanted 7.43637
25-01-17 17:11:51 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:11:51 | I | in layer model.layers.4
25-01-17 17:11:51 | I | quantizing weights for layer model.layers.4
25-01-17 17:11:52 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:52 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:52 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:52 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:52 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:11:52 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:11:53 | I |       - range scale = [    1.0000]
25-01-17 17:11:53 | I |         sum  error  = [    0.2863]
25-01-17 17:11:53 | I |         best error  = [    0.2863]
25-01-17 17:11:53 | I |     + error = [0.2863]
25-01-17 17:11:54 | I |       - range scale = [    1.0000]
25-01-17 17:11:54 | I |         sum  error  = [    3.0365]
25-01-17 17:11:54 | I |         best error  = [    3.0365]
25-01-17 17:11:54 | I |     + error = [3.0365]
25-01-17 17:11:54 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:11:55 | I |       - range scale = [    1.0000]
25-01-17 17:11:55 | I |         sum  error  = [    0.2724]
25-01-17 17:11:55 | I |         best error  = [    0.2724]
25-01-17 17:11:55 | I |     + error = [0.2724]
25-01-17 17:11:55 | I |       - range scale = [    1.0000]
25-01-17 17:11:55 | I |         sum  error  = [    3.3111]
25-01-17 17:11:55 | I |         best error  = [    3.3111]
25-01-17 17:11:55 | I |     + error = [3.3111]
25-01-17 17:11:55 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:11:56 | I |       - range scale = [    1.0000]
25-01-17 17:11:56 | I |         sum  error  = [    0.0934]
25-01-17 17:11:56 | I |         best error  = [    0.0934]
25-01-17 17:11:56 | I |     + error = [0.0934]
25-01-17 17:11:57 | I |       - range scale = [    1.0000]
25-01-17 17:11:57 | I |         sum  error  = [    1.0534]
25-01-17 17:11:57 | I |         best error  = [    1.0534]
25-01-17 17:11:57 | I |     + error = [1.0534]
25-01-17 17:11:57 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:11:58 | I |       - range scale = [    1.0000]
25-01-17 17:11:58 | I |         sum  error  = [    0.1149]
25-01-17 17:11:58 | I |         best error  = [    0.1149]
25-01-17 17:11:58 | I |     + error = [0.1149]
25-01-17 17:11:58 | I |       - range scale = [    1.0000]
25-01-17 17:11:58 | I |         sum  error  = [    1.2612]
25-01-17 17:11:58 | I |         best error  = [    1.2612]
25-01-17 17:11:58 | I |     + error = [1.2612]
25-01-17 17:11:58 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:11:59 | I |       - range scale = [    1.0000]
25-01-17 17:11:59 | I |         sum  error  = [    0.4782]
25-01-17 17:11:59 | I |         best error  = [    0.4782]
25-01-17 17:11:59 | I |     + error = [0.4782]
25-01-17 17:12:00 | I |       - range scale = [    1.0000]
25-01-17 17:12:00 | I |         sum  error  = [    5.4615]
25-01-17 17:12:00 | I |         best error  = [    5.4615]
25-01-17 17:12:00 | I |     + error = [5.4615]
25-01-17 17:12:00 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:12:01 | I |       - range scale = [    1.0000]
25-01-17 17:12:01 | I |         sum  error  = [    2.5719]
25-01-17 17:12:01 | I |         best error  = [    2.5719]
25-01-17 17:12:01 | I |     + error = [2.5719]
25-01-17 17:12:01 | I |       - range scale = [    1.0000]
25-01-17 17:12:01 | I |         sum  error  = [   29.2812]
25-01-17 17:12:01 | I |         best error  = [   29.2812]
25-01-17 17:12:01 | I |     + error = [29.2812]
25-01-17 17:12:02 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:12:02 | I |       - range scale = [    1.0000]
25-01-17 17:12:02 | I |         sum  error  = [    0.2026]
25-01-17 17:12:02 | I |         best error  = [    0.2026]
25-01-17 17:12:02 | I |     + error = [0.2026]
25-01-17 17:12:03 | I |       - range scale = [    1.0000]
25-01-17 17:12:03 | I |         sum  error  = [    1.8331]
25-01-17 17:12:03 | I |         best error  = [    1.8331]
25-01-17 17:12:03 | I |     + error = [1.8331]
25-01-17 17:12:03 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:12:05 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:12:06 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:12:07 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:12:09 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:12:10 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:12:12 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:12:15 | I | quantizing activations for layer model.layers.4
25-01-17 17:12:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:17 | I | forward this layer
25-01-17 17:12:17 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/30.pt
25-01-17 17:12:17 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/30.pt
25-01-17 17:12:18 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:12:18 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:12:18 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:12:18 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:12:18 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:12:18 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:12:18 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:12:18 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:12:18 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:12:18 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:12:18 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:12:18 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:12:18 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:12:18 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:12:18 | I | in layer model.layers.4
25-01-17 17:12:18 | I | quantizing weights for layer model.layers.4
25-01-17 17:12:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:19 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:12:19 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:12:19 | I |       - range scale = [    1.0000]
25-01-17 17:12:19 | I |         sum  error  = [    0.2336]
25-01-17 17:12:19 | I |         best error  = [    0.2336]
25-01-17 17:12:19 | I |     + error = [0.2336]
25-01-17 17:12:20 | I |       - range scale = [    1.0000]
25-01-17 17:12:20 | I |         sum  error  = [    2.6056]
25-01-17 17:12:20 | I |         best error  = [    2.6056]
25-01-17 17:12:20 | I |     + error = [2.6056]
25-01-17 17:12:20 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:12:21 | I |       - range scale = [    1.0000]
25-01-17 17:12:21 | I |         sum  error  = [    0.2186]
25-01-17 17:12:21 | I |         best error  = [    0.2186]
25-01-17 17:12:21 | I |     + error = [0.2186]
25-01-17 17:12:22 | I |       - range scale = [    1.0000]
25-01-17 17:12:22 | I |         sum  error  = [    2.6188]
25-01-17 17:12:22 | I |         best error  = [    2.6188]
25-01-17 17:12:22 | I |     + error = [2.6188]
25-01-17 17:12:22 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:12:23 | I |       - range scale = [    1.0000]
25-01-17 17:12:23 | I |         sum  error  = [    0.0929]
25-01-17 17:12:23 | I |         best error  = [    0.0929]
25-01-17 17:12:23 | I |     + error = [0.0929]
25-01-17 17:12:23 | I |       - range scale = [    1.0000]
25-01-17 17:12:23 | I |         sum  error  = [    1.0531]
25-01-17 17:12:23 | I |         best error  = [    1.0531]
25-01-17 17:12:23 | I |     + error = [1.0531]
25-01-17 17:12:23 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:12:24 | I |       - range scale = [    1.0000]
25-01-17 17:12:24 | I |         sum  error  = [    0.1113]
25-01-17 17:12:24 | I |         best error  = [    0.1113]
25-01-17 17:12:24 | I |     + error = [0.1113]
25-01-17 17:12:25 | I |       - range scale = [    1.0000]
25-01-17 17:12:25 | I |         sum  error  = [    1.2326]
25-01-17 17:12:25 | I |         best error  = [    1.2326]
25-01-17 17:12:25 | I |     + error = [1.2326]
25-01-17 17:12:25 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:12:26 | I |       - range scale = [    1.0000]
25-01-17 17:12:26 | I |         sum  error  = [    0.4789]
25-01-17 17:12:26 | I |         best error  = [    0.4789]
25-01-17 17:12:26 | I |     + error = [0.4789]
25-01-17 17:12:26 | I |       - range scale = [    1.0000]
25-01-17 17:12:26 | I |         sum  error  = [    5.4624]
25-01-17 17:12:26 | I |         best error  = [    5.4624]
25-01-17 17:12:26 | I |     + error = [5.4624]
25-01-17 17:12:27 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:12:27 | I |       - range scale = [    1.0000]
25-01-17 17:12:27 | I |         sum  error  = [    2.5746]
25-01-17 17:12:27 | I |         best error  = [    2.5746]
25-01-17 17:12:27 | I |     + error = [2.5746]
25-01-17 17:12:28 | I |       - range scale = [    1.0000]
25-01-17 17:12:28 | I |         sum  error  = [   29.2908]
25-01-17 17:12:28 | I |         best error  = [   29.2908]
25-01-17 17:12:28 | I |     + error = [29.2908]
25-01-17 17:12:28 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:12:29 | I |       - range scale = [    1.0000]
25-01-17 17:12:29 | I |         sum  error  = [    0.2018]
25-01-17 17:12:29 | I |         best error  = [    0.2018]
25-01-17 17:12:29 | I |     + error = [0.2018]
25-01-17 17:12:29 | I |       - range scale = [    1.0000]
25-01-17 17:12:29 | I |         sum  error  = [    1.8311]
25-01-17 17:12:29 | I |         best error  = [    1.8311]
25-01-17 17:12:29 | I |     + error = [1.8311]
25-01-17 17:12:30 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:12:31 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:12:32 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:12:34 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:12:35 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:12:37 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:12:38 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:12:41 | I | quantizing activations for layer model.layers.4
25-01-17 17:12:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:44 | I | forward this layer
25-01-17 17:12:44 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/31.pt
25-01-17 17:12:44 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/31.pt
25-01-17 17:12:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:12:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:12:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:12:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:12:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:12:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:12:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:12:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:12:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:12:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:12:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:12:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:12:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:12:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:12:44 | I | [15] done with optimizer step
25-01-17 17:12:44 | I | epoch 001:     16 / 409600000 loss=1.0509e-05, loss_sum=0.238691, wps=220.6, ups=0.01, wpb=32768, bsz=64, num_updates=16, lr=0.0016, gnorm=0, clip=0, loss_scale=128, train_wall=53, cuda_gb_allocated=12.1, cuda_gb_reserved=13.5, cuda_gb_free=11.6, wall=2668
25-01-17 17:12:44 | I | begin validation on "valid" subset on rank 0
25-01-17 17:12:44 | I | got valid iterator on "valid" subset on rank 0
25-01-17 17:12:44 | I | Valid: Start iterating over samples
25-01-17 17:12:44 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:12:44 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:12:44 | I | - Evaluator: gptq
25-01-17 17:12:44 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:12:44 | I | - Batch_size: 8
25-01-17 17:12:44 | I |   + Max_seq_length: 2048
25-01-17 17:13:02 | I |     - Results:
25-01-17 17:13:02 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:13:02 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:13:02 | I |       |wikitext |      1|word_perplexity|7.7074|±  |7.7074|
25-01-17 17:13:02 | I |       |val_valid|      1|word_perplexity|7.4137|±  |7.4137|
25-01-17 17:13:02 | I |       
25-01-17 17:13:02 | I | in valid, quantize current layer weights
25-01-17 17:13:03 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 17:13:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:17 | I |       - range scale = [    1.0000]
25-01-17 17:13:17 | I |         sum  error  = [    0.6608]
25-01-17 17:13:17 | I |         best error  = [    0.6608]
25-01-17 17:13:17 | I |     + error = [0.6608]
25-01-17 17:13:18 | I |       - range scale = [    1.0000]
25-01-17 17:13:18 | I |         sum  error  = [    7.3390]
25-01-17 17:13:18 | I |         best error  = [    7.3390]
25-01-17 17:13:18 | I |     + error = [7.3390]
25-01-17 17:13:19 | I |       - range scale = [    1.0000]
25-01-17 17:13:19 | I |         sum  error  = [    0.6555]
25-01-17 17:13:19 | I |         best error  = [    0.6555]
25-01-17 17:13:19 | I |     + error = [0.6555]
25-01-17 17:13:20 | I |       - range scale = [    1.0000]
25-01-17 17:13:20 | I |         sum  error  = [    7.1265]
25-01-17 17:13:20 | I |         best error  = [    7.1265]
25-01-17 17:13:20 | I |     + error = [7.1265]
25-01-17 17:13:21 | I |       - range scale = [    1.0000]
25-01-17 17:13:21 | I |         sum  error  = [    0.0937]
25-01-17 17:13:21 | I |         best error  = [    0.0937]
25-01-17 17:13:21 | I |     + error = [0.0937]
25-01-17 17:13:21 | I |       - range scale = [    1.0000]
25-01-17 17:13:21 | I |         sum  error  = [    1.0592]
25-01-17 17:13:21 | I |         best error  = [    1.0592]
25-01-17 17:13:21 | I |     + error = [1.0592]
25-01-17 17:13:22 | I |       - range scale = [    1.0000]
25-01-17 17:13:22 | I |         sum  error  = [    0.0960]
25-01-17 17:13:22 | I |         best error  = [    0.0960]
25-01-17 17:13:22 | I |     + error = [0.0960]
25-01-17 17:13:23 | I |       - range scale = [    1.0000]
25-01-17 17:13:23 | I |         sum  error  = [    1.0476]
25-01-17 17:13:23 | I |         best error  = [    1.0476]
25-01-17 17:13:23 | I |     + error = [1.0476]
25-01-17 17:13:24 | I |       - range scale = [    1.0000]
25-01-17 17:13:24 | I |         sum  error  = [    0.4814]
25-01-17 17:13:24 | I |         best error  = [    0.4814]
25-01-17 17:13:24 | I |     + error = [0.4814]
25-01-17 17:13:24 | I |       - range scale = [    1.0000]
25-01-17 17:13:24 | I |         sum  error  = [    5.5039]
25-01-17 17:13:24 | I |         best error  = [    5.5039]
25-01-17 17:13:24 | I |     + error = [5.5039]
25-01-17 17:13:25 | I |       - range scale = [    1.0000]
25-01-17 17:13:25 | I |         sum  error  = [    2.5865]
25-01-17 17:13:25 | I |         best error  = [    2.5865]
25-01-17 17:13:25 | I |     + error = [2.5865]
25-01-17 17:13:26 | I |       - range scale = [    1.0000]
25-01-17 17:13:26 | I |         sum  error  = [   29.4843]
25-01-17 17:13:26 | I |         best error  = [   29.4843]
25-01-17 17:13:26 | I |     + error = [29.4843]
25-01-17 17:13:27 | I |       - range scale = [    1.0000]
25-01-17 17:13:27 | I |         sum  error  = [    0.1927]
25-01-17 17:13:27 | I |         best error  = [    0.1927]
25-01-17 17:13:27 | I |     + error = [0.1927]
25-01-17 17:13:28 | I |       - range scale = [    1.0000]
25-01-17 17:13:28 | I |         sum  error  = [    1.7468]
25-01-17 17:13:28 | I |         best error  = [    1.7468]
25-01-17 17:13:28 | I |     + error = [1.7468]
25-01-17 17:13:40 | I | in valid, quantize current layer acts
25-01-17 17:13:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:47 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 17:13:47 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:13:47 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:13:47 | I | - Evaluator: gptq
25-01-17 17:13:47 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:13:47 | I | - Batch_size: 8
25-01-17 17:13:47 | I |   + Max_seq_length: 2048
25-01-17 17:14:06 | I |     - Results:
25-01-17 17:14:06 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:14:06 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:14:06 | I |       |wikitext |      1|word_perplexity|7.7261|±  |7.7261|
25-01-17 17:14:06 | I |       |val_valid|      1|word_perplexity|7.4345|±  |7.4345|
25-01-17 17:14:06 | I |       
25-01-17 17:14:19 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.616, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.13, wps=36510.7, wpb=4058.2, bsz=2, num_updates=16, lmquant_ppl_wikitext_all_quanted=7.70745, lmquant_ppl_val_all_quanted=7.41367, lmquant_ppl_wikitext_partly_quanted=7.72607, lmquant_ppl_val_partly_quanted=7.43449
25-01-17 17:14:19 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.616 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.13 | wps 36510.7 | wpb 4058.2 | bsz 2 | num_updates 16 | lmquant_ppl_wikitext_all_quanted 7.70745 | lmquant_ppl_val_all_quanted 7.41367 | lmquant_ppl_wikitext_partly_quanted 7.72607 | lmquant_ppl_val_partly_quanted 7.43449
25-01-17 17:14:19 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:14:19 | I | in layer model.layers.4
25-01-17 17:14:19 | I | quantizing weights for layer model.layers.4
25-01-17 17:14:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:20 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:21 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:14:21 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:14:21 | I |       - range scale = [    1.0000]
25-01-17 17:14:21 | I |         sum  error  = [    0.2387]
25-01-17 17:14:21 | I |         best error  = [    0.2387]
25-01-17 17:14:21 | I |     + error = [0.2387]
25-01-17 17:14:22 | I |       - range scale = [    1.0000]
25-01-17 17:14:22 | I |         sum  error  = [    2.8284]
25-01-17 17:14:22 | I |         best error  = [    2.8284]
25-01-17 17:14:22 | I |     + error = [2.8284]
25-01-17 17:14:22 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:14:23 | I |       - range scale = [    1.0000]
25-01-17 17:14:23 | I |         sum  error  = [    0.2189]
25-01-17 17:14:23 | I |         best error  = [    0.2189]
25-01-17 17:14:23 | I |     + error = [0.2189]
25-01-17 17:14:24 | I |       - range scale = [    1.0000]
25-01-17 17:14:24 | I |         sum  error  = [    2.5456]
25-01-17 17:14:24 | I |         best error  = [    2.5456]
25-01-17 17:14:24 | I |     + error = [2.5456]
25-01-17 17:14:24 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:14:24 | I |       - range scale = [    1.0000]
25-01-17 17:14:24 | I |         sum  error  = [    0.0929]
25-01-17 17:14:24 | I |         best error  = [    0.0929]
25-01-17 17:14:24 | I |     + error = [0.0929]
25-01-17 17:14:25 | I |       - range scale = [    1.0000]
25-01-17 17:14:25 | I |         sum  error  = [    1.0505]
25-01-17 17:14:25 | I |         best error  = [    1.0505]
25-01-17 17:14:25 | I |     + error = [1.0505]
25-01-17 17:14:25 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:14:26 | I |       - range scale = [    1.0000]
25-01-17 17:14:26 | I |         sum  error  = [    0.1096]
25-01-17 17:14:26 | I |         best error  = [    0.1096]
25-01-17 17:14:26 | I |     + error = [0.1096]
25-01-17 17:14:27 | I |       - range scale = [    1.0000]
25-01-17 17:14:27 | I |         sum  error  = [    1.1963]
25-01-17 17:14:27 | I |         best error  = [    1.1963]
25-01-17 17:14:27 | I |     + error = [1.1963]
25-01-17 17:14:27 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:14:28 | I |       - range scale = [    1.0000]
25-01-17 17:14:28 | I |         sum  error  = [    0.4789]
25-01-17 17:14:28 | I |         best error  = [    0.4789]
25-01-17 17:14:28 | I |     + error = [0.4789]
25-01-17 17:14:28 | I |       - range scale = [    1.0000]
25-01-17 17:14:28 | I |         sum  error  = [    5.4634]
25-01-17 17:14:28 | I |         best error  = [    5.4634]
25-01-17 17:14:28 | I |     + error = [5.4634]
25-01-17 17:14:29 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:14:29 | I |       - range scale = [    1.0000]
25-01-17 17:14:29 | I |         sum  error  = [    2.5730]
25-01-17 17:14:29 | I |         best error  = [    2.5730]
25-01-17 17:14:29 | I |     + error = [2.5730]
25-01-17 17:14:30 | I |       - range scale = [    1.0000]
25-01-17 17:14:30 | I |         sum  error  = [   29.2782]
25-01-17 17:14:30 | I |         best error  = [   29.2782]
25-01-17 17:14:30 | I |     + error = [29.2782]
25-01-17 17:14:30 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:14:31 | I |       - range scale = [    1.0000]
25-01-17 17:14:31 | I |         sum  error  = [    0.1915]
25-01-17 17:14:31 | I |         best error  = [    0.1915]
25-01-17 17:14:31 | I |     + error = [0.1915]
25-01-17 17:14:32 | I |       - range scale = [    1.0000]
25-01-17 17:14:32 | I |         sum  error  = [    1.7184]
25-01-17 17:14:32 | I |         best error  = [    1.7184]
25-01-17 17:14:32 | I |     + error = [1.7184]
25-01-17 17:14:32 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:14:33 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:14:35 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:14:36 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:14:37 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:14:39 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:14:40 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:14:44 | I | quantizing activations for layer model.layers.4
25-01-17 17:14:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:46 | I | forward this layer
25-01-17 17:14:46 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/32.pt
25-01-17 17:14:46 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/32.pt
25-01-17 17:14:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:14:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:14:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:14:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:14:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:14:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:14:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:14:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:14:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:14:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:14:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:14:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:14:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:14:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:14:47 | I | in layer model.layers.4
25-01-17 17:14:47 | I | quantizing weights for layer model.layers.4
25-01-17 17:14:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:48 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:14:48 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:14:48 | I |       - range scale = [    1.0000]
25-01-17 17:14:48 | I |         sum  error  = [    0.2401]
25-01-17 17:14:48 | I |         best error  = [    0.2401]
25-01-17 17:14:48 | I |     + error = [0.2401]
25-01-17 17:14:49 | I |       - range scale = [    1.0000]
25-01-17 17:14:49 | I |         sum  error  = [    2.8512]
25-01-17 17:14:49 | I |         best error  = [    2.8512]
25-01-17 17:14:49 | I |     + error = [2.8512]
25-01-17 17:14:49 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:14:50 | I |       - range scale = [    1.0000]
25-01-17 17:14:50 | I |         sum  error  = [    0.2236]
25-01-17 17:14:50 | I |         best error  = [    0.2236]
25-01-17 17:14:50 | I |     + error = [0.2236]
25-01-17 17:14:51 | I |       - range scale = [    1.0000]
25-01-17 17:14:51 | I |         sum  error  = [    2.5098]
25-01-17 17:14:51 | I |         best error  = [    2.5098]
25-01-17 17:14:51 | I |     + error = [2.5098]
25-01-17 17:14:51 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:14:51 | I |       - range scale = [    1.0000]
25-01-17 17:14:51 | I |         sum  error  = [    0.0931]
25-01-17 17:14:51 | I |         best error  = [    0.0931]
25-01-17 17:14:51 | I |     + error = [0.0931]
25-01-17 17:14:52 | I |       - range scale = [    1.0000]
25-01-17 17:14:52 | I |         sum  error  = [    1.0497]
25-01-17 17:14:52 | I |         best error  = [    1.0497]
25-01-17 17:14:52 | I |     + error = [1.0497]
25-01-17 17:14:52 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:14:53 | I |       - range scale = [    1.0000]
25-01-17 17:14:53 | I |         sum  error  = [    0.1113]
25-01-17 17:14:53 | I |         best error  = [    0.1113]
25-01-17 17:14:53 | I |     + error = [0.1113]
25-01-17 17:14:54 | I |       - range scale = [    1.0000]
25-01-17 17:14:54 | I |         sum  error  = [    1.2181]
25-01-17 17:14:54 | I |         best error  = [    1.2181]
25-01-17 17:14:54 | I |     + error = [1.2181]
25-01-17 17:14:54 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:14:55 | I |       - range scale = [    1.0000]
25-01-17 17:14:55 | I |         sum  error  = [    0.4789]
25-01-17 17:14:55 | I |         best error  = [    0.4789]
25-01-17 17:14:55 | I |     + error = [0.4789]
25-01-17 17:14:55 | I |       - range scale = [    1.0000]
25-01-17 17:14:55 | I |         sum  error  = [    5.4622]
25-01-17 17:14:55 | I |         best error  = [    5.4622]
25-01-17 17:14:55 | I |     + error = [5.4622]
25-01-17 17:14:56 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:14:56 | I |       - range scale = [    1.0000]
25-01-17 17:14:56 | I |         sum  error  = [    2.5728]
25-01-17 17:14:56 | I |         best error  = [    2.5728]
25-01-17 17:14:56 | I |     + error = [2.5728]
25-01-17 17:14:57 | I |       - range scale = [    1.0000]
25-01-17 17:14:57 | I |         sum  error  = [   29.2724]
25-01-17 17:14:57 | I |         best error  = [   29.2724]
25-01-17 17:14:57 | I |     + error = [29.2724]
25-01-17 17:14:57 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:14:58 | I |       - range scale = [    1.0000]
25-01-17 17:14:58 | I |         sum  error  = [    0.1929]
25-01-17 17:14:58 | I |         best error  = [    0.1929]
25-01-17 17:14:58 | I |     + error = [0.1929]
25-01-17 17:14:59 | I |       - range scale = [    1.0000]
25-01-17 17:14:59 | I |         sum  error  = [    1.7266]
25-01-17 17:14:59 | I |         best error  = [    1.7266]
25-01-17 17:14:59 | I |     + error = [1.7266]
25-01-17 17:14:59 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:15:00 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:15:02 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:15:03 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:15:04 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:15:06 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:15:07 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:15:10 | I | quantizing activations for layer model.layers.4
25-01-17 17:15:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:13 | I | forward this layer
25-01-17 17:15:13 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/33.pt
25-01-17 17:15:13 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/33.pt
25-01-17 17:15:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:15:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:15:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:15:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:15:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:15:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:15:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:15:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:15:13 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:15:13 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:15:13 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:15:13 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:15:13 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:15:13 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:15:13 | I | [16] done with optimizer step
25-01-17 17:15:13 | I | epoch 001:     17 / 409600000 loss=9.719e-06, loss_sum=0.220748, wps=219.7, ups=0.01, wpb=32768, bsz=64, num_updates=17, lr=0.0017, gnorm=0, clip=0, loss_scale=128, train_wall=54, cuda_gb_allocated=12.1, cuda_gb_reserved=13.6, cuda_gb_free=11.6, wall=2818
25-01-17 17:15:13 | I | begin validation on "valid" subset on rank 0
25-01-17 17:15:13 | I | got valid iterator on "valid" subset on rank 0
25-01-17 17:15:13 | I | Valid: Start iterating over samples
25-01-17 17:15:13 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:15:13 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:15:13 | I | - Evaluator: gptq
25-01-17 17:15:13 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:15:13 | I | - Batch_size: 8
25-01-17 17:15:13 | I |   + Max_seq_length: 2048
25-01-17 17:15:31 | I |     - Results:
25-01-17 17:15:31 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:15:31 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:15:31 | I |       |wikitext |      1|word_perplexity|7.7075|±  |7.7075|
25-01-17 17:15:31 | I |       |val_valid|      1|word_perplexity|7.4138|±  |7.4138|
25-01-17 17:15:31 | I |       
25-01-17 17:15:31 | I | in valid, quantize current layer weights
25-01-17 17:15:32 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 17:15:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:46 | I |       - range scale = [    1.0000]
25-01-17 17:15:46 | I |         sum  error  = [    0.6608]
25-01-17 17:15:46 | I |         best error  = [    0.6608]
25-01-17 17:15:46 | I |     + error = [0.6608]
25-01-17 17:15:47 | I |       - range scale = [    1.0000]
25-01-17 17:15:47 | I |         sum  error  = [    7.3390]
25-01-17 17:15:47 | I |         best error  = [    7.3390]
25-01-17 17:15:47 | I |     + error = [7.3390]
25-01-17 17:15:48 | I |       - range scale = [    1.0000]
25-01-17 17:15:48 | I |         sum  error  = [    0.6555]
25-01-17 17:15:48 | I |         best error  = [    0.6555]
25-01-17 17:15:48 | I |     + error = [0.6555]
25-01-17 17:15:49 | I |       - range scale = [    1.0000]
25-01-17 17:15:49 | I |         sum  error  = [    7.1266]
25-01-17 17:15:49 | I |         best error  = [    7.1266]
25-01-17 17:15:49 | I |     + error = [7.1266]
25-01-17 17:15:50 | I |       - range scale = [    1.0000]
25-01-17 17:15:50 | I |         sum  error  = [    0.0937]
25-01-17 17:15:50 | I |         best error  = [    0.0937]
25-01-17 17:15:50 | I |     + error = [0.0937]
25-01-17 17:15:50 | I |       - range scale = [    1.0000]
25-01-17 17:15:50 | I |         sum  error  = [    1.0592]
25-01-17 17:15:50 | I |         best error  = [    1.0592]
25-01-17 17:15:50 | I |     + error = [1.0592]
25-01-17 17:15:51 | I |       - range scale = [    1.0000]
25-01-17 17:15:51 | I |         sum  error  = [    0.0960]
25-01-17 17:15:51 | I |         best error  = [    0.0960]
25-01-17 17:15:51 | I |     + error = [0.0960]
25-01-17 17:15:52 | I |       - range scale = [    1.0000]
25-01-17 17:15:52 | I |         sum  error  = [    1.0476]
25-01-17 17:15:52 | I |         best error  = [    1.0476]
25-01-17 17:15:52 | I |     + error = [1.0476]
25-01-17 17:15:53 | I |       - range scale = [    1.0000]
25-01-17 17:15:53 | I |         sum  error  = [    0.4814]
25-01-17 17:15:53 | I |         best error  = [    0.4814]
25-01-17 17:15:53 | I |     + error = [0.4814]
25-01-17 17:15:54 | I |       - range scale = [    1.0000]
25-01-17 17:15:54 | I |         sum  error  = [    5.5039]
25-01-17 17:15:54 | I |         best error  = [    5.5039]
25-01-17 17:15:54 | I |     + error = [5.5039]
25-01-17 17:15:54 | I |       - range scale = [    1.0000]
25-01-17 17:15:54 | I |         sum  error  = [    2.5865]
25-01-17 17:15:54 | I |         best error  = [    2.5865]
25-01-17 17:15:54 | I |     + error = [2.5865]
25-01-17 17:15:55 | I |       - range scale = [    1.0000]
25-01-17 17:15:55 | I |         sum  error  = [   29.4842]
25-01-17 17:15:55 | I |         best error  = [   29.4842]
25-01-17 17:15:55 | I |     + error = [29.4842]
25-01-17 17:15:56 | I |       - range scale = [    1.0000]
25-01-17 17:15:56 | I |         sum  error  = [    0.1927]
25-01-17 17:15:56 | I |         best error  = [    0.1927]
25-01-17 17:15:56 | I |     + error = [0.1927]
25-01-17 17:15:57 | I |       - range scale = [    1.0000]
25-01-17 17:15:57 | I |         sum  error  = [    1.7468]
25-01-17 17:15:57 | I |         best error  = [    1.7468]
25-01-17 17:15:57 | I |     + error = [1.7468]
25-01-17 17:16:09 | I | in valid, quantize current layer acts
25-01-17 17:16:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:16 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 17:16:16 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:16:16 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:16:16 | I | - Evaluator: gptq
25-01-17 17:16:16 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:16:16 | I | - Batch_size: 8
25-01-17 17:16:16 | I |   + Max_seq_length: 2048
25-01-17 17:16:35 | I |     - Results:
25-01-17 17:16:35 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:16:35 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:16:35 | I |       |wikitext |      1|word_perplexity|7.7249|±  |7.7249|
25-01-17 17:16:35 | I |       |val_valid|      1|word_perplexity|7.4358|±  |7.4358|
25-01-17 17:16:35 | I |       
25-01-17 17:16:48 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.616, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.13, wps=36501.7, wpb=4058.2, bsz=2, num_updates=17, lmquant_ppl_wikitext_all_quanted=7.70746, lmquant_ppl_val_all_quanted=7.41376, lmquant_ppl_wikitext_partly_quanted=7.72493, lmquant_ppl_val_partly_quanted=7.43583
25-01-17 17:16:48 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.616 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.13 | wps 36501.7 | wpb 4058.2 | bsz 2 | num_updates 17 | lmquant_ppl_wikitext_all_quanted 7.70746 | lmquant_ppl_val_all_quanted 7.41376 | lmquant_ppl_wikitext_partly_quanted 7.72493 | lmquant_ppl_val_partly_quanted 7.43583
25-01-17 17:16:48 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:16:48 | I | in layer model.layers.4
25-01-17 17:16:48 | I | quantizing weights for layer model.layers.4
25-01-17 17:16:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:49 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:16:49 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:16:50 | I |       - range scale = [    1.0000]
25-01-17 17:16:50 | I |         sum  error  = [    0.2371]
25-01-17 17:16:50 | I |         best error  = [    0.2371]
25-01-17 17:16:50 | I |     + error = [0.2371]
25-01-17 17:16:51 | I |       - range scale = [    1.0000]
25-01-17 17:16:51 | I |         sum  error  = [    2.8138]
25-01-17 17:16:51 | I |         best error  = [    2.8138]
25-01-17 17:16:51 | I |     + error = [2.8138]
25-01-17 17:16:51 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:16:52 | I |       - range scale = [    1.0000]
25-01-17 17:16:52 | I |         sum  error  = [    0.2186]
25-01-17 17:16:52 | I |         best error  = [    0.2186]
25-01-17 17:16:52 | I |     + error = [0.2186]
25-01-17 17:16:52 | I |       - range scale = [    1.0000]
25-01-17 17:16:52 | I |         sum  error  = [    2.4566]
25-01-17 17:16:52 | I |         best error  = [    2.4566]
25-01-17 17:16:52 | I |     + error = [2.4566]
25-01-17 17:16:53 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:16:53 | I |       - range scale = [    1.0000]
25-01-17 17:16:53 | I |         sum  error  = [    0.0931]
25-01-17 17:16:53 | I |         best error  = [    0.0931]
25-01-17 17:16:53 | I |     + error = [0.0931]
25-01-17 17:16:54 | I |       - range scale = [    1.0000]
25-01-17 17:16:54 | I |         sum  error  = [    1.0511]
25-01-17 17:16:54 | I |         best error  = [    1.0511]
25-01-17 17:16:54 | I |     + error = [1.0511]
25-01-17 17:16:54 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:16:55 | I |       - range scale = [    1.0000]
25-01-17 17:16:55 | I |         sum  error  = [    0.1102]
25-01-17 17:16:55 | I |         best error  = [    0.1102]
25-01-17 17:16:55 | I |     + error = [0.1102]
25-01-17 17:16:55 | I |       - range scale = [    1.0000]
25-01-17 17:16:55 | I |         sum  error  = [    1.2000]
25-01-17 17:16:55 | I |         best error  = [    1.2000]
25-01-17 17:16:55 | I |     + error = [1.2000]
25-01-17 17:16:56 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:16:56 | I |       - range scale = [    1.0000]
25-01-17 17:16:56 | I |         sum  error  = [    0.4791]
25-01-17 17:16:56 | I |         best error  = [    0.4791]
25-01-17 17:16:56 | I |     + error = [0.4791]
25-01-17 17:16:57 | I |       - range scale = [    1.0000]
25-01-17 17:16:57 | I |         sum  error  = [    5.4629]
25-01-17 17:16:57 | I |         best error  = [    5.4629]
25-01-17 17:16:57 | I |     + error = [5.4629]
25-01-17 17:16:57 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:16:58 | I |       - range scale = [    1.0000]
25-01-17 17:16:58 | I |         sum  error  = [    2.5728]
25-01-17 17:16:58 | I |         best error  = [    2.5728]
25-01-17 17:16:58 | I |     + error = [2.5728]
25-01-17 17:16:59 | I |       - range scale = [    1.0000]
25-01-17 17:16:59 | I |         sum  error  = [   29.2763]
25-01-17 17:16:59 | I |         best error  = [   29.2763]
25-01-17 17:16:59 | I |     + error = [29.2763]
25-01-17 17:16:59 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:16:59 | I |       - range scale = [    1.0000]
25-01-17 17:16:59 | I |         sum  error  = [    0.1923]
25-01-17 17:16:59 | I |         best error  = [    0.1923]
25-01-17 17:16:59 | I |     + error = [0.1923]
25-01-17 17:17:00 | I |       - range scale = [    1.0000]
25-01-17 17:17:00 | I |         sum  error  = [    1.7216]
25-01-17 17:17:00 | I |         best error  = [    1.7216]
25-01-17 17:17:00 | I |     + error = [1.7216]
25-01-17 17:17:00 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:17:02 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:17:03 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:17:04 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:17:06 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:17:07 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:17:09 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:17:12 | I | quantizing activations for layer model.layers.4
25-01-17 17:17:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:17:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:17:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:17:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:17:15 | I | forward this layer
25-01-17 17:17:15 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/34.pt
25-01-17 17:17:15 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/34.pt
25-01-17 17:17:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:17:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:17:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:17:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:17:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:17:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:17:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:17:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:17:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:17:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:17:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:17:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:17:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:17:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:17:15 | I | in layer model.layers.4
25-01-17 17:17:15 | I | quantizing weights for layer model.layers.4
25-01-17 17:17:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:17:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:17:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:17:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:17:16 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:17:16 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:17:17 | I |       - range scale = [    1.0000]
25-01-17 17:17:17 | I |         sum  error  = [    0.2383]
25-01-17 17:17:17 | I |         best error  = [    0.2383]
25-01-17 17:17:17 | I |     + error = [0.2383]
25-01-17 17:17:17 | I |       - range scale = [    1.0000]
25-01-17 17:17:17 | I |         sum  error  = [    2.8441]
25-01-17 17:17:17 | I |         best error  = [    2.8441]
25-01-17 17:17:17 | I |     + error = [2.8441]
25-01-17 17:17:17 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:17:18 | I |       - range scale = [    1.0000]
25-01-17 17:17:18 | I |         sum  error  = [    0.2209]
25-01-17 17:17:18 | I |         best error  = [    0.2209]
25-01-17 17:17:18 | I |     + error = [0.2209]
25-01-17 17:17:19 | I |       - range scale = [    1.0000]
25-01-17 17:17:19 | I |         sum  error  = [    2.5174]
25-01-17 17:17:19 | I |         best error  = [    2.5174]
25-01-17 17:17:19 | I |     + error = [2.5174]
25-01-17 17:17:19 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:17:20 | I |       - range scale = [    1.0000]
25-01-17 17:17:20 | I |         sum  error  = [    0.0931]
25-01-17 17:17:20 | I |         best error  = [    0.0931]
25-01-17 17:17:20 | I |     + error = [0.0931]
25-01-17 17:17:20 | I |       - range scale = [    1.0000]
25-01-17 17:17:20 | I |         sum  error  = [    1.0489]
25-01-17 17:17:20 | I |         best error  = [    1.0489]
25-01-17 17:17:20 | I |     + error = [1.0489]
25-01-17 17:17:20 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:17:21 | I |       - range scale = [    1.0000]
25-01-17 17:17:21 | I |         sum  error  = [    0.1078]
25-01-17 17:17:21 | I |         best error  = [    0.1078]
25-01-17 17:17:21 | I |     + error = [0.1078]
25-01-17 17:17:22 | I |       - range scale = [    1.0000]
25-01-17 17:17:22 | I |         sum  error  = [    1.1756]
25-01-17 17:17:22 | I |         best error  = [    1.1756]
25-01-17 17:17:22 | I |     + error = [1.1756]
25-01-17 17:17:22 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:17:23 | I |       - range scale = [    1.0000]
25-01-17 17:17:23 | I |         sum  error  = [    0.4783]
25-01-17 17:17:23 | I |         best error  = [    0.4783]
25-01-17 17:17:23 | I |     + error = [0.4783]
25-01-17 17:17:23 | I |       - range scale = [    1.0000]
25-01-17 17:17:23 | I |         sum  error  = [    5.4637]
25-01-17 17:17:23 | I |         best error  = [    5.4637]
25-01-17 17:17:23 | I |     + error = [5.4637]
25-01-17 17:17:24 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:17:24 | I |       - range scale = [    1.0000]
25-01-17 17:17:24 | I |         sum  error  = [    2.5733]
25-01-17 17:17:24 | I |         best error  = [    2.5733]
25-01-17 17:17:24 | I |     + error = [2.5733]
25-01-17 17:17:25 | I |       - range scale = [    1.0000]
25-01-17 17:17:25 | I |         sum  error  = [   29.2736]
25-01-17 17:17:25 | I |         best error  = [   29.2736]
25-01-17 17:17:25 | I |     + error = [29.2736]
25-01-17 17:17:25 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:17:26 | I |       - range scale = [    1.0000]
25-01-17 17:17:26 | I |         sum  error  = [    0.1917]
25-01-17 17:17:26 | I |         best error  = [    0.1917]
25-01-17 17:17:26 | I |     + error = [0.1917]
25-01-17 17:17:27 | I |       - range scale = [    1.0000]
25-01-17 17:17:27 | I |         sum  error  = [    1.7219]
25-01-17 17:17:27 | I |         best error  = [    1.7219]
25-01-17 17:17:27 | I |     + error = [1.7219]
25-01-17 17:17:27 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:17:28 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:17:30 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:17:31 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:17:32 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:17:34 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:17:35 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:17:38 | I | quantizing activations for layer model.layers.4
25-01-17 17:17:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:17:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:17:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:17:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:17:41 | I | forward this layer
25-01-17 17:17:41 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/35.pt
25-01-17 17:17:41 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/35.pt
25-01-17 17:17:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:17:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:17:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:17:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:17:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:17:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:17:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:17:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:17:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:17:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:17:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:17:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:17:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:17:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:17:41 | I | [17] done with optimizer step
25-01-17 17:17:41 | I | epoch 001:     18 / 409600000 loss=9.2459e-06, loss_sum=0.210003, wps=221.4, ups=0.01, wpb=32768, bsz=64, num_updates=18, lr=0.0018, gnorm=0, clip=0, loss_scale=128, train_wall=53, cuda_gb_allocated=12.1, cuda_gb_reserved=13.6, cuda_gb_free=11.6, wall=2966
25-01-17 17:17:41 | I | begin validation on "valid" subset on rank 0
25-01-17 17:17:41 | I | got valid iterator on "valid" subset on rank 0
25-01-17 17:17:41 | I | Valid: Start iterating over samples
25-01-17 17:17:41 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:17:41 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:17:41 | I | - Evaluator: gptq
25-01-17 17:17:41 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:17:41 | I | - Batch_size: 8
25-01-17 17:17:41 | I |   + Max_seq_length: 2048
25-01-17 17:17:59 | I |     - Results:
25-01-17 17:17:59 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:17:59 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:17:59 | I |       |wikitext |      1|word_perplexity|7.7075|±  |7.7075|
25-01-17 17:17:59 | I |       |val_valid|      1|word_perplexity|7.4134|±  |7.4134|
25-01-17 17:17:59 | I |       
25-01-17 17:17:59 | I | in valid, quantize current layer weights
25-01-17 17:18:00 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 17:18:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:14 | I |       - range scale = [    1.0000]
25-01-17 17:18:14 | I |         sum  error  = [    0.6606]
25-01-17 17:18:14 | I |         best error  = [    0.6606]
25-01-17 17:18:14 | I |     + error = [0.6606]
25-01-17 17:18:15 | I |       - range scale = [    1.0000]
25-01-17 17:18:15 | I |         sum  error  = [    7.3389]
25-01-17 17:18:15 | I |         best error  = [    7.3389]
25-01-17 17:18:15 | I |     + error = [7.3389]
25-01-17 17:18:16 | I |       - range scale = [    1.0000]
25-01-17 17:18:16 | I |         sum  error  = [    0.6554]
25-01-17 17:18:16 | I |         best error  = [    0.6554]
25-01-17 17:18:16 | I |     + error = [0.6554]
25-01-17 17:18:17 | I |       - range scale = [    1.0000]
25-01-17 17:18:17 | I |         sum  error  = [    7.1262]
25-01-17 17:18:17 | I |         best error  = [    7.1262]
25-01-17 17:18:17 | I |     + error = [7.1262]
25-01-17 17:18:18 | I |       - range scale = [    1.0000]
25-01-17 17:18:18 | I |         sum  error  = [    0.0937]
25-01-17 17:18:18 | I |         best error  = [    0.0937]
25-01-17 17:18:18 | I |     + error = [0.0937]
25-01-17 17:18:18 | I |       - range scale = [    1.0000]
25-01-17 17:18:18 | I |         sum  error  = [    1.0592]
25-01-17 17:18:18 | I |         best error  = [    1.0592]
25-01-17 17:18:18 | I |     + error = [1.0592]
25-01-17 17:18:19 | I |       - range scale = [    1.0000]
25-01-17 17:18:19 | I |         sum  error  = [    0.0961]
25-01-17 17:18:19 | I |         best error  = [    0.0961]
25-01-17 17:18:19 | I |     + error = [0.0961]
25-01-17 17:18:20 | I |       - range scale = [    1.0000]
25-01-17 17:18:20 | I |         sum  error  = [    1.0476]
25-01-17 17:18:20 | I |         best error  = [    1.0476]
25-01-17 17:18:20 | I |     + error = [1.0476]
25-01-17 17:18:21 | I |       - range scale = [    1.0000]
25-01-17 17:18:21 | I |         sum  error  = [    0.4814]
25-01-17 17:18:21 | I |         best error  = [    0.4814]
25-01-17 17:18:21 | I |     + error = [0.4814]
25-01-17 17:18:22 | I |       - range scale = [    1.0000]
25-01-17 17:18:22 | I |         sum  error  = [    5.5039]
25-01-17 17:18:22 | I |         best error  = [    5.5039]
25-01-17 17:18:22 | I |     + error = [5.5039]
25-01-17 17:18:22 | I |       - range scale = [    1.0000]
25-01-17 17:18:22 | I |         sum  error  = [    2.5865]
25-01-17 17:18:22 | I |         best error  = [    2.5865]
25-01-17 17:18:22 | I |     + error = [2.5865]
25-01-17 17:18:23 | I |       - range scale = [    1.0000]
25-01-17 17:18:23 | I |         sum  error  = [   29.4843]
25-01-17 17:18:23 | I |         best error  = [   29.4843]
25-01-17 17:18:23 | I |     + error = [29.4843]
25-01-17 17:18:24 | I |       - range scale = [    1.0000]
25-01-17 17:18:24 | I |         sum  error  = [    0.1927]
25-01-17 17:18:24 | I |         best error  = [    0.1927]
25-01-17 17:18:24 | I |     + error = [0.1927]
25-01-17 17:18:25 | I |       - range scale = [    1.0000]
25-01-17 17:18:25 | I |         sum  error  = [    1.7468]
25-01-17 17:18:25 | I |         best error  = [    1.7468]
25-01-17 17:18:25 | I |     + error = [1.7468]
25-01-17 17:18:38 | I | in valid, quantize current layer acts
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:18:44 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 17:18:44 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:18:44 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:18:44 | I | - Evaluator: gptq
25-01-17 17:18:44 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:18:44 | I | - Batch_size: 8
25-01-17 17:18:44 | I |   + Max_seq_length: 2048
25-01-17 17:19:04 | I |     - Results:
25-01-17 17:19:04 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:19:04 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:19:04 | I |       |wikitext |      1|word_perplexity|7.7253|±  |7.7253|
25-01-17 17:19:04 | I |       |val_valid|      1|word_perplexity|7.4315|±  |7.4315|
25-01-17 17:19:04 | I |       
25-01-17 17:19:17 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.617, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.13, wps=36524.1, wpb=4058.2, bsz=2, num_updates=18, lmquant_ppl_wikitext_all_quanted=7.70751, lmquant_ppl_val_all_quanted=7.41345, lmquant_ppl_wikitext_partly_quanted=7.72535, lmquant_ppl_val_partly_quanted=7.43151
25-01-17 17:19:17 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.617 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.13 | wps 36524.1 | wpb 4058.2 | bsz 2 | num_updates 18 | lmquant_ppl_wikitext_all_quanted 7.70751 | lmquant_ppl_val_all_quanted 7.41345 | lmquant_ppl_wikitext_partly_quanted 7.72535 | lmquant_ppl_val_partly_quanted 7.43151
25-01-17 17:19:17 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:19:17 | I | in layer model.layers.4
25-01-17 17:19:17 | I | quantizing weights for layer model.layers.4
25-01-17 17:19:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:19:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:19:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:19:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:19:18 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:19:18 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:19:19 | I |       - range scale = [    1.0000]
25-01-17 17:19:19 | I |         sum  error  = [    0.2370]
25-01-17 17:19:19 | I |         best error  = [    0.2370]
25-01-17 17:19:19 | I |     + error = [0.2370]
25-01-17 17:19:19 | I |       - range scale = [    1.0000]
25-01-17 17:19:19 | I |         sum  error  = [    2.8438]
25-01-17 17:19:19 | I |         best error  = [    2.8438]
25-01-17 17:19:19 | I |     + error = [2.8438]
25-01-17 17:19:20 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:19:20 | I |       - range scale = [    1.0000]
25-01-17 17:19:20 | I |         sum  error  = [    0.2208]
25-01-17 17:19:20 | I |         best error  = [    0.2208]
25-01-17 17:19:20 | I |     + error = [0.2208]
25-01-17 17:19:21 | I |       - range scale = [    1.0000]
25-01-17 17:19:21 | I |         sum  error  = [    2.5373]
25-01-17 17:19:21 | I |         best error  = [    2.5373]
25-01-17 17:19:21 | I |     + error = [2.5373]
25-01-17 17:19:21 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:19:22 | I |       - range scale = [    1.0000]
25-01-17 17:19:22 | I |         sum  error  = [    0.0934]
25-01-17 17:19:22 | I |         best error  = [    0.0934]
25-01-17 17:19:22 | I |     + error = [0.0934]
25-01-17 17:19:23 | I |       - range scale = [    1.0000]
25-01-17 17:19:23 | I |         sum  error  = [    1.0507]
25-01-17 17:19:23 | I |         best error  = [    1.0507]
25-01-17 17:19:23 | I |     + error = [1.0507]
25-01-17 17:19:23 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:19:23 | I |       - range scale = [    1.0000]
25-01-17 17:19:23 | I |         sum  error  = [    0.1094]
25-01-17 17:19:23 | I |         best error  = [    0.1094]
25-01-17 17:19:23 | I |     + error = [0.1094]
25-01-17 17:19:24 | I |       - range scale = [    1.0000]
25-01-17 17:19:24 | I |         sum  error  = [    1.1936]
25-01-17 17:19:24 | I |         best error  = [    1.1936]
25-01-17 17:19:24 | I |     + error = [1.1936]
25-01-17 17:19:24 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:19:25 | I |       - range scale = [    1.0000]
25-01-17 17:19:25 | I |         sum  error  = [    0.4792]
25-01-17 17:19:25 | I |         best error  = [    0.4792]
25-01-17 17:19:25 | I |     + error = [0.4792]
25-01-17 17:19:26 | I |       - range scale = [    1.0000]
25-01-17 17:19:26 | I |         sum  error  = [    5.4642]
25-01-17 17:19:26 | I |         best error  = [    5.4642]
25-01-17 17:19:26 | I |     + error = [5.4642]
25-01-17 17:19:26 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:19:27 | I |       - range scale = [    1.0000]
25-01-17 17:19:27 | I |         sum  error  = [    2.5743]
25-01-17 17:19:27 | I |         best error  = [    2.5743]
25-01-17 17:19:27 | I |     + error = [2.5743]
25-01-17 17:19:27 | I |       - range scale = [    1.0000]
25-01-17 17:19:27 | I |         sum  error  = [   29.2770]
25-01-17 17:19:27 | I |         best error  = [   29.2770]
25-01-17 17:19:27 | I |     + error = [29.2770]
25-01-17 17:19:28 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:19:28 | I |       - range scale = [    1.0000]
25-01-17 17:19:28 | I |         sum  error  = [    0.1944]
25-01-17 17:19:28 | I |         best error  = [    0.1944]
25-01-17 17:19:28 | I |     + error = [0.1944]
25-01-17 17:19:29 | I |       - range scale = [    1.0000]
25-01-17 17:19:29 | I |         sum  error  = [    1.7410]
25-01-17 17:19:29 | I |         best error  = [    1.7410]
25-01-17 17:19:29 | I |     + error = [1.7410]
25-01-17 17:19:29 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:19:31 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:19:32 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:19:33 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:19:35 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:19:36 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:19:37 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:19:41 | I | quantizing activations for layer model.layers.4
25-01-17 17:19:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:19:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:19:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:19:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:19:44 | I | forward this layer
25-01-17 17:19:44 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/36.pt
25-01-17 17:19:44 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/36.pt
25-01-17 17:19:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:19:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:19:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:19:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:19:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:19:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:19:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:19:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:19:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:19:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:19:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:19:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:19:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:19:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:19:44 | I | in layer model.layers.4
25-01-17 17:19:44 | I | quantizing weights for layer model.layers.4
25-01-17 17:19:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:19:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:19:44 | I | collecting calibration activations in model.layers.4
25-01-17 17:19:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:19:45 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:19:45 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:19:46 | I |       - range scale = [    1.0000]
25-01-17 17:19:46 | I |         sum  error  = [    0.2401]
25-01-17 17:19:46 | I |         best error  = [    0.2401]
25-01-17 17:19:46 | I |     + error = [0.2401]
25-01-17 17:19:46 | I |       - range scale = [    1.0000]
25-01-17 17:19:46 | I |         sum  error  = [    2.8713]
25-01-17 17:19:46 | I |         best error  = [    2.8713]
25-01-17 17:19:46 | I |     + error = [2.8713]
25-01-17 17:19:47 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:19:47 | I |       - range scale = [    1.0000]
25-01-17 17:19:47 | I |         sum  error  = [    0.2240]
25-01-17 17:19:47 | I |         best error  = [    0.2240]
25-01-17 17:19:47 | I |     + error = [0.2240]
25-01-17 17:19:48 | I |       - range scale = [    1.0000]
25-01-17 17:19:48 | I |         sum  error  = [    2.5525]
25-01-17 17:19:48 | I |         best error  = [    2.5525]
25-01-17 17:19:48 | I |     + error = [2.5525]
25-01-17 17:19:48 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:19:49 | I |       - range scale = [    1.0000]
25-01-17 17:19:49 | I |         sum  error  = [    0.0932]
25-01-17 17:19:49 | I |         best error  = [    0.0932]
25-01-17 17:19:49 | I |     + error = [0.0932]
25-01-17 17:19:49 | I |       - range scale = [    1.0000]
25-01-17 17:19:49 | I |         sum  error  = [    1.0499]
25-01-17 17:19:49 | I |         best error  = [    1.0499]
25-01-17 17:19:49 | I |     + error = [1.0499]
25-01-17 17:19:50 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:19:50 | I |       - range scale = [    1.0000]
25-01-17 17:19:50 | I |         sum  error  = [    0.1154]
25-01-17 17:19:50 | I |         best error  = [    0.1154]
25-01-17 17:19:50 | I |     + error = [0.1154]
25-01-17 17:19:51 | I |       - range scale = [    1.0000]
25-01-17 17:19:51 | I |         sum  error  = [    1.2564]
25-01-17 17:19:51 | I |         best error  = [    1.2564]
25-01-17 17:19:51 | I |     + error = [1.2564]
25-01-17 17:19:51 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:19:52 | I |       - range scale = [    1.0000]
25-01-17 17:19:52 | I |         sum  error  = [    0.4784]
25-01-17 17:19:52 | I |         best error  = [    0.4784]
25-01-17 17:19:52 | I |     + error = [0.4784]
25-01-17 17:19:53 | I |       - range scale = [    1.0000]
25-01-17 17:19:53 | I |         sum  error  = [    5.4628]
25-01-17 17:19:53 | I |         best error  = [    5.4628]
25-01-17 17:19:53 | I |     + error = [5.4628]
25-01-17 17:19:53 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:19:54 | I |       - range scale = [    1.0000]
25-01-17 17:19:54 | I |         sum  error  = [    2.5744]
25-01-17 17:19:54 | I |         best error  = [    2.5744]
25-01-17 17:19:54 | I |     + error = [2.5744]
25-01-17 17:19:54 | I |       - range scale = [    1.0000]
25-01-17 17:19:54 | I |         sum  error  = [   29.2714]
25-01-17 17:19:54 | I |         best error  = [   29.2714]
25-01-17 17:19:54 | I |     + error = [29.2714]
25-01-17 17:19:54 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:19:55 | I |       - range scale = [    1.0000]
25-01-17 17:19:55 | I |         sum  error  = [    0.1909]
25-01-17 17:19:55 | I |         best error  = [    0.1909]
25-01-17 17:19:55 | I |     + error = [0.1909]
25-01-17 17:19:56 | I |       - range scale = [    1.0000]
25-01-17 17:19:56 | I |         sum  error  = [    1.7098]
25-01-17 17:19:56 | I |         best error  = [    1.7098]
25-01-17 17:19:56 | I |     + error = [1.7098]
25-01-17 17:19:56 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:19:58 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:19:59 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:20:00 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:20:02 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:20:03 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:20:05 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:20:08 | I | quantizing activations for layer model.layers.4
25-01-17 17:20:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:10 | I | forward this layer
25-01-17 17:20:10 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/37.pt
25-01-17 17:20:10 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/37.pt
25-01-17 17:20:11 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:20:11 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:20:11 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:20:11 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:20:11 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:20:11 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:20:11 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:20:11 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:20:11 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:20:11 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:20:11 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:20:11 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:20:11 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:20:11 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:20:11 | I | [18] done with optimizer step
25-01-17 17:20:11 | I | epoch 001:     19 / 409600000 loss=9.4928e-06, loss_sum=0.215611, wps=219.3, ups=0.01, wpb=32768, bsz=64, num_updates=19, lr=0.0019, gnorm=0, clip=0, loss_scale=128, train_wall=54, cuda_gb_allocated=12.1, cuda_gb_reserved=13.6, cuda_gb_free=11.6, wall=3115
25-01-17 17:20:11 | I | begin validation on "valid" subset on rank 0
25-01-17 17:20:11 | I | got valid iterator on "valid" subset on rank 0
25-01-17 17:20:11 | I | Valid: Start iterating over samples
25-01-17 17:20:11 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:20:11 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:20:11 | I | - Evaluator: gptq
25-01-17 17:20:11 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:20:11 | I | - Batch_size: 8
25-01-17 17:20:11 | I |   + Max_seq_length: 2048
25-01-17 17:20:28 | I |     - Results:
25-01-17 17:20:28 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:20:28 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:20:28 | I |       |wikitext |      1|word_perplexity|7.7075|±  |7.7075|
25-01-17 17:20:28 | I |       |val_valid|      1|word_perplexity|7.4135|±  |7.4135|
25-01-17 17:20:28 | I |       
25-01-17 17:20:28 | I | in valid, quantize current layer weights
25-01-17 17:20:29 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:20:43 | I |       - range scale = [    1.0000]
25-01-17 17:20:43 | I |         sum  error  = [    0.6606]
25-01-17 17:20:43 | I |         best error  = [    0.6606]
25-01-17 17:20:43 | I |     + error = [0.6606]
25-01-17 17:20:44 | I |       - range scale = [    1.0000]
25-01-17 17:20:44 | I |         sum  error  = [    7.3387]
25-01-17 17:20:44 | I |         best error  = [    7.3387]
25-01-17 17:20:44 | I |     + error = [7.3387]
25-01-17 17:20:45 | I |       - range scale = [    1.0000]
25-01-17 17:20:45 | I |         sum  error  = [    0.6547]
25-01-17 17:20:45 | I |         best error  = [    0.6547]
25-01-17 17:20:45 | I |     + error = [0.6547]
25-01-17 17:20:46 | I |       - range scale = [    1.0000]
25-01-17 17:20:46 | I |         sum  error  = [    7.1265]
25-01-17 17:20:46 | I |         best error  = [    7.1265]
25-01-17 17:20:46 | I |     + error = [7.1265]
25-01-17 17:20:47 | I |       - range scale = [    1.0000]
25-01-17 17:20:47 | I |         sum  error  = [    0.0937]
25-01-17 17:20:47 | I |         best error  = [    0.0937]
25-01-17 17:20:47 | I |     + error = [0.0937]
25-01-17 17:20:48 | I |       - range scale = [    1.0000]
25-01-17 17:20:48 | I |         sum  error  = [    1.0592]
25-01-17 17:20:48 | I |         best error  = [    1.0592]
25-01-17 17:20:48 | I |     + error = [1.0592]
25-01-17 17:20:49 | I |       - range scale = [    1.0000]
25-01-17 17:20:49 | I |         sum  error  = [    0.0961]
25-01-17 17:20:49 | I |         best error  = [    0.0961]
25-01-17 17:20:49 | I |     + error = [0.0961]
25-01-17 17:20:50 | I |       - range scale = [    1.0000]
25-01-17 17:20:50 | I |         sum  error  = [    1.0476]
25-01-17 17:20:50 | I |         best error  = [    1.0476]
25-01-17 17:20:50 | I |     + error = [1.0476]
25-01-17 17:20:50 | I |       - range scale = [    1.0000]
25-01-17 17:20:50 | I |         sum  error  = [    0.4814]
25-01-17 17:20:50 | I |         best error  = [    0.4814]
25-01-17 17:20:50 | I |     + error = [0.4814]
25-01-17 17:20:51 | I |       - range scale = [    1.0000]
25-01-17 17:20:51 | I |         sum  error  = [    5.5039]
25-01-17 17:20:51 | I |         best error  = [    5.5039]
25-01-17 17:20:51 | I |     + error = [5.5039]
25-01-17 17:20:52 | I |       - range scale = [    1.0000]
25-01-17 17:20:52 | I |         sum  error  = [    2.5865]
25-01-17 17:20:52 | I |         best error  = [    2.5865]
25-01-17 17:20:52 | I |     + error = [2.5865]
25-01-17 17:20:53 | I |       - range scale = [    1.0000]
25-01-17 17:20:53 | I |         sum  error  = [   29.4843]
25-01-17 17:20:53 | I |         best error  = [   29.4843]
25-01-17 17:20:53 | I |     + error = [29.4843]
25-01-17 17:20:54 | I |       - range scale = [    1.0000]
25-01-17 17:20:54 | I |         sum  error  = [    0.1927]
25-01-17 17:20:54 | I |         best error  = [    0.1927]
25-01-17 17:20:54 | I |     + error = [0.1927]
25-01-17 17:20:54 | I |       - range scale = [    1.0000]
25-01-17 17:20:54 | I |         sum  error  = [    1.7468]
25-01-17 17:20:54 | I |         best error  = [    1.7468]
25-01-17 17:20:54 | I |     + error = [1.7468]
25-01-17 17:21:07 | I | in valid, quantize current layer acts
25-01-17 17:21:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:12 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:14 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 17:21:14 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:21:14 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:21:14 | I | - Evaluator: gptq
25-01-17 17:21:14 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:21:14 | I | - Batch_size: 8
25-01-17 17:21:14 | I |   + Max_seq_length: 2048
25-01-17 17:21:33 | I |     - Results:
25-01-17 17:21:33 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:21:33 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:21:33 | I |       |wikitext |      1|word_perplexity|7.7271|±  |7.7271|
25-01-17 17:21:33 | I |       |val_valid|      1|word_perplexity|7.4357|±  |7.4357|
25-01-17 17:21:33 | I |       
25-01-17 17:21:46 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.617, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.14, wps=36586.9, wpb=4058.2, bsz=2, num_updates=19, lmquant_ppl_wikitext_all_quanted=7.7075, lmquant_ppl_val_all_quanted=7.41352, lmquant_ppl_wikitext_partly_quanted=7.72713, lmquant_ppl_val_partly_quanted=7.4357
25-01-17 17:21:46 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.617 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.14 | wps 36586.9 | wpb 4058.2 | bsz 2 | num_updates 19 | lmquant_ppl_wikitext_all_quanted 7.7075 | lmquant_ppl_val_all_quanted 7.41352 | lmquant_ppl_wikitext_partly_quanted 7.72713 | lmquant_ppl_val_partly_quanted 7.4357
25-01-17 17:21:47 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:21:47 | I | in layer model.layers.4
25-01-17 17:21:47 | I | quantizing weights for layer model.layers.4
25-01-17 17:21:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:21:48 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:21:48 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:21:48 | I |       - range scale = [    1.0000]
25-01-17 17:21:48 | I |         sum  error  = [    0.2351]
25-01-17 17:21:48 | I |         best error  = [    0.2351]
25-01-17 17:21:48 | I |     + error = [0.2351]
25-01-17 17:21:49 | I |       - range scale = [    1.0000]
25-01-17 17:21:49 | I |         sum  error  = [    2.7077]
25-01-17 17:21:49 | I |         best error  = [    2.7077]
25-01-17 17:21:49 | I |     + error = [2.7077]
25-01-17 17:21:49 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:21:50 | I |       - range scale = [    1.0000]
25-01-17 17:21:50 | I |         sum  error  = [    0.2232]
25-01-17 17:21:50 | I |         best error  = [    0.2232]
25-01-17 17:21:50 | I |     + error = [0.2232]
25-01-17 17:21:50 | I |       - range scale = [    1.0000]
25-01-17 17:21:50 | I |         sum  error  = [    2.5480]
25-01-17 17:21:50 | I |         best error  = [    2.5480]
25-01-17 17:21:50 | I |     + error = [2.5480]
25-01-17 17:21:51 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:21:51 | I |       - range scale = [    1.0000]
25-01-17 17:21:51 | I |         sum  error  = [    0.0928]
25-01-17 17:21:51 | I |         best error  = [    0.0928]
25-01-17 17:21:51 | I |     + error = [0.0928]
25-01-17 17:21:52 | I |       - range scale = [    1.0000]
25-01-17 17:21:52 | I |         sum  error  = [    1.0512]
25-01-17 17:21:52 | I |         best error  = [    1.0512]
25-01-17 17:21:52 | I |     + error = [1.0512]
25-01-17 17:21:52 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:21:53 | I |       - range scale = [    1.0000]
25-01-17 17:21:53 | I |         sum  error  = [    0.1143]
25-01-17 17:21:53 | I |         best error  = [    0.1143]
25-01-17 17:21:53 | I |     + error = [0.1143]
25-01-17 17:21:54 | I |       - range scale = [    1.0000]
25-01-17 17:21:54 | I |         sum  error  = [    1.2454]
25-01-17 17:21:54 | I |         best error  = [    1.2454]
25-01-17 17:21:54 | I |     + error = [1.2454]
25-01-17 17:21:54 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:21:54 | I |       - range scale = [    1.0000]
25-01-17 17:21:54 | I |         sum  error  = [    0.4789]
25-01-17 17:21:54 | I |         best error  = [    0.4789]
25-01-17 17:21:54 | I |     + error = [0.4789]
25-01-17 17:21:55 | I |       - range scale = [    1.0000]
25-01-17 17:21:55 | I |         sum  error  = [    5.4625]
25-01-17 17:21:55 | I |         best error  = [    5.4625]
25-01-17 17:21:55 | I |     + error = [5.4625]
25-01-17 17:21:55 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:21:56 | I |       - range scale = [    1.0000]
25-01-17 17:21:56 | I |         sum  error  = [    2.5738]
25-01-17 17:21:56 | I |         best error  = [    2.5738]
25-01-17 17:21:56 | I |     + error = [2.5738]
25-01-17 17:21:57 | I |       - range scale = [    1.0000]
25-01-17 17:21:57 | I |         sum  error  = [   29.2870]
25-01-17 17:21:57 | I |         best error  = [   29.2870]
25-01-17 17:21:57 | I |     + error = [29.2870]
25-01-17 17:21:57 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:21:58 | I |       - range scale = [    1.0000]
25-01-17 17:21:58 | I |         sum  error  = [    0.1930]
25-01-17 17:21:58 | I |         best error  = [    0.1930]
25-01-17 17:21:58 | I |     + error = [0.1930]
25-01-17 17:21:58 | I |       - range scale = [    1.0000]
25-01-17 17:21:58 | I |         sum  error  = [    1.7247]
25-01-17 17:21:58 | I |         best error  = [    1.7247]
25-01-17 17:21:58 | I |     + error = [1.7247]
25-01-17 17:21:59 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:22:00 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:22:01 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:22:03 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:22:04 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:22:05 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:22:07 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:22:10 | I | quantizing activations for layer model.layers.4
25-01-17 17:22:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:22:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:22:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:22:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:22:13 | I | forward this layer
25-01-17 17:22:13 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/38.pt
25-01-17 17:22:13 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/38.pt
25-01-17 17:22:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:22:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:22:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:22:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:22:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:22:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:22:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:22:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:22:13 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:22:13 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:22:13 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:22:13 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:22:13 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:22:13 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:22:13 | I | in layer model.layers.4
25-01-17 17:22:13 | I | quantizing weights for layer model.layers.4
25-01-17 17:22:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:22:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:22:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:22:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:22:14 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:22:14 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:22:15 | I |       - range scale = [    1.0000]
25-01-17 17:22:15 | I |         sum  error  = [    0.2376]
25-01-17 17:22:15 | I |         best error  = [    0.2376]
25-01-17 17:22:15 | I |     + error = [0.2376]
25-01-17 17:22:15 | I |       - range scale = [    1.0000]
25-01-17 17:22:15 | I |         sum  error  = [    2.6620]
25-01-17 17:22:15 | I |         best error  = [    2.6620]
25-01-17 17:22:15 | I |     + error = [2.6620]
25-01-17 17:22:16 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:22:16 | I |       - range scale = [    1.0000]
25-01-17 17:22:16 | I |         sum  error  = [    0.2216]
25-01-17 17:22:16 | I |         best error  = [    0.2216]
25-01-17 17:22:16 | I |     + error = [0.2216]
25-01-17 17:22:17 | I |       - range scale = [    1.0000]
25-01-17 17:22:17 | I |         sum  error  = [    2.7011]
25-01-17 17:22:17 | I |         best error  = [    2.7011]
25-01-17 17:22:17 | I |     + error = [2.7011]
25-01-17 17:22:17 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:22:18 | I |       - range scale = [    1.0000]
25-01-17 17:22:18 | I |         sum  error  = [    0.0926]
25-01-17 17:22:18 | I |         best error  = [    0.0926]
25-01-17 17:22:18 | I |     + error = [0.0926]
25-01-17 17:22:19 | I |       - range scale = [    1.0000]
25-01-17 17:22:19 | I |         sum  error  = [    1.0493]
25-01-17 17:22:19 | I |         best error  = [    1.0493]
25-01-17 17:22:19 | I |     + error = [1.0493]
25-01-17 17:22:19 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:22:19 | I |       - range scale = [    1.0000]
25-01-17 17:22:19 | I |         sum  error  = [    0.1149]
25-01-17 17:22:19 | I |         best error  = [    0.1149]
25-01-17 17:22:19 | I |     + error = [0.1149]
25-01-17 17:22:20 | I |       - range scale = [    1.0000]
25-01-17 17:22:20 | I |         sum  error  = [    1.2553]
25-01-17 17:22:20 | I |         best error  = [    1.2553]
25-01-17 17:22:20 | I |     + error = [1.2553]
25-01-17 17:22:20 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:22:21 | I |       - range scale = [    1.0000]
25-01-17 17:22:21 | I |         sum  error  = [    0.4775]
25-01-17 17:22:21 | I |         best error  = [    0.4775]
25-01-17 17:22:21 | I |     + error = [0.4775]
25-01-17 17:22:22 | I |       - range scale = [    1.0000]
25-01-17 17:22:22 | I |         sum  error  = [    5.4513]
25-01-17 17:22:22 | I |         best error  = [    5.4513]
25-01-17 17:22:22 | I |     + error = [5.4513]
25-01-17 17:22:22 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:22:23 | I |       - range scale = [    1.0000]
25-01-17 17:22:23 | I |         sum  error  = [    2.5700]
25-01-17 17:22:23 | I |         best error  = [    2.5700]
25-01-17 17:22:23 | I |     + error = [2.5700]
25-01-17 17:22:23 | I |       - range scale = [    1.0000]
25-01-17 17:22:23 | I |         sum  error  = [   29.2332]
25-01-17 17:22:23 | I |         best error  = [   29.2332]
25-01-17 17:22:23 | I |     + error = [29.2332]
25-01-17 17:22:23 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:22:24 | I |       - range scale = [    1.0000]
25-01-17 17:22:24 | I |         sum  error  = [    0.2037]
25-01-17 17:22:24 | I |         best error  = [    0.2037]
25-01-17 17:22:24 | I |     + error = [0.2037]
25-01-17 17:22:25 | I |       - range scale = [    1.0000]
25-01-17 17:22:25 | I |         sum  error  = [    1.8247]
25-01-17 17:22:25 | I |         best error  = [    1.8247]
25-01-17 17:22:25 | I |     + error = [1.8247]
25-01-17 17:22:25 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:22:26 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:22:28 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:22:29 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:22:30 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:22:32 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:22:33 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:22:37 | I | quantizing activations for layer model.layers.4
25-01-17 17:22:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:22:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:22:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:22:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:22:39 | I | forward this layer
25-01-17 17:22:39 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/39.pt
25-01-17 17:22:39 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/39.pt
25-01-17 17:22:39 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:22:39 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:22:39 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:22:39 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:22:39 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:22:39 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:22:39 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:22:39 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:22:39 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:22:39 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:22:39 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:22:39 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:22:39 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:22:39 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:22:39 | I | [19] done with optimizer step
25-01-17 17:22:39 | I | epoch 001:     20 / 409600000 loss=1.03714e-05, loss_sum=0.235567, wps=220.4, ups=0.01, wpb=32768, bsz=64, num_updates=20, lr=0.002, gnorm=0, clip=0, loss_scale=128, train_wall=53, cuda_gb_allocated=12.1, cuda_gb_reserved=13.6, cuda_gb_free=11.6, wall=3264
25-01-17 17:22:39 | I | begin validation on "valid" subset on rank 0
25-01-17 17:22:39 | I | got valid iterator on "valid" subset on rank 0
25-01-17 17:22:39 | I | Valid: Start iterating over samples
25-01-17 17:22:39 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:22:39 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:22:39 | I | - Evaluator: gptq
25-01-17 17:22:39 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:22:39 | I | - Batch_size: 8
25-01-17 17:22:39 | I |   + Max_seq_length: 2048
25-01-17 17:22:57 | I |     - Results:
25-01-17 17:22:57 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:22:57 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:22:57 | I |       |wikitext |      1|word_perplexity|7.7075|±  |7.7075|
25-01-17 17:22:57 | I |       |val_valid|      1|word_perplexity|7.4136|±  |7.4136|
25-01-17 17:22:57 | I |       
25-01-17 17:22:57 | I | in valid, quantize current layer weights
25-01-17 17:22:58 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 17:23:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:12 | I |       - range scale = [    1.0000]
25-01-17 17:23:12 | I |         sum  error  = [    0.6606]
25-01-17 17:23:12 | I |         best error  = [    0.6606]
25-01-17 17:23:12 | I |     + error = [0.6606]
25-01-17 17:23:13 | I |       - range scale = [    1.0000]
25-01-17 17:23:13 | I |         sum  error  = [    7.3385]
25-01-17 17:23:13 | I |         best error  = [    7.3385]
25-01-17 17:23:13 | I |     + error = [7.3385]
25-01-17 17:23:14 | I |       - range scale = [    1.0000]
25-01-17 17:23:14 | I |         sum  error  = [    0.6551]
25-01-17 17:23:14 | I |         best error  = [    0.6551]
25-01-17 17:23:14 | I |     + error = [0.6551]
25-01-17 17:23:15 | I |       - range scale = [    1.0000]
25-01-17 17:23:15 | I |         sum  error  = [    7.1255]
25-01-17 17:23:15 | I |         best error  = [    7.1255]
25-01-17 17:23:15 | I |     + error = [7.1255]
25-01-17 17:23:16 | I |       - range scale = [    1.0000]
25-01-17 17:23:16 | I |         sum  error  = [    0.0937]
25-01-17 17:23:16 | I |         best error  = [    0.0937]
25-01-17 17:23:16 | I |     + error = [0.0937]
25-01-17 17:23:17 | I |       - range scale = [    1.0000]
25-01-17 17:23:17 | I |         sum  error  = [    1.0592]
25-01-17 17:23:17 | I |         best error  = [    1.0592]
25-01-17 17:23:17 | I |     + error = [1.0592]
25-01-17 17:23:17 | I |       - range scale = [    1.0000]
25-01-17 17:23:17 | I |         sum  error  = [    0.0960]
25-01-17 17:23:17 | I |         best error  = [    0.0960]
25-01-17 17:23:17 | I |     + error = [0.0960]
25-01-17 17:23:18 | I |       - range scale = [    1.0000]
25-01-17 17:23:18 | I |         sum  error  = [    1.0475]
25-01-17 17:23:18 | I |         best error  = [    1.0475]
25-01-17 17:23:18 | I |     + error = [1.0475]
25-01-17 17:23:19 | I |       - range scale = [    1.0000]
25-01-17 17:23:19 | I |         sum  error  = [    0.4814]
25-01-17 17:23:19 | I |         best error  = [    0.4814]
25-01-17 17:23:19 | I |     + error = [0.4814]
25-01-17 17:23:20 | I |       - range scale = [    1.0000]
25-01-17 17:23:20 | I |         sum  error  = [    5.5039]
25-01-17 17:23:20 | I |         best error  = [    5.5039]
25-01-17 17:23:20 | I |     + error = [5.5039]
25-01-17 17:23:21 | I |       - range scale = [    1.0000]
25-01-17 17:23:21 | I |         sum  error  = [    2.5866]
25-01-17 17:23:21 | I |         best error  = [    2.5866]
25-01-17 17:23:21 | I |     + error = [2.5866]
25-01-17 17:23:21 | I |       - range scale = [    1.0000]
25-01-17 17:23:21 | I |         sum  error  = [   29.4843]
25-01-17 17:23:21 | I |         best error  = [   29.4843]
25-01-17 17:23:21 | I |     + error = [29.4843]
25-01-17 17:23:22 | I |       - range scale = [    1.0000]
25-01-17 17:23:22 | I |         sum  error  = [    0.1927]
25-01-17 17:23:22 | I |         best error  = [    0.1927]
25-01-17 17:23:22 | I |     + error = [0.1927]
25-01-17 17:23:23 | I |       - range scale = [    1.0000]
25-01-17 17:23:23 | I |         sum  error  = [    1.7468]
25-01-17 17:23:23 | I |         best error  = [    1.7468]
25-01-17 17:23:23 | I |     + error = [1.7468]
25-01-17 17:23:36 | I | in valid, quantize current layer acts
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:23:43 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 17:23:43 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:23:43 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:23:43 | I | - Evaluator: gptq
25-01-17 17:23:43 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:23:43 | I | - Batch_size: 8
25-01-17 17:23:43 | I |   + Max_seq_length: 2048
25-01-17 17:24:02 | I |     - Results:
25-01-17 17:24:02 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:24:02 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:24:02 | I |       |wikitext |      1|word_perplexity|7.7262|±  |7.7262|
25-01-17 17:24:02 | I |       |val_valid|      1|word_perplexity|7.4339|±  |7.4339|
25-01-17 17:24:02 | I |       
25-01-17 17:24:15 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.616, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.13, wps=36406, wpb=4058.2, bsz=2, num_updates=20, lmquant_ppl_wikitext_all_quanted=7.70752, lmquant_ppl_val_all_quanted=7.41358, lmquant_ppl_wikitext_partly_quanted=7.72617, lmquant_ppl_val_partly_quanted=7.43394
25-01-17 17:24:15 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.616 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.13 | wps 36406 | wpb 4058.2 | bsz 2 | num_updates 20 | lmquant_ppl_wikitext_all_quanted 7.70752 | lmquant_ppl_val_all_quanted 7.41358 | lmquant_ppl_wikitext_partly_quanted 7.72617 | lmquant_ppl_val_partly_quanted 7.43394
25-01-17 17:24:15 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:24:15 | I | in layer model.layers.4
25-01-17 17:24:15 | I | quantizing weights for layer model.layers.4
25-01-17 17:24:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:24:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:24:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:24:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:24:17 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:24:17 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:24:17 | I |       - range scale = [    1.0000]
25-01-17 17:24:17 | I |         sum  error  = [    0.2328]
25-01-17 17:24:17 | I |         best error  = [    0.2328]
25-01-17 17:24:17 | I |     + error = [0.2328]
25-01-17 17:24:18 | I |       - range scale = [    1.0000]
25-01-17 17:24:18 | I |         sum  error  = [    2.5993]
25-01-17 17:24:18 | I |         best error  = [    2.5993]
25-01-17 17:24:18 | I |     + error = [2.5993]
25-01-17 17:24:18 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:24:19 | I |       - range scale = [    1.0000]
25-01-17 17:24:19 | I |         sum  error  = [    0.2144]
25-01-17 17:24:19 | I |         best error  = [    0.2144]
25-01-17 17:24:19 | I |     + error = [0.2144]
25-01-17 17:24:20 | I |       - range scale = [    1.0000]
25-01-17 17:24:20 | I |         sum  error  = [    2.6101]
25-01-17 17:24:20 | I |         best error  = [    2.6101]
25-01-17 17:24:20 | I |     + error = [2.6101]
25-01-17 17:24:20 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:24:20 | I |       - range scale = [    1.0000]
25-01-17 17:24:20 | I |         sum  error  = [    0.0922]
25-01-17 17:24:20 | I |         best error  = [    0.0922]
25-01-17 17:24:20 | I |     + error = [0.0922]
25-01-17 17:24:21 | I |       - range scale = [    1.0000]
25-01-17 17:24:21 | I |         sum  error  = [    1.0522]
25-01-17 17:24:21 | I |         best error  = [    1.0522]
25-01-17 17:24:21 | I |     + error = [1.0522]
25-01-17 17:24:21 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:24:22 | I |       - range scale = [    1.0000]
25-01-17 17:24:22 | I |         sum  error  = [    0.1020]
25-01-17 17:24:22 | I |         best error  = [    0.1020]
25-01-17 17:24:22 | I |     + error = [0.1020]
25-01-17 17:24:23 | I |       - range scale = [    1.0000]
25-01-17 17:24:23 | I |         sum  error  = [    1.1282]
25-01-17 17:24:23 | I |         best error  = [    1.1282]
25-01-17 17:24:23 | I |     + error = [1.1282]
25-01-17 17:24:23 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:24:24 | I |       - range scale = [    1.0000]
25-01-17 17:24:24 | I |         sum  error  = [    0.4776]
25-01-17 17:24:24 | I |         best error  = [    0.4776]
25-01-17 17:24:24 | I |     + error = [0.4776]
25-01-17 17:24:24 | I |       - range scale = [    1.0000]
25-01-17 17:24:24 | I |         sum  error  = [    5.4589]
25-01-17 17:24:24 | I |         best error  = [    5.4589]
25-01-17 17:24:24 | I |     + error = [5.4589]
25-01-17 17:24:25 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:24:25 | I |       - range scale = [    1.0000]
25-01-17 17:24:25 | I |         sum  error  = [    2.5679]
25-01-17 17:24:25 | I |         best error  = [    2.5679]
25-01-17 17:24:25 | I |     + error = [2.5679]
25-01-17 17:24:26 | I |       - range scale = [    1.0000]
25-01-17 17:24:26 | I |         sum  error  = [   29.2669]
25-01-17 17:24:26 | I |         best error  = [   29.2669]
25-01-17 17:24:26 | I |     + error = [29.2669]
25-01-17 17:24:26 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:24:27 | I |       - range scale = [    1.0000]
25-01-17 17:24:27 | I |         sum  error  = [    0.2022]
25-01-17 17:24:27 | I |         best error  = [    0.2022]
25-01-17 17:24:27 | I |     + error = [0.2022]
25-01-17 17:24:28 | I |       - range scale = [    1.0000]
25-01-17 17:24:28 | I |         sum  error  = [    1.8335]
25-01-17 17:24:28 | I |         best error  = [    1.8335]
25-01-17 17:24:28 | I |     + error = [1.8335]
25-01-17 17:24:28 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:24:29 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:24:31 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:24:32 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:24:33 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:24:35 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:24:36 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:24:40 | I | quantizing activations for layer model.layers.4
25-01-17 17:24:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:24:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:24:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:24:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:24:42 | I | forward this layer
25-01-17 17:24:42 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/40.pt
25-01-17 17:24:42 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/40.pt
25-01-17 17:24:43 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:24:43 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:24:43 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:24:43 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:24:43 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:24:43 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:24:43 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:24:43 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:24:43 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:24:43 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:24:43 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:24:43 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:24:43 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:24:43 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:24:43 | I | in layer model.layers.4
25-01-17 17:24:43 | I | quantizing weights for layer model.layers.4
25-01-17 17:24:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:24:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:24:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:24:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:24:44 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:24:44 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:24:44 | I |       - range scale = [    1.0000]
25-01-17 17:24:44 | I |         sum  error  = [    0.2341]
25-01-17 17:24:44 | I |         best error  = [    0.2341]
25-01-17 17:24:44 | I |     + error = [0.2341]
25-01-17 17:24:45 | I |       - range scale = [    1.0000]
25-01-17 17:24:45 | I |         sum  error  = [    2.6126]
25-01-17 17:24:45 | I |         best error  = [    2.6126]
25-01-17 17:24:45 | I |     + error = [2.6126]
25-01-17 17:24:45 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:24:46 | I |       - range scale = [    1.0000]
25-01-17 17:24:46 | I |         sum  error  = [    0.2126]
25-01-17 17:24:46 | I |         best error  = [    0.2126]
25-01-17 17:24:46 | I |     + error = [0.2126]
25-01-17 17:24:47 | I |       - range scale = [    1.0000]
25-01-17 17:24:47 | I |         sum  error  = [    2.5464]
25-01-17 17:24:47 | I |         best error  = [    2.5464]
25-01-17 17:24:47 | I |     + error = [2.5464]
25-01-17 17:24:47 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:24:48 | I |       - range scale = [    1.0000]
25-01-17 17:24:48 | I |         sum  error  = [    0.0926]
25-01-17 17:24:48 | I |         best error  = [    0.0926]
25-01-17 17:24:48 | I |     + error = [0.0926]
25-01-17 17:24:48 | I |       - range scale = [    1.0000]
25-01-17 17:24:48 | I |         sum  error  = [    1.0526]
25-01-17 17:24:48 | I |         best error  = [    1.0526]
25-01-17 17:24:48 | I |     + error = [1.0526]
25-01-17 17:24:49 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:24:49 | I |       - range scale = [    1.0000]
25-01-17 17:24:49 | I |         sum  error  = [    0.1158]
25-01-17 17:24:49 | I |         best error  = [    0.1158]
25-01-17 17:24:49 | I |     + error = [0.1158]
25-01-17 17:24:50 | I |       - range scale = [    1.0000]
25-01-17 17:24:50 | I |         sum  error  = [    1.2586]
25-01-17 17:24:50 | I |         best error  = [    1.2586]
25-01-17 17:24:50 | I |     + error = [1.2586]
25-01-17 17:24:50 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:24:51 | I |       - range scale = [    1.0000]
25-01-17 17:24:51 | I |         sum  error  = [    0.4784]
25-01-17 17:24:51 | I |         best error  = [    0.4784]
25-01-17 17:24:51 | I |     + error = [0.4784]
25-01-17 17:24:52 | I |       - range scale = [    1.0000]
25-01-17 17:24:52 | I |         sum  error  = [    5.4641]
25-01-17 17:24:52 | I |         best error  = [    5.4641]
25-01-17 17:24:52 | I |     + error = [5.4641]
25-01-17 17:24:52 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:24:52 | I |       - range scale = [    1.0000]
25-01-17 17:24:52 | I |         sum  error  = [    2.5683]
25-01-17 17:24:52 | I |         best error  = [    2.5683]
25-01-17 17:24:52 | I |     + error = [2.5683]
25-01-17 17:24:53 | I |       - range scale = [    1.0000]
25-01-17 17:24:53 | I |         sum  error  = [   29.2732]
25-01-17 17:24:53 | I |         best error  = [   29.2732]
25-01-17 17:24:53 | I |     + error = [29.2732]
25-01-17 17:24:53 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:24:54 | I |       - range scale = [    1.0000]
25-01-17 17:24:54 | I |         sum  error  = [    0.1966]
25-01-17 17:24:54 | I |         best error  = [    0.1966]
25-01-17 17:24:54 | I |     + error = [0.1966]
25-01-17 17:24:55 | I |       - range scale = [    1.0000]
25-01-17 17:24:55 | I |         sum  error  = [    1.7725]
25-01-17 17:24:55 | I |         best error  = [    1.7725]
25-01-17 17:24:55 | I |     + error = [1.7725]
25-01-17 17:24:55 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:24:56 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:24:58 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:24:59 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:25:01 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:25:02 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:25:03 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:25:07 | I | quantizing activations for layer model.layers.4
25-01-17 17:25:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:09 | I | forward this layer
25-01-17 17:25:09 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_4/41.pt
25-01-17 17:25:09 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/41.pt
25-01-17 17:25:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:25:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:25:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:25:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:25:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:25:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:25:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:25:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:25:09 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:25:09 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:25:09 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:25:09 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:25:09 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:25:09 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:25:09 | I | [20] done with optimizer step
25-01-17 17:25:10 | I | epoch 001:     21 / 409600000 loss=1.05739e-05, loss_sum=0.240166, wps=218.2, ups=0.01, wpb=32768, bsz=64, num_updates=21, lr=0.0021, gnorm=0, clip=0, loss_scale=128, train_wall=54, cuda_gb_allocated=12.1, cuda_gb_reserved=13.6, cuda_gb_free=11.6, wall=3414
25-01-17 17:25:10 | I | begin validation on "valid" subset on rank 0
25-01-17 17:25:10 | I | got valid iterator on "valid" subset on rank 0
25-01-17 17:25:10 | I | Valid: Start iterating over samples
25-01-17 17:25:10 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:25:10 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:25:10 | I | - Evaluator: gptq
25-01-17 17:25:10 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:25:10 | I | - Batch_size: 8
25-01-17 17:25:10 | I |   + Max_seq_length: 2048
25-01-17 17:25:27 | I |     - Results:
25-01-17 17:25:27 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:25:27 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:25:27 | I |       |wikitext |      1|word_perplexity|7.7075|±  |7.7075|
25-01-17 17:25:27 | I |       |val_valid|      1|word_perplexity|7.4134|±  |7.4134|
25-01-17 17:25:27 | I |       
25-01-17 17:25:27 | I | in valid, quantize current layer weights
25-01-17 17:25:28 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 17:25:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:25:42 | I |       - range scale = [    1.0000]
25-01-17 17:25:42 | I |         sum  error  = [    0.6604]
25-01-17 17:25:42 | I |         best error  = [    0.6604]
25-01-17 17:25:42 | I |     + error = [0.6604]
25-01-17 17:25:43 | I |       - range scale = [    1.0000]
25-01-17 17:25:43 | I |         sum  error  = [    7.3382]
25-01-17 17:25:43 | I |         best error  = [    7.3382]
25-01-17 17:25:43 | I |     + error = [7.3382]
25-01-17 17:25:44 | I |       - range scale = [    1.0000]
25-01-17 17:25:44 | I |         sum  error  = [    0.6550]
25-01-17 17:25:44 | I |         best error  = [    0.6550]
25-01-17 17:25:44 | I |     + error = [0.6550]
25-01-17 17:25:45 | I |       - range scale = [    1.0000]
25-01-17 17:25:45 | I |         sum  error  = [    7.1253]
25-01-17 17:25:45 | I |         best error  = [    7.1253]
25-01-17 17:25:45 | I |     + error = [7.1253]
25-01-17 17:25:46 | I |       - range scale = [    1.0000]
25-01-17 17:25:46 | I |         sum  error  = [    0.0937]
25-01-17 17:25:46 | I |         best error  = [    0.0937]
25-01-17 17:25:46 | I |     + error = [0.0937]
25-01-17 17:25:47 | I |       - range scale = [    1.0000]
25-01-17 17:25:47 | I |         sum  error  = [    1.0592]
25-01-17 17:25:47 | I |         best error  = [    1.0592]
25-01-17 17:25:47 | I |     + error = [1.0592]
25-01-17 17:25:48 | I |       - range scale = [    1.0000]
25-01-17 17:25:48 | I |         sum  error  = [    0.0960]
25-01-17 17:25:48 | I |         best error  = [    0.0960]
25-01-17 17:25:48 | I |     + error = [0.0960]
25-01-17 17:25:48 | I |       - range scale = [    1.0000]
25-01-17 17:25:48 | I |         sum  error  = [    1.0475]
25-01-17 17:25:48 | I |         best error  = [    1.0475]
25-01-17 17:25:48 | I |     + error = [1.0475]
25-01-17 17:25:49 | I |       - range scale = [    1.0000]
25-01-17 17:25:49 | I |         sum  error  = [    0.4814]
25-01-17 17:25:49 | I |         best error  = [    0.4814]
25-01-17 17:25:49 | I |     + error = [0.4814]
25-01-17 17:25:50 | I |       - range scale = [    1.0000]
25-01-17 17:25:50 | I |         sum  error  = [    5.5039]
25-01-17 17:25:50 | I |         best error  = [    5.5039]
25-01-17 17:25:50 | I |     + error = [5.5039]
25-01-17 17:25:51 | I |       - range scale = [    1.0000]
25-01-17 17:25:51 | I |         sum  error  = [    2.5865]
25-01-17 17:25:51 | I |         best error  = [    2.5865]
25-01-17 17:25:51 | I |     + error = [2.5865]
25-01-17 17:25:51 | I |       - range scale = [    1.0000]
25-01-17 17:25:51 | I |         sum  error  = [   29.4843]
25-01-17 17:25:51 | I |         best error  = [   29.4843]
25-01-17 17:25:51 | I |     + error = [29.4843]
25-01-17 17:25:52 | I |       - range scale = [    1.0000]
25-01-17 17:25:52 | I |         sum  error  = [    0.1927]
25-01-17 17:25:52 | I |         best error  = [    0.1927]
25-01-17 17:25:52 | I |     + error = [0.1927]
25-01-17 17:25:53 | I |       - range scale = [    1.0000]
25-01-17 17:25:53 | I |         sum  error  = [    1.7468]
25-01-17 17:25:53 | I |         best error  = [    1.7468]
25-01-17 17:25:53 | I |     + error = [1.7468]
25-01-17 17:26:06 | I | in valid, quantize current layer acts
25-01-17 17:26:06 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:09 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:26:12 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 17:26:12 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:26:12 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:26:12 | I | - Evaluator: gptq
25-01-17 17:26:12 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:26:12 | I | - Batch_size: 8
25-01-17 17:26:12 | I |   + Max_seq_length: 2048
25-01-17 17:26:31 | I |     - Results:
25-01-17 17:26:32 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:26:32 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:26:32 | I |       |wikitext |      1|word_perplexity|7.7269|±  |7.7269|
25-01-17 17:26:32 | I |       |val_valid|      1|word_perplexity|7.4299|±  |7.4299|
25-01-17 17:26:32 | I |       
