25-01-15 02:14:53 | I | === Configurations ===
25-01-15 02:14:53 | I | LlmRunConfig(
25-01-15 02:14:53 | I |   model=LlmModelConfig(
25-01-15 02:14:53 | I |     name=tiny-llama-1.1b,
25-01-15 02:14:53 | I |     path=/data/gyy/TinyLlama,
25-01-15 02:14:53 | I |     root=/dataset/models,
25-01-15 02:14:53 | I |     local_path=/dataset/models/tiny/tiny-llama-1.1b,
25-01-15 02:14:53 | I |     local_root=/dataset/models,
25-01-15 02:14:53 | I |     family=tiny,
25-01-15 02:14:53 | I |     size=1.1),
25-01-15 02:14:53 | I |   eval=LlmEvalConfig(
25-01-15 02:14:53 | I |     num_gpus=2,
25-01-15 02:14:53 | I |     batch_size=8,
25-01-15 02:14:53 | I |     output_root=runs,
25-01-15 02:14:53 | I |     output_dirname=skip.y.[q]-krnl-rot-rodr.Seq.[fc2]-smth.xw.a0p3.b0p7.[AbsMax].[out+fc2].yx.a0p5.b0.[AbsMax].[qk]-pileval.128x1024.[0-0]-250115.021453,
25-01-15 02:14:53 | I |     attach_timestamp=True,
25-01-15 02:14:53 | I |     timestamp=250115.021453,
25-01-15 02:14:53 | I |     output_dirname_without_timestamp=skip.y.[q]-krnl-rot-rodr.Seq.[fc2]-smth.xw.a0p3.b0p7.[AbsMax].[out+fc2].yx.a0p5.b0.[AbsMax].[qk]-pileval.128x1024.[0-0],
25-01-15 02:14:53 | I |     tasks=['wikitext'],
25-01-15 02:14:53 | I |     max_seq_length=-4096,
25-01-15 02:14:53 | I |     evaluator=gptq),
25-01-15 02:14:53 | I |   calib=LlmCalibConfig(
25-01-15 02:14:53 | I |     data=pileval,
25-01-15 02:14:53 | I |     num_samples=128,
25-01-15 02:14:53 | I |     cache_root=runs,
25-01-15 02:14:53 | I |     cache_dirpath=runs/llm/cache/pileval.128x1024.[0-0],
25-01-15 02:14:53 | I |     dataset_path=mit-han-lab/pile-val-backup,
25-01-15 02:14:53 | I |     seq_length=1024,
25-01-15 02:14:53 | I |     min_seq_length=0,
25-01-15 02:14:53 | I |     max_seq_length=0,
25-01-15 02:14:53 | I |     local_dataset_path=/dataset/pile),
25-01-15 02:14:53 | I |   quant=LlmQuantConfig(
25-01-15 02:14:53 | I |     wgts=WeightQuantizerConfig(
25-01-15 02:14:53 | I |       dtype=zint4,
25-01-15 02:14:53 | I |       group_shapes=((1, -1, -1), (1, 128, -1)),
25-01-15 02:14:53 | I |       group_scale_dtypes=(torch.float16, sint8),
25-01-15 02:14:53 | I |       compute_dtype=sint8,
25-01-15 02:14:53 | I |       compute_group_level=0,
25-01-15 02:14:53 | I |       saturate_compute_dtype=False,
25-01-15 02:14:53 | I |       exponent_scaling_level=2,
25-01-15 02:14:53 | I |       skips=['embed', 'head', 'router'],
25-01-15 02:14:53 | I |       static=True,
25-01-15 02:14:53 | I |       calib_kernel=QuantizerKernelConfig(
25-01-15 02:14:53 | I |         _kernels={'proj_1st': QuantGPTQConfig(includes=['proj_1st', 'proj_2nd', 'proj_out', 'proj_qkv'], damp_percentage=0.01, block_size=128, num_inv_tries=250, hessian_block_size=512), 'proj_2nd': QuantGPTQConfig(includes=['proj_1st', 'proj_2nd', 'proj_out', 'proj_qkv'], damp_percentage=0.01, block_size=128, num_inv_tries=250, hessian_block_size=512), 'proj_out': QuantGPTQConfig(includes=['proj_1st', 'proj_2nd', 'proj_out', 'proj_qkv'], damp_percentage=0.01, block_size=128, num_inv_tries=250, hessian_block_size=512), 'proj_qkv': QuantGPTQConfig(includes=['proj_1st', 'proj_2nd', 'proj_out', 'proj_qkv'], damp_percentage=0.01, block_size=128, num_inv_tries=250, hessian_block_size=512)},
25-01-15 02:14:53 | I |         gptq=QuantGPTQConfig(
25-01-15 02:14:53 | I |           includes=['proj_1st', 'proj_2nd', 'proj_out', 'proj_qkv'],
25-01-15 02:14:53 | I |           damp_percentage=0.01,
25-01-15 02:14:53 | I |           block_size=128,
25-01-15 02:14:53 | I |           num_inv_tries=250,
25-01-15 02:14:53 | I |           hessian_block_size=512)),
25-01-15 02:14:53 | I |       calib_range=DynamicRangeCalibConfig(
25-01-15 02:14:53 | I |         degree=2,
25-01-15 02:14:53 | I |         skips=[],
25-01-15 02:14:53 | I |         objective=SearchBasedCalibObjective.OutputsError,
25-01-15 02:14:53 | I |         strategy=SearchBasedCalibStrategy.Manual,
25-01-15 02:14:53 | I |         granularity=SearchBasedCalibGranularity.Group,
25-01-15 02:14:53 | I |         element_batch_size=64,
25-01-15 02:14:53 | I |         sample_batch_size=-1,
25-01-15 02:14:53 | I |         element_size=512,
25-01-15 02:14:53 | I |         sample_size=-1,
25-01-15 02:14:53 | I |         pre_reshape=True,
25-01-15 02:14:53 | I |         outputs_device=cpu,
25-01-15 02:14:53 | I |         allow_kernel_calib=False,
25-01-15 02:14:53 | I |         ratio=1.0,
25-01-15 02:14:53 | I |         max_shrink=0.2,
25-01-15 02:14:53 | I |         max_expand=1.0,
25-01-15 02:14:53 | I |         num_grids=80)),
25-01-15 02:14:53 | I |     ipts=ActivationQuantizerConfig(
25-01-15 02:14:53 | I |       dtype=sint8,
25-01-15 02:14:53 | I |       group_shapes=((1, -1, -1),),
25-01-15 02:14:53 | I |       group_scale_dtypes=(torch.float16,),
25-01-15 02:14:53 | I |       compute_dtype=None,
25-01-15 02:14:53 | I |       compute_group_level=-1,
25-01-15 02:14:53 | I |       saturate_compute_dtype=False,
25-01-15 02:14:53 | I |       exponent_scaling_level=1,
25-01-15 02:14:53 | I |       skips=['embed', 'head', 'router'],
25-01-15 02:14:53 | I |       static=False,
25-01-15 02:14:53 | I |       calib_kernel=None,
25-01-15 02:14:53 | I |       calib_range=None),
25-01-15 02:14:53 | I |     opts=ActivationQuantizerConfig(
25-01-15 02:14:53 | I |       dtype=zint4,
25-01-15 02:14:53 | I |       group_shapes=((1, 128, -1),),
25-01-15 02:14:53 | I |       group_scale_dtypes=(torch.float16,),
25-01-15 02:14:53 | I |       compute_dtype=None,
25-01-15 02:14:53 | I |       compute_group_level=-1,
25-01-15 02:14:53 | I |       saturate_compute_dtype=False,
25-01-15 02:14:53 | I |       exponent_scaling_level=1,
25-01-15 02:14:53 | I |       skips=['attn_q'],
25-01-15 02:14:53 | I |       static=False,
25-01-15 02:14:53 | I |       calib_kernel=None,
25-01-15 02:14:53 | I |       calib_range=None),
25-01-15 02:14:53 | I |     rotation=QuantRotationConfig(
25-01-15 02:14:53 | I |       random=False,
25-01-15 02:14:53 | I |       transforms=[]),
25-01-15 02:14:53 | I |     reorder=QuantReorderConfig(
25-01-15 02:14:53 | I |       degree=2,
25-01-15 02:14:53 | I |       skips=['proj_out', 'proj_qkv', 'residual'],
25-01-15 02:14:53 | I |       objective=SearchBasedCalibObjective.OutputsError,
25-01-15 02:14:53 | I |       strategy=SearchBasedCalibStrategy.Manual,
25-01-15 02:14:53 | I |       granularity=SearchBasedCalibGranularity.Layer,
25-01-15 02:14:53 | I |       element_batch_size=-1,
25-01-15 02:14:53 | I |       sample_batch_size=-1,
25-01-15 02:14:53 | I |       element_size=-1,
25-01-15 02:14:53 | I |       sample_size=-1,
25-01-15 02:14:53 | I |       pre_reshape=True,
25-01-15 02:14:53 | I |       outputs_device=cpu,
25-01-15 02:14:53 | I |       allow_kernel_calib=False,
25-01-15 02:14:53 | I |       channel_metric=ChannelMetric.InputsAbsMax,
25-01-15 02:14:53 | I |       channel_index=ChannelIndex.Sequential,
25-01-15 02:14:53 | I |       dynamic=False),
25-01-15 02:14:53 | I |     smooth=QuantSmoothConfig(
25-01-15 02:14:53 | I |       xw=QuantSmoothCalibConfig(
25-01-15 02:14:53 | I |         degree=2,
25-01-15 02:14:53 | I |         skips=['proj_1st', 'proj_qkv'],
25-01-15 02:14:53 | I |         objective=SearchBasedCalibObjective.OutputsError,
25-01-15 02:14:53 | I |         strategy=SearchBasedCalibStrategy.Manual,
25-01-15 02:14:53 | I |         granularity=SearchBasedCalibGranularity.Layer,
25-01-15 02:14:53 | I |         element_batch_size=-1,
25-01-15 02:14:53 | I |         sample_batch_size=-1,
25-01-15 02:14:53 | I |         element_size=-1,
25-01-15 02:14:53 | I |         sample_size=-1,
25-01-15 02:14:53 | I |         pre_reshape=True,
25-01-15 02:14:53 | I |         outputs_device=cpu,
25-01-15 02:14:53 | I |         allow_kernel_calib=False,
25-01-15 02:14:53 | I |         ranges=[(<RangeMode.AbsMax: 1>, <RangeMode.AbsMax: 1>)],
25-01-15 02:14:53 | I |         x_ranges=[<RangeMode.AbsMax: 1>],
25-01-15 02:14:53 | I |         w_ranges=[<RangeMode.AbsMax: 1>],
25-01-15 02:14:53 | I |         alpha=0.3,
25-01-15 02:14:53 | I |         beta=0.7,
25-01-15 02:14:53 | I |         num_grids=20),
25-01-15 02:14:53 | I |       yx=QuantSmoothCalibConfig(
25-01-15 02:14:53 | I |         degree=2,
25-01-15 02:14:53 | I |         skips=[],
25-01-15 02:14:53 | I |         objective=SearchBasedCalibObjective.OutputsError,
25-01-15 02:14:53 | I |         strategy=SearchBasedCalibStrategy.Manual,
25-01-15 02:14:53 | I |         granularity=SearchBasedCalibGranularity.Layer,
25-01-15 02:14:53 | I |         element_batch_size=-1,
25-01-15 02:14:53 | I |         sample_batch_size=-1,
25-01-15 02:14:53 | I |         element_size=-1,
25-01-15 02:14:53 | I |         sample_size=-1,
25-01-15 02:14:53 | I |         pre_reshape=True,
25-01-15 02:14:53 | I |         outputs_device=cpu,
25-01-15 02:14:53 | I |         allow_kernel_calib=False,
25-01-15 02:14:53 | I |         ranges=[(<RangeMode.AbsMax: 1>, <RangeMode.AbsMax: 1>)],
25-01-15 02:14:53 | I |         x_ranges=[<RangeMode.AbsMax: 1>],
25-01-15 02:14:53 | I |         w_ranges=[<RangeMode.AbsMax: 1>],
25-01-15 02:14:53 | I |         alpha=0.5,
25-01-15 02:14:53 | I |         beta=0.0,
25-01-15 02:14:53 | I |         num_grids=20)),
25-01-15 02:14:53 | I |     bias_correction=False,
25-01-15 02:14:53 | I |     post_rotary=True,
25-01-15 02:14:53 | I |     develop_dtype=torch.float32,
25-01-15 02:14:53 | I |     select_wgts=None,
25-01-15 02:14:53 | I |     select_ipts=None,
25-01-15 02:14:53 | I |     select_opts=None,
25-01-15 02:14:53 | I |     keywords_i={'proj_qkv': ['q_proj', 'k_proj', 'v_proj'], 'proj_out': ['out_proj', 'o_proj'], 'proj_1st': ['fc1', 'up_proj', 'gate_proj', 'w1', 'w3'], 'proj_2nd': ['fc2', 'down_proj', 'w2'], 'head': ['output', 'score', 'qa_outputs'], 'embed': ['embed', 'lm_head', 'embed_out'], 'router': ['block_sparse_moe']},
25-01-15 02:14:53 | I |     keywords_w={'proj_qkv': ['q_proj', 'k_proj', 'v_proj'], 'proj_out': ['out_proj', 'o_proj'], 'proj_1st': ['fc1', 'up_proj', 'gate_proj', 'w1', 'w3'], 'proj_2nd': ['fc2', 'down_proj', 'w2'], 'head': ['output', 'score', 'qa_outputs'], 'embed': ['embed', 'lm_head', 'embed_out'], 'router': ['block_sparse_moe.gate']},
25-01-15 02:14:53 | I |     keywords_o={'attn_q': ['q_rotary_emb'], 'attn_k': ['k_rotary_emb'], 'attn_v': ['v_proj']},
25-01-15 02:14:53 | I |     module_types_i=(<class 'torch.nn.modules.linear.Linear'>, <class 'transformers.models.mixtral.modeling_mixtral.MixtralSparseMoeBlock'>),
25-01-15 02:14:53 | I |     module_types_w=(<class 'torch.nn.modules.linear.Linear'>,),
25-01-15 02:14:53 | I |     module_types_o=(<class 'torch.nn.modules.linear.Linear'>, <class 'lmquant.llm.nn.attention.RotaryEmbedding'>),
25-01-15 02:14:53 | I |     num_hidden_layers=-1),
25-01-15 02:14:53 | I |   seed=12345,
25-01-15 02:14:53 | I |   save_model=True,
25-01-15 02:14:53 | I |   output_dirpath=runs/llm/tiny/tiny-llama-1.1b/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/rot-reorder-smooth.xw.yx-w.static.kernel/skip.y.[q]-krnl-rot-rodr.Seq.[fc2]-smth.xw.a0p3.b0p7.[AbsMax].[out+fc2].yx.a0p5.b0.[AbsMax].[qk]-pileval.128x1024.[0-0]-250115.021453,
25-01-15 02:14:53 | I |   cache_dirpath=LlmQuantCachePath(rotation='runs/llm/cache/rotation/hadamard', reorder='runs/llm/cache/pileval.128x1024.[0-0]/reorder/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]', smooth='runs/llm/cache/pileval.128x1024.[0-0]/smooth/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]/smooth.xw.OutputsError.Manual.Layer.d2.en1.sn1-yx.OutputsError.Manual.Layer.d2.en1.sn1/smooth.xw.[x.AbsMax.w.AbsMax]-yx.[x.AbsMax.w.AbsMax]/smooth.xw.a0p3.b0p7-yx.a0p5.b0/smooth.xw.skip.[proj_1st+proj_qkv]-yx.skip.[]', wgts='runs/llm/cache/pileval.128x1024.[0-0]/wgts/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]/smooth.xw.OutputsError.Manual.Layer.d2.en1.sn1-yx.OutputsError.Manual.Layer.d2.en1.sn1/smooth.xw.[x.AbsMax.w.AbsMax]-yx.[x.AbsMax.w.AbsMax]/smooth.xw.a0p3.b0p7-yx.a0p5.b0/smooth.xw.skip.[proj_1st+proj_qkv]-yx.skip.[]/w.kernel.gptq.d0p01.b128/w.kernel.gptq.include.[proj_1st+proj_2nd+proj_out+proj_qkv]/w.range.OutputsError.Manual.Group.d2.e512.sn1/w.range.r.[1].static/w.range.skip.[]', acts=''),
25-01-15 02:14:53 | I |   cache_path=LlmQuantCachePath(rotation='runs/llm/cache/rotation/hadamard/tiny-llama-1.1b.pt', reorder='runs/llm/cache/pileval.128x1024.[0-0]/reorder/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]/tiny-llama-1.1b.pt', smooth='runs/llm/cache/pileval.128x1024.[0-0]/smooth/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]/smooth.xw.OutputsError.Manual.Layer.d2.en1.sn1-yx.OutputsError.Manual.Layer.d2.en1.sn1/smooth.xw.[x.AbsMax.w.AbsMax]-yx.[x.AbsMax.w.AbsMax]/smooth.xw.a0p3.b0p7-yx.a0p5.b0/smooth.xw.skip.[proj_1st+proj_qkv]-yx.skip.[]/tiny-llama-1.1b.pt', wgts='runs/llm/cache/pileval.128x1024.[0-0]/wgts/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]/smooth.xw.OutputsError.Manual.Layer.d2.en1.sn1-yx.OutputsError.Manual.Layer.d2.en1.sn1/smooth.xw.[x.AbsMax.w.AbsMax]-yx.[x.AbsMax.w.AbsMax]/smooth.xw.a0p3.b0p7-yx.a0p5.b0/smooth.xw.skip.[proj_1st+proj_qkv]-yx.skip.[]/w.kernel.gptq.d0p01.b128/w.kernel.gptq.include.[proj_1st+proj_2nd+proj_out+proj_qkv]/w.range.OutputsError.Manual.Group.d2.e512.sn1/w.range.r.[1].static/w.range.skip.[]/tiny-llama-1.1b.pt', acts=''),
25-01-15 02:14:53 | I |   fairseq_args=/data/gyy/lmquant-main/projects/llm/configs/fairseq_args_1.1b.json,
25-01-15 02:14:53 | I |   gen_teacher_opts=False,
25-01-15 02:14:53 | I |   enable_cache=True,
25-01-15 02:14:53 | I |   with_preprocess=True)
25-01-15 02:14:53 | I | === Dumped Configurations ===
25-01-15 02:14:53 | I | { 'calib': { 'cache_root': 'runs',
25-01-15 02:14:53 | I |              'data': 'pileval',
25-01-15 02:14:53 | I |              'dataset_path': 'mit-han-lab/pile-val-backup',
25-01-15 02:14:53 | I |              'local_dataset_path': '/dataset/pile',
25-01-15 02:14:53 | I |              'max_seq_length': 0,
25-01-15 02:14:53 | I |              'min_seq_length': 0,
25-01-15 02:14:53 | I |              'num_samples': 128,
25-01-15 02:14:53 | I |              'seq_length': 1024},
25-01-15 02:14:53 | I |   'enable_cache': True,
25-01-15 02:14:53 | I |   'eval': { 'attach_timestamp': True,
25-01-15 02:14:53 | I |             'batch_size': 8,
25-01-15 02:14:53 | I |             'evaluator': 'gptq',
25-01-15 02:14:53 | I |             'max_seq_length': -4096,
25-01-15 02:14:53 | I |             'num_gpus': 2,
25-01-15 02:14:53 | I |             'output_dirname': 'skip.y.[q]-krnl-rot-rodr.Seq.[fc2]-smth.xw.a0p3.b0p7.[AbsMax].[out+fc2].yx.a0p5.b0.[AbsMax].[qk]-pileval.128x1024.[0-0]-250115.021453',
25-01-15 02:14:53 | I |             'output_root': 'runs',
25-01-15 02:14:53 | I |             'tasks': ['wikitext']},
25-01-15 02:14:53 | I |   'fairseq_args': '/data/gyy/lmquant-main/projects/llm/configs/fairseq_args_1.1b.json',
25-01-15 02:14:53 | I |   'gen_teacher_opts': False,
25-01-15 02:14:53 | I |   'model': { 'local_path': '/dataset/models/tiny/tiny-llama-1.1b',
25-01-15 02:14:53 | I |              'local_root': '/dataset/models',
25-01-15 02:14:53 | I |              'name': 'tiny-llama-1.1b',
25-01-15 02:14:53 | I |              'path': '/data/gyy/TinyLlama',
25-01-15 02:14:53 | I |              'root': '/dataset/models'},
25-01-15 02:14:53 | I |   'quant': { 'bias_correction': False,
25-01-15 02:14:53 | I |              'develop_dtype': 'torch.float32',
25-01-15 02:14:53 | I |              'enable_reorder': True,
25-01-15 02:14:53 | I |              'enable_rotation': True,
25-01-15 02:14:53 | I |              'enable_select_ipts': False,
25-01-15 02:14:53 | I |              'enable_select_opts': False,
25-01-15 02:14:53 | I |              'enable_select_wgts': False,
25-01-15 02:14:53 | I |              'enable_smooth': True,
25-01-15 02:14:53 | I |              'ipts': { 'compute_dtype': None,
25-01-15 02:14:53 | I |                        'compute_group_level': -1,
25-01-15 02:14:53 | I |                        'dtype': 'sint8',
25-01-15 02:14:53 | I |                        'enable_calib_range': False,
25-01-15 02:14:53 | I |                        'group_scale_dtypes': ['torch.float16'],
25-01-15 02:14:53 | I |                        'group_shapes': [[1, -1, -1]],
25-01-15 02:14:53 | I |                        'saturate_compute_dtype': False,
25-01-15 02:14:53 | I |                        'skips': ['embed', 'head', 'router'],
25-01-15 02:14:53 | I |                        'static': False},
25-01-15 02:14:53 | I |              'opts': { 'compute_dtype': None,
25-01-15 02:14:53 | I |                        'compute_group_level': -1,
25-01-15 02:14:53 | I |                        'dtype': 'zint4',
25-01-15 02:14:53 | I |                        'enable_calib_range': False,
25-01-15 02:14:53 | I |                        'group_scale_dtypes': ['torch.float16'],
25-01-15 02:14:53 | I |                        'group_shapes': [[1, 128, -1]],
25-01-15 02:14:53 | I |                        'saturate_compute_dtype': False,
25-01-15 02:14:53 | I |                        'skips': ['attn_q'],
25-01-15 02:14:53 | I |                        'static': False},
25-01-15 02:14:53 | I |              'post_rotary': True,
25-01-15 02:14:53 | I |              'reorder': { 'allow_kernel_calib': False,
25-01-15 02:14:53 | I |                           'channel_index': 'Sequential',
25-01-15 02:14:53 | I |                           'channel_metric': 'InputsAbsMax',
25-01-15 02:14:53 | I |                           'degree': 2,
25-01-15 02:14:53 | I |                           'dynamic': False,
25-01-15 02:14:53 | I |                           'element_batch_size': -1,
25-01-15 02:14:53 | I |                           'element_size': -1,
25-01-15 02:14:53 | I |                           'outputs_device': 'cpu',
25-01-15 02:14:53 | I |                           'pre_reshape': True,
25-01-15 02:14:53 | I |                           'sample_batch_size': -1,
25-01-15 02:14:53 | I |                           'sample_size': -1,
25-01-15 02:14:53 | I |                           'skips': ['proj_out', 'proj_qkv', 'residual'],
25-01-15 02:14:53 | I |                           'strategy': 'Manual'},
25-01-15 02:14:53 | I |              'rotation': {'random': False, 'transforms': []},
25-01-15 02:14:53 | I |              'smooth': { 'enable_xw': True,
25-01-15 02:14:53 | I |                          'enable_yx': True,
25-01-15 02:14:53 | I |                          'xw': { 'allow_kernel_calib': False,
25-01-15 02:14:53 | I |                                  'alpha': 0.3,
25-01-15 02:14:53 | I |                                  'beta': 0.7,
25-01-15 02:14:53 | I |                                  'degree': 2,
25-01-15 02:14:53 | I |                                  'element_batch_size': -1,
25-01-15 02:14:53 | I |                                  'element_size': -1,
25-01-15 02:14:53 | I |                                  'granularity': 'Layer',
25-01-15 02:14:53 | I |                                  'num_grids': 20,
25-01-15 02:14:53 | I |                                  'objective': 'OutputsError',
25-01-15 02:14:53 | I |                                  'outputs_device': 'cpu',
25-01-15 02:14:53 | I |                                  'pre_reshape': True,
25-01-15 02:14:53 | I |                                  'ranges': [['AbsMax', 'AbsMax']],
25-01-15 02:14:53 | I |                                  'sample_batch_size': -1,
25-01-15 02:14:53 | I |                                  'sample_size': -1,
25-01-15 02:14:53 | I |                                  'skips': ['proj_1st', 'proj_qkv'],
25-01-15 02:14:53 | I |                                  'strategy': 'Manual'},
25-01-15 02:14:53 | I |                          'yx': { 'allow_kernel_calib': False,
25-01-15 02:14:53 | I |                                  'alpha': 0.5,
25-01-15 02:14:53 | I |                                  'beta': 0.0,
25-01-15 02:14:53 | I |                                  'degree': 2,
25-01-15 02:14:53 | I |                                  'element_batch_size': -1,
25-01-15 02:14:53 | I |                                  'element_size': -1,
25-01-15 02:14:53 | I |                                  'granularity': 'Layer',
25-01-15 02:14:53 | I |                                  'num_grids': 20,
25-01-15 02:14:53 | I |                                  'objective': 'OutputsError',
25-01-15 02:14:53 | I |                                  'outputs_device': 'cpu',
25-01-15 02:14:53 | I |                                  'pre_reshape': True,
25-01-15 02:14:53 | I |                                  'ranges': [['AbsMax', 'AbsMax']],
25-01-15 02:14:53 | I |                                  'sample_batch_size': -1,
25-01-15 02:14:53 | I |                                  'sample_size': -1,
25-01-15 02:14:53 | I |                                  'skips': [],
25-01-15 02:14:53 | I |                                  'strategy': 'Manual'}},
25-01-15 02:14:53 | I |              'wgts': { 'calib_kernel': { 'enable_gptq': True,
25-01-15 02:14:53 | I |                                          'gptq': { 'block_size': 128,
25-01-15 02:14:53 | I |                                                    'damp_percentage': 0.01,
25-01-15 02:14:53 | I |                                                    'hessian_block_size': 512,
25-01-15 02:14:53 | I |                                                    'includes': ['proj_1st', 'proj_2nd', 'proj_out', 'proj_qkv'],
25-01-15 02:14:53 | I |                                                    'num_inv_tries': 250}},
25-01-15 02:14:53 | I |                        'calib_range': { 'allow_kernel_calib': False,
25-01-15 02:14:53 | I |                                         'degree': 2,
25-01-15 02:14:53 | I |                                         'element_batch_size': 64,
25-01-15 02:14:53 | I |                                         'element_size': 512,
25-01-15 02:14:53 | I |                                         'granularity': 'Group',
25-01-15 02:14:53 | I |                                         'max_expand': 1.0,
25-01-15 02:14:53 | I |                                         'max_shrink': 0.2,
25-01-15 02:14:53 | I |                                         'num_grids': 80,
25-01-15 02:14:53 | I |                                         'objective': 'OutputsError',
25-01-15 02:14:53 | I |                                         'outputs_device': 'cpu',
25-01-15 02:14:53 | I |                                         'pre_reshape': True,
25-01-15 02:14:53 | I |                                         'ratio': 1.0,
25-01-15 02:14:53 | I |                                         'sample_batch_size': -1,
25-01-15 02:14:53 | I |                                         'sample_size': -1,
25-01-15 02:14:53 | I |                                         'skips': [],
25-01-15 02:14:53 | I |                                         'strategy': 'Manual'},
25-01-15 02:14:53 | I |                        'compute_dtype': 'sint8',
25-01-15 02:14:53 | I |                        'compute_group_level': 0,
25-01-15 02:14:53 | I |                        'dtype': 'zint4',
25-01-15 02:14:53 | I |                        'enable_calib_kernel': True,
25-01-15 02:14:53 | I |                        'enable_calib_range': True,
25-01-15 02:14:53 | I |                        'group_scale_dtypes': ['torch.float16', 'sint8'],
25-01-15 02:14:53 | I |                        'group_shapes': [[1, -1, -1], [1, 128, -1]],
25-01-15 02:14:53 | I |                        'saturate_compute_dtype': False,
25-01-15 02:14:53 | I |                        'skips': ['embed', 'head', 'router']}},
25-01-15 02:14:53 | I |   'save_model': True,
25-01-15 02:14:53 | I |   'seed': 12345,
25-01-15 02:14:53 | I |   'with_preprocess': True}
25-01-15 02:14:53 | I | === Output Directory ===
25-01-15 02:14:53 | I | runs/llm/tiny/tiny-llama-1.1b/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/rot-reorder-smooth.xw.yx-w.static.kernel/skip.y.[q]-krnl-rot-rodr.Seq.[fc2]-smth.xw.a0p3.b0p7.[AbsMax].[out+fc2].yx.a0p5.b0.[AbsMax].[qk]-pileval.128x1024.[0-0]-250115.021453
25-01-15 02:14:53 | I | === Start Evaluating ===
25-01-15 02:14:53 | I | * Building model tiny-llama-1.1b from /data/gyy/TinyLlama
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.0.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.1.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.2.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.3.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.4.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.5.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.6.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.7.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.8.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.9.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.10.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.11.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.12.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.13.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.14.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.15.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.16.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.17.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.18.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.19.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.20.self_attn
25-01-15 02:14:55 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.21.self_attn
25-01-15 02:14:55 | I | * Development dtype is torch.float32
25-01-15 02:14:55 | I | * Rotating model
25-01-15 02:14:55 | I |   - Loading rotation from runs/llm/cache/rotation/hadamard/tiny-llama-1.1b.pt
25-01-15 02:14:55 | D |   - Transforming norm and linear in model.layers.0
25-01-15 02:14:55 | D |   - Transforming norm and linear in model.layers.1
25-01-15 02:14:55 | D |   - Transforming norm and linear in model.layers.2
25-01-15 02:14:56 | D |   - Transforming norm and linear in model.layers.3
25-01-15 02:14:56 | D |   - Transforming norm and linear in model.layers.4
25-01-15 02:14:56 | D |   - Transforming norm and linear in model.layers.5
25-01-15 02:14:56 | D |   - Transforming norm and linear in model.layers.6
25-01-15 02:14:56 | D |   - Transforming norm and linear in model.layers.7
25-01-15 02:14:57 | D |   - Transforming norm and linear in model.layers.8
25-01-15 02:14:57 | D |   - Transforming norm and linear in model.layers.9
25-01-15 02:14:57 | D |   - Transforming norm and linear in model.layers.10
25-01-15 02:14:57 | D |   - Transforming norm and linear in model.layers.11
25-01-15 02:14:57 | D |   - Transforming norm and linear in model.layers.12
25-01-15 02:14:58 | D |   - Transforming norm and linear in model.layers.13
25-01-15 02:14:58 | D |   - Transforming norm and linear in model.layers.14
25-01-15 02:14:58 | D |   - Transforming norm and linear in model.layers.15
25-01-15 02:14:58 | D |   - Transforming norm and linear in model.layers.16
25-01-15 02:14:58 | D |   - Transforming norm and linear in model.layers.17
25-01-15 02:14:59 | D |   - Transforming norm and linear in model.layers.18
25-01-15 02:14:59 | D |   - Transforming norm and linear in model.layers.19
25-01-15 02:14:59 | D |   - Transforming norm and linear in model.layers.20
25-01-15 02:14:59 | D |   - Transforming norm and linear in model.layers.21
25-01-15 02:15:00 | D |   - Transforming model.norm
25-01-15 02:15:00 | D |   - Rotating model.embed_tokens
25-01-15 02:15:00 | D |   - Rotating model.layers.0
25-01-15 02:15:00 | D |     - Rotating model.layers.0.self_attn.q_proj (in)
25-01-15 02:15:00 | D |     - Rotating model.layers.0.self_attn.k_proj (in)
25-01-15 02:15:00 | D |     - Rotating model.layers.0.self_attn.v_proj (in)
25-01-15 02:15:00 | D |     - Rotating model.layers.0.self_attn.o_proj (out)
25-01-15 02:15:00 | D |     - Rotating model.layers.0.proj_1st (in)
25-01-15 02:15:00 | D |     - Rotating model.layers.0.proj_2nd (out)
25-01-15 02:15:01 | D |   - Rotating model.layers.1
25-01-15 02:15:01 | D |     - Rotating model.layers.1.self_attn.q_proj (in)
25-01-15 02:15:01 | D |     - Rotating model.layers.1.self_attn.k_proj (in)
25-01-15 02:15:01 | D |     - Rotating model.layers.1.self_attn.v_proj (in)
25-01-15 02:15:01 | D |     - Rotating model.layers.1.self_attn.o_proj (out)
25-01-15 02:15:01 | D |     - Rotating model.layers.1.proj_1st (in)
25-01-15 02:15:01 | D |     - Rotating model.layers.1.proj_2nd (out)
25-01-15 02:15:01 | D |   - Rotating model.layers.2
25-01-15 02:15:01 | D |     - Rotating model.layers.2.self_attn.q_proj (in)
25-01-15 02:15:01 | D |     - Rotating model.layers.2.self_attn.k_proj (in)
25-01-15 02:15:01 | D |     - Rotating model.layers.2.self_attn.v_proj (in)
25-01-15 02:15:01 | D |     - Rotating model.layers.2.self_attn.o_proj (out)
25-01-15 02:15:01 | D |     - Rotating model.layers.2.proj_1st (in)
25-01-15 02:15:01 | D |     - Rotating model.layers.2.proj_2nd (out)
25-01-15 02:15:01 | D |   - Rotating model.layers.3
25-01-15 02:15:01 | D |     - Rotating model.layers.3.self_attn.q_proj (in)
25-01-15 02:15:01 | D |     - Rotating model.layers.3.self_attn.k_proj (in)
25-01-15 02:15:01 | D |     - Rotating model.layers.3.self_attn.v_proj (in)
25-01-15 02:15:01 | D |     - Rotating model.layers.3.self_attn.o_proj (out)
25-01-15 02:15:01 | D |     - Rotating model.layers.3.proj_1st (in)
25-01-15 02:15:01 | D |     - Rotating model.layers.3.proj_2nd (out)
25-01-15 02:15:02 | D |   - Rotating model.layers.4
25-01-15 02:15:02 | D |     - Rotating model.layers.4.self_attn.q_proj (in)
25-01-15 02:15:02 | D |     - Rotating model.layers.4.self_attn.k_proj (in)
25-01-15 02:15:02 | D |     - Rotating model.layers.4.self_attn.v_proj (in)
25-01-15 02:15:02 | D |     - Rotating model.layers.4.self_attn.o_proj (out)
25-01-15 02:15:02 | D |     - Rotating model.layers.4.proj_1st (in)
25-01-15 02:15:02 | D |     - Rotating model.layers.4.proj_2nd (out)
25-01-15 02:15:02 | D |   - Rotating model.layers.5
25-01-15 02:15:02 | D |     - Rotating model.layers.5.self_attn.q_proj (in)
25-01-15 02:15:02 | D |     - Rotating model.layers.5.self_attn.k_proj (in)
25-01-15 02:15:02 | D |     - Rotating model.layers.5.self_attn.v_proj (in)
25-01-15 02:15:02 | D |     - Rotating model.layers.5.self_attn.o_proj (out)
25-01-15 02:15:02 | D |     - Rotating model.layers.5.proj_1st (in)
25-01-15 02:15:02 | D |     - Rotating model.layers.5.proj_2nd (out)
25-01-15 02:15:02 | D |   - Rotating model.layers.6
25-01-15 02:15:02 | D |     - Rotating model.layers.6.self_attn.q_proj (in)
25-01-15 02:15:02 | D |     - Rotating model.layers.6.self_attn.k_proj (in)
25-01-15 02:15:02 | D |     - Rotating model.layers.6.self_attn.v_proj (in)
25-01-15 02:15:02 | D |     - Rotating model.layers.6.self_attn.o_proj (out)
25-01-15 02:15:02 | D |     - Rotating model.layers.6.proj_1st (in)
25-01-15 02:15:02 | D |     - Rotating model.layers.6.proj_2nd (out)
25-01-15 02:15:03 | D |   - Rotating model.layers.7
25-01-15 02:15:03 | D |     - Rotating model.layers.7.self_attn.q_proj (in)
25-01-15 02:15:03 | D |     - Rotating model.layers.7.self_attn.k_proj (in)
25-01-15 02:15:03 | D |     - Rotating model.layers.7.self_attn.v_proj (in)
25-01-15 02:15:03 | D |     - Rotating model.layers.7.self_attn.o_proj (out)
25-01-15 02:15:03 | D |     - Rotating model.layers.7.proj_1st (in)
25-01-15 02:15:03 | D |     - Rotating model.layers.7.proj_2nd (out)
25-01-15 02:15:03 | D |   - Rotating model.layers.8
25-01-15 02:15:03 | D |     - Rotating model.layers.8.self_attn.q_proj (in)
25-01-15 02:15:03 | D |     - Rotating model.layers.8.self_attn.k_proj (in)
25-01-15 02:15:03 | D |     - Rotating model.layers.8.self_attn.v_proj (in)
25-01-15 02:15:03 | D |     - Rotating model.layers.8.self_attn.o_proj (out)
25-01-15 02:15:03 | D |     - Rotating model.layers.8.proj_1st (in)
25-01-15 02:15:03 | D |     - Rotating model.layers.8.proj_2nd (out)
25-01-15 02:15:03 | D |   - Rotating model.layers.9
25-01-15 02:15:03 | D |     - Rotating model.layers.9.self_attn.q_proj (in)
25-01-15 02:15:03 | D |     - Rotating model.layers.9.self_attn.k_proj (in)
25-01-15 02:15:03 | D |     - Rotating model.layers.9.self_attn.v_proj (in)
25-01-15 02:15:03 | D |     - Rotating model.layers.9.self_attn.o_proj (out)
25-01-15 02:15:03 | D |     - Rotating model.layers.9.proj_1st (in)
25-01-15 02:15:03 | D |     - Rotating model.layers.9.proj_2nd (out)
25-01-15 02:15:04 | D |   - Rotating model.layers.10
25-01-15 02:15:04 | D |     - Rotating model.layers.10.self_attn.q_proj (in)
25-01-15 02:15:04 | D |     - Rotating model.layers.10.self_attn.k_proj (in)
25-01-15 02:15:04 | D |     - Rotating model.layers.10.self_attn.v_proj (in)
25-01-15 02:15:04 | D |     - Rotating model.layers.10.self_attn.o_proj (out)
25-01-15 02:15:04 | D |     - Rotating model.layers.10.proj_1st (in)
25-01-15 02:15:04 | D |     - Rotating model.layers.10.proj_2nd (out)
25-01-15 02:15:04 | D |   - Rotating model.layers.11
25-01-15 02:15:04 | D |     - Rotating model.layers.11.self_attn.q_proj (in)
25-01-15 02:15:04 | D |     - Rotating model.layers.11.self_attn.k_proj (in)
25-01-15 02:15:04 | D |     - Rotating model.layers.11.self_attn.v_proj (in)
25-01-15 02:15:04 | D |     - Rotating model.layers.11.self_attn.o_proj (out)
25-01-15 02:15:04 | D |     - Rotating model.layers.11.proj_1st (in)
25-01-15 02:15:04 | D |     - Rotating model.layers.11.proj_2nd (out)
25-01-15 02:15:04 | D |   - Rotating model.layers.12
25-01-15 02:15:04 | D |     - Rotating model.layers.12.self_attn.q_proj (in)
25-01-15 02:15:04 | D |     - Rotating model.layers.12.self_attn.k_proj (in)
25-01-15 02:15:04 | D |     - Rotating model.layers.12.self_attn.v_proj (in)
25-01-15 02:15:04 | D |     - Rotating model.layers.12.self_attn.o_proj (out)
25-01-15 02:15:04 | D |     - Rotating model.layers.12.proj_1st (in)
25-01-15 02:15:04 | D |     - Rotating model.layers.12.proj_2nd (out)
25-01-15 02:15:05 | D |   - Rotating model.layers.13
25-01-15 02:15:05 | D |     - Rotating model.layers.13.self_attn.q_proj (in)
25-01-15 02:15:05 | D |     - Rotating model.layers.13.self_attn.k_proj (in)
25-01-15 02:15:05 | D |     - Rotating model.layers.13.self_attn.v_proj (in)
25-01-15 02:15:05 | D |     - Rotating model.layers.13.self_attn.o_proj (out)
25-01-15 02:15:05 | D |     - Rotating model.layers.13.proj_1st (in)
25-01-15 02:15:05 | D |     - Rotating model.layers.13.proj_2nd (out)
25-01-15 02:15:05 | D |   - Rotating model.layers.14
25-01-15 02:15:05 | D |     - Rotating model.layers.14.self_attn.q_proj (in)
25-01-15 02:15:05 | D |     - Rotating model.layers.14.self_attn.k_proj (in)
25-01-15 02:15:05 | D |     - Rotating model.layers.14.self_attn.v_proj (in)
25-01-15 02:15:05 | D |     - Rotating model.layers.14.self_attn.o_proj (out)
25-01-15 02:15:05 | D |     - Rotating model.layers.14.proj_1st (in)
25-01-15 02:15:05 | D |     - Rotating model.layers.14.proj_2nd (out)
25-01-15 02:15:05 | D |   - Rotating model.layers.15
25-01-15 02:15:05 | D |     - Rotating model.layers.15.self_attn.q_proj (in)
25-01-15 02:15:05 | D |     - Rotating model.layers.15.self_attn.k_proj (in)
25-01-15 02:15:05 | D |     - Rotating model.layers.15.self_attn.v_proj (in)
25-01-15 02:15:05 | D |     - Rotating model.layers.15.self_attn.o_proj (out)
25-01-15 02:15:05 | D |     - Rotating model.layers.15.proj_1st (in)
25-01-15 02:15:05 | D |     - Rotating model.layers.15.proj_2nd (out)
25-01-15 02:15:06 | D |   - Rotating model.layers.16
25-01-15 02:15:06 | D |     - Rotating model.layers.16.self_attn.q_proj (in)
25-01-15 02:15:06 | D |     - Rotating model.layers.16.self_attn.k_proj (in)
25-01-15 02:15:06 | D |     - Rotating model.layers.16.self_attn.v_proj (in)
25-01-15 02:15:06 | D |     - Rotating model.layers.16.self_attn.o_proj (out)
25-01-15 02:15:06 | D |     - Rotating model.layers.16.proj_1st (in)
25-01-15 02:15:06 | D |     - Rotating model.layers.16.proj_2nd (out)
25-01-15 02:15:06 | D |   - Rotating model.layers.17
25-01-15 02:15:06 | D |     - Rotating model.layers.17.self_attn.q_proj (in)
25-01-15 02:15:06 | D |     - Rotating model.layers.17.self_attn.k_proj (in)
25-01-15 02:15:06 | D |     - Rotating model.layers.17.self_attn.v_proj (in)
25-01-15 02:15:06 | D |     - Rotating model.layers.17.self_attn.o_proj (out)
25-01-15 02:15:06 | D |     - Rotating model.layers.17.proj_1st (in)
25-01-15 02:15:06 | D |     - Rotating model.layers.17.proj_2nd (out)
25-01-15 02:15:06 | D |   - Rotating model.layers.18
25-01-15 02:15:06 | D |     - Rotating model.layers.18.self_attn.q_proj (in)
25-01-15 02:15:06 | D |     - Rotating model.layers.18.self_attn.k_proj (in)
25-01-15 02:15:06 | D |     - Rotating model.layers.18.self_attn.v_proj (in)
25-01-15 02:15:06 | D |     - Rotating model.layers.18.self_attn.o_proj (out)
25-01-15 02:15:06 | D |     - Rotating model.layers.18.proj_1st (in)
25-01-15 02:15:06 | D |     - Rotating model.layers.18.proj_2nd (out)
25-01-15 02:15:07 | D |   - Rotating model.layers.19
25-01-15 02:15:07 | D |     - Rotating model.layers.19.self_attn.q_proj (in)
25-01-15 02:15:07 | D |     - Rotating model.layers.19.self_attn.k_proj (in)
25-01-15 02:15:07 | D |     - Rotating model.layers.19.self_attn.v_proj (in)
25-01-15 02:15:07 | D |     - Rotating model.layers.19.self_attn.o_proj (out)
25-01-15 02:15:07 | D |     - Rotating model.layers.19.proj_1st (in)
25-01-15 02:15:07 | D |     - Rotating model.layers.19.proj_2nd (out)
25-01-15 02:15:07 | D |   - Rotating model.layers.20
25-01-15 02:15:07 | D |     - Rotating model.layers.20.self_attn.q_proj (in)
25-01-15 02:15:07 | D |     - Rotating model.layers.20.self_attn.k_proj (in)
25-01-15 02:15:07 | D |     - Rotating model.layers.20.self_attn.v_proj (in)
25-01-15 02:15:07 | D |     - Rotating model.layers.20.self_attn.o_proj (out)
25-01-15 02:15:07 | D |     - Rotating model.layers.20.proj_1st (in)
25-01-15 02:15:07 | D |     - Rotating model.layers.20.proj_2nd (out)
25-01-15 02:15:07 | D |   - Rotating model.layers.21
25-01-15 02:15:07 | D |     - Rotating model.layers.21.self_attn.q_proj (in)
25-01-15 02:15:07 | D |     - Rotating model.layers.21.self_attn.k_proj (in)
25-01-15 02:15:07 | D |     - Rotating model.layers.21.self_attn.v_proj (in)
25-01-15 02:15:07 | D |     - Rotating model.layers.21.self_attn.o_proj (out)
25-01-15 02:15:07 | D |     - Rotating model.layers.21.proj_1st (in)
25-01-15 02:15:07 | D |     - Rotating model.layers.21.proj_2nd (out)
25-01-15 02:15:08 | D |   - Rotating lm_head (in)
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.0.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.1.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.2.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.3.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.4.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.5.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.6.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.7.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.8.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.9.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.10.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.11.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.12.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.13.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.14.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.15.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.16.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.17.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.18.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.19.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.20.self_attn
25-01-15 02:15:13 | I | - Patching LlamaSdpaAttention._old_forward in model.layers.21.self_attn
25-01-15 02:15:13 | I | * Rotating model in float16 again
25-01-15 02:15:13 | D |   - Transforming norm and linear in model.layers.0
25-01-15 02:15:13 | D |   - Transforming norm and linear in model.layers.1
25-01-15 02:15:13 | D |   - Transforming norm and linear in model.layers.2
25-01-15 02:15:13 | D |   - Transforming norm and linear in model.layers.3
25-01-15 02:15:13 | D |   - Transforming norm and linear in model.layers.4
25-01-15 02:15:14 | D |   - Transforming norm and linear in model.layers.5
25-01-15 02:15:14 | D |   - Transforming norm and linear in model.layers.6
25-01-15 02:15:14 | D |   - Transforming norm and linear in model.layers.7
25-01-15 02:15:14 | D |   - Transforming norm and linear in model.layers.8
25-01-15 02:15:14 | D |   - Transforming norm and linear in model.layers.9
25-01-15 02:15:15 | D |   - Transforming norm and linear in model.layers.10
25-01-15 02:15:15 | D |   - Transforming norm and linear in model.layers.11
25-01-15 02:15:15 | D |   - Transforming norm and linear in model.layers.12
25-01-15 02:15:15 | D |   - Transforming norm and linear in model.layers.13
25-01-15 02:15:16 | D |   - Transforming norm and linear in model.layers.14
25-01-15 02:15:16 | D |   - Transforming norm and linear in model.layers.15
25-01-15 02:15:16 | D |   - Transforming norm and linear in model.layers.16
25-01-15 02:15:16 | D |   - Transforming norm and linear in model.layers.17
25-01-15 02:15:16 | D |   - Transforming norm and linear in model.layers.18
25-01-15 02:15:17 | D |   - Transforming norm and linear in model.layers.19
25-01-15 02:15:17 | D |   - Transforming norm and linear in model.layers.20
25-01-15 02:15:17 | D |   - Transforming norm and linear in model.layers.21
25-01-15 02:15:17 | D |   - Transforming model.norm
25-01-15 02:15:17 | D |   - Rotating model.embed_tokens
25-01-15 02:15:17 | D |   - Rotating model.layers.0
25-01-15 02:15:17 | D |     - Rotating model.layers.0.self_attn.q_proj (in)
25-01-15 02:15:17 | D |     - Rotating model.layers.0.self_attn.k_proj (in)
25-01-15 02:15:17 | D |     - Rotating model.layers.0.self_attn.v_proj (in)
25-01-15 02:15:17 | D |     - Rotating model.layers.0.self_attn.o_proj (out)
25-01-15 02:15:17 | D |     - Rotating model.layers.0.proj_1st (in)
25-01-15 02:15:17 | D |     - Rotating model.layers.0.proj_2nd (out)
25-01-15 02:15:18 | D |   - Rotating model.layers.1
25-01-15 02:15:18 | D |     - Rotating model.layers.1.self_attn.q_proj (in)
25-01-15 02:15:18 | D |     - Rotating model.layers.1.self_attn.k_proj (in)
25-01-15 02:15:18 | D |     - Rotating model.layers.1.self_attn.v_proj (in)
25-01-15 02:15:18 | D |     - Rotating model.layers.1.self_attn.o_proj (out)
25-01-15 02:15:18 | D |     - Rotating model.layers.1.proj_1st (in)
25-01-15 02:15:18 | D |     - Rotating model.layers.1.proj_2nd (out)
25-01-15 02:15:18 | D |   - Rotating model.layers.2
25-01-15 02:15:18 | D |     - Rotating model.layers.2.self_attn.q_proj (in)
25-01-15 02:15:18 | D |     - Rotating model.layers.2.self_attn.k_proj (in)
25-01-15 02:15:18 | D |     - Rotating model.layers.2.self_attn.v_proj (in)
25-01-15 02:15:18 | D |     - Rotating model.layers.2.self_attn.o_proj (out)
25-01-15 02:15:18 | D |     - Rotating model.layers.2.proj_1st (in)
25-01-15 02:15:18 | D |     - Rotating model.layers.2.proj_2nd (out)
25-01-15 02:15:19 | D |   - Rotating model.layers.3
25-01-15 02:15:19 | D |     - Rotating model.layers.3.self_attn.q_proj (in)
25-01-15 02:15:19 | D |     - Rotating model.layers.3.self_attn.k_proj (in)
25-01-15 02:15:19 | D |     - Rotating model.layers.3.self_attn.v_proj (in)
25-01-15 02:15:19 | D |     - Rotating model.layers.3.self_attn.o_proj (out)
25-01-15 02:15:19 | D |     - Rotating model.layers.3.proj_1st (in)
25-01-15 02:15:19 | D |     - Rotating model.layers.3.proj_2nd (out)
25-01-15 02:15:19 | D |   - Rotating model.layers.4
25-01-15 02:15:19 | D |     - Rotating model.layers.4.self_attn.q_proj (in)
25-01-15 02:15:19 | D |     - Rotating model.layers.4.self_attn.k_proj (in)
25-01-15 02:15:19 | D |     - Rotating model.layers.4.self_attn.v_proj (in)
25-01-15 02:15:19 | D |     - Rotating model.layers.4.self_attn.o_proj (out)
25-01-15 02:15:19 | D |     - Rotating model.layers.4.proj_1st (in)
25-01-15 02:15:19 | D |     - Rotating model.layers.4.proj_2nd (out)
25-01-15 02:15:19 | D |   - Rotating model.layers.5
25-01-15 02:15:19 | D |     - Rotating model.layers.5.self_attn.q_proj (in)
25-01-15 02:15:19 | D |     - Rotating model.layers.5.self_attn.k_proj (in)
25-01-15 02:15:19 | D |     - Rotating model.layers.5.self_attn.v_proj (in)
25-01-15 02:15:19 | D |     - Rotating model.layers.5.self_attn.o_proj (out)
25-01-15 02:15:19 | D |     - Rotating model.layers.5.proj_1st (in)
25-01-15 02:15:19 | D |     - Rotating model.layers.5.proj_2nd (out)
25-01-15 02:15:20 | D |   - Rotating model.layers.6
25-01-15 02:15:20 | D |     - Rotating model.layers.6.self_attn.q_proj (in)
25-01-15 02:15:20 | D |     - Rotating model.layers.6.self_attn.k_proj (in)
25-01-15 02:15:20 | D |     - Rotating model.layers.6.self_attn.v_proj (in)
25-01-15 02:15:20 | D |     - Rotating model.layers.6.self_attn.o_proj (out)
25-01-15 02:15:20 | D |     - Rotating model.layers.6.proj_1st (in)
25-01-15 02:15:20 | D |     - Rotating model.layers.6.proj_2nd (out)
25-01-15 02:15:20 | D |   - Rotating model.layers.7
25-01-15 02:15:20 | D |     - Rotating model.layers.7.self_attn.q_proj (in)
25-01-15 02:15:20 | D |     - Rotating model.layers.7.self_attn.k_proj (in)
25-01-15 02:15:20 | D |     - Rotating model.layers.7.self_attn.v_proj (in)
25-01-15 02:15:20 | D |     - Rotating model.layers.7.self_attn.o_proj (out)
25-01-15 02:15:20 | D |     - Rotating model.layers.7.proj_1st (in)
25-01-15 02:15:20 | D |     - Rotating model.layers.7.proj_2nd (out)
25-01-15 02:15:20 | D |   - Rotating model.layers.8
25-01-15 02:15:20 | D |     - Rotating model.layers.8.self_attn.q_proj (in)
25-01-15 02:15:20 | D |     - Rotating model.layers.8.self_attn.k_proj (in)
25-01-15 02:15:20 | D |     - Rotating model.layers.8.self_attn.v_proj (in)
25-01-15 02:15:20 | D |     - Rotating model.layers.8.self_attn.o_proj (out)
25-01-15 02:15:20 | D |     - Rotating model.layers.8.proj_1st (in)
25-01-15 02:15:20 | D |     - Rotating model.layers.8.proj_2nd (out)
25-01-15 02:15:21 | D |   - Rotating model.layers.9
25-01-15 02:15:21 | D |     - Rotating model.layers.9.self_attn.q_proj (in)
25-01-15 02:15:21 | D |     - Rotating model.layers.9.self_attn.k_proj (in)
25-01-15 02:15:21 | D |     - Rotating model.layers.9.self_attn.v_proj (in)
25-01-15 02:15:21 | D |     - Rotating model.layers.9.self_attn.o_proj (out)
25-01-15 02:15:21 | D |     - Rotating model.layers.9.proj_1st (in)
25-01-15 02:15:21 | D |     - Rotating model.layers.9.proj_2nd (out)
25-01-15 02:15:21 | D |   - Rotating model.layers.10
25-01-15 02:15:21 | D |     - Rotating model.layers.10.self_attn.q_proj (in)
25-01-15 02:15:21 | D |     - Rotating model.layers.10.self_attn.k_proj (in)
25-01-15 02:15:21 | D |     - Rotating model.layers.10.self_attn.v_proj (in)
25-01-15 02:15:21 | D |     - Rotating model.layers.10.self_attn.o_proj (out)
25-01-15 02:15:21 | D |     - Rotating model.layers.10.proj_1st (in)
25-01-15 02:15:21 | D |     - Rotating model.layers.10.proj_2nd (out)
25-01-15 02:15:21 | D |   - Rotating model.layers.11
25-01-15 02:15:21 | D |     - Rotating model.layers.11.self_attn.q_proj (in)
25-01-15 02:15:21 | D |     - Rotating model.layers.11.self_attn.k_proj (in)
25-01-15 02:15:21 | D |     - Rotating model.layers.11.self_attn.v_proj (in)
25-01-15 02:15:21 | D |     - Rotating model.layers.11.self_attn.o_proj (out)
25-01-15 02:15:21 | D |     - Rotating model.layers.11.proj_1st (in)
25-01-15 02:15:21 | D |     - Rotating model.layers.11.proj_2nd (out)
25-01-15 02:15:22 | D |   - Rotating model.layers.12
25-01-15 02:15:22 | D |     - Rotating model.layers.12.self_attn.q_proj (in)
25-01-15 02:15:22 | D |     - Rotating model.layers.12.self_attn.k_proj (in)
25-01-15 02:15:22 | D |     - Rotating model.layers.12.self_attn.v_proj (in)
25-01-15 02:15:22 | D |     - Rotating model.layers.12.self_attn.o_proj (out)
25-01-15 02:15:22 | D |     - Rotating model.layers.12.proj_1st (in)
25-01-15 02:15:22 | D |     - Rotating model.layers.12.proj_2nd (out)
25-01-15 02:15:22 | D |   - Rotating model.layers.13
25-01-15 02:15:22 | D |     - Rotating model.layers.13.self_attn.q_proj (in)
25-01-15 02:15:22 | D |     - Rotating model.layers.13.self_attn.k_proj (in)
25-01-15 02:15:22 | D |     - Rotating model.layers.13.self_attn.v_proj (in)
25-01-15 02:15:22 | D |     - Rotating model.layers.13.self_attn.o_proj (out)
25-01-15 02:15:22 | D |     - Rotating model.layers.13.proj_1st (in)
25-01-15 02:15:22 | D |     - Rotating model.layers.13.proj_2nd (out)
25-01-15 02:15:22 | D |   - Rotating model.layers.14
25-01-15 02:15:22 | D |     - Rotating model.layers.14.self_attn.q_proj (in)
25-01-15 02:15:22 | D |     - Rotating model.layers.14.self_attn.k_proj (in)
25-01-15 02:15:22 | D |     - Rotating model.layers.14.self_attn.v_proj (in)
25-01-15 02:15:22 | D |     - Rotating model.layers.14.self_attn.o_proj (out)
25-01-15 02:15:22 | D |     - Rotating model.layers.14.proj_1st (in)
25-01-15 02:15:22 | D |     - Rotating model.layers.14.proj_2nd (out)
25-01-15 02:15:23 | D |   - Rotating model.layers.15
25-01-15 02:15:23 | D |     - Rotating model.layers.15.self_attn.q_proj (in)
25-01-15 02:15:23 | D |     - Rotating model.layers.15.self_attn.k_proj (in)
25-01-15 02:15:23 | D |     - Rotating model.layers.15.self_attn.v_proj (in)
25-01-15 02:15:23 | D |     - Rotating model.layers.15.self_attn.o_proj (out)
25-01-15 02:15:23 | D |     - Rotating model.layers.15.proj_1st (in)
25-01-15 02:15:23 | D |     - Rotating model.layers.15.proj_2nd (out)
25-01-15 02:15:23 | D |   - Rotating model.layers.16
25-01-15 02:15:23 | D |     - Rotating model.layers.16.self_attn.q_proj (in)
25-01-15 02:15:23 | D |     - Rotating model.layers.16.self_attn.k_proj (in)
25-01-15 02:15:23 | D |     - Rotating model.layers.16.self_attn.v_proj (in)
25-01-15 02:15:23 | D |     - Rotating model.layers.16.self_attn.o_proj (out)
25-01-15 02:15:23 | D |     - Rotating model.layers.16.proj_1st (in)
25-01-15 02:15:23 | D |     - Rotating model.layers.16.proj_2nd (out)
25-01-15 02:15:23 | D |   - Rotating model.layers.17
25-01-15 02:15:23 | D |     - Rotating model.layers.17.self_attn.q_proj (in)
25-01-15 02:15:23 | D |     - Rotating model.layers.17.self_attn.k_proj (in)
25-01-15 02:15:23 | D |     - Rotating model.layers.17.self_attn.v_proj (in)
25-01-15 02:15:23 | D |     - Rotating model.layers.17.self_attn.o_proj (out)
25-01-15 02:15:23 | D |     - Rotating model.layers.17.proj_1st (in)
25-01-15 02:15:23 | D |     - Rotating model.layers.17.proj_2nd (out)
25-01-15 02:15:24 | D |   - Rotating model.layers.18
25-01-15 02:15:24 | D |     - Rotating model.layers.18.self_attn.q_proj (in)
25-01-15 02:15:24 | D |     - Rotating model.layers.18.self_attn.k_proj (in)
25-01-15 02:15:24 | D |     - Rotating model.layers.18.self_attn.v_proj (in)
25-01-15 02:15:24 | D |     - Rotating model.layers.18.self_attn.o_proj (out)
25-01-15 02:15:24 | D |     - Rotating model.layers.18.proj_1st (in)
25-01-15 02:15:24 | D |     - Rotating model.layers.18.proj_2nd (out)
25-01-15 02:15:24 | D |   - Rotating model.layers.19
25-01-15 02:15:24 | D |     - Rotating model.layers.19.self_attn.q_proj (in)
25-01-15 02:15:24 | D |     - Rotating model.layers.19.self_attn.k_proj (in)
25-01-15 02:15:24 | D |     - Rotating model.layers.19.self_attn.v_proj (in)
25-01-15 02:15:24 | D |     - Rotating model.layers.19.self_attn.o_proj (out)
25-01-15 02:15:24 | D |     - Rotating model.layers.19.proj_1st (in)
25-01-15 02:15:24 | D |     - Rotating model.layers.19.proj_2nd (out)
25-01-15 02:15:24 | D |   - Rotating model.layers.20
25-01-15 02:15:24 | D |     - Rotating model.layers.20.self_attn.q_proj (in)
25-01-15 02:15:24 | D |     - Rotating model.layers.20.self_attn.k_proj (in)
25-01-15 02:15:24 | D |     - Rotating model.layers.20.self_attn.v_proj (in)
25-01-15 02:15:24 | D |     - Rotating model.layers.20.self_attn.o_proj (out)
25-01-15 02:15:24 | D |     - Rotating model.layers.20.proj_1st (in)
25-01-15 02:15:24 | D |     - Rotating model.layers.20.proj_2nd (out)
25-01-15 02:15:25 | D |   - Rotating model.layers.21
25-01-15 02:15:25 | D |     - Rotating model.layers.21.self_attn.q_proj (in)
25-01-15 02:15:25 | D |     - Rotating model.layers.21.self_attn.k_proj (in)
25-01-15 02:15:25 | D |     - Rotating model.layers.21.self_attn.v_proj (in)
25-01-15 02:15:25 | D |     - Rotating model.layers.21.self_attn.o_proj (out)
25-01-15 02:15:25 | D |     - Rotating model.layers.21.proj_1st (in)
25-01-15 02:15:25 | D |     - Rotating model.layers.21.proj_2nd (out)
25-01-15 02:15:25 | D |   - Rotating lm_head (in)
25-01-15 02:15:27 | I | * Smooth quantizing model
25-01-15 02:15:27 | I |   - Loading smooth scales from runs/llm/cache/pileval.128x1024.[0-0]/smooth/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]/smooth.xw.OutputsError.Manual.Layer.d2.en1.sn1-yx.OutputsError.Manual.Layer.d2.en1.sn1/smooth.xw.[x.AbsMax.w.AbsMax]-yx.[x.AbsMax.w.AbsMax]/smooth.xw.a0p3.b0p7-yx.a0p5.b0/smooth.xw.skip.[proj_1st+proj_qkv]-yx.skip.[]/tiny-llama-1.1b.pt
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.0
25-01-15 02:15:27 | D |     - model.layers.0.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.0.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.0.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.1
25-01-15 02:15:27 | D |     - model.layers.1.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.1.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.1.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.2
25-01-15 02:15:27 | D |     - model.layers.2.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.2.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.2.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.3
25-01-15 02:15:27 | D |     - model.layers.3.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.3.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.3.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.4
25-01-15 02:15:27 | D |     - model.layers.4.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.4.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.4.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.5
25-01-15 02:15:27 | D |     - model.layers.5.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.5.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.5.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.6
25-01-15 02:15:27 | D |     - model.layers.6.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.6.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.6.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.7
25-01-15 02:15:27 | D |     - model.layers.7.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.7.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.7.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.8
25-01-15 02:15:27 | D |     - model.layers.8.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.8.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.8.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.9
25-01-15 02:15:27 | D |     - model.layers.9.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.9.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.9.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.10
25-01-15 02:15:27 | D |     - model.layers.10.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.10.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.10.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.11
25-01-15 02:15:27 | D |     - model.layers.11.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.11.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.11.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.12
25-01-15 02:15:27 | D |     - model.layers.12.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.12.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.12.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.13
25-01-15 02:15:27 | D |     - model.layers.13.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.13.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.13.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.14
25-01-15 02:15:27 | D |     - model.layers.14.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.14.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.14.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.15
25-01-15 02:15:27 | D |     - model.layers.15.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.15.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.15.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.16
25-01-15 02:15:27 | D |     - model.layers.16.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.16.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.16.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.17
25-01-15 02:15:27 | D |     - model.layers.17.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.17.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.17.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.18
25-01-15 02:15:27 | D |     - model.layers.18.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.18.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.18.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.19
25-01-15 02:15:27 | D |     - model.layers.19.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.19.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.19.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.20
25-01-15 02:15:27 | D |     - model.layers.20.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.20.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.20.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:27 | D |   - Smooth Quantizing Decoder Layer model.layers.21
25-01-15 02:15:27 | D |     - model.layers.21.self_attn.LlmModuleKey.ATTN_QK
25-01-15 02:15:27 | D |     - model.layers.21.self_attn.LlmModuleKey.PROJ_OUT
25-01-15 02:15:27 | D |     - model.layers.21.mlp.LlmModuleKey.PROJ_2ND
25-01-15 02:15:28 | I | * Begin to QAT
25-01-15 02:15:28 | D | Setting JobRuntime:name=UNKNOWN_NAME
25-01-15 02:15:28 | D | Setting JobRuntime:name=utils
25-01-15 02:15:30 | I | distributed init (rank 0): env://
25-01-15 02:15:30 | I | initialized host 3fb0cc53fbf9 as rank 0
25-01-15 02:15:30 | I | nvidia-smi stats: {'gpu_0_mem_used_gb': 2.443359375, 'gpu_1_mem_used_gb': 2.7109375, 'gpu_2_mem_used_gb': 2.64453125, 'gpu_3_mem_used_gb': 0.0, 'gpu_4_mem_used_gb': 0.0, 'gpu_5_mem_used_gb': 0.0, 'gpu_6_mem_used_gb': 0.0, 'gpu_7_mem_used_gb': 0.0}
25-01-15 02:15:30 | I | {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 1, 'log_format': 'simple', 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': 'layer_wise_quant', 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': True, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma', 'log_nvidia_smi': False}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None, 'is_moe': False, 'is_model_parallel': False}, 'distributed_training': {'_name': None, 'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'env://', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'pytorch_ddp', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 2, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'zero_group_size': -1, 'save_zero_ckpt_fast': False, 'fp16': True, 'memory_efficient_fp16': True, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False}, 'dataset': {'_name': None, 'num_workers': 1, 'num_workers_valid': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 32, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 1, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 32, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 100, 'stop_time_hours': 0.0, 'clip_norm': 2.0, 'sentence_avg': False, 'update_freq': [2], 'lr': [0.00015], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 1000, 'keep_interval_updates': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': True, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_best_checkpoints': False, 'no_save_optimizer_state': False, 'no_save_optimizer_state_on_training_finished': False, 'symlink_best_and_last_checkpoints': False, 'best_checkpoint_metric': 'loss_valid', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 's3_upload_path': None, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 2}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'input_quant_method': '', 'input_bits': -1, 'weight_quant_method': '', 'weight_bits': -1, 'smoothquant': False, 'smoothquant_alpha': 0.5, 'smoothquant_bitnet': False, 'input_bits_post': 8, 'hadamard_group': -1, 'cal_input_stat': 'none', 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807, 'stats_path': None, 'max_valid_steps': None}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'llama_for_layer_wise_qat', 'load_ckpt': None, 'batch_size': 32, 'share_input_output_embed': False, 'sliding_window': None, 'rope_theta': 10000.0, 'checkpoint_activations': False, 'tokens_per_sample': 512, 'model_parallel_size': 1}, 'task': {'_name': 'kd', 'path_to_labels': None, 'data': '/data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b', 'tokens_per_sample': 512, 'batch_size_in_quant': 8, 'max_target_positions': None, 'llama_model': None, 'quant_acts_when_training': True, 'tiktoken_model': 'cl100k_base', 'batch_read_ahead': 1, 'pad_to_max_len': True, 'absolute_path': False, 'tokenizer_pad_to_multiple': 1, 'seed': 1, 'batch_size': 32}, 'criterion': {'_name': 'mse', 'sentence_avg': False}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9, 0.95)', 'adam_eps': 1e-06, 'weight_decay': 0.05, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'bf16': False, 'lr': [0.00015], 'block_wise': False}, 'lr_scheduler': {'_name': 'polynomial_decay', 'warmup_updates': 50, 'force_anneal': None, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 300000.0, 'lr': [0.00015]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None}
25-01-15 02:15:30 | I | LlamaModelDecoderLayer(
  (decoder): LlamaDecoderLayerInFairseq(
    (model): LlamaDecoderLayer(
      (self_attn): LlamaSdpaAttention(
        (q_proj): Linear(in_features=2048, out_features=2048, bias=False)
        (k_proj): Linear(in_features=2048, out_features=256, bias=False)
        (v_proj): Linear(in_features=2048, out_features=256, bias=False)
        (o_proj): Linear(in_features=2048, out_features=2048, bias=False)
        (rotary_emb): LlamaRotaryEmbedding()
        (q_rotary_emb): RotaryEmbedding()
        (k_rotary_emb): RotaryEmbedding()
      )
      (mlp): LlamaMLP(
        (gate_proj): Linear(in_features=2048, out_features=5632, bias=False)
        (up_proj): Linear(in_features=2048, out_features=5632, bias=False)
        (down_proj): Linear(in_features=5632, out_features=2048, bias=False)
        (act_fn): SiLU()
      )
      (input_layernorm): LlamaRMSNorm((2048,), eps=1e-05)
      (post_attention_layernorm): LlamaRMSNorm((2048,), eps=1e-05)
    )
  )
  (model): LlamaDecoderLayerInFairseq(
    (model): LlamaDecoderLayer(
      (self_attn): LlamaSdpaAttention(
        (q_proj): Linear(in_features=2048, out_features=2048, bias=False)
        (k_proj): Linear(in_features=2048, out_features=256, bias=False)
        (v_proj): Linear(in_features=2048, out_features=256, bias=False)
        (o_proj): Linear(in_features=2048, out_features=2048, bias=False)
        (rotary_emb): LlamaRotaryEmbedding()
        (q_rotary_emb): RotaryEmbedding()
        (k_rotary_emb): RotaryEmbedding()
      )
      (mlp): LlamaMLP(
        (gate_proj): Linear(in_features=2048, out_features=5632, bias=False)
        (up_proj): Linear(in_features=2048, out_features=5632, bias=False)
        (down_proj): Linear(in_features=5632, out_features=2048, bias=False)
        (act_fn): SiLU()
      )
      (input_layernorm): LlamaRMSNorm((2048,), eps=1e-05)
      (post_attention_layernorm): LlamaRMSNorm((2048,), eps=1e-05)
    )
  )
)
25-01-15 02:15:30 | I | task: KDTask
25-01-15 02:15:30 | I | model: LlamaModelDecoderLayer
25-01-15 02:15:30 | I | criterion: MSECriterion
25-01-15 02:15:30 | I | num. non-expert model params: 44,044,288 (num. trained: 44,044,288)
25-01-15 02:15:30 | I | num. expert model params: 0 (num. trained: 0)
25-01-15 02:15:30 | I | nvidia-smi stats: {'gpu_0_mem_used_gb': 2.443359375, 'gpu_1_mem_used_gb': 2.7109375, 'gpu_2_mem_used_gb': 2.64453125, 'gpu_3_mem_used_gb': 0.0, 'gpu_4_mem_used_gb': 0.0, 'gpu_5_mem_used_gb': 0.0, 'gpu_6_mem_used_gb': 0.0, 'gpu_7_mem_used_gb': 0.0}
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.self_attn.q_proj.weight <- model.model.self_attn.q_proj.weight
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- decoder.model.self_attn.k_proj.bias
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- decoder.model.self_attn.v_proj.bias
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- decoder.model.self_attn.o_proj.bias
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- decoder.model.mlp.gate_proj.bias
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- decoder.model.mlp.up_proj.bias
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- decoder.model.mlp.down_proj.bias
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.self_attn.q_proj.bias
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.self_attn.k_proj.bias
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.self_attn.v_proj.bias
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.self_attn.o_proj.bias
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.mlp.gate_proj.bias
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.mlp.up_proj.bias
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.mlp.down_proj.bias
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.self_attn.k_proj.weight <- model.model.self_attn.k_proj.weight
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.self_attn.v_proj.weight <- model.model.self_attn.v_proj.weight
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.self_attn.o_proj.weight <- model.model.self_attn.o_proj.weight
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.mlp.gate_proj.weight <- model.model.mlp.gate_proj.weight
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.mlp.up_proj.weight <- model.model.mlp.up_proj.weight
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.mlp.down_proj.weight <- model.model.mlp.down_proj.weight
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.input_layernorm.weight <- model.model.input_layernorm.weight
25-01-15 02:15:30 | I | detected shared parameter: decoder.model.post_attention_layernorm.weight <- model.model.post_attention_layernorm.weight
25-01-15 02:15:30 | I | nvidia-smi stats: {'gpu_0_mem_used_gb': 2.443359375, 'gpu_1_mem_used_gb': 2.7109375, 'gpu_2_mem_used_gb': 2.64453125, 'gpu_3_mem_used_gb': 0.0, 'gpu_4_mem_used_gb': 0.0, 'gpu_5_mem_used_gb': 0.0, 'gpu_6_mem_used_gb': 0.0, 'gpu_7_mem_used_gb': 0.0}
25-01-15 02:15:30 | I | ***********************CUDA enviroments for all 1 workers***********************
25-01-15 02:15:30 | I | rank   0: capabilities =  8.6  ; total memory = 23.691 GB ; name = NVIDIA GeForce RTX 3090                 
25-01-15 02:15:30 | I | ***********************CUDA enviroments for all 1 workers***********************
25-01-15 02:15:30 | I | training on 1 devices (GPUs/TPUs)
25-01-15 02:15:30 | I | max tokens per GPU = None and batch size per GPU = 32
25-01-15 02:15:30 | I | nvidia-smi stats: {'gpu_0_mem_used_gb': 2.443359375, 'gpu_1_mem_used_gb': 2.7109375, 'gpu_2_mem_used_gb': 2.64453125, 'gpu_3_mem_used_gb': 0.0, 'gpu_4_mem_used_gb': 0.0, 'gpu_5_mem_used_gb': 0.0, 'gpu_6_mem_used_gb': 0.0, 'gpu_7_mem_used_gb': 0.0}
25-01-15 02:15:30 | I | loading train data for epoch 1
25-01-15 02:15:32 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/0.jsonl 
 ***
25-01-15 02:15:32 | I | *** 
 total_rows = 700 
 ***
25-01-15 02:15:32 | I | current row num = 0
25-01-15 02:15:32 | I | in forward_and_gen_teacher_outputs, Start iterating over samples
25-01-15 02:15:32 | I | current row num = 32
25-01-15 02:15:34 | I | current row num = 64
25-01-15 02:15:36 | I | current row num = 96
25-01-15 02:15:37 | I | current row num = 128
25-01-15 02:15:38 | I | current row num = 160
25-01-15 02:15:39 | I | current row num = 192
25-01-15 02:15:41 | I | current row num = 224
25-01-15 02:15:42 | I | current row num = 256
25-01-15 02:15:43 | I | current row num = 288
25-01-15 02:15:44 | I | current row num = 320
25-01-15 02:15:45 | I | current row num = 352
25-01-15 02:15:47 | I | current row num = 384
25-01-15 02:15:48 | I | current row num = 416
25-01-15 02:15:49 | I | current row num = 448
25-01-15 02:15:50 | I | current row num = 480
25-01-15 02:15:52 | I | current row num = 512
25-01-15 02:15:53 | I | current row num = 544
25-01-15 02:15:54 | I | current row num = 576
25-01-15 02:15:55 | I | current row num = 608
25-01-15 02:15:57 | I | current row num = 640
25-01-15 02:15:58 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/1.jsonl 
 ***
25-01-15 02:15:58 | I | *** 
 total_rows = 241 
 ***
25-01-15 02:15:58 | I | current row num = 0
25-01-15 02:15:59 | I | current row num = 32
25-01-15 02:16:01 | I | current row num = 64
25-01-15 02:16:02 | I | current row num = 96
25-01-15 02:16:03 | I | current row num = 128
25-01-15 02:16:04 | I | current row num = 160
25-01-15 02:16:06 | I | current row num = 192
25-01-15 02:16:07 | I | current row num = 224
25-01-15 02:16:09 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/2.jsonl 
 ***
25-01-15 02:16:09 | I | *** 
 total_rows = 509 
 ***
25-01-15 02:16:09 | I | current row num = 0
25-01-15 02:16:10 | I | current row num = 32
25-01-15 02:16:12 | I | current row num = 64
25-01-15 02:16:14 | I | current row num = 96
25-01-15 02:16:16 | I | current row num = 128
25-01-15 02:16:17 | I | current row num = 160
25-01-15 02:16:18 | I | current row num = 192
25-01-15 02:16:19 | I | current row num = 224
25-01-15 02:16:20 | I | current row num = 256
25-01-15 02:16:22 | I | current row num = 288
25-01-15 02:16:23 | I | current row num = 320
25-01-15 02:16:24 | I | current row num = 352
25-01-15 02:16:26 | I | current row num = 384
25-01-15 02:16:27 | I | current row num = 416
25-01-15 02:16:29 | I | current row num = 448
25-01-15 02:16:30 | I | current row num = 480
25-01-15 02:16:32 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/3.jsonl 
 ***
25-01-15 02:16:32 | I | *** 
 total_rows = 274 
 ***
25-01-15 02:16:32 | I | current row num = 0
25-01-15 02:16:33 | I | current row num = 32
25-01-15 02:16:36 | I | current row num = 64
25-01-15 02:16:37 | I | current row num = 96
25-01-15 02:16:38 | I | current row num = 128
25-01-15 02:16:39 | I | current row num = 160
25-01-15 02:16:40 | I | current row num = 192
25-01-15 02:16:42 | I | current row num = 224
25-01-15 02:16:43 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/4.jsonl 
 ***
25-01-15 02:16:43 | I | *** 
 total_rows = 191 
 ***
25-01-15 02:16:43 | I | current row num = 0
25-01-15 02:16:45 | I | current row num = 32
25-01-15 02:16:46 | I | current row num = 64
25-01-15 02:16:47 | I | current row num = 96
25-01-15 02:16:48 | I | current row num = 128
25-01-15 02:16:50 | I | current row num = 160
25-01-15 02:16:53 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/5.jsonl 
 ***
25-01-15 02:16:53 | I | *** 
 total_rows = 211 
 ***
25-01-15 02:16:53 | I | current row num = 0
25-01-15 02:16:54 | I | current row num = 32
25-01-15 02:16:55 | I | current row num = 64
25-01-15 02:16:56 | I | current row num = 96
25-01-15 02:16:57 | I | current row num = 128
25-01-15 02:17:00 | I | current row num = 160
25-01-15 02:17:01 | I | current row num = 192
25-01-15 02:17:03 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/6.jsonl 
 ***
25-01-15 02:17:03 | I | *** 
 total_rows = 241 
 ***
25-01-15 02:17:03 | I | current row num = 0
25-01-15 02:17:04 | I | current row num = 32
25-01-15 02:17:06 | I | current row num = 64
25-01-15 02:17:07 | I | current row num = 96
25-01-15 02:17:08 | I | current row num = 128
25-01-15 02:17:09 | I | current row num = 160
25-01-15 02:17:11 | I | current row num = 192
25-01-15 02:17:13 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/7.jsonl 
 ***
25-01-15 02:17:13 | I | *** 
 total_rows = 279 
 ***
25-01-15 02:17:13 | I | current row num = 0
25-01-15 02:17:14 | I | current row num = 32
25-01-15 02:17:15 | I | current row num = 64
25-01-15 02:17:16 | I | current row num = 96
25-01-15 02:17:18 | I | current row num = 128
25-01-15 02:17:19 | I | current row num = 160
25-01-15 02:17:20 | I | current row num = 192
25-01-15 02:17:21 | I | current row num = 224
25-01-15 02:17:22 | I | current row num = 256
25-01-15 02:17:24 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/8.jsonl 
 ***
25-01-15 02:17:24 | I | *** 
 total_rows = 186 
 ***
25-01-15 02:17:24 | I | current row num = 0
25-01-15 02:17:25 | I | current row num = 32
25-01-15 02:17:27 | I | current row num = 64
25-01-15 02:17:28 | I | current row num = 96
25-01-15 02:17:29 | I | current row num = 128
25-01-15 02:17:30 | I | current row num = 160
25-01-15 02:17:33 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/9.jsonl 
 ***
25-01-15 02:17:33 | I | *** 
 total_rows = 770 
 ***
25-01-15 02:17:33 | I | current row num = 0
25-01-15 02:17:34 | I | current row num = 32
25-01-15 02:17:37 | I | current row num = 64
25-01-15 02:17:38 | I | current row num = 96
25-01-15 02:17:39 | I | current row num = 128
25-01-15 02:17:41 | I | current row num = 160
25-01-15 02:17:42 | I | current row num = 192
25-01-15 02:17:43 | I | current row num = 224
25-01-15 02:17:45 | I | current row num = 256
25-01-15 02:17:47 | I | current row num = 288
25-01-15 02:17:48 | I | current row num = 320
25-01-15 02:17:50 | I | current row num = 352
25-01-15 02:17:51 | I | current row num = 384
25-01-15 02:17:52 | I | current row num = 416
25-01-15 02:17:55 | I | current row num = 448
25-01-15 02:17:56 | I | current row num = 480
25-01-15 02:17:57 | I | current row num = 512
25-01-15 02:17:59 | I | current row num = 544
25-01-15 02:18:00 | I | current row num = 576
25-01-15 02:18:01 | I | current row num = 608
25-01-15 02:18:02 | I | current row num = 640
25-01-15 02:18:04 | I | current row num = 672
25-01-15 02:18:06 | I | current row num = 704
25-01-15 02:18:07 | I | current row num = 736
25-01-15 02:18:09 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/10.jsonl 
 ***
25-01-15 02:18:09 | I | *** 
 total_rows = 271 
 ***
25-01-15 02:18:09 | I | current row num = 0
25-01-15 02:18:10 | I | current row num = 32
25-01-15 02:18:11 | I | current row num = 64
25-01-15 02:18:14 | I | current row num = 96
25-01-15 02:18:15 | I | current row num = 128
25-01-15 02:18:17 | I | current row num = 160
25-01-15 02:18:19 | I | current row num = 192
25-01-15 02:18:20 | I | current row num = 224
25-01-15 02:18:21 | I | current row num = 256
25-01-15 02:18:23 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/11.jsonl 
 ***
25-01-15 02:18:23 | I | *** 
 total_rows = 273 
 ***
25-01-15 02:18:23 | I | current row num = 0
25-01-15 02:18:24 | I | current row num = 32
25-01-15 02:18:25 | I | current row num = 64
25-01-15 02:18:27 | I | current row num = 96
25-01-15 02:18:28 | I | current row num = 128
25-01-15 02:18:30 | I | current row num = 160
25-01-15 02:18:31 | I | current row num = 192
25-01-15 02:18:33 | I | current row num = 224
25-01-15 02:18:35 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/12.jsonl 
 ***
25-01-15 02:18:35 | I | *** 
 total_rows = 301 
 ***
25-01-15 02:18:35 | I | current row num = 0
25-01-15 02:18:36 | I | current row num = 32
25-01-15 02:18:38 | I | current row num = 64
25-01-15 02:18:39 | I | current row num = 96
25-01-15 02:18:40 | I | current row num = 128
25-01-15 02:18:41 | I | current row num = 160
25-01-15 02:18:43 | I | current row num = 192
25-01-15 02:18:45 | I | current row num = 224
25-01-15 02:18:47 | I | current row num = 256
25-01-15 02:18:48 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/13.jsonl 
 ***
25-01-15 02:18:48 | I | *** 
 total_rows = 239 
 ***
25-01-15 02:18:48 | I | current row num = 0
25-01-15 02:18:50 | I | current row num = 32
25-01-15 02:18:52 | I | current row num = 64
25-01-15 02:18:53 | I | current row num = 96
25-01-15 02:18:54 | I | current row num = 128
25-01-15 02:18:55 | I | current row num = 160
25-01-15 02:18:58 | I | current row num = 192
25-01-15 02:19:01 | I | current row num = 224
25-01-15 02:19:02 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/14.jsonl 
 ***
25-01-15 02:19:02 | I | *** 
 total_rows = 262 
 ***
25-01-15 02:19:02 | I | current row num = 0
25-01-15 02:19:04 | I | current row num = 32
25-01-15 02:19:05 | I | current row num = 64
25-01-15 02:19:06 | I | current row num = 96
25-01-15 02:19:08 | I | current row num = 128
25-01-15 02:19:09 | I | current row num = 160
25-01-15 02:19:11 | I | current row num = 192
25-01-15 02:19:12 | I | current row num = 224
25-01-15 02:19:15 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/15.jsonl 
 ***
25-01-15 02:19:15 | I | *** 
 total_rows = 253 
 ***
25-01-15 02:19:15 | I | current row num = 0
25-01-15 02:19:17 | I | current row num = 32
25-01-15 02:19:18 | I | current row num = 64
25-01-15 02:19:19 | I | current row num = 96
25-01-15 02:19:21 | I | current row num = 128
25-01-15 02:19:22 | I | current row num = 160
25-01-15 02:19:24 | I | current row num = 192
25-01-15 02:19:25 | I | current row num = 224
25-01-15 02:19:27 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/16.jsonl 
 ***
25-01-15 02:19:27 | I | *** 
 total_rows = 523 
 ***
25-01-15 02:19:27 | I | current row num = 0
25-01-15 02:19:28 | I | current row num = 32
25-01-15 02:19:30 | I | current row num = 64
25-01-15 02:19:31 | I | current row num = 96
25-01-15 02:19:32 | I | current row num = 128
25-01-15 02:19:33 | I | current row num = 160
25-01-15 02:19:35 | I | current row num = 192
25-01-15 02:19:36 | I | current row num = 224
25-01-15 02:19:38 | I | current row num = 256
25-01-15 02:19:40 | I | current row num = 288
25-01-15 02:19:41 | I | current row num = 320
25-01-15 02:19:42 | I | current row num = 352
25-01-15 02:19:45 | I | current row num = 384
25-01-15 02:19:46 | I | current row num = 416
25-01-15 02:19:47 | I | current row num = 448
25-01-15 02:19:48 | I | current row num = 480
25-01-15 02:19:50 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/17.jsonl 
 ***
25-01-15 02:19:50 | I | *** 
 total_rows = 251 
 ***
25-01-15 02:19:50 | I | current row num = 0
25-01-15 02:19:51 | I | current row num = 32
25-01-15 02:19:53 | I | current row num = 64
25-01-15 02:19:54 | I | current row num = 96
25-01-15 02:19:56 | I | current row num = 128
25-01-15 02:19:57 | I | current row num = 160
25-01-15 02:19:58 | I | current row num = 192
25-01-15 02:20:01 | I | current row num = 224
25-01-15 02:20:03 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/18.jsonl 
 ***
25-01-15 02:20:03 | I | *** 
 total_rows = 274 
 ***
25-01-15 02:20:03 | I | current row num = 0
25-01-15 02:20:04 | I | current row num = 32
25-01-15 02:20:05 | I | current row num = 64
25-01-15 02:20:06 | I | current row num = 96
25-01-15 02:20:07 | I | current row num = 128
25-01-15 02:20:09 | I | current row num = 160
25-01-15 02:20:10 | I | current row num = 192
25-01-15 02:20:11 | I | current row num = 224
25-01-15 02:20:12 | I | current row num = 256
25-01-15 02:20:14 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/19.jsonl 
 ***
25-01-15 02:20:14 | I | *** 
 total_rows = 315 
 ***
25-01-15 02:20:14 | I | current row num = 0
25-01-15 02:20:15 | I | current row num = 32
25-01-15 02:20:17 | I | current row num = 64
25-01-15 02:20:18 | I | current row num = 96
25-01-15 02:20:19 | I | current row num = 128
25-01-15 02:20:20 | I | current row num = 160
25-01-15 02:20:22 | I | current row num = 192
25-01-15 02:20:23 | I | current row num = 224
25-01-15 02:20:24 | I | current row num = 256
25-01-15 02:20:25 | I | current row num = 288
25-01-15 02:20:26 | I | current row num = 320
25-01-15 02:20:27 | I | loading train data for epoch 1
25-01-15 02:20:29 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/0.jsonl 
 ***
25-01-15 02:20:29 | I | *** 
 total_rows = 700 
 ***
25-01-15 02:20:29 | I | current row num = 0
25-01-15 02:20:29 | I | in forward_and_gen_args_and_kwargs, Start iterating over samples
25-01-15 02:20:29 | I | No existing checkpoint found checkpoints/checkpoint_last.pt
25-01-15 02:20:29 | I | loading train data for epoch 1
25-01-15 02:20:29 | I | loading valid data for epoch 1
25-01-15 02:20:35 | I | begin training epoch 1
25-01-15 02:20:35 | I | Start iterating over samples
25-01-15 02:20:36 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:20:36 | I | in layer model.layers.0
25-01-15 02:20:36 | I | quantizing weights for layer model.layers.0
25-01-15 02:20:36 | I | collecting info in model.layers.0
25-01-15 02:20:36 | I | collecting info in model.layers.0
25-01-15 02:20:36 | I | collecting info in model.layers.0
25-01-15 02:20:36 | I | collecting info in model.layers.0
25-01-15 02:20:36 | I | collecting calibration activations in model.layers.0
25-01-15 02:20:36 | I | collecting calibration activations in model.layers.0
25-01-15 02:20:36 | I | collecting calibration activations in model.layers.0
25-01-15 02:20:36 | I | collecting calibration activations in model.layers.0
25-01-15 02:20:37 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:20:37 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:20:37 | I |       - range scale = [    1.0000]
25-01-15 02:20:37 | I |         sum  error  = [    0.0433]
25-01-15 02:20:37 | I |         best error  = [    0.0433]
25-01-15 02:20:37 | I |     + error = [0.0433]
25-01-15 02:20:38 | I |       - range scale = [    1.0000]
25-01-15 02:20:38 | I |         sum  error  = [    0.4872]
25-01-15 02:20:38 | I |         best error  = [    0.4872]
25-01-15 02:20:38 | I |     + error = [0.4872]
25-01-15 02:20:38 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:20:39 | I |       - range scale = [    1.0000]
25-01-15 02:20:39 | I |         sum  error  = [    0.0532]
25-01-15 02:20:39 | I |         best error  = [    0.0532]
25-01-15 02:20:39 | I |     + error = [0.0532]
25-01-15 02:20:40 | I |       - range scale = [    1.0000]
25-01-15 02:20:40 | I |         sum  error  = [    0.6448]
25-01-15 02:20:40 | I |         best error  = [    0.6448]
25-01-15 02:20:40 | I |     + error = [0.6448]
25-01-15 02:20:40 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:20:40 | I |       - range scale = [    1.0000]
25-01-15 02:20:40 | I |         sum  error  = [    0.0122]
25-01-15 02:20:40 | I |         best error  = [    0.0122]
25-01-15 02:20:40 | I |     + error = [0.0122]
25-01-15 02:20:41 | I |       - range scale = [    1.0000]
25-01-15 02:20:41 | I |         sum  error  = [    0.1420]
25-01-15 02:20:41 | I |         best error  = [    0.1420]
25-01-15 02:20:41 | I |     + error = [0.1420]
25-01-15 02:20:41 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:20:42 | I |       - range scale = [    1.0000]
25-01-15 02:20:42 | I |         sum  error  = [    0.0515]
25-01-15 02:20:42 | I |         best error  = [    0.0515]
25-01-15 02:20:42 | I |     + error = [0.0515]
25-01-15 02:20:43 | I |       - range scale = [    1.0000]
25-01-15 02:20:43 | I |         sum  error  = [    0.5277]
25-01-15 02:20:43 | I |         best error  = [    0.5277]
25-01-15 02:20:43 | I |     + error = [0.5277]
25-01-15 02:20:43 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:20:44 | I |       - range scale = [    1.0000]
25-01-15 02:20:44 | I |         sum  error  = [    0.3232]
25-01-15 02:20:44 | I |         best error  = [    0.3232]
25-01-15 02:20:44 | I |     + error = [0.3232]
25-01-15 02:20:44 | I |       - range scale = [    1.0000]
25-01-15 02:20:44 | I |         sum  error  = [    3.6897]
25-01-15 02:20:44 | I |         best error  = [    3.6897]
25-01-15 02:20:44 | I |     + error = [3.6897]
25-01-15 02:20:45 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:20:45 | I |       - range scale = [    1.0000]
25-01-15 02:20:45 | I |         sum  error  = [    1.3330]
25-01-15 02:20:45 | I |         best error  = [    1.3330]
25-01-15 02:20:45 | I |     + error = [1.3330]
25-01-15 02:20:46 | I |       - range scale = [    1.0000]
25-01-15 02:20:46 | I |         sum  error  = [   15.4345]
25-01-15 02:20:46 | I |         best error  = [   15.4345]
25-01-15 02:20:46 | I |     + error = [15.4345]
25-01-15 02:20:46 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:20:47 | I |       - range scale = [    1.0000]
25-01-15 02:20:47 | I |         sum  error  = [    5.4638]
25-01-15 02:20:47 | I |         best error  = [    5.4638]
25-01-15 02:20:47 | I |     + error = [5.4638]
25-01-15 02:20:48 | I |       - range scale = [    1.0000]
25-01-15 02:20:48 | I |         sum  error  = [   28.7077]
25-01-15 02:20:48 | I |         best error  = [   28.7077]
25-01-15 02:20:48 | I |     + error = [28.7077]
25-01-15 02:20:48 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:20:49 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:20:51 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:20:52 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:20:54 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:20:55 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:20:56 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:21:00 | I | quantizing activations for layer model.layers.0
25-01-15 02:21:00 | I | collecting info in model.layers.0
25-01-15 02:21:00 | I | collecting info in model.layers.0
25-01-15 02:21:00 | I | collecting info in model.layers.0
25-01-15 02:21:00 | I | collecting info in model.layers.0
25-01-15 02:21:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:02 | I | forward this layer
25-01-15 02:21:02 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/00.pt
25-01-15 02:21:02 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/00.pt
25-01-15 02:21:03 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: True
25-01-15 02:21:03 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:21:03 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:21:03 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: True
25-01-15 02:21:03 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:21:03 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:21:03 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: True
25-01-15 02:21:03 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:21:03 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:21:03 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: True
25-01-15 02:21:03 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:21:03 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:21:03 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: True
25-01-15 02:21:03 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:21:03 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:21:03 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: True
25-01-15 02:21:03 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:21:03 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:21:03 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:21:03 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: True
25-01-15 02:21:03 | I | inf: first position tensor([  31, 5007], device='cuda:0')
25-01-15 02:21:03 | I | in layer model.layers.0
25-01-15 02:21:03 | I | quantizing weights for layer model.layers.0
25-01-15 02:21:03 | I | collecting info in model.layers.0
25-01-15 02:21:03 | I | collecting info in model.layers.0
25-01-15 02:21:03 | I | collecting info in model.layers.0
25-01-15 02:21:03 | I | collecting info in model.layers.0
25-01-15 02:21:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:04 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:21:04 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:21:04 | I |       - range scale = [    1.0000]
25-01-15 02:21:04 | I |         sum  error  = [    0.0442]
25-01-15 02:21:04 | I |         best error  = [    0.0442]
25-01-15 02:21:04 | I |     + error = [0.0442]
25-01-15 02:21:05 | I |       - range scale = [    1.0000]
25-01-15 02:21:05 | I |         sum  error  = [    0.4991]
25-01-15 02:21:05 | I |         best error  = [    0.4991]
25-01-15 02:21:05 | I |     + error = [0.4991]
25-01-15 02:21:05 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:21:06 | I |       - range scale = [    1.0000]
25-01-15 02:21:06 | I |         sum  error  = [    0.0546]
25-01-15 02:21:06 | I |         best error  = [    0.0546]
25-01-15 02:21:06 | I |     + error = [0.0546]
25-01-15 02:21:07 | I |       - range scale = [    1.0000]
25-01-15 02:21:07 | I |         sum  error  = [    0.6413]
25-01-15 02:21:07 | I |         best error  = [    0.6413]
25-01-15 02:21:07 | I |     + error = [0.6413]
25-01-15 02:21:07 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:21:07 | I |       - range scale = [    1.0000]
25-01-15 02:21:07 | I |         sum  error  = [    0.0123]
25-01-15 02:21:08 | I |         best error  = [    0.0123]
25-01-15 02:21:08 | I |     + error = [0.0123]
25-01-15 02:21:08 | I |       - range scale = [    1.0000]
25-01-15 02:21:08 | I |         sum  error  = [    0.1419]
25-01-15 02:21:08 | I |         best error  = [    0.1419]
25-01-15 02:21:08 | I |     + error = [0.1419]
25-01-15 02:21:08 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:21:09 | I |       - range scale = [    1.0000]
25-01-15 02:21:09 | I |         sum  error  = [    0.0527]
25-01-15 02:21:09 | I |         best error  = [    0.0527]
25-01-15 02:21:09 | I |     + error = [0.0527]
25-01-15 02:21:10 | I |       - range scale = [    1.0000]
25-01-15 02:21:10 | I |         sum  error  = [    0.5366]
25-01-15 02:21:10 | I |         best error  = [    0.5366]
25-01-15 02:21:10 | I |     + error = [0.5366]
25-01-15 02:21:10 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:21:11 | I |       - range scale = [    1.0000]
25-01-15 02:21:11 | I |         sum  error  = [    0.3231]
25-01-15 02:21:11 | I |         best error  = [    0.3231]
25-01-15 02:21:11 | I |     + error = [0.3231]
25-01-15 02:21:11 | I |       - range scale = [    1.0000]
25-01-15 02:21:11 | I |         sum  error  = [    3.6892]
25-01-15 02:21:11 | I |         best error  = [    3.6892]
25-01-15 02:21:11 | I |     + error = [3.6892]
25-01-15 02:21:11 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:21:12 | I |       - range scale = [    1.0000]
25-01-15 02:21:12 | I |         sum  error  = [    1.3344]
25-01-15 02:21:12 | I |         best error  = [    1.3344]
25-01-15 02:21:12 | I |     + error = [1.3344]
25-01-15 02:21:13 | I |       - range scale = [    1.0000]
25-01-15 02:21:13 | I |         sum  error  = [   15.4313]
25-01-15 02:21:13 | I |         best error  = [   15.4313]
25-01-15 02:21:13 | I |     + error = [15.4313]
25-01-15 02:21:13 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:21:14 | I |       - range scale = [    1.0000]
25-01-15 02:21:14 | I |         sum  error  = [    7.2872]
25-01-15 02:21:14 | I |         best error  = [    7.2872]
25-01-15 02:21:14 | I |     + error = [7.2872]
25-01-15 02:21:14 | I |       - range scale = [    1.0000]
25-01-15 02:21:14 | I |         sum  error  = [   39.3434]
25-01-15 02:21:14 | I |         best error  = [   39.3434]
25-01-15 02:21:14 | I |     + error = [39.3434]
25-01-15 02:21:15 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:21:16 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:21:17 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:21:19 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:21:20 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:21:21 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:21:23 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:21:26 | I | quantizing activations for layer model.layers.0
25-01-15 02:21:26 | I | collecting info in model.layers.0
25-01-15 02:21:26 | I | collecting info in model.layers.0
25-01-15 02:21:26 | I | collecting info in model.layers.0
25-01-15 02:21:26 | I | collecting info in model.layers.0
25-01-15 02:21:27 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:27 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:27 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:27 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:29 | I | forward this layer
25-01-15 02:21:29 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/01.pt
25-01-15 02:21:29 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/01.pt
25-01-15 02:21:29 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: True
25-01-15 02:21:29 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:21:29 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:21:29 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: True
25-01-15 02:21:29 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:21:29 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:21:29 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: True
25-01-15 02:21:29 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:21:29 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:21:29 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: True
25-01-15 02:21:29 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:21:29 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:21:29 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: True
25-01-15 02:21:29 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:21:29 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:21:29 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: True
25-01-15 02:21:29 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: True
25-01-15 02:21:29 | I | inf: first position tensor([5007,    1], device='cuda:0')
25-01-15 02:21:29 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:21:29 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:21:29 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: True
25-01-15 02:21:29 | I | inf: first position tensor([   0, 5007], device='cuda:0')
25-01-15 02:21:29 | I | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
25-01-15 02:21:29 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:21:29 | I | in layer model.layers.0
25-01-15 02:21:29 | I | quantizing weights for layer model.layers.0
25-01-15 02:21:29 | I | collecting info in model.layers.0
25-01-15 02:21:29 | I | collecting info in model.layers.0
25-01-15 02:21:29 | I | collecting info in model.layers.0
25-01-15 02:21:29 | I | collecting info in model.layers.0
25-01-15 02:21:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:30 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:21:30 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:21:31 | I |       - range scale = [    1.0000]
25-01-15 02:21:31 | I |         sum  error  = [    0.0440]
25-01-15 02:21:31 | I |         best error  = [    0.0440]
25-01-15 02:21:31 | I |     + error = [0.0440]
25-01-15 02:21:31 | I |       - range scale = [    1.0000]
25-01-15 02:21:31 | I |         sum  error  = [    0.4954]
25-01-15 02:21:31 | I |         best error  = [    0.4954]
25-01-15 02:21:31 | I |     + error = [0.4954]
25-01-15 02:21:32 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:21:32 | I |       - range scale = [    1.0000]
25-01-15 02:21:32 | I |         sum  error  = [    0.0544]
25-01-15 02:21:32 | I |         best error  = [    0.0544]
25-01-15 02:21:32 | I |     + error = [0.0544]
25-01-15 02:21:33 | I |       - range scale = [    1.0000]
25-01-15 02:21:33 | I |         sum  error  = [    0.6588]
25-01-15 02:21:33 | I |         best error  = [    0.6588]
25-01-15 02:21:33 | I |     + error = [0.6588]
25-01-15 02:21:33 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:21:34 | I |       - range scale = [    1.0000]
25-01-15 02:21:34 | I |         sum  error  = [    0.0123]
25-01-15 02:21:34 | I |         best error  = [    0.0123]
25-01-15 02:21:34 | I |     + error = [0.0123]
25-01-15 02:21:35 | I |       - range scale = [    1.0000]
25-01-15 02:21:35 | I |         sum  error  = [    0.1417]
25-01-15 02:21:35 | I |         best error  = [    0.1417]
25-01-15 02:21:35 | I |     + error = [0.1417]
25-01-15 02:21:35 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:21:35 | I |       - range scale = [    1.0000]
25-01-15 02:21:35 | I |         sum  error  = [    0.0522]
25-01-15 02:21:35 | I |         best error  = [    0.0522]
25-01-15 02:21:35 | I |     + error = [0.0522]
25-01-15 02:21:36 | I |       - range scale = [    1.0000]
25-01-15 02:21:36 | I |         sum  error  = [    0.5332]
25-01-15 02:21:36 | I |         best error  = [    0.5332]
25-01-15 02:21:36 | I |     + error = [0.5332]
25-01-15 02:21:36 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:21:37 | I |       - range scale = [    1.0000]
25-01-15 02:21:37 | I |         sum  error  = [    0.3231]
25-01-15 02:21:37 | I |         best error  = [    0.3231]
25-01-15 02:21:37 | I |     + error = [0.3231]
25-01-15 02:21:38 | I |       - range scale = [    1.0000]
25-01-15 02:21:38 | I |         sum  error  = [    3.6896]
25-01-15 02:21:38 | I |         best error  = [    3.6896]
25-01-15 02:21:38 | I |     + error = [3.6896]
25-01-15 02:21:38 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:21:38 | I |       - range scale = [    1.0000]
25-01-15 02:21:38 | I |         sum  error  = [    1.3337]
25-01-15 02:21:38 | I |         best error  = [    1.3337]
25-01-15 02:21:38 | I |     + error = [1.3337]
25-01-15 02:21:39 | I |       - range scale = [    1.0000]
25-01-15 02:21:39 | I |         sum  error  = [   15.4363]
25-01-15 02:21:39 | I |         best error  = [   15.4363]
25-01-15 02:21:39 | I |     + error = [15.4363]
25-01-15 02:21:39 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:21:40 | I |       - range scale = [    1.0000]
25-01-15 02:21:40 | I |         sum  error  = [    7.3640]
25-01-15 02:21:40 | I |         best error  = [    7.3640]
25-01-15 02:21:40 | I |     + error = [7.3640]
25-01-15 02:21:41 | I |       - range scale = [    1.0000]
25-01-15 02:21:41 | I |         sum  error  = [   38.5366]
25-01-15 02:21:41 | I |         best error  = [   38.5366]
25-01-15 02:21:41 | I |     + error = [38.5366]
25-01-15 02:21:41 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:21:42 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:21:44 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:21:45 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:21:46 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:21:48 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:21:49 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:21:52 | I | quantizing activations for layer model.layers.0
25-01-15 02:21:52 | I | collecting info in model.layers.0
25-01-15 02:21:52 | I | collecting info in model.layers.0
25-01-15 02:21:52 | I | collecting info in model.layers.0
25-01-15 02:21:52 | I | collecting info in model.layers.0
25-01-15 02:21:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:55 | I | forward this layer
25-01-15 02:21:55 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/02.pt
25-01-15 02:21:55 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/02.pt
25-01-15 02:21:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: True
25-01-15 02:21:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:21:55 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:21:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: True
25-01-15 02:21:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:21:55 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:21:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: True
25-01-15 02:21:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:21:55 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:21:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: True
25-01-15 02:21:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:21:55 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:21:55 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: True
25-01-15 02:21:55 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: True
25-01-15 02:21:55 | I | inf: first position tensor([197,   0], device='cuda:0')
25-01-15 02:21:55 | I | nan: first position tensor([2029,    5], device='cuda:0')
25-01-15 02:21:55 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:21:55 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: True
25-01-15 02:21:55 | I | inf: first position tensor([371,   5], device='cuda:0')
25-01-15 02:21:55 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:21:55 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: True
25-01-15 02:21:55 | I | inf: first position tensor([  32, 2029], device='cuda:0')
25-01-15 02:21:55 | I | in layer model.layers.0
25-01-15 02:21:55 | I | quantizing weights for layer model.layers.0
25-01-15 02:21:55 | I | collecting info in model.layers.0
25-01-15 02:21:55 | I | collecting info in model.layers.0
25-01-15 02:21:55 | I | collecting info in model.layers.0
25-01-15 02:21:55 | I | collecting info in model.layers.0
25-01-15 02:21:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:21:56 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:21:56 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:21:57 | I |       - range scale = [    1.0000]
25-01-15 02:21:57 | I |         sum  error  = [    0.0437]
25-01-15 02:21:57 | I |         best error  = [    0.0437]
25-01-15 02:21:57 | I |     + error = [0.0437]
25-01-15 02:21:58 | I |       - range scale = [    1.0000]
25-01-15 02:21:58 | I |         sum  error  = [    0.4991]
25-01-15 02:21:58 | I |         best error  = [    0.4991]
25-01-15 02:21:58 | I |     + error = [0.4991]
25-01-15 02:21:58 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:21:58 | I |       - range scale = [    1.0000]
25-01-15 02:21:58 | I |         sum  error  = [    0.0544]
25-01-15 02:21:58 | I |         best error  = [    0.0544]
25-01-15 02:21:58 | I |     + error = [0.0544]
25-01-15 02:21:59 | I |       - range scale = [    1.0000]
25-01-15 02:21:59 | I |         sum  error  = [    0.6554]
25-01-15 02:21:59 | I |         best error  = [    0.6554]
25-01-15 02:21:59 | I |     + error = [0.6554]
25-01-15 02:21:59 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:22:00 | I |       - range scale = [    1.0000]
25-01-15 02:22:00 | I |         sum  error  = [    0.0122]
25-01-15 02:22:00 | I |         best error  = [    0.0122]
25-01-15 02:22:00 | I |     + error = [0.0122]
25-01-15 02:22:01 | I |       - range scale = [    1.0000]
25-01-15 02:22:01 | I |         sum  error  = [    0.1419]
25-01-15 02:22:01 | I |         best error  = [    0.1419]
25-01-15 02:22:01 | I |     + error = [0.1419]
25-01-15 02:22:01 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:22:02 | I |       - range scale = [    1.0000]
25-01-15 02:22:02 | I |         sum  error  = [    0.0498]
25-01-15 02:22:02 | I |         best error  = [    0.0498]
25-01-15 02:22:02 | I |     + error = [0.0498]
25-01-15 02:22:02 | I |       - range scale = [    1.0000]
25-01-15 02:22:02 | I |         sum  error  = [    0.5073]
25-01-15 02:22:02 | I |         best error  = [    0.5073]
25-01-15 02:22:02 | I |     + error = [0.5073]
25-01-15 02:22:02 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:22:03 | I |       - range scale = [    1.0000]
25-01-15 02:22:03 | I |         sum  error  = [    0.3233]
25-01-15 02:22:03 | I |         best error  = [    0.3233]
25-01-15 02:22:03 | I |     + error = [0.3233]
25-01-15 02:22:04 | I |       - range scale = [    1.0000]
25-01-15 02:22:04 | I |         sum  error  = [    3.6931]
25-01-15 02:22:04 | I |         best error  = [    3.6931]
25-01-15 02:22:04 | I |     + error = [3.6931]
25-01-15 02:22:04 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:22:05 | I |       - range scale = [    1.0000]
25-01-15 02:22:05 | I |         sum  error  = [    1.3358]
25-01-15 02:22:05 | I |         best error  = [    1.3358]
25-01-15 02:22:05 | I |     + error = [1.3358]
25-01-15 02:22:05 | I |       - range scale = [    1.0000]
25-01-15 02:22:05 | I |         sum  error  = [   15.4516]
25-01-15 02:22:05 | I |         best error  = [   15.4516]
25-01-15 02:22:05 | I |     + error = [15.4516]
25-01-15 02:22:06 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:22:06 | I |       - range scale = [    1.0000]
25-01-15 02:22:06 | I |         sum  error  = [    6.6329]
25-01-15 02:22:06 | I |         best error  = [    6.6329]
25-01-15 02:22:06 | I |     + error = [6.6329]
25-01-15 02:22:07 | I |       - range scale = [    1.0000]
25-01-15 02:22:07 | I |         sum  error  = [   33.2986]
25-01-15 02:22:07 | I |         best error  = [   33.2986]
25-01-15 02:22:07 | I |     + error = [33.2986]
25-01-15 02:22:07 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:22:09 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:22:10 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:22:11 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:22:13 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:22:14 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:22:15 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:22:19 | I | quantizing activations for layer model.layers.0
25-01-15 02:22:19 | I | collecting info in model.layers.0
25-01-15 02:22:19 | I | collecting info in model.layers.0
25-01-15 02:22:19 | I | collecting info in model.layers.0
25-01-15 02:22:19 | I | collecting info in model.layers.0
25-01-15 02:22:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:22:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:22:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:22:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:22:21 | I | forward this layer
25-01-15 02:22:21 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/03.pt
25-01-15 02:22:21 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/03.pt
25-01-15 02:22:21 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: True
25-01-15 02:22:21 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:22:21 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:22:21 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: True
25-01-15 02:22:21 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:22:21 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:22:21 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: True
25-01-15 02:22:21 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:22:21 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:22:21 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: True
25-01-15 02:22:21 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:22:21 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:22:21 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: True
25-01-15 02:22:21 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: True
25-01-15 02:22:21 | I | inf: first position tensor([197,   1], device='cuda:0')
25-01-15 02:22:21 | I | nan: first position tensor([2029,   31], device='cuda:0')
25-01-15 02:22:21 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:22:21 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: True
25-01-15 02:22:21 | I | inf: first position tensor([371,   5], device='cuda:0')
25-01-15 02:22:21 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:22:21 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: True
25-01-15 02:22:21 | I | inf: first position tensor([  32, 2029], device='cuda:0')
25-01-15 02:22:21 | I | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
25-01-15 02:22:22 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:22:22 | I | in layer model.layers.0
25-01-15 02:22:22 | I | quantizing weights for layer model.layers.0
25-01-15 02:22:22 | I | collecting info in model.layers.0
25-01-15 02:22:22 | I | collecting info in model.layers.0
25-01-15 02:22:22 | I | collecting info in model.layers.0
25-01-15 02:22:22 | I | collecting info in model.layers.0
25-01-15 02:22:22 | I | collecting calibration activations in model.layers.0
25-01-15 02:22:22 | I | collecting calibration activations in model.layers.0
25-01-15 02:22:22 | I | collecting calibration activations in model.layers.0
25-01-15 02:22:22 | I | collecting calibration activations in model.layers.0
25-01-15 02:22:23 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:22:23 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:22:23 | I |       - range scale = [    1.0000]
25-01-15 02:22:23 | I |         sum  error  = [    0.0435]
25-01-15 02:22:23 | I |         best error  = [    0.0435]
25-01-15 02:22:23 | I |     + error = [0.0435]
25-01-15 02:22:24 | I |       - range scale = [    1.0000]
25-01-15 02:22:24 | I |         sum  error  = [    0.4996]
25-01-15 02:22:24 | I |         best error  = [    0.4996]
25-01-15 02:22:24 | I |     + error = [0.4996]
25-01-15 02:22:24 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:22:25 | I |       - range scale = [    1.0000]
25-01-15 02:22:25 | I |         sum  error  = [    0.0540]
25-01-15 02:22:25 | I |         best error  = [    0.0540]
25-01-15 02:22:25 | I |     + error = [0.0540]
25-01-15 02:22:25 | I |       - range scale = [    1.0000]
25-01-15 02:22:25 | I |         sum  error  = [    0.6666]
25-01-15 02:22:25 | I |         best error  = [    0.6666]
25-01-15 02:22:25 | I |     + error = [0.6666]
25-01-15 02:22:26 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:22:26 | I |       - range scale = [    1.0000]
25-01-15 02:22:26 | I |         sum  error  = [    0.0123]
25-01-15 02:22:26 | I |         best error  = [    0.0123]
25-01-15 02:22:26 | I |     + error = [0.0123]
25-01-15 02:22:27 | I |       - range scale = [    1.0000]
25-01-15 02:22:27 | I |         sum  error  = [    0.1419]
25-01-15 02:22:27 | I |         best error  = [    0.1419]
25-01-15 02:22:27 | I |     + error = [0.1419]
25-01-15 02:22:27 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:22:28 | I |       - range scale = [    1.0000]
25-01-15 02:22:28 | I |         sum  error  = [    0.0499]
25-01-15 02:22:28 | I |         best error  = [    0.0499]
25-01-15 02:22:28 | I |     + error = [0.0499]
25-01-15 02:22:28 | I |       - range scale = [    1.0000]
25-01-15 02:22:28 | I |         sum  error  = [    0.5055]
25-01-15 02:22:28 | I |         best error  = [    0.5055]
25-01-15 02:22:28 | I |     + error = [0.5055]
25-01-15 02:22:29 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:22:29 | I |       - range scale = [    1.0000]
25-01-15 02:22:29 | I |         sum  error  = [    0.3237]
25-01-15 02:22:29 | I |         best error  = [    0.3237]
25-01-15 02:22:29 | I |     + error = [0.3237]
25-01-15 02:22:30 | I |       - range scale = [    1.0000]
25-01-15 02:22:30 | I |         sum  error  = [    3.6936]
25-01-15 02:22:30 | I |         best error  = [    3.6936]
25-01-15 02:22:30 | I |     + error = [3.6936]
25-01-15 02:22:30 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:22:31 | I |       - range scale = [    1.0000]
25-01-15 02:22:31 | I |         sum  error  = [    1.3356]
25-01-15 02:22:31 | I |         best error  = [    1.3356]
25-01-15 02:22:31 | I |     + error = [1.3356]
25-01-15 02:22:32 | I |       - range scale = [    1.0000]
25-01-15 02:22:32 | I |         sum  error  = [   15.4584]
25-01-15 02:22:32 | I |         best error  = [   15.4584]
25-01-15 02:22:32 | I |     + error = [15.4584]
25-01-15 02:22:32 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:22:32 | I |       - range scale = [    1.0000]
25-01-15 02:22:32 | I |         sum  error  = [    5.6571]
25-01-15 02:22:32 | I |         best error  = [    5.6571]
25-01-15 02:22:32 | I |     + error = [5.6571]
25-01-15 02:22:33 | I |       - range scale = [    1.0000]
25-01-15 02:22:33 | I |         sum  error  = [   26.3216]
25-01-15 02:22:33 | I |         best error  = [   26.3216]
25-01-15 02:22:33 | I |     + error = [26.3216]
25-01-15 02:22:33 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:22:35 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:22:36 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:22:37 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:22:39 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:22:40 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:22:41 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:22:45 | I | quantizing activations for layer model.layers.0
25-01-15 02:22:45 | I | collecting info in model.layers.0
25-01-15 02:22:45 | I | collecting info in model.layers.0
25-01-15 02:22:45 | I | collecting info in model.layers.0
25-01-15 02:22:45 | I | collecting info in model.layers.0
25-01-15 02:22:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:22:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:22:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:22:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:22:47 | I | forward this layer
25-01-15 02:22:47 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/04.pt
25-01-15 02:22:47 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/04.pt
25-01-15 02:22:47 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: True
25-01-15 02:22:47 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:22:47 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:22:47 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: True
25-01-15 02:22:47 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:22:47 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:22:47 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: True
25-01-15 02:22:47 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:22:47 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:22:47 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: True
25-01-15 02:22:47 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:22:47 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:22:47 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: True
25-01-15 02:22:47 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: True
25-01-15 02:22:47 | I | inf: first position tensor([197,   1], device='cuda:0')
25-01-15 02:22:47 | I | nan: first position tensor([5007,    3], device='cuda:0')
25-01-15 02:22:47 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:22:47 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: True
25-01-15 02:22:47 | I | inf: first position tensor([371,  38], device='cuda:0')
25-01-15 02:22:47 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:22:47 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: True
25-01-15 02:22:47 | I | inf: first position tensor([  84, 2029], device='cuda:0')
25-01-15 02:22:47 | I | in layer model.layers.0
25-01-15 02:22:47 | I | quantizing weights for layer model.layers.0
25-01-15 02:22:47 | I | collecting info in model.layers.0
25-01-15 02:22:47 | I | collecting info in model.layers.0
25-01-15 02:22:47 | I | collecting info in model.layers.0
25-01-15 02:22:47 | I | collecting info in model.layers.0
25-01-15 02:22:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:22:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:22:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:22:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:22:48 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:22:48 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:22:49 | I |       - range scale = [    1.0000]
25-01-15 02:22:49 | I |         sum  error  = [    0.0439]
25-01-15 02:22:49 | I |         best error  = [    0.0439]
25-01-15 02:22:49 | I |     + error = [0.0439]
25-01-15 02:22:50 | I |       - range scale = [    1.0000]
25-01-15 02:22:50 | I |         sum  error  = [    0.5003]
25-01-15 02:22:50 | I |         best error  = [    0.5003]
25-01-15 02:22:50 | I |     + error = [0.5003]
25-01-15 02:22:50 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:22:51 | I |       - range scale = [    1.0000]
25-01-15 02:22:51 | I |         sum  error  = [    0.0548]
25-01-15 02:22:51 | I |         best error  = [    0.0548]
25-01-15 02:22:51 | I |     + error = [0.0548]
25-01-15 02:22:51 | I |       - range scale = [    1.0000]
25-01-15 02:22:51 | I |         sum  error  = [    0.6454]
25-01-15 02:22:51 | I |         best error  = [    0.6454]
25-01-15 02:22:51 | I |     + error = [0.6454]
25-01-15 02:22:51 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:22:52 | I |       - range scale = [    1.0000]
25-01-15 02:22:52 | I |         sum  error  = [    0.0123]
25-01-15 02:22:52 | I |         best error  = [    0.0123]
25-01-15 02:22:52 | I |     + error = [0.0123]
25-01-15 02:22:53 | I |       - range scale = [    1.0000]
25-01-15 02:22:53 | I |         sum  error  = [    0.1419]
25-01-15 02:22:53 | I |         best error  = [    0.1419]
25-01-15 02:22:53 | I |     + error = [0.1419]
25-01-15 02:22:53 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:22:54 | I |       - range scale = [    1.0000]
25-01-15 02:22:54 | I |         sum  error  = [    0.0517]
25-01-15 02:22:54 | I |         best error  = [    0.0517]
25-01-15 02:22:54 | I |     + error = [0.0517]
25-01-15 02:22:54 | I |       - range scale = [    1.0000]
25-01-15 02:22:54 | I |         sum  error  = [    0.5259]
25-01-15 02:22:54 | I |         best error  = [    0.5259]
25-01-15 02:22:54 | I |     + error = [0.5259]
25-01-15 02:22:54 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:22:55 | I |       - range scale = [    1.0000]
25-01-15 02:22:55 | I |         sum  error  = [    0.3231]
25-01-15 02:22:55 | I |         best error  = [    0.3231]
25-01-15 02:22:55 | I |     + error = [0.3231]
25-01-15 02:22:56 | I |       - range scale = [    1.0000]
25-01-15 02:22:56 | I |         sum  error  = [    3.6912]
25-01-15 02:22:56 | I |         best error  = [    3.6912]
25-01-15 02:22:56 | I |     + error = [3.6912]
25-01-15 02:22:56 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:22:57 | I |       - range scale = [    1.0000]
25-01-15 02:22:57 | I |         sum  error  = [    1.3351]
25-01-15 02:22:57 | I |         best error  = [    1.3351]
25-01-15 02:22:57 | I |     + error = [1.3351]
25-01-15 02:22:57 | I |       - range scale = [    1.0000]
25-01-15 02:22:57 | I |         sum  error  = [   15.4387]
25-01-15 02:22:57 | I |         best error  = [   15.4387]
25-01-15 02:22:57 | I |     + error = [15.4387]
25-01-15 02:22:58 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:22:58 | I |       - range scale = [    1.0000]
25-01-15 02:22:58 | I |         sum  error  = [    5.5186]
25-01-15 02:22:58 | I |         best error  = [    5.5186]
25-01-15 02:22:58 | I |     + error = [5.5186]
25-01-15 02:22:59 | I |       - range scale = [    1.0000]
25-01-15 02:22:59 | I |         sum  error  = [   28.4531]
25-01-15 02:22:59 | I |         best error  = [   28.4531]
25-01-15 02:22:59 | I |     + error = [28.4531]
25-01-15 02:22:59 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:23:01 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:23:02 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:23:03 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:23:05 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:23:06 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:23:07 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:23:11 | I | quantizing activations for layer model.layers.0
25-01-15 02:23:11 | I | collecting info in model.layers.0
25-01-15 02:23:11 | I | collecting info in model.layers.0
25-01-15 02:23:11 | I | collecting info in model.layers.0
25-01-15 02:23:11 | I | collecting info in model.layers.0
25-01-15 02:23:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:23:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:23:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:23:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:23:13 | I | forward this layer
25-01-15 02:23:13 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/05.pt
25-01-15 02:23:13 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/05.pt
25-01-15 02:23:13 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: True
25-01-15 02:23:13 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:23:13 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:23:13 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: True
25-01-15 02:23:13 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:23:13 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:23:13 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: True
25-01-15 02:23:13 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:23:13 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:23:13 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: True
25-01-15 02:23:13 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:23:13 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:23:13 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: True
25-01-15 02:23:13 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: True
25-01-15 02:23:13 | I | inf: first position tensor([197,   1], device='cuda:0')
25-01-15 02:23:13 | I | nan: first position tensor([5007,    0], device='cuda:0')
25-01-15 02:23:13 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:23:13 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: True
25-01-15 02:23:13 | I | inf: first position tensor([371,  72], device='cuda:0')
25-01-15 02:23:13 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:23:13 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: True
25-01-15 02:23:13 | I | inf: first position tensor([  84, 2029], device='cuda:0')
25-01-15 02:23:13 | I | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
25-01-15 02:23:14 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:23:14 | I | in layer model.layers.0
25-01-15 02:23:14 | I | quantizing weights for layer model.layers.0
25-01-15 02:23:14 | I | collecting info in model.layers.0
25-01-15 02:23:14 | I | collecting info in model.layers.0
25-01-15 02:23:14 | I | collecting info in model.layers.0
25-01-15 02:23:14 | I | collecting info in model.layers.0
25-01-15 02:23:14 | I | collecting calibration activations in model.layers.0
25-01-15 02:23:14 | I | collecting calibration activations in model.layers.0
25-01-15 02:23:14 | I | collecting calibration activations in model.layers.0
25-01-15 02:23:14 | I | collecting calibration activations in model.layers.0
25-01-15 02:23:15 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:23:15 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:23:15 | I |       - range scale = [    1.0000]
25-01-15 02:23:15 | I |         sum  error  = [    0.0446]
25-01-15 02:23:15 | I |         best error  = [    0.0446]
25-01-15 02:23:15 | I |     + error = [0.0446]
25-01-15 02:23:16 | I |       - range scale = [    1.0000]
25-01-15 02:23:16 | I |         sum  error  = [    0.4988]
25-01-15 02:23:16 | I |         best error  = [    0.4988]
25-01-15 02:23:16 | I |     + error = [0.4988]
25-01-15 02:23:16 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:23:17 | I |       - range scale = [    1.0000]
25-01-15 02:23:17 | I |         sum  error  = [    0.0565]
25-01-15 02:23:17 | I |         best error  = [    0.0565]
25-01-15 02:23:17 | I |     + error = [0.0565]
25-01-15 02:23:17 | I |       - range scale = [    1.0000]
25-01-15 02:23:17 | I |         sum  error  = [    0.6159]
25-01-15 02:23:17 | I |         best error  = [    0.6159]
25-01-15 02:23:17 | I |     + error = [0.6159]
25-01-15 02:23:18 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:23:18 | I |       - range scale = [    1.0000]
25-01-15 02:23:18 | I |         sum  error  = [    0.0122]
25-01-15 02:23:18 | I |         best error  = [    0.0122]
25-01-15 02:23:18 | I |     + error = [0.0122]
25-01-15 02:23:19 | I |       - range scale = [    1.0000]
25-01-15 02:23:19 | I |         sum  error  = [    0.1415]
25-01-15 02:23:19 | I |         best error  = [    0.1415]
25-01-15 02:23:19 | I |     + error = [0.1415]
25-01-15 02:23:19 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:23:20 | I |       - range scale = [    1.0000]
25-01-15 02:23:20 | I |         sum  error  = [    0.0532]
25-01-15 02:23:20 | I |         best error  = [    0.0532]
25-01-15 02:23:20 | I |     + error = [0.0532]
25-01-15 02:23:20 | I |       - range scale = [    1.0000]
25-01-15 02:23:20 | I |         sum  error  = [    0.5433]
25-01-15 02:23:20 | I |         best error  = [    0.5433]
25-01-15 02:23:20 | I |     + error = [0.5433]
25-01-15 02:23:21 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:23:21 | I |       - range scale = [    1.0000]
25-01-15 02:23:21 | I |         sum  error  = [    0.3233]
25-01-15 02:23:21 | I |         best error  = [    0.3233]
25-01-15 02:23:21 | I |     + error = [0.3233]
25-01-15 02:23:22 | I |       - range scale = [    1.0000]
25-01-15 02:23:22 | I |         sum  error  = [    3.6878]
25-01-15 02:23:22 | I |         best error  = [    3.6878]
25-01-15 02:23:22 | I |     + error = [3.6878]
25-01-15 02:23:22 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:23:23 | I |       - range scale = [    1.0000]
25-01-15 02:23:23 | I |         sum  error  = [    1.3331]
25-01-15 02:23:23 | I |         best error  = [    1.3331]
25-01-15 02:23:23 | I |     + error = [1.3331]
25-01-15 02:23:24 | I |       - range scale = [    1.0000]
25-01-15 02:23:24 | I |         sum  error  = [   15.4304]
25-01-15 02:23:24 | I |         best error  = [   15.4304]
25-01-15 02:23:24 | I |     + error = [15.4304]
25-01-15 02:23:24 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:23:24 | I |       - range scale = [    1.0000]
25-01-15 02:23:24 | I |         sum  error  = [    7.0015]
25-01-15 02:23:24 | I |         best error  = [    7.0015]
25-01-15 02:23:24 | I |     + error = [7.0015]
25-01-15 02:23:25 | I |       - range scale = [    1.0000]
25-01-15 02:23:25 | I |         sum  error  = [   36.2245]
25-01-15 02:23:25 | I |         best error  = [   36.2245]
25-01-15 02:23:25 | I |     + error = [36.2245]
25-01-15 02:23:25 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:23:27 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:23:28 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:23:29 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:23:31 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:23:32 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:23:34 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:23:37 | I | quantizing activations for layer model.layers.0
25-01-15 02:23:37 | I | collecting info in model.layers.0
25-01-15 02:23:37 | I | collecting info in model.layers.0
25-01-15 02:23:37 | I | collecting info in model.layers.0
25-01-15 02:23:37 | I | collecting info in model.layers.0
25-01-15 02:23:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:23:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:23:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:23:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:23:39 | I | forward this layer
25-01-15 02:23:39 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/06.pt
25-01-15 02:23:39 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/06.pt
25-01-15 02:23:40 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: True
25-01-15 02:23:40 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:23:40 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:23:40 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: True
25-01-15 02:23:40 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:23:40 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:23:40 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: True
25-01-15 02:23:40 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:23:40 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:23:40 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: True
25-01-15 02:23:40 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:23:40 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:23:40 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: True
25-01-15 02:23:40 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: True
25-01-15 02:23:40 | I | inf: first position tensor([197,  25], device='cuda:0')
25-01-15 02:23:40 | I | nan: first position tensor([5007,    2], device='cuda:0')
25-01-15 02:23:40 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:23:40 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: True
25-01-15 02:23:40 | I | inf: first position tensor([2029,  145], device='cuda:0')
25-01-15 02:23:40 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:23:40 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: True
25-01-15 02:23:40 | I | inf: first position tensor([1183, 2029], device='cuda:0')
25-01-15 02:23:40 | I | in layer model.layers.0
25-01-15 02:23:40 | I | quantizing weights for layer model.layers.0
25-01-15 02:23:40 | I | collecting info in model.layers.0
25-01-15 02:23:40 | I | collecting info in model.layers.0
25-01-15 02:23:40 | I | collecting info in model.layers.0
25-01-15 02:23:40 | I | collecting info in model.layers.0
25-01-15 02:23:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:23:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:23:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:23:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:23:41 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:23:41 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:23:41 | I |       - range scale = [    1.0000]
25-01-15 02:23:41 | I |         sum  error  = [    0.0441]
25-01-15 02:23:41 | I |         best error  = [    0.0441]
25-01-15 02:23:41 | I |     + error = [0.0441]
25-01-15 02:23:42 | I |       - range scale = [    1.0000]
25-01-15 02:23:42 | I |         sum  error  = [    0.4978]
25-01-15 02:23:42 | I |         best error  = [    0.4978]
25-01-15 02:23:42 | I |     + error = [0.4978]
25-01-15 02:23:43 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:23:44 | I |       - range scale = [    1.0000]
25-01-15 02:23:44 | I |         sum  error  = [    0.0533]
25-01-15 02:23:44 | I |         best error  = [    0.0533]
25-01-15 02:23:44 | I |     + error = [0.0533]
25-01-15 02:23:44 | I |       - range scale = [    1.0000]
25-01-15 02:23:44 | I |         sum  error  = [    0.6074]
25-01-15 02:23:44 | I |         best error  = [    0.6074]
25-01-15 02:23:44 | I |     + error = [0.6074]
25-01-15 02:23:45 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:23:45 | I |       - range scale = [    1.0000]
25-01-15 02:23:45 | I |         sum  error  = [    0.0122]
25-01-15 02:23:45 | I |         best error  = [    0.0122]
25-01-15 02:23:45 | I |     + error = [0.0122]
25-01-15 02:23:46 | I |       - range scale = [    1.0000]
25-01-15 02:23:46 | I |         sum  error  = [    0.1423]
25-01-15 02:23:46 | I |         best error  = [    0.1423]
25-01-15 02:23:46 | I |     + error = [0.1423]
25-01-15 02:23:46 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:23:47 | I |       - range scale = [    1.0000]
25-01-15 02:23:47 | I |         sum  error  = [    0.0561]
25-01-15 02:23:47 | I |         best error  = [    0.0561]
25-01-15 02:23:47 | I |     + error = [0.0561]
25-01-15 02:23:47 | I |       - range scale = [    1.0000]
25-01-15 02:23:47 | I |         sum  error  = [    0.5706]
25-01-15 02:23:47 | I |         best error  = [    0.5706]
25-01-15 02:23:47 | I |     + error = [0.5706]
25-01-15 02:23:48 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:23:48 | I |       - range scale = [    1.0000]
25-01-15 02:23:48 | I |         sum  error  = [    0.3234]
25-01-15 02:23:48 | I |         best error  = [    0.3234]
25-01-15 02:23:48 | I |     + error = [0.3234]
25-01-15 02:23:49 | I |       - range scale = [    1.0000]
25-01-15 02:23:49 | I |         sum  error  = [    3.6944]
25-01-15 02:23:49 | I |         best error  = [    3.6944]
25-01-15 02:23:49 | I |     + error = [3.6944]
25-01-15 02:23:49 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:23:50 | I |       - range scale = [    1.0000]
25-01-15 02:23:50 | I |         sum  error  = [    1.3361]
25-01-15 02:23:50 | I |         best error  = [    1.3361]
25-01-15 02:23:50 | I |     + error = [1.3361]
25-01-15 02:23:51 | I |       - range scale = [    1.0000]
25-01-15 02:23:51 | I |         sum  error  = [   15.4473]
25-01-15 02:23:51 | I |         best error  = [   15.4473]
25-01-15 02:23:51 | I |     + error = [15.4473]
25-01-15 02:23:51 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:23:51 | I |       - range scale = [    1.0000]
25-01-15 02:23:51 | I |         sum  error  = [    6.2214]
25-01-15 02:23:51 | I |         best error  = [    6.2214]
25-01-15 02:23:51 | I |     + error = [6.2214]
25-01-15 02:23:52 | I |       - range scale = [    1.0000]
25-01-15 02:23:52 | I |         sum  error  = [   32.9626]
25-01-15 02:23:52 | I |         best error  = [   32.9626]
25-01-15 02:23:52 | I |     + error = [32.9626]
25-01-15 02:23:52 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:23:54 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:23:55 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:23:56 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:23:58 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:23:59 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:24:00 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:24:04 | I | quantizing activations for layer model.layers.0
25-01-15 02:24:04 | I | collecting info in model.layers.0
25-01-15 02:24:04 | I | collecting info in model.layers.0
25-01-15 02:24:04 | I | collecting info in model.layers.0
25-01-15 02:24:04 | I | collecting info in model.layers.0
25-01-15 02:24:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:24:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:24:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:24:05 | I | collecting calibration activations in model.layers.0
25-01-15 02:24:06 | I | forward this layer
25-01-15 02:24:06 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/07.pt
25-01-15 02:24:06 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/07.pt
25-01-15 02:24:07 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: True
25-01-15 02:24:07 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:24:07 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:24:07 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: True
25-01-15 02:24:07 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:24:07 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:24:07 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: True
25-01-15 02:24:07 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:24:07 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:24:07 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: True
25-01-15 02:24:07 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:24:07 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:24:07 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: True
25-01-15 02:24:07 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: True
25-01-15 02:24:07 | I | inf: first position tensor([197,   2], device='cuda:0')
25-01-15 02:24:07 | I | nan: first position tensor([5007,    4], device='cuda:0')
25-01-15 02:24:07 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:24:07 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: True
25-01-15 02:24:07 | I | inf: first position tensor([2029,  145], device='cuda:0')
25-01-15 02:24:07 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:24:07 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: True
25-01-15 02:24:07 | I | inf: first position tensor([1628, 2029], device='cuda:0')
25-01-15 02:24:07 | I | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
25-01-15 02:24:07 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:24:07 | I | in layer model.layers.0
25-01-15 02:24:07 | I | quantizing weights for layer model.layers.0
25-01-15 02:24:07 | I | collecting info in model.layers.0
25-01-15 02:24:07 | I | collecting info in model.layers.0
25-01-15 02:24:07 | I | collecting info in model.layers.0
25-01-15 02:24:07 | I | collecting info in model.layers.0
25-01-15 02:24:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:24:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:24:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:24:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:24:08 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:24:08 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:24:09 | I |       - range scale = [    1.0000]
25-01-15 02:24:09 | I |         sum  error  = [    0.0444]
25-01-15 02:24:09 | I |         best error  = [    0.0444]
25-01-15 02:24:09 | I |     + error = [0.0444]
25-01-15 02:24:09 | I |       - range scale = [    1.0000]
25-01-15 02:24:09 | I |         sum  error  = [    0.4931]
25-01-15 02:24:09 | I |         best error  = [    0.4931]
25-01-15 02:24:09 | I |     + error = [0.4931]
25-01-15 02:24:09 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:24:10 | I |       - range scale = [    1.0000]
25-01-15 02:24:10 | I |         sum  error  = [    0.0528]
25-01-15 02:24:10 | I |         best error  = [    0.0528]
25-01-15 02:24:10 | I |     + error = [0.0528]
25-01-15 02:24:11 | I |       - range scale = [    1.0000]
25-01-15 02:24:11 | I |         sum  error  = [    0.5926]
25-01-15 02:24:11 | I |         best error  = [    0.5926]
25-01-15 02:24:11 | I |     + error = [0.5926]
25-01-15 02:24:11 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:24:12 | I |       - range scale = [    1.0000]
25-01-15 02:24:12 | I |         sum  error  = [    0.0122]
25-01-15 02:24:12 | I |         best error  = [    0.0122]
25-01-15 02:24:12 | I |     + error = [0.0122]
25-01-15 02:24:12 | I |       - range scale = [    1.0000]
25-01-15 02:24:12 | I |         sum  error  = [    0.1419]
25-01-15 02:24:12 | I |         best error  = [    0.1419]
25-01-15 02:24:12 | I |     + error = [0.1419]
25-01-15 02:24:12 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:24:13 | I |       - range scale = [    1.0000]
25-01-15 02:24:13 | I |         sum  error  = [    0.0539]
25-01-15 02:24:13 | I |         best error  = [    0.0539]
25-01-15 02:24:13 | I |     + error = [0.0539]
25-01-15 02:24:14 | I |       - range scale = [    1.0000]
25-01-15 02:24:14 | I |         sum  error  = [    0.5441]
25-01-15 02:24:14 | I |         best error  = [    0.5441]
25-01-15 02:24:14 | I |     + error = [0.5441]
25-01-15 02:24:14 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:24:15 | I |       - range scale = [    1.0000]
25-01-15 02:24:15 | I |         sum  error  = [    0.3229]
25-01-15 02:24:15 | I |         best error  = [    0.3229]
25-01-15 02:24:15 | I |     + error = [0.3229]
25-01-15 02:24:16 | I |       - range scale = [    1.0000]
25-01-15 02:24:16 | I |         sum  error  = [    3.6871]
25-01-15 02:24:16 | I |         best error  = [    3.6871]
25-01-15 02:24:16 | I |     + error = [3.6871]
25-01-15 02:24:16 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:24:17 | I |       - range scale = [    1.0000]
25-01-15 02:24:17 | I |         sum  error  = [    1.3311]
25-01-15 02:24:17 | I |         best error  = [    1.3311]
25-01-15 02:24:17 | I |     + error = [1.3311]
25-01-15 02:24:18 | I |       - range scale = [    1.0000]
25-01-15 02:24:18 | I |         sum  error  = [   15.4177]
25-01-15 02:24:18 | I |         best error  = [   15.4177]
25-01-15 02:24:18 | I |     + error = [15.4177]
25-01-15 02:24:18 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:24:18 | I |       - range scale = [    1.0000]
25-01-15 02:24:18 | I |         sum  error  = [    8.3729]
25-01-15 02:24:18 | I |         best error  = [    8.3729]
25-01-15 02:24:18 | I |     + error = [8.3729]
25-01-15 02:24:19 | I |       - range scale = [    1.0000]
25-01-15 02:24:19 | I |         sum  error  = [   46.0379]
25-01-15 02:24:19 | I |         best error  = [   46.0379]
25-01-15 02:24:19 | I |     + error = [46.0379]
25-01-15 02:24:19 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:24:21 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:24:22 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:24:24 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:24:25 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:24:26 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:24:28 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:24:31 | I | quantizing activations for layer model.layers.0
25-01-15 02:24:31 | I | collecting info in model.layers.0
25-01-15 02:24:31 | I | collecting info in model.layers.0
25-01-15 02:24:31 | I | collecting info in model.layers.0
25-01-15 02:24:31 | I | collecting info in model.layers.0
25-01-15 02:24:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:24:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:24:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:24:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:24:33 | I | forward this layer
25-01-15 02:24:33 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/08.pt
25-01-15 02:24:33 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/08.pt
25-01-15 02:24:34 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: True
25-01-15 02:24:34 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:24:34 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:24:34 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: True
25-01-15 02:24:34 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:24:34 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:24:34 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: True
25-01-15 02:24:34 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:24:34 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:24:34 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:24:34 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:24:34 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:24:34 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: True
25-01-15 02:24:34 | I | inf: first position tensor([197,  38], device='cuda:0')
25-01-15 02:24:34 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:24:34 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: True
25-01-15 02:24:34 | I | inf: first position tensor([5007,  553], device='cuda:0')
25-01-15 02:24:34 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:24:34 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:24:34 | I | in layer model.layers.0
25-01-15 02:24:34 | I | quantizing weights for layer model.layers.0
25-01-15 02:24:34 | I | collecting info in model.layers.0
25-01-15 02:24:34 | I | collecting info in model.layers.0
25-01-15 02:24:34 | I | collecting info in model.layers.0
25-01-15 02:24:34 | I | collecting info in model.layers.0
25-01-15 02:24:34 | I | collecting calibration activations in model.layers.0
25-01-15 02:24:34 | I | collecting calibration activations in model.layers.0
25-01-15 02:24:34 | I | collecting calibration activations in model.layers.0
25-01-15 02:24:34 | I | collecting calibration activations in model.layers.0
25-01-15 02:24:35 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:24:35 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:24:35 | I |       - range scale = [    1.0000]
25-01-15 02:24:35 | I |         sum  error  = [    0.0435]
25-01-15 02:24:35 | I |         best error  = [    0.0435]
25-01-15 02:24:35 | I |     + error = [0.0435]
25-01-15 02:24:36 | I |       - range scale = [    1.0000]
25-01-15 02:24:36 | I |         sum  error  = [    0.4772]
25-01-15 02:24:36 | I |         best error  = [    0.4772]
25-01-15 02:24:36 | I |     + error = [0.4772]
25-01-15 02:24:36 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:24:37 | I |       - range scale = [    1.0000]
25-01-15 02:24:37 | I |         sum  error  = [    0.0545]
25-01-15 02:24:37 | I |         best error  = [    0.0545]
25-01-15 02:24:37 | I |     + error = [0.0545]
25-01-15 02:24:38 | I |       - range scale = [    1.0000]
25-01-15 02:24:38 | I |         sum  error  = [    0.6039]
25-01-15 02:24:38 | I |         best error  = [    0.6039]
25-01-15 02:24:38 | I |     + error = [0.6039]
25-01-15 02:24:38 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:24:38 | I |       - range scale = [    1.0000]
25-01-15 02:24:38 | I |         sum  error  = [    0.0124]
25-01-15 02:24:38 | I |         best error  = [    0.0124]
25-01-15 02:24:38 | I |     + error = [0.0124]
25-01-15 02:24:39 | I |       - range scale = [    1.0000]
25-01-15 02:24:39 | I |         sum  error  = [    0.1422]
25-01-15 02:24:39 | I |         best error  = [    0.1422]
25-01-15 02:24:39 | I |     + error = [0.1422]
25-01-15 02:24:39 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:24:40 | I |       - range scale = [    1.0000]
25-01-15 02:24:40 | I |         sum  error  = [    0.0571]
25-01-15 02:24:40 | I |         best error  = [    0.0571]
25-01-15 02:24:40 | I |     + error = [0.0571]
25-01-15 02:24:41 | I |       - range scale = [    1.0000]
25-01-15 02:24:41 | I |         sum  error  = [    0.5761]
25-01-15 02:24:41 | I |         best error  = [    0.5761]
25-01-15 02:24:41 | I |     + error = [0.5761]
25-01-15 02:24:41 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:24:41 | I |       - range scale = [    1.0000]
25-01-15 02:24:41 | I |         sum  error  = [    0.3242]
25-01-15 02:24:41 | I |         best error  = [    0.3242]
25-01-15 02:24:41 | I |     + error = [0.3242]
25-01-15 02:24:42 | I |       - range scale = [    1.0000]
25-01-15 02:24:42 | I |         sum  error  = [    3.6976]
25-01-15 02:24:42 | I |         best error  = [    3.6976]
25-01-15 02:24:42 | I |     + error = [3.6976]
25-01-15 02:24:42 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:24:43 | I |       - range scale = [    1.0000]
25-01-15 02:24:43 | I |         sum  error  = [    1.3363]
25-01-15 02:24:43 | I |         best error  = [    1.3363]
25-01-15 02:24:43 | I |     + error = [1.3363]
25-01-15 02:24:44 | I |       - range scale = [    1.0000]
25-01-15 02:24:44 | I |         sum  error  = [   15.4662]
25-01-15 02:24:44 | I |         best error  = [   15.4662]
25-01-15 02:24:44 | I |     + error = [15.4662]
25-01-15 02:24:44 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:24:45 | I |       - range scale = [    1.0000]
25-01-15 02:24:45 | I |         sum  error  = [    8.4926]
25-01-15 02:24:45 | I |         best error  = [    8.4926]
25-01-15 02:24:45 | I |     + error = [8.4926]
25-01-15 02:24:45 | I |       - range scale = [    1.0000]
25-01-15 02:24:45 | I |         sum  error  = [   46.5239]
25-01-15 02:24:45 | I |         best error  = [   46.5239]
25-01-15 02:24:45 | I |     + error = [46.5239]
25-01-15 02:24:45 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:24:47 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:24:48 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:24:50 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:24:51 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:24:52 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:24:54 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:24:57 | I | quantizing activations for layer model.layers.0
25-01-15 02:24:57 | I | collecting info in model.layers.0
25-01-15 02:24:57 | I | collecting info in model.layers.0
25-01-15 02:24:57 | I | collecting info in model.layers.0
25-01-15 02:24:57 | I | collecting info in model.layers.0
25-01-15 02:24:57 | I | collecting calibration activations in model.layers.0
25-01-15 02:24:57 | I | collecting calibration activations in model.layers.0
25-01-15 02:24:57 | I | collecting calibration activations in model.layers.0
25-01-15 02:24:58 | I | collecting calibration activations in model.layers.0
25-01-15 02:24:59 | I | forward this layer
25-01-15 02:24:59 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/09.pt
25-01-15 02:24:59 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/09.pt
25-01-15 02:24:59 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: True
25-01-15 02:24:59 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:24:59 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:24:59 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: True
25-01-15 02:24:59 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:24:59 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:25:00 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: True
25-01-15 02:25:00 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:25:00 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:25:00 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:25:00 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:25:00 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:25:00 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: True
25-01-15 02:25:00 | I | inf: first position tensor([1137,    5], device='cuda:0')
25-01-15 02:25:00 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:25:00 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: True
25-01-15 02:25:00 | I | inf: first position tensor([5007,  695], device='cuda:0')
25-01-15 02:25:00 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:25:00 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:25:00 | I | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 4.0
25-01-15 02:25:00 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:25:00 | I | in layer model.layers.0
25-01-15 02:25:00 | I | quantizing weights for layer model.layers.0
25-01-15 02:25:00 | I | collecting info in model.layers.0
25-01-15 02:25:00 | I | collecting info in model.layers.0
25-01-15 02:25:00 | I | collecting info in model.layers.0
25-01-15 02:25:00 | I | collecting info in model.layers.0
25-01-15 02:25:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:25:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:25:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:25:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:25:01 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:25:01 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:25:01 | I |       - range scale = [    1.0000]
25-01-15 02:25:01 | I |         sum  error  = [    0.0436]
25-01-15 02:25:01 | I |         best error  = [    0.0436]
25-01-15 02:25:01 | I |     + error = [0.0436]
25-01-15 02:25:02 | I |       - range scale = [    1.0000]
25-01-15 02:25:02 | I |         sum  error  = [    0.4827]
25-01-15 02:25:02 | I |         best error  = [    0.4827]
25-01-15 02:25:02 | I |     + error = [0.4827]
25-01-15 02:25:02 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:25:03 | I |       - range scale = [    1.0000]
25-01-15 02:25:03 | I |         sum  error  = [    0.0517]
25-01-15 02:25:03 | I |         best error  = [    0.0517]
25-01-15 02:25:03 | I |     + error = [0.0517]
25-01-15 02:25:04 | I |       - range scale = [    1.0000]
25-01-15 02:25:04 | I |         sum  error  = [    0.5797]
25-01-15 02:25:04 | I |         best error  = [    0.5797]
25-01-15 02:25:04 | I |     + error = [0.5797]
25-01-15 02:25:04 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:25:04 | I |       - range scale = [    1.0000]
25-01-15 02:25:04 | I |         sum  error  = [    0.0123]
25-01-15 02:25:04 | I |         best error  = [    0.0123]
25-01-15 02:25:04 | I |     + error = [0.0123]
25-01-15 02:25:05 | I |       - range scale = [    1.0000]
25-01-15 02:25:05 | I |         sum  error  = [    0.1418]
25-01-15 02:25:05 | I |         best error  = [    0.1418]
25-01-15 02:25:05 | I |     + error = [0.1418]
25-01-15 02:25:05 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:25:06 | I |       - range scale = [    1.0000]
25-01-15 02:25:06 | I |         sum  error  = [    0.0513]
25-01-15 02:25:06 | I |         best error  = [    0.0513]
25-01-15 02:25:06 | I |     + error = [0.0513]
25-01-15 02:25:06 | I |       - range scale = [    1.0000]
25-01-15 02:25:06 | I |         sum  error  = [    0.5235]
25-01-15 02:25:06 | I |         best error  = [    0.5235]
25-01-15 02:25:06 | I |     + error = [0.5235]
25-01-15 02:25:07 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:25:07 | I |       - range scale = [    1.0000]
25-01-15 02:25:07 | I |         sum  error  = [    0.3232]
25-01-15 02:25:07 | I |         best error  = [    0.3232]
25-01-15 02:25:07 | I |     + error = [0.3232]
25-01-15 02:25:08 | I |       - range scale = [    1.0000]
25-01-15 02:25:08 | I |         sum  error  = [    3.6879]
25-01-15 02:25:08 | I |         best error  = [    3.6879]
25-01-15 02:25:08 | I |     + error = [3.6879]
25-01-15 02:25:08 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:25:09 | I |       - range scale = [    1.0000]
25-01-15 02:25:09 | I |         sum  error  = [    1.3333]
25-01-15 02:25:09 | I |         best error  = [    1.3333]
25-01-15 02:25:09 | I |     + error = [1.3333]
25-01-15 02:25:10 | I |       - range scale = [    1.0000]
25-01-15 02:25:10 | I |         sum  error  = [   15.4229]
25-01-15 02:25:10 | I |         best error  = [   15.4229]
25-01-15 02:25:10 | I |     + error = [15.4229]
25-01-15 02:25:10 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:25:10 | I |       - range scale = [    1.0000]
25-01-15 02:25:10 | I |         sum  error  = [    6.4698]
25-01-15 02:25:10 | I |         best error  = [    6.4698]
25-01-15 02:25:10 | I |     + error = [6.4698]
25-01-15 02:25:11 | I |       - range scale = [    1.0000]
25-01-15 02:25:11 | I |         sum  error  = [   35.2856]
25-01-15 02:25:11 | I |         best error  = [   35.2856]
25-01-15 02:25:11 | I |     + error = [35.2856]
25-01-15 02:25:11 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:25:13 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:25:14 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:25:15 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:25:17 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:25:18 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:25:19 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:25:23 | I | quantizing activations for layer model.layers.0
25-01-15 02:25:23 | I | collecting info in model.layers.0
25-01-15 02:25:23 | I | collecting info in model.layers.0
25-01-15 02:25:23 | I | collecting info in model.layers.0
25-01-15 02:25:23 | I | collecting info in model.layers.0
25-01-15 02:25:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:25:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:25:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:25:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:25:25 | I | forward this layer
25-01-15 02:25:25 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/10.pt
25-01-15 02:25:25 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/10.pt
25-01-15 02:25:25 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: True
25-01-15 02:25:25 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:25:25 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:25:25 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: True
25-01-15 02:25:25 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:25:25 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:25:25 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: True
25-01-15 02:25:25 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:25:25 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:25:25 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:25:25 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:25:25 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:25:25 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: True
25-01-15 02:25:25 | I | inf: first position tensor([2029,   80], device='cuda:0')
25-01-15 02:25:25 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:25:25 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:25:25 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:25:25 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:25:26 | I | in layer model.layers.0
25-01-15 02:25:26 | I | quantizing weights for layer model.layers.0
25-01-15 02:25:26 | I | collecting info in model.layers.0
25-01-15 02:25:26 | I | collecting info in model.layers.0
25-01-15 02:25:26 | I | collecting info in model.layers.0
25-01-15 02:25:26 | I | collecting info in model.layers.0
25-01-15 02:25:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:25:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:25:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:25:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:25:27 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:25:27 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:25:27 | I |       - range scale = [    1.0000]
25-01-15 02:25:27 | I |         sum  error  = [    0.0439]
25-01-15 02:25:27 | I |         best error  = [    0.0439]
25-01-15 02:25:27 | I |     + error = [0.0439]
25-01-15 02:25:28 | I |       - range scale = [    1.0000]
25-01-15 02:25:28 | I |         sum  error  = [    0.4962]
25-01-15 02:25:28 | I |         best error  = [    0.4962]
25-01-15 02:25:28 | I |     + error = [0.4962]
25-01-15 02:25:28 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:25:29 | I |       - range scale = [    1.0000]
25-01-15 02:25:29 | I |         sum  error  = [    0.0552]
25-01-15 02:25:29 | I |         best error  = [    0.0552]
25-01-15 02:25:29 | I |     + error = [0.0552]
25-01-15 02:25:29 | I |       - range scale = [    1.0000]
25-01-15 02:25:29 | I |         sum  error  = [    0.5921]
25-01-15 02:25:29 | I |         best error  = [    0.5921]
25-01-15 02:25:29 | I |     + error = [0.5921]
25-01-15 02:25:30 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:25:30 | I |       - range scale = [    1.0000]
25-01-15 02:25:30 | I |         sum  error  = [    0.0122]
25-01-15 02:25:30 | I |         best error  = [    0.0122]
25-01-15 02:25:30 | I |     + error = [0.0122]
25-01-15 02:25:31 | I |       - range scale = [    1.0000]
25-01-15 02:25:31 | I |         sum  error  = [    0.1419]
25-01-15 02:25:31 | I |         best error  = [    0.1419]
25-01-15 02:25:31 | I |     + error = [0.1419]
25-01-15 02:25:31 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:25:32 | I |       - range scale = [    1.0000]
25-01-15 02:25:32 | I |         sum  error  = [    0.0522]
25-01-15 02:25:32 | I |         best error  = [    0.0522]
25-01-15 02:25:32 | I |     + error = [0.0522]
25-01-15 02:25:32 | I |       - range scale = [    1.0000]
25-01-15 02:25:32 | I |         sum  error  = [    0.5328]
25-01-15 02:25:32 | I |         best error  = [    0.5328]
25-01-15 02:25:32 | I |     + error = [0.5328]
25-01-15 02:25:33 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:25:33 | I |       - range scale = [    1.0000]
25-01-15 02:25:33 | I |         sum  error  = [    0.3231]
25-01-15 02:25:33 | I |         best error  = [    0.3231]
25-01-15 02:25:33 | I |     + error = [0.3231]
25-01-15 02:25:34 | I |       - range scale = [    1.0000]
25-01-15 02:25:34 | I |         sum  error  = [    3.6838]
25-01-15 02:25:34 | I |         best error  = [    3.6838]
25-01-15 02:25:34 | I |     + error = [3.6838]
25-01-15 02:25:34 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:25:35 | I |       - range scale = [    1.0000]
25-01-15 02:25:35 | I |         sum  error  = [    1.3313]
25-01-15 02:25:35 | I |         best error  = [    1.3313]
25-01-15 02:25:35 | I |     + error = [1.3313]
25-01-15 02:25:35 | I |       - range scale = [    1.0000]
25-01-15 02:25:35 | I |         sum  error  = [   15.4169]
25-01-15 02:25:35 | I |         best error  = [   15.4169]
25-01-15 02:25:35 | I |     + error = [15.4169]
25-01-15 02:25:36 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:25:36 | I |       - range scale = [    1.0000]
25-01-15 02:25:36 | I |         sum  error  = [    7.3912]
25-01-15 02:25:36 | I |         best error  = [    7.3912]
25-01-15 02:25:36 | I |     + error = [7.3912]
25-01-15 02:25:37 | I |       - range scale = [    1.0000]
25-01-15 02:25:37 | I |         sum  error  = [   40.8484]
25-01-15 02:25:37 | I |         best error  = [   40.8484]
25-01-15 02:25:37 | I |     + error = [40.8484]
25-01-15 02:25:37 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:25:39 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:25:40 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:25:41 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:25:43 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:25:44 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:25:45 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:25:48 | I | quantizing activations for layer model.layers.0
25-01-15 02:25:48 | I | collecting info in model.layers.0
25-01-15 02:25:48 | I | collecting info in model.layers.0
25-01-15 02:25:48 | I | collecting info in model.layers.0
25-01-15 02:25:48 | I | collecting info in model.layers.0
25-01-15 02:25:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:25:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:25:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:25:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:25:51 | I | forward this layer
25-01-15 02:25:51 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/11.pt
25-01-15 02:25:51 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/11.pt
25-01-15 02:25:51 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: True
25-01-15 02:25:51 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:25:51 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:25:51 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: True
25-01-15 02:25:51 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:25:51 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:25:51 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: True
25-01-15 02:25:51 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:25:51 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:25:51 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:25:51 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:25:51 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:25:51 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: True
25-01-15 02:25:51 | I | inf: first position tensor([5007,    0], device='cuda:0')
25-01-15 02:25:51 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:25:51 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:25:51 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:25:51 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:25:51 | I | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 2.0
25-01-15 02:25:51 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:25:51 | I | in layer model.layers.0
25-01-15 02:25:51 | I | quantizing weights for layer model.layers.0
25-01-15 02:25:51 | I | collecting info in model.layers.0
25-01-15 02:25:51 | I | collecting info in model.layers.0
25-01-15 02:25:51 | I | collecting info in model.layers.0
25-01-15 02:25:51 | I | collecting info in model.layers.0
25-01-15 02:25:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:25:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:25:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:25:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:25:52 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:25:52 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:25:53 | I |       - range scale = [    1.0000]
25-01-15 02:25:53 | I |         sum  error  = [    0.0438]
25-01-15 02:25:53 | I |         best error  = [    0.0438]
25-01-15 02:25:53 | I |     + error = [0.0438]
25-01-15 02:25:54 | I |       - range scale = [    1.0000]
25-01-15 02:25:54 | I |         sum  error  = [    0.4936]
25-01-15 02:25:54 | I |         best error  = [    0.4936]
25-01-15 02:25:54 | I |     + error = [0.4936]
25-01-15 02:25:54 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:25:55 | I |       - range scale = [    1.0000]
25-01-15 02:25:55 | I |         sum  error  = [    0.0544]
25-01-15 02:25:55 | I |         best error  = [    0.0544]
25-01-15 02:25:55 | I |     + error = [0.0544]
25-01-15 02:25:55 | I |       - range scale = [    1.0000]
25-01-15 02:25:55 | I |         sum  error  = [    0.5749]
25-01-15 02:25:55 | I |         best error  = [    0.5749]
25-01-15 02:25:55 | I |     + error = [0.5749]
25-01-15 02:25:56 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:25:56 | I |       - range scale = [    1.0000]
25-01-15 02:25:56 | I |         sum  error  = [    0.0123]
25-01-15 02:25:56 | I |         best error  = [    0.0123]
25-01-15 02:25:56 | I |     + error = [0.0123]
25-01-15 02:25:57 | I |       - range scale = [    1.0000]
25-01-15 02:25:57 | I |         sum  error  = [    0.1422]
25-01-15 02:25:57 | I |         best error  = [    0.1422]
25-01-15 02:25:57 | I |     + error = [0.1422]
25-01-15 02:25:57 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:25:58 | I |       - range scale = [    1.0000]
25-01-15 02:25:58 | I |         sum  error  = [    0.0558]
25-01-15 02:25:58 | I |         best error  = [    0.0558]
25-01-15 02:25:58 | I |     + error = [0.0558]
25-01-15 02:25:59 | I |       - range scale = [    1.0000]
25-01-15 02:25:59 | I |         sum  error  = [    0.5684]
25-01-15 02:25:59 | I |         best error  = [    0.5684]
25-01-15 02:25:59 | I |     + error = [0.5684]
25-01-15 02:25:59 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:25:59 | I |       - range scale = [    1.0000]
25-01-15 02:25:59 | I |         sum  error  = [    0.3227]
25-01-15 02:25:59 | I |         best error  = [    0.3227]
25-01-15 02:25:59 | I |     + error = [0.3227]
25-01-15 02:26:00 | I |       - range scale = [    1.0000]
25-01-15 02:26:00 | I |         sum  error  = [    3.6838]
25-01-15 02:26:00 | I |         best error  = [    3.6838]
25-01-15 02:26:00 | I |     + error = [3.6838]
25-01-15 02:26:00 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:26:01 | I |       - range scale = [    1.0000]
25-01-15 02:26:01 | I |         sum  error  = [    1.3310]
25-01-15 02:26:01 | I |         best error  = [    1.3310]
25-01-15 02:26:01 | I |     + error = [1.3310]
25-01-15 02:26:02 | I |       - range scale = [    1.0000]
25-01-15 02:26:02 | I |         sum  error  = [   15.4113]
25-01-15 02:26:02 | I |         best error  = [   15.4113]
25-01-15 02:26:02 | I |     + error = [15.4113]
25-01-15 02:26:02 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:26:03 | I |       - range scale = [    1.0000]
25-01-15 02:26:03 | I |         sum  error  = [    6.4598]
25-01-15 02:26:03 | I |         best error  = [    6.4598]
25-01-15 02:26:03 | I |     + error = [6.4598]
25-01-15 02:26:03 | I |       - range scale = [    1.0000]
25-01-15 02:26:03 | I |         sum  error  = [   36.0535]
25-01-15 02:26:03 | I |         best error  = [   36.0535]
25-01-15 02:26:03 | I |     + error = [36.0535]
25-01-15 02:26:04 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:26:05 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:26:06 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:26:08 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:26:09 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:26:11 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:26:12 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:26:15 | I | quantizing activations for layer model.layers.0
25-01-15 02:26:15 | I | collecting info in model.layers.0
25-01-15 02:26:15 | I | collecting info in model.layers.0
25-01-15 02:26:15 | I | collecting info in model.layers.0
25-01-15 02:26:15 | I | collecting info in model.layers.0
25-01-15 02:26:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:26:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:26:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:26:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:26:18 | I | forward this layer
25-01-15 02:26:18 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/12.pt
25-01-15 02:26:18 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/12.pt
25-01-15 02:26:18 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: True
25-01-15 02:26:18 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:26:18 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:26:18 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: True
25-01-15 02:26:18 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:26:18 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:26:18 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: True
25-01-15 02:26:18 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:26:18 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:26:18 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:26:18 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:26:18 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:26:18 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: True
25-01-15 02:26:18 | I | inf: first position tensor([5007,    5], device='cuda:0')
25-01-15 02:26:18 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:26:18 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:26:18 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:26:18 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:26:18 | I | in layer model.layers.0
25-01-15 02:26:18 | I | quantizing weights for layer model.layers.0
25-01-15 02:26:18 | I | collecting info in model.layers.0
25-01-15 02:26:18 | I | collecting info in model.layers.0
25-01-15 02:26:18 | I | collecting info in model.layers.0
25-01-15 02:26:18 | I | collecting info in model.layers.0
25-01-15 02:26:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:26:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:26:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:26:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:26:19 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:26:19 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:26:20 | I |       - range scale = [    1.0000]
25-01-15 02:26:20 | I |         sum  error  = [    0.0443]
25-01-15 02:26:20 | I |         best error  = [    0.0443]
25-01-15 02:26:20 | I |     + error = [0.0443]
25-01-15 02:26:20 | I |       - range scale = [    1.0000]
25-01-15 02:26:20 | I |         sum  error  = [    0.4993]
25-01-15 02:26:20 | I |         best error  = [    0.4993]
25-01-15 02:26:20 | I |     + error = [0.4993]
25-01-15 02:26:21 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:26:21 | I |       - range scale = [    1.0000]
25-01-15 02:26:21 | I |         sum  error  = [    0.0555]
25-01-15 02:26:21 | I |         best error  = [    0.0555]
25-01-15 02:26:21 | I |     + error = [0.0555]
25-01-15 02:26:22 | I |       - range scale = [    1.0000]
25-01-15 02:26:22 | I |         sum  error  = [    0.5935]
25-01-15 02:26:22 | I |         best error  = [    0.5935]
25-01-15 02:26:22 | I |     + error = [0.5935]
25-01-15 02:26:22 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:26:23 | I |       - range scale = [    1.0000]
25-01-15 02:26:23 | I |         sum  error  = [    0.0123]
25-01-15 02:26:23 | I |         best error  = [    0.0123]
25-01-15 02:26:23 | I |     + error = [0.0123]
25-01-15 02:26:23 | I |       - range scale = [    1.0000]
25-01-15 02:26:23 | I |         sum  error  = [    0.1420]
25-01-15 02:26:23 | I |         best error  = [    0.1420]
25-01-15 02:26:23 | I |     + error = [0.1420]
25-01-15 02:26:24 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:26:24 | I |       - range scale = [    1.0000]
25-01-15 02:26:24 | I |         sum  error  = [    0.0531]
25-01-15 02:26:24 | I |         best error  = [    0.0531]
25-01-15 02:26:24 | I |     + error = [0.0531]
25-01-15 02:26:25 | I |       - range scale = [    1.0000]
25-01-15 02:26:25 | I |         sum  error  = [    0.5387]
25-01-15 02:26:25 | I |         best error  = [    0.5387]
25-01-15 02:26:25 | I |     + error = [0.5387]
25-01-15 02:26:25 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:26:26 | I |       - range scale = [    1.0000]
25-01-15 02:26:26 | I |         sum  error  = [    0.3230]
25-01-15 02:26:26 | I |         best error  = [    0.3230]
25-01-15 02:26:26 | I |     + error = [0.3230]
25-01-15 02:26:26 | I |       - range scale = [    1.0000]
25-01-15 02:26:26 | I |         sum  error  = [    3.6842]
25-01-15 02:26:26 | I |         best error  = [    3.6842]
25-01-15 02:26:26 | I |     + error = [3.6842]
25-01-15 02:26:27 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:26:27 | I |       - range scale = [    1.0000]
25-01-15 02:26:27 | I |         sum  error  = [    1.3324]
25-01-15 02:26:27 | I |         best error  = [    1.3324]
25-01-15 02:26:27 | I |     + error = [1.3324]
25-01-15 02:26:28 | I |       - range scale = [    1.0000]
25-01-15 02:26:28 | I |         sum  error  = [   15.4143]
25-01-15 02:26:28 | I |         best error  = [   15.4143]
25-01-15 02:26:28 | I |     + error = [15.4143]
25-01-15 02:26:28 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:26:29 | I |       - range scale = [    1.0000]
25-01-15 02:26:29 | I |         sum  error  = [    7.3505]
25-01-15 02:26:29 | I |         best error  = [    7.3505]
25-01-15 02:26:29 | I |     + error = [7.3505]
25-01-15 02:26:30 | I |       - range scale = [    1.0000]
25-01-15 02:26:30 | I |         sum  error  = [   40.3184]
25-01-15 02:26:30 | I |         best error  = [   40.3184]
25-01-15 02:26:30 | I |     + error = [40.3184]
25-01-15 02:26:30 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:26:31 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:26:33 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:26:34 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:26:35 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:26:37 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:26:38 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:26:41 | I | quantizing activations for layer model.layers.0
25-01-15 02:26:41 | I | collecting info in model.layers.0
25-01-15 02:26:41 | I | collecting info in model.layers.0
25-01-15 02:26:41 | I | collecting info in model.layers.0
25-01-15 02:26:41 | I | collecting info in model.layers.0
25-01-15 02:26:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:26:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:26:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:26:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:26:44 | I | forward this layer
25-01-15 02:26:44 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/13.pt
25-01-15 02:26:44 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/13.pt
25-01-15 02:26:44 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: True
25-01-15 02:26:44 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:26:44 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:26:44 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: True
25-01-15 02:26:44 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:26:44 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:26:44 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: True
25-01-15 02:26:44 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:26:44 | I | nan: first position tensor([0, 0], device='cuda:0')
25-01-15 02:26:44 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:26:44 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:26:44 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:26:44 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: True
25-01-15 02:26:44 | I | inf: first position tensor([5007,    5], device='cuda:0')
25-01-15 02:26:44 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:26:44 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:26:44 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:26:44 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:26:44 | I | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 1.0
25-01-15 02:26:44 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:26:44 | I | in layer model.layers.0
25-01-15 02:26:44 | I | quantizing weights for layer model.layers.0
25-01-15 02:26:44 | I | collecting info in model.layers.0
25-01-15 02:26:44 | I | collecting info in model.layers.0
25-01-15 02:26:44 | I | collecting info in model.layers.0
25-01-15 02:26:44 | I | collecting info in model.layers.0
25-01-15 02:26:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:26:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:26:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:26:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:26:45 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:26:45 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:26:46 | I |       - range scale = [    1.0000]
25-01-15 02:26:46 | I |         sum  error  = [    0.0440]
25-01-15 02:26:46 | I |         best error  = [    0.0440]
25-01-15 02:26:46 | I |     + error = [0.0440]
25-01-15 02:26:47 | I |       - range scale = [    1.0000]
25-01-15 02:26:47 | I |         sum  error  = [    0.4961]
25-01-15 02:26:47 | I |         best error  = [    0.4961]
25-01-15 02:26:47 | I |     + error = [0.4961]
25-01-15 02:26:47 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:26:47 | I |       - range scale = [    1.0000]
25-01-15 02:26:47 | I |         sum  error  = [    0.0560]
25-01-15 02:26:47 | I |         best error  = [    0.0560]
25-01-15 02:26:47 | I |     + error = [0.0560]
25-01-15 02:26:48 | I |       - range scale = [    1.0000]
25-01-15 02:26:48 | I |         sum  error  = [    0.6014]
25-01-15 02:26:48 | I |         best error  = [    0.6014]
25-01-15 02:26:48 | I |     + error = [0.6014]
25-01-15 02:26:48 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:26:49 | I |       - range scale = [    1.0000]
25-01-15 02:26:49 | I |         sum  error  = [    0.0123]
25-01-15 02:26:49 | I |         best error  = [    0.0123]
25-01-15 02:26:49 | I |     + error = [0.0123]
25-01-15 02:26:49 | I |       - range scale = [    1.0000]
25-01-15 02:26:49 | I |         sum  error  = [    0.1422]
25-01-15 02:26:49 | I |         best error  = [    0.1422]
25-01-15 02:26:49 | I |     + error = [0.1422]
25-01-15 02:26:50 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:26:50 | I |       - range scale = [    1.0000]
25-01-15 02:26:50 | I |         sum  error  = [    0.0545]
25-01-15 02:26:50 | I |         best error  = [    0.0545]
25-01-15 02:26:50 | I |     + error = [0.0545]
25-01-15 02:26:51 | I |       - range scale = [    1.0000]
25-01-15 02:26:51 | I |         sum  error  = [    0.5537]
25-01-15 02:26:51 | I |         best error  = [    0.5537]
25-01-15 02:26:51 | I |     + error = [0.5537]
25-01-15 02:26:51 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:26:52 | I |       - range scale = [    1.0000]
25-01-15 02:26:52 | I |         sum  error  = [    0.3232]
25-01-15 02:26:52 | I |         best error  = [    0.3232]
25-01-15 02:26:52 | I |     + error = [0.3232]
25-01-15 02:26:52 | I |       - range scale = [    1.0000]
25-01-15 02:26:52 | I |         sum  error  = [    3.6851]
25-01-15 02:26:52 | I |         best error  = [    3.6851]
25-01-15 02:26:52 | I |     + error = [3.6851]
25-01-15 02:26:53 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:26:53 | I |       - range scale = [    1.0000]
25-01-15 02:26:53 | I |         sum  error  = [    1.3322]
25-01-15 02:26:53 | I |         best error  = [    1.3322]
25-01-15 02:26:53 | I |     + error = [1.3322]
25-01-15 02:26:54 | I |       - range scale = [    1.0000]
25-01-15 02:26:54 | I |         sum  error  = [   15.4139]
25-01-15 02:26:54 | I |         best error  = [   15.4139]
25-01-15 02:26:54 | I |     + error = [15.4139]
25-01-15 02:26:54 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:26:55 | I |       - range scale = [    1.0000]
25-01-15 02:26:55 | I |         sum  error  = [    8.0362]
25-01-15 02:26:55 | I |         best error  = [    8.0362]
25-01-15 02:26:55 | I |     + error = [8.0362]
25-01-15 02:26:56 | I |       - range scale = [    1.0000]
25-01-15 02:26:56 | I |         sum  error  = [   44.2729]
25-01-15 02:26:56 | I |         best error  = [   44.2729]
25-01-15 02:26:56 | I |     + error = [44.2729]
25-01-15 02:26:56 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:26:57 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:26:58 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:27:00 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:27:01 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:27:02 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:27:04 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:27:07 | I | quantizing activations for layer model.layers.0
25-01-15 02:27:07 | I | collecting info in model.layers.0
25-01-15 02:27:07 | I | collecting info in model.layers.0
25-01-15 02:27:07 | I | collecting info in model.layers.0
25-01-15 02:27:07 | I | collecting info in model.layers.0
25-01-15 02:27:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:27:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:27:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:27:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:27:10 | I | forward this layer
25-01-15 02:27:10 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/14.pt
25-01-15 02:27:10 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/14.pt
25-01-15 02:27:10 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:27:10 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:27:10 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:27:10 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:27:10 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:27:10 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: True
25-01-15 02:27:10 | I | inf: first position tensor([21,  0], device='cuda:0')
25-01-15 02:27:10 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:27:10 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:27:10 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:27:10 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: True
25-01-15 02:27:10 | I | inf: first position tensor([5007,    5], device='cuda:0')
25-01-15 02:27:10 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:27:10 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:27:10 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:27:10 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:27:10 | I | in layer model.layers.0
25-01-15 02:27:10 | I | quantizing weights for layer model.layers.0
25-01-15 02:27:10 | I | collecting info in model.layers.0
25-01-15 02:27:10 | I | collecting info in model.layers.0
25-01-15 02:27:10 | I | collecting info in model.layers.0
25-01-15 02:27:10 | I | collecting info in model.layers.0
25-01-15 02:27:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:27:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:27:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:27:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:27:11 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:27:11 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:27:12 | I |       - range scale = [    1.0000]
25-01-15 02:27:12 | I |         sum  error  = [    0.0448]
25-01-15 02:27:12 | I |         best error  = [    0.0448]
25-01-15 02:27:12 | I |     + error = [0.0448]
25-01-15 02:27:12 | I |       - range scale = [    1.0000]
25-01-15 02:27:12 | I |         sum  error  = [    0.5112]
25-01-15 02:27:12 | I |         best error  = [    0.5112]
25-01-15 02:27:12 | I |     + error = [0.5112]
25-01-15 02:27:12 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:27:13 | I |       - range scale = [    1.0000]
25-01-15 02:27:13 | I |         sum  error  = [    0.0561]
25-01-15 02:27:13 | I |         best error  = [    0.0561]
25-01-15 02:27:13 | I |     + error = [0.0561]
25-01-15 02:27:14 | I |       - range scale = [    1.0000]
25-01-15 02:27:14 | I |         sum  error  = [    0.6092]
25-01-15 02:27:14 | I |         best error  = [    0.6092]
25-01-15 02:27:14 | I |     + error = [0.6092]
25-01-15 02:27:14 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:27:15 | I |       - range scale = [    1.0000]
25-01-15 02:27:15 | I |         sum  error  = [    0.0123]
25-01-15 02:27:15 | I |         best error  = [    0.0123]
25-01-15 02:27:15 | I |     + error = [0.0123]
25-01-15 02:27:15 | I |       - range scale = [    1.0000]
25-01-15 02:27:15 | I |         sum  error  = [    0.1424]
25-01-15 02:27:15 | I |         best error  = [    0.1424]
25-01-15 02:27:15 | I |     + error = [0.1424]
25-01-15 02:27:16 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:27:16 | I |       - range scale = [    1.0000]
25-01-15 02:27:16 | I |         sum  error  = [    0.0566]
25-01-15 02:27:16 | I |         best error  = [    0.0566]
25-01-15 02:27:16 | I |     + error = [0.0566]
25-01-15 02:27:17 | I |       - range scale = [    1.0000]
25-01-15 02:27:17 | I |         sum  error  = [    0.5768]
25-01-15 02:27:17 | I |         best error  = [    0.5768]
25-01-15 02:27:17 | I |     + error = [0.5768]
25-01-15 02:27:17 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:27:18 | I |       - range scale = [    1.0000]
25-01-15 02:27:18 | I |         sum  error  = [    0.3232]
25-01-15 02:27:18 | I |         best error  = [    0.3232]
25-01-15 02:27:18 | I |     + error = [0.3232]
25-01-15 02:27:19 | I |       - range scale = [    1.0000]
25-01-15 02:27:19 | I |         sum  error  = [    3.6896]
25-01-15 02:27:19 | I |         best error  = [    3.6896]
25-01-15 02:27:19 | I |     + error = [3.6896]
25-01-15 02:27:19 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:27:19 | I |       - range scale = [    1.0000]
25-01-15 02:27:19 | I |         sum  error  = [    1.3331]
25-01-15 02:27:19 | I |         best error  = [    1.3331]
25-01-15 02:27:19 | I |     + error = [1.3331]
25-01-15 02:27:20 | I |       - range scale = [    1.0000]
25-01-15 02:27:20 | I |         sum  error  = [   15.4335]
25-01-15 02:27:20 | I |         best error  = [   15.4335]
25-01-15 02:27:20 | I |     + error = [15.4335]
25-01-15 02:27:20 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:27:21 | I |       - range scale = [    1.0000]
25-01-15 02:27:21 | I |         sum  error  = [    7.3756]
25-01-15 02:27:21 | I |         best error  = [    7.3756]
25-01-15 02:27:21 | I |     + error = [7.3756]
25-01-15 02:27:22 | I |       - range scale = [    1.0000]
25-01-15 02:27:22 | I |         sum  error  = [   41.5370]
25-01-15 02:27:22 | I |         best error  = [   41.5370]
25-01-15 02:27:22 | I |     + error = [41.5370]
25-01-15 02:27:22 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:27:23 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:27:25 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:27:26 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:27:27 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:27:29 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:27:30 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:27:33 | I | quantizing activations for layer model.layers.0
25-01-15 02:27:33 | I | collecting info in model.layers.0
25-01-15 02:27:33 | I | collecting info in model.layers.0
25-01-15 02:27:33 | I | collecting info in model.layers.0
25-01-15 02:27:33 | I | collecting info in model.layers.0
25-01-15 02:27:34 | I | collecting calibration activations in model.layers.0
25-01-15 02:27:34 | I | collecting calibration activations in model.layers.0
25-01-15 02:27:34 | I | collecting calibration activations in model.layers.0
25-01-15 02:27:34 | I | collecting calibration activations in model.layers.0
25-01-15 02:27:36 | I | forward this layer
25-01-15 02:27:36 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/15.pt
25-01-15 02:27:36 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/15.pt
25-01-15 02:27:36 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:27:36 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:27:36 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:27:36 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:27:36 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:27:36 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: True
25-01-15 02:27:36 | I | inf: first position tensor([21,  2], device='cuda:0')
25-01-15 02:27:36 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:27:36 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:27:36 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:27:36 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: True
25-01-15 02:27:36 | I | inf: first position tensor([5007,   72], device='cuda:0')
25-01-15 02:27:36 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:27:36 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:27:36 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:27:36 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:27:36 | I | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.5
25-01-15 02:27:36 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:27:36 | I | in layer model.layers.0
25-01-15 02:27:36 | I | quantizing weights for layer model.layers.0
25-01-15 02:27:36 | I | collecting info in model.layers.0
25-01-15 02:27:36 | I | collecting info in model.layers.0
25-01-15 02:27:36 | I | collecting info in model.layers.0
25-01-15 02:27:36 | I | collecting info in model.layers.0
25-01-15 02:27:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:27:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:27:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:27:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:27:37 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:27:37 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:27:38 | I |       - range scale = [    1.0000]
25-01-15 02:27:38 | I |         sum  error  = [    0.0441]
25-01-15 02:27:38 | I |         best error  = [    0.0441]
25-01-15 02:27:38 | I |     + error = [0.0441]
25-01-15 02:27:39 | I |       - range scale = [    1.0000]
25-01-15 02:27:39 | I |         sum  error  = [    0.4982]
25-01-15 02:27:39 | I |         best error  = [    0.4982]
25-01-15 02:27:39 | I |     + error = [0.4982]
25-01-15 02:27:39 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:27:39 | I |       - range scale = [    1.0000]
25-01-15 02:27:39 | I |         sum  error  = [    0.0551]
25-01-15 02:27:39 | I |         best error  = [    0.0551]
25-01-15 02:27:39 | I |     + error = [0.0551]
25-01-15 02:27:40 | I |       - range scale = [    1.0000]
25-01-15 02:27:40 | I |         sum  error  = [    0.5881]
25-01-15 02:27:40 | I |         best error  = [    0.5881]
25-01-15 02:27:40 | I |     + error = [0.5881]
25-01-15 02:27:40 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:27:41 | I |       - range scale = [    1.0000]
25-01-15 02:27:41 | I |         sum  error  = [    0.0123]
25-01-15 02:27:41 | I |         best error  = [    0.0123]
25-01-15 02:27:41 | I |     + error = [0.0123]
25-01-15 02:27:42 | I |       - range scale = [    1.0000]
25-01-15 02:27:42 | I |         sum  error  = [    0.1420]
25-01-15 02:27:42 | I |         best error  = [    0.1420]
25-01-15 02:27:42 | I |     + error = [0.1420]
25-01-15 02:27:42 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:27:42 | I |       - range scale = [    1.0000]
25-01-15 02:27:42 | I |         sum  error  = [    0.0552]
25-01-15 02:27:42 | I |         best error  = [    0.0552]
25-01-15 02:27:42 | I |     + error = [0.0552]
25-01-15 02:27:43 | I |       - range scale = [    1.0000]
25-01-15 02:27:43 | I |         sum  error  = [    0.5596]
25-01-15 02:27:43 | I |         best error  = [    0.5596]
25-01-15 02:27:43 | I |     + error = [0.5596]
25-01-15 02:27:43 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:27:44 | I |       - range scale = [    1.0000]
25-01-15 02:27:44 | I |         sum  error  = [    0.3231]
25-01-15 02:27:44 | I |         best error  = [    0.3231]
25-01-15 02:27:44 | I |     + error = [0.3231]
25-01-15 02:27:45 | I |       - range scale = [    1.0000]
25-01-15 02:27:45 | I |         sum  error  = [    3.6824]
25-01-15 02:27:45 | I |         best error  = [    3.6824]
25-01-15 02:27:45 | I |     + error = [3.6824]
25-01-15 02:27:45 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:27:46 | I |       - range scale = [    1.0000]
25-01-15 02:27:46 | I |         sum  error  = [    1.3309]
25-01-15 02:27:46 | I |         best error  = [    1.3309]
25-01-15 02:27:46 | I |     + error = [1.3309]
25-01-15 02:27:46 | I |       - range scale = [    1.0000]
25-01-15 02:27:46 | I |         sum  error  = [   15.4052]
25-01-15 02:27:46 | I |         best error  = [   15.4052]
25-01-15 02:27:46 | I |     + error = [15.4052]
25-01-15 02:27:46 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:27:47 | I |       - range scale = [    1.0000]
25-01-15 02:27:47 | I |         sum  error  = [    7.6607]
25-01-15 02:27:47 | I |         best error  = [    7.6607]
25-01-15 02:27:47 | I |     + error = [7.6607]
25-01-15 02:27:48 | I |       - range scale = [    1.0000]
25-01-15 02:27:48 | I |         sum  error  = [   42.6853]
25-01-15 02:27:48 | I |         best error  = [   42.6853]
25-01-15 02:27:48 | I |     + error = [42.6853]
25-01-15 02:27:48 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:27:49 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:27:51 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:27:52 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:27:54 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:27:55 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:27:56 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:28:00 | I | quantizing activations for layer model.layers.0
25-01-15 02:28:00 | I | collecting info in model.layers.0
25-01-15 02:28:00 | I | collecting info in model.layers.0
25-01-15 02:28:00 | I | collecting info in model.layers.0
25-01-15 02:28:00 | I | collecting info in model.layers.0
25-01-15 02:28:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:02 | I | forward this layer
25-01-15 02:28:02 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/16.pt
25-01-15 02:28:02 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/16.pt
25-01-15 02:28:02 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:28:02 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:28:02 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:28:02 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:28:02 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:28:02 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: True
25-01-15 02:28:02 | I | inf: first position tensor([21,  0], device='cuda:0')
25-01-15 02:28:02 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:28:02 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:28:02 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:28:02 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: True
25-01-15 02:28:02 | I | inf: first position tensor([5007,  352], device='cuda:0')
25-01-15 02:28:02 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:28:02 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:28:02 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:28:02 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:28:02 | I | in layer model.layers.0
25-01-15 02:28:02 | I | quantizing weights for layer model.layers.0
25-01-15 02:28:02 | I | collecting info in model.layers.0
25-01-15 02:28:02 | I | collecting info in model.layers.0
25-01-15 02:28:02 | I | collecting info in model.layers.0
25-01-15 02:28:02 | I | collecting info in model.layers.0
25-01-15 02:28:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:03 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:28:03 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:28:04 | I |       - range scale = [    1.0000]
25-01-15 02:28:04 | I |         sum  error  = [    0.0447]
25-01-15 02:28:04 | I |         best error  = [    0.0447]
25-01-15 02:28:04 | I |     + error = [0.0447]
25-01-15 02:28:05 | I |       - range scale = [    1.0000]
25-01-15 02:28:05 | I |         sum  error  = [    0.4944]
25-01-15 02:28:05 | I |         best error  = [    0.4944]
25-01-15 02:28:05 | I |     + error = [0.4944]
25-01-15 02:28:05 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:28:06 | I |       - range scale = [    1.0000]
25-01-15 02:28:06 | I |         sum  error  = [    0.0551]
25-01-15 02:28:06 | I |         best error  = [    0.0551]
25-01-15 02:28:06 | I |     + error = [0.0551]
25-01-15 02:28:06 | I |       - range scale = [    1.0000]
25-01-15 02:28:06 | I |         sum  error  = [    0.6091]
25-01-15 02:28:06 | I |         best error  = [    0.6091]
25-01-15 02:28:06 | I |     + error = [0.6091]
25-01-15 02:28:06 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:28:07 | I |       - range scale = [    1.0000]
25-01-15 02:28:07 | I |         sum  error  = [    0.0123]
25-01-15 02:28:07 | I |         best error  = [    0.0123]
25-01-15 02:28:07 | I |     + error = [0.0123]
25-01-15 02:28:08 | I |       - range scale = [    1.0000]
25-01-15 02:28:08 | I |         sum  error  = [    0.1423]
25-01-15 02:28:08 | I |         best error  = [    0.1423]
25-01-15 02:28:08 | I |     + error = [0.1423]
25-01-15 02:28:08 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:28:09 | I |       - range scale = [    1.0000]
25-01-15 02:28:09 | I |         sum  error  = [    0.0535]
25-01-15 02:28:09 | I |         best error  = [    0.0535]
25-01-15 02:28:09 | I |     + error = [0.0535]
25-01-15 02:28:09 | I |       - range scale = [    1.0000]
25-01-15 02:28:09 | I |         sum  error  = [    0.5457]
25-01-15 02:28:09 | I |         best error  = [    0.5457]
25-01-15 02:28:09 | I |     + error = [0.5457]
25-01-15 02:28:09 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:28:10 | I |       - range scale = [    1.0000]
25-01-15 02:28:10 | I |         sum  error  = [    0.3235]
25-01-15 02:28:10 | I |         best error  = [    0.3235]
25-01-15 02:28:10 | I |     + error = [0.3235]
25-01-15 02:28:11 | I |       - range scale = [    1.0000]
25-01-15 02:28:11 | I |         sum  error  = [    3.6954]
25-01-15 02:28:11 | I |         best error  = [    3.6954]
25-01-15 02:28:11 | I |     + error = [3.6954]
25-01-15 02:28:11 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:28:12 | I |       - range scale = [    1.0000]
25-01-15 02:28:12 | I |         sum  error  = [    1.3362]
25-01-15 02:28:12 | I |         best error  = [    1.3362]
25-01-15 02:28:12 | I |     + error = [1.3362]
25-01-15 02:28:12 | I |       - range scale = [    1.0000]
25-01-15 02:28:12 | I |         sum  error  = [   15.4528]
25-01-15 02:28:12 | I |         best error  = [   15.4528]
25-01-15 02:28:12 | I |     + error = [15.4528]
25-01-15 02:28:13 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:28:13 | I |       - range scale = [    1.0000]
25-01-15 02:28:13 | I |         sum  error  = [    6.9810]
25-01-15 02:28:13 | I |         best error  = [    6.9810]
25-01-15 02:28:13 | I |     + error = [6.9810]
25-01-15 02:28:14 | I |       - range scale = [    1.0000]
25-01-15 02:28:14 | I |         sum  error  = [   36.7199]
25-01-15 02:28:14 | I |         best error  = [   36.7199]
25-01-15 02:28:14 | I |     + error = [36.7199]
25-01-15 02:28:14 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:28:16 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:28:17 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:28:18 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:28:20 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:28:21 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:28:22 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:28:25 | I | quantizing activations for layer model.layers.0
25-01-15 02:28:25 | I | collecting info in model.layers.0
25-01-15 02:28:25 | I | collecting info in model.layers.0
25-01-15 02:28:25 | I | collecting info in model.layers.0
25-01-15 02:28:25 | I | collecting info in model.layers.0
25-01-15 02:28:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:28 | I | forward this layer
25-01-15 02:28:28 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/17.pt
25-01-15 02:28:28 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/17.pt
25-01-15 02:28:28 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:28:28 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:28:28 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:28:28 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:28:28 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:28:28 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: True
25-01-15 02:28:28 | I | inf: first position tensor([21,  1], device='cuda:0')
25-01-15 02:28:28 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:28:28 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:28:28 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:28:28 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: True
25-01-15 02:28:28 | I | inf: first position tensor([5007,  695], device='cuda:0')
25-01-15 02:28:28 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:28:28 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:28:28 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:28:28 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:28:28 | I | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.25
25-01-15 02:28:28 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:28:28 | I | in layer model.layers.0
25-01-15 02:28:28 | I | quantizing weights for layer model.layers.0
25-01-15 02:28:28 | I | collecting info in model.layers.0
25-01-15 02:28:28 | I | collecting info in model.layers.0
25-01-15 02:28:28 | I | collecting info in model.layers.0
25-01-15 02:28:28 | I | collecting info in model.layers.0
25-01-15 02:28:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:29 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:28:29 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:28:30 | I |       - range scale = [    1.0000]
25-01-15 02:28:30 | I |         sum  error  = [    0.0432]
25-01-15 02:28:30 | I |         best error  = [    0.0432]
25-01-15 02:28:30 | I |     + error = [0.0432]
25-01-15 02:28:31 | I |       - range scale = [    1.0000]
25-01-15 02:28:31 | I |         sum  error  = [    0.4831]
25-01-15 02:28:31 | I |         best error  = [    0.4831]
25-01-15 02:28:31 | I |     + error = [0.4831]
25-01-15 02:28:31 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:28:32 | I |       - range scale = [    1.0000]
25-01-15 02:28:32 | I |         sum  error  = [    0.0516]
25-01-15 02:28:32 | I |         best error  = [    0.0516]
25-01-15 02:28:32 | I |     + error = [0.0516]
25-01-15 02:28:32 | I |       - range scale = [    1.0000]
25-01-15 02:28:32 | I |         sum  error  = [    0.5405]
25-01-15 02:28:32 | I |         best error  = [    0.5405]
25-01-15 02:28:32 | I |     + error = [0.5405]
25-01-15 02:28:33 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:28:33 | I |       - range scale = [    1.0000]
25-01-15 02:28:33 | I |         sum  error  = [    0.0122]
25-01-15 02:28:33 | I |         best error  = [    0.0122]
25-01-15 02:28:33 | I |     + error = [0.0122]
25-01-15 02:28:34 | I |       - range scale = [    1.0000]
25-01-15 02:28:34 | I |         sum  error  = [    0.1409]
25-01-15 02:28:34 | I |         best error  = [    0.1409]
25-01-15 02:28:34 | I |     + error = [0.1409]
25-01-15 02:28:34 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:28:35 | I |       - range scale = [    1.0000]
25-01-15 02:28:35 | I |         sum  error  = [    0.0554]
25-01-15 02:28:35 | I |         best error  = [    0.0554]
25-01-15 02:28:35 | I |     + error = [0.0554]
25-01-15 02:28:35 | I |       - range scale = [    1.0000]
25-01-15 02:28:35 | I |         sum  error  = [    0.5625]
25-01-15 02:28:35 | I |         best error  = [    0.5625]
25-01-15 02:28:35 | I |     + error = [0.5625]
25-01-15 02:28:36 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:28:36 | I |       - range scale = [    1.0000]
25-01-15 02:28:36 | I |         sum  error  = [    0.3239]
25-01-15 02:28:36 | I |         best error  = [    0.3239]
25-01-15 02:28:36 | I |     + error = [0.3239]
25-01-15 02:28:37 | I |       - range scale = [    1.0000]
25-01-15 02:28:37 | I |         sum  error  = [    3.6827]
25-01-15 02:28:37 | I |         best error  = [    3.6827]
25-01-15 02:28:37 | I |     + error = [3.6827]
25-01-15 02:28:37 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:28:38 | I |       - range scale = [    1.0000]
25-01-15 02:28:38 | I |         sum  error  = [    1.3291]
25-01-15 02:28:38 | I |         best error  = [    1.3291]
25-01-15 02:28:38 | I |     + error = [1.3291]
25-01-15 02:28:38 | I |       - range scale = [    1.0000]
25-01-15 02:28:38 | I |         sum  error  = [   15.4050]
25-01-15 02:28:38 | I |         best error  = [   15.4050]
25-01-15 02:28:38 | I |     + error = [15.4050]
25-01-15 02:28:39 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:28:39 | I |       - range scale = [    1.0000]
25-01-15 02:28:39 | I |         sum  error  = [    6.8636]
25-01-15 02:28:39 | I |         best error  = [    6.8636]
25-01-15 02:28:39 | I |     + error = [6.8636]
25-01-15 02:28:40 | I |       - range scale = [    1.0000]
25-01-15 02:28:40 | I |         sum  error  = [   38.0371]
25-01-15 02:28:40 | I |         best error  = [   38.0371]
25-01-15 02:28:40 | I |     + error = [38.0371]
25-01-15 02:28:40 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:28:42 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:28:43 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:28:44 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:28:46 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:28:47 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:28:48 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:28:52 | I | quantizing activations for layer model.layers.0
25-01-15 02:28:52 | I | collecting info in model.layers.0
25-01-15 02:28:52 | I | collecting info in model.layers.0
25-01-15 02:28:52 | I | collecting info in model.layers.0
25-01-15 02:28:52 | I | collecting info in model.layers.0
25-01-15 02:28:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:54 | I | forward this layer
25-01-15 02:28:54 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/18.pt
25-01-15 02:28:54 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/18.pt
25-01-15 02:28:54 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:28:54 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:28:54 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:28:54 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:28:54 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:28:54 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: True
25-01-15 02:28:54 | I | inf: first position tensor([ 21, 454], device='cuda:0')
25-01-15 02:28:54 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:28:54 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:28:54 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:28:54 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:28:54 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:28:54 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:28:54 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:28:54 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:28:54 | I | in layer model.layers.0
25-01-15 02:28:54 | I | quantizing weights for layer model.layers.0
25-01-15 02:28:54 | I | collecting info in model.layers.0
25-01-15 02:28:54 | I | collecting info in model.layers.0
25-01-15 02:28:54 | I | collecting info in model.layers.0
25-01-15 02:28:54 | I | collecting info in model.layers.0
25-01-15 02:28:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:28:55 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:28:55 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:28:56 | I |       - range scale = [    1.0000]
25-01-15 02:28:56 | I |         sum  error  = [    0.0444]
25-01-15 02:28:56 | I |         best error  = [    0.0444]
25-01-15 02:28:56 | I |     + error = [0.0444]
25-01-15 02:28:57 | I |       - range scale = [    1.0000]
25-01-15 02:28:57 | I |         sum  error  = [    0.4922]
25-01-15 02:28:57 | I |         best error  = [    0.4922]
25-01-15 02:28:57 | I |     + error = [0.4922]
25-01-15 02:28:57 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:28:58 | I |       - range scale = [    1.0000]
25-01-15 02:28:58 | I |         sum  error  = [    0.0500]
25-01-15 02:28:58 | I |         best error  = [    0.0500]
25-01-15 02:28:58 | I |     + error = [0.0500]
25-01-15 02:28:58 | I |       - range scale = [    1.0000]
25-01-15 02:28:58 | I |         sum  error  = [    0.5551]
25-01-15 02:28:58 | I |         best error  = [    0.5551]
25-01-15 02:28:58 | I |     + error = [0.5551]
25-01-15 02:28:58 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:28:59 | I |       - range scale = [    1.0000]
25-01-15 02:28:59 | I |         sum  error  = [    0.0122]
25-01-15 02:28:59 | I |         best error  = [    0.0122]
25-01-15 02:28:59 | I |     + error = [0.0122]
25-01-15 02:29:00 | I |       - range scale = [    1.0000]
25-01-15 02:29:00 | I |         sum  error  = [    0.1406]
25-01-15 02:29:00 | I |         best error  = [    0.1406]
25-01-15 02:29:00 | I |     + error = [0.1406]
25-01-15 02:29:00 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:29:01 | I |       - range scale = [    1.0000]
25-01-15 02:29:01 | I |         sum  error  = [    0.0512]
25-01-15 02:29:01 | I |         best error  = [    0.0512]
25-01-15 02:29:01 | I |     + error = [0.0512]
25-01-15 02:29:01 | I |       - range scale = [    1.0000]
25-01-15 02:29:01 | I |         sum  error  = [    0.5184]
25-01-15 02:29:01 | I |         best error  = [    0.5184]
25-01-15 02:29:01 | I |     + error = [0.5184]
25-01-15 02:29:01 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:29:02 | I |       - range scale = [    1.0000]
25-01-15 02:29:02 | I |         sum  error  = [    0.3224]
25-01-15 02:29:02 | I |         best error  = [    0.3224]
25-01-15 02:29:02 | I |     + error = [0.3224]
25-01-15 02:29:03 | I |       - range scale = [    1.0000]
25-01-15 02:29:03 | I |         sum  error  = [    3.6769]
25-01-15 02:29:03 | I |         best error  = [    3.6769]
25-01-15 02:29:03 | I |     + error = [3.6769]
25-01-15 02:29:03 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:29:04 | I |       - range scale = [    1.0000]
25-01-15 02:29:04 | I |         sum  error  = [    1.3294]
25-01-15 02:29:04 | I |         best error  = [    1.3294]
25-01-15 02:29:04 | I |     + error = [1.3294]
25-01-15 02:29:04 | I |       - range scale = [    1.0000]
25-01-15 02:29:04 | I |         sum  error  = [   15.3781]
25-01-15 02:29:04 | I |         best error  = [   15.3781]
25-01-15 02:29:04 | I |     + error = [15.3781]
25-01-15 02:29:04 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:29:05 | I |       - range scale = [    1.0000]
25-01-15 02:29:05 | I |         sum  error  = [    7.5110]
25-01-15 02:29:05 | I |         best error  = [    7.5110]
25-01-15 02:29:05 | I |     + error = [7.5110]
25-01-15 02:29:06 | I |       - range scale = [    1.0000]
25-01-15 02:29:06 | I |         sum  error  = [   40.2385]
25-01-15 02:29:06 | I |         best error  = [   40.2385]
25-01-15 02:29:06 | I |     + error = [40.2385]
25-01-15 02:29:06 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:29:07 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:29:09 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:29:10 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:29:11 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:29:13 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:29:14 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:29:17 | I | quantizing activations for layer model.layers.0
25-01-15 02:29:17 | I | collecting info in model.layers.0
25-01-15 02:29:17 | I | collecting info in model.layers.0
25-01-15 02:29:17 | I | collecting info in model.layers.0
25-01-15 02:29:17 | I | collecting info in model.layers.0
25-01-15 02:29:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:29:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:29:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:29:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:29:20 | I | forward this layer
25-01-15 02:29:20 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/19.pt
25-01-15 02:29:20 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/19.pt
25-01-15 02:29:20 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:29:20 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:29:20 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:29:20 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:29:20 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:29:20 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: True
25-01-15 02:29:20 | I | inf: first position tensor([ 21, 257], device='cuda:0')
25-01-15 02:29:20 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:29:20 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:29:20 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:29:20 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:29:20 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:29:20 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:29:20 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:29:20 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:29:20 | I | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.125
25-01-15 02:29:20 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:29:20 | I | in layer model.layers.0
25-01-15 02:29:20 | I | quantizing weights for layer model.layers.0
25-01-15 02:29:20 | I | collecting info in model.layers.0
25-01-15 02:29:20 | I | collecting info in model.layers.0
25-01-15 02:29:20 | I | collecting info in model.layers.0
25-01-15 02:29:20 | I | collecting info in model.layers.0
25-01-15 02:29:21 | I | collecting calibration activations in model.layers.0
25-01-15 02:29:21 | I | collecting calibration activations in model.layers.0
25-01-15 02:29:21 | I | collecting calibration activations in model.layers.0
25-01-15 02:29:21 | I | collecting calibration activations in model.layers.0
25-01-15 02:29:21 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:29:21 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:29:22 | I |       - range scale = [    1.0000]
25-01-15 02:29:22 | I |         sum  error  = [    0.0457]
25-01-15 02:29:22 | I |         best error  = [    0.0457]
25-01-15 02:29:22 | I |     + error = [0.0457]
25-01-15 02:29:23 | I |       - range scale = [    1.0000]
25-01-15 02:29:23 | I |         sum  error  = [    0.5048]
25-01-15 02:29:23 | I |         best error  = [    0.5048]
25-01-15 02:29:23 | I |     + error = [0.5048]
25-01-15 02:29:23 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:29:24 | I |       - range scale = [    1.0000]
25-01-15 02:29:24 | I |         sum  error  = [    0.0533]
25-01-15 02:29:24 | I |         best error  = [    0.0533]
25-01-15 02:29:24 | I |     + error = [0.0533]
25-01-15 02:29:24 | I |       - range scale = [    1.0000]
25-01-15 02:29:24 | I |         sum  error  = [    0.6048]
25-01-15 02:29:24 | I |         best error  = [    0.6048]
25-01-15 02:29:24 | I |     + error = [0.6048]
25-01-15 02:29:24 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:29:25 | I |       - range scale = [    1.0000]
25-01-15 02:29:25 | I |         sum  error  = [    0.0124]
25-01-15 02:29:25 | I |         best error  = [    0.0124]
25-01-15 02:29:25 | I |     + error = [0.0124]
25-01-15 02:29:26 | I |       - range scale = [    1.0000]
25-01-15 02:29:26 | I |         sum  error  = [    0.1420]
25-01-15 02:29:26 | I |         best error  = [    0.1420]
25-01-15 02:29:26 | I |     + error = [0.1420]
25-01-15 02:29:26 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:29:26 | I |       - range scale = [    1.0000]
25-01-15 02:29:26 | I |         sum  error  = [    0.0553]
25-01-15 02:29:26 | I |         best error  = [    0.0553]
25-01-15 02:29:26 | I |     + error = [0.0553]
25-01-15 02:29:27 | I |       - range scale = [    1.0000]
25-01-15 02:29:27 | I |         sum  error  = [    0.5613]
25-01-15 02:29:27 | I |         best error  = [    0.5613]
25-01-15 02:29:27 | I |     + error = [0.5613]
25-01-15 02:29:27 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:29:28 | I |       - range scale = [    1.0000]
25-01-15 02:29:28 | I |         sum  error  = [    0.3231]
25-01-15 02:29:28 | I |         best error  = [    0.3231]
25-01-15 02:29:28 | I |     + error = [0.3231]
25-01-15 02:29:29 | I |       - range scale = [    1.0000]
25-01-15 02:29:29 | I |         sum  error  = [    3.6884]
25-01-15 02:29:29 | I |         best error  = [    3.6884]
25-01-15 02:29:29 | I |     + error = [3.6884]
25-01-15 02:29:29 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:29:30 | I |       - range scale = [    1.0000]
25-01-15 02:29:30 | I |         sum  error  = [    1.3325]
25-01-15 02:29:30 | I |         best error  = [    1.3325]
25-01-15 02:29:30 | I |     + error = [1.3325]
25-01-15 02:29:30 | I |       - range scale = [    1.0000]
25-01-15 02:29:30 | I |         sum  error  = [   15.4292]
25-01-15 02:29:30 | I |         best error  = [   15.4292]
25-01-15 02:29:30 | I |     + error = [15.4292]
25-01-15 02:29:31 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:29:31 | I |       - range scale = [    1.0000]
25-01-15 02:29:31 | I |         sum  error  = [    8.5280]
25-01-15 02:29:31 | I |         best error  = [    8.5280]
25-01-15 02:29:31 | I |     + error = [8.5280]
25-01-15 02:29:32 | I |       - range scale = [    1.0000]
25-01-15 02:29:32 | I |         sum  error  = [   46.3989]
25-01-15 02:29:32 | I |         best error  = [   46.3989]
25-01-15 02:29:32 | I |     + error = [46.3989]
25-01-15 02:29:32 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:29:33 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:29:35 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:29:36 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:29:38 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:29:39 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:29:40 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:29:44 | I | quantizing activations for layer model.layers.0
25-01-15 02:29:44 | I | collecting info in model.layers.0
25-01-15 02:29:44 | I | collecting info in model.layers.0
25-01-15 02:29:44 | I | collecting info in model.layers.0
25-01-15 02:29:44 | I | collecting info in model.layers.0
25-01-15 02:29:44 | I | collecting calibration activations in model.layers.0
25-01-15 02:29:44 | I | collecting calibration activations in model.layers.0
25-01-15 02:29:44 | I | collecting calibration activations in model.layers.0
25-01-15 02:29:44 | I | collecting calibration activations in model.layers.0
25-01-15 02:29:46 | I | forward this layer
25-01-15 02:29:46 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/20.pt
25-01-15 02:29:46 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/20.pt
25-01-15 02:29:46 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:29:46 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:29:46 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:29:46 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:29:46 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:29:46 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:29:46 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:29:46 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:29:46 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:29:46 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:29:46 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:29:46 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:29:46 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:29:46 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:29:46 | I | in layer model.layers.0
25-01-15 02:29:46 | I | quantizing weights for layer model.layers.0
25-01-15 02:29:46 | I | collecting info in model.layers.0
25-01-15 02:29:46 | I | collecting info in model.layers.0
25-01-15 02:29:46 | I | collecting info in model.layers.0
25-01-15 02:29:46 | I | collecting info in model.layers.0
25-01-15 02:29:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:29:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:29:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:29:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:29:47 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:29:47 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:29:48 | I |       - range scale = [    1.0000]
25-01-15 02:29:48 | I |         sum  error  = [    0.0442]
25-01-15 02:29:48 | I |         best error  = [    0.0442]
25-01-15 02:29:48 | I |     + error = [0.0442]
25-01-15 02:29:49 | I |       - range scale = [    1.0000]
25-01-15 02:29:49 | I |         sum  error  = [    0.4930]
25-01-15 02:29:49 | I |         best error  = [    0.4930]
25-01-15 02:29:49 | I |     + error = [0.4930]
25-01-15 02:29:49 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:29:50 | I |       - range scale = [    1.0000]
25-01-15 02:29:50 | I |         sum  error  = [    0.0532]
25-01-15 02:29:50 | I |         best error  = [    0.0532]
25-01-15 02:29:50 | I |     + error = [0.0532]
25-01-15 02:29:50 | I |       - range scale = [    1.0000]
25-01-15 02:29:50 | I |         sum  error  = [    0.6011]
25-01-15 02:29:50 | I |         best error  = [    0.6011]
25-01-15 02:29:50 | I |     + error = [0.6011]
25-01-15 02:29:50 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:29:51 | I |       - range scale = [    1.0000]
25-01-15 02:29:51 | I |         sum  error  = [    0.0123]
25-01-15 02:29:51 | I |         best error  = [    0.0123]
25-01-15 02:29:51 | I |     + error = [0.0123]
25-01-15 02:29:52 | I |       - range scale = [    1.0000]
25-01-15 02:29:52 | I |         sum  error  = [    0.1417]
25-01-15 02:29:52 | I |         best error  = [    0.1417]
25-01-15 02:29:52 | I |     + error = [0.1417]
25-01-15 02:29:52 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:29:52 | I |       - range scale = [    1.0000]
25-01-15 02:29:52 | I |         sum  error  = [    0.0546]
25-01-15 02:29:52 | I |         best error  = [    0.0546]
25-01-15 02:29:52 | I |     + error = [0.0546]
25-01-15 02:29:53 | I |       - range scale = [    1.0000]
25-01-15 02:29:53 | I |         sum  error  = [    0.5530]
25-01-15 02:29:53 | I |         best error  = [    0.5530]
25-01-15 02:29:53 | I |     + error = [0.5530]
25-01-15 02:29:53 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:29:54 | I |       - range scale = [    1.0000]
25-01-15 02:29:54 | I |         sum  error  = [    0.3235]
25-01-15 02:29:54 | I |         best error  = [    0.3235]
25-01-15 02:29:54 | I |     + error = [0.3235]
25-01-15 02:29:55 | I |       - range scale = [    1.0000]
25-01-15 02:29:55 | I |         sum  error  = [    3.6891]
25-01-15 02:29:55 | I |         best error  = [    3.6891]
25-01-15 02:29:55 | I |     + error = [3.6891]
25-01-15 02:29:55 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:29:56 | I |       - range scale = [    1.0000]
25-01-15 02:29:56 | I |         sum  error  = [    1.3336]
25-01-15 02:29:56 | I |         best error  = [    1.3336]
25-01-15 02:29:56 | I |     + error = [1.3336]
25-01-15 02:29:56 | I |       - range scale = [    1.0000]
25-01-15 02:29:56 | I |         sum  error  = [   15.4274]
25-01-15 02:29:56 | I |         best error  = [   15.4274]
25-01-15 02:29:56 | I |     + error = [15.4274]
25-01-15 02:29:56 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:29:57 | I |       - range scale = [    1.0000]
25-01-15 02:29:57 | I |         sum  error  = [    7.3444]
25-01-15 02:29:57 | I |         best error  = [    7.3444]
25-01-15 02:29:57 | I |     + error = [7.3444]
25-01-15 02:29:58 | I |       - range scale = [    1.0000]
25-01-15 02:29:58 | I |         sum  error  = [   39.8003]
25-01-15 02:29:58 | I |         best error  = [   39.8003]
25-01-15 02:29:58 | I |     + error = [39.8003]
25-01-15 02:29:58 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:29:59 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:30:01 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:30:02 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:30:04 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:30:05 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:30:06 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:30:10 | I | quantizing activations for layer model.layers.0
25-01-15 02:30:10 | I | collecting info in model.layers.0
25-01-15 02:30:10 | I | collecting info in model.layers.0
25-01-15 02:30:10 | I | collecting info in model.layers.0
25-01-15 02:30:10 | I | collecting info in model.layers.0
25-01-15 02:30:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:30:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:30:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:30:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:30:12 | I | forward this layer
25-01-15 02:30:12 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/21.pt
25-01-15 02:30:12 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/21.pt
25-01-15 02:30:12 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:30:12 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:30:12 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:30:12 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:30:12 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:30:12 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: True
25-01-15 02:30:12 | I | inf: first position tensor([45, 23], device='cuda:0')
25-01-15 02:30:12 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:30:12 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:30:12 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:30:12 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:30:12 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:30:12 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:30:12 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:30:12 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:30:12 | I | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 0.0625
25-01-15 02:30:12 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:30:12 | I | in layer model.layers.0
25-01-15 02:30:12 | I | quantizing weights for layer model.layers.0
25-01-15 02:30:12 | I | collecting info in model.layers.0
25-01-15 02:30:12 | I | collecting info in model.layers.0
25-01-15 02:30:12 | I | collecting info in model.layers.0
25-01-15 02:30:12 | I | collecting info in model.layers.0
25-01-15 02:30:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:30:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:30:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:30:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:30:13 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:30:13 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:30:14 | I |       - range scale = [    1.0000]
25-01-15 02:30:14 | I |         sum  error  = [    0.0440]
25-01-15 02:30:14 | I |         best error  = [    0.0440]
25-01-15 02:30:14 | I |     + error = [0.0440]
25-01-15 02:30:15 | I |       - range scale = [    1.0000]
25-01-15 02:30:15 | I |         sum  error  = [    0.4896]
25-01-15 02:30:15 | I |         best error  = [    0.4896]
25-01-15 02:30:15 | I |     + error = [0.4896]
25-01-15 02:30:15 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:30:16 | I |       - range scale = [    1.0000]
25-01-15 02:30:16 | I |         sum  error  = [    0.0511]
25-01-15 02:30:16 | I |         best error  = [    0.0511]
25-01-15 02:30:16 | I |     + error = [0.0511]
25-01-15 02:30:17 | I |       - range scale = [    1.0000]
25-01-15 02:30:17 | I |         sum  error  = [    0.5835]
25-01-15 02:30:17 | I |         best error  = [    0.5835]
25-01-15 02:30:17 | I |     + error = [0.5835]
25-01-15 02:30:17 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:30:18 | I |       - range scale = [    1.0000]
25-01-15 02:30:18 | I |         sum  error  = [    0.0124]
25-01-15 02:30:18 | I |         best error  = [    0.0124]
25-01-15 02:30:18 | I |     + error = [0.0124]
25-01-15 02:30:18 | I |       - range scale = [    1.0000]
25-01-15 02:30:18 | I |         sum  error  = [    0.1420]
25-01-15 02:30:18 | I |         best error  = [    0.1420]
25-01-15 02:30:18 | I |     + error = [0.1420]
25-01-15 02:30:18 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:30:19 | I |       - range scale = [    1.0000]
25-01-15 02:30:19 | I |         sum  error  = [    0.0593]
25-01-15 02:30:19 | I |         best error  = [    0.0593]
25-01-15 02:30:19 | I |     + error = [0.0593]
25-01-15 02:30:20 | I |       - range scale = [    1.0000]
25-01-15 02:30:20 | I |         sum  error  = [    0.6010]
25-01-15 02:30:20 | I |         best error  = [    0.6010]
25-01-15 02:30:20 | I |     + error = [0.6010]
25-01-15 02:30:20 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:30:21 | I |       - range scale = [    1.0000]
25-01-15 02:30:21 | I |         sum  error  = [    0.3238]
25-01-15 02:30:21 | I |         best error  = [    0.3238]
25-01-15 02:30:21 | I |     + error = [0.3238]
25-01-15 02:30:21 | I |       - range scale = [    1.0000]
25-01-15 02:30:21 | I |         sum  error  = [    3.6895]
25-01-15 02:30:21 | I |         best error  = [    3.6895]
25-01-15 02:30:21 | I |     + error = [3.6895]
25-01-15 02:30:22 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:30:22 | I |       - range scale = [    1.0000]
25-01-15 02:30:22 | I |         sum  error  = [    1.3329]
25-01-15 02:30:22 | I |         best error  = [    1.3329]
25-01-15 02:30:22 | I |     + error = [1.3329]
25-01-15 02:30:23 | I |       - range scale = [    1.0000]
25-01-15 02:30:23 | I |         sum  error  = [   15.4324]
25-01-15 02:30:23 | I |         best error  = [   15.4324]
25-01-15 02:30:23 | I |     + error = [15.4324]
25-01-15 02:30:23 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:30:24 | I |       - range scale = [    1.0000]
25-01-15 02:30:24 | I |         sum  error  = [    6.8014]
25-01-15 02:30:24 | I |         best error  = [    6.8014]
25-01-15 02:30:24 | I |     + error = [6.8014]
25-01-15 02:30:25 | I |       - range scale = [    1.0000]
25-01-15 02:30:25 | I |         sum  error  = [   37.2945]
25-01-15 02:30:25 | I |         best error  = [   37.2945]
25-01-15 02:30:25 | I |     + error = [37.2945]
25-01-15 02:30:25 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:30:26 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:30:27 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:30:29 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:30:30 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:30:32 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:30:33 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:30:36 | I | quantizing activations for layer model.layers.0
25-01-15 02:30:36 | I | collecting info in model.layers.0
25-01-15 02:30:36 | I | collecting info in model.layers.0
25-01-15 02:30:36 | I | collecting info in model.layers.0
25-01-15 02:30:36 | I | collecting info in model.layers.0
25-01-15 02:30:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:30:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:30:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:30:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:30:39 | I | forward this layer
25-01-15 02:30:39 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/22.pt
25-01-15 02:30:39 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/22.pt
25-01-15 02:30:39 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:30:39 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:30:39 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:30:39 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:30:39 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:30:39 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:30:39 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:30:39 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:30:39 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:30:39 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:30:39 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:30:39 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:30:39 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:30:39 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:30:39 | I | in layer model.layers.0
25-01-15 02:30:39 | I | quantizing weights for layer model.layers.0
25-01-15 02:30:39 | I | collecting info in model.layers.0
25-01-15 02:30:39 | I | collecting info in model.layers.0
25-01-15 02:30:39 | I | collecting info in model.layers.0
25-01-15 02:30:39 | I | collecting info in model.layers.0
25-01-15 02:30:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:30:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:30:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:30:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:30:40 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:30:40 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:30:41 | I |       - range scale = [    1.0000]
25-01-15 02:30:41 | I |         sum  error  = [    0.0446]
25-01-15 02:30:41 | I |         best error  = [    0.0446]
25-01-15 02:30:41 | I |     + error = [0.0446]
25-01-15 02:30:41 | I |       - range scale = [    1.0000]
25-01-15 02:30:41 | I |         sum  error  = [    0.4910]
25-01-15 02:30:41 | I |         best error  = [    0.4910]
25-01-15 02:30:41 | I |     + error = [0.4910]
25-01-15 02:30:42 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:30:42 | I |       - range scale = [    1.0000]
25-01-15 02:30:42 | I |         sum  error  = [    0.0519]
25-01-15 02:30:42 | I |         best error  = [    0.0519]
25-01-15 02:30:42 | I |     + error = [0.0519]
25-01-15 02:30:43 | I |       - range scale = [    1.0000]
25-01-15 02:30:43 | I |         sum  error  = [    0.5752]
25-01-15 02:30:43 | I |         best error  = [    0.5752]
25-01-15 02:30:43 | I |     + error = [0.5752]
25-01-15 02:30:43 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:30:44 | I |       - range scale = [    1.0000]
25-01-15 02:30:44 | I |         sum  error  = [    0.0123]
25-01-15 02:30:44 | I |         best error  = [    0.0123]
25-01-15 02:30:44 | I |     + error = [0.0123]
25-01-15 02:30:44 | I |       - range scale = [    1.0000]
25-01-15 02:30:44 | I |         sum  error  = [    0.1411]
25-01-15 02:30:44 | I |         best error  = [    0.1411]
25-01-15 02:30:44 | I |     + error = [0.1411]
25-01-15 02:30:45 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:30:45 | I |       - range scale = [    1.0000]
25-01-15 02:30:45 | I |         sum  error  = [    0.0564]
25-01-15 02:30:45 | I |         best error  = [    0.0564]
25-01-15 02:30:45 | I |     + error = [0.0564]
25-01-15 02:30:46 | I |       - range scale = [    1.0000]
25-01-15 02:30:46 | I |         sum  error  = [    0.5697]
25-01-15 02:30:46 | I |         best error  = [    0.5697]
25-01-15 02:30:46 | I |     + error = [0.5697]
25-01-15 02:30:46 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:30:47 | I |       - range scale = [    1.0000]
25-01-15 02:30:47 | I |         sum  error  = [    0.3222]
25-01-15 02:30:47 | I |         best error  = [    0.3222]
25-01-15 02:30:47 | I |     + error = [0.3222]
25-01-15 02:30:47 | I |       - range scale = [    1.0000]
25-01-15 02:30:47 | I |         sum  error  = [    3.6737]
25-01-15 02:30:47 | I |         best error  = [    3.6737]
25-01-15 02:30:47 | I |     + error = [3.6737]
25-01-15 02:30:48 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:30:48 | I |       - range scale = [    1.0000]
25-01-15 02:30:48 | I |         sum  error  = [    1.3255]
25-01-15 02:30:48 | I |         best error  = [    1.3255]
25-01-15 02:30:48 | I |     + error = [1.3255]
25-01-15 02:30:49 | I |       - range scale = [    1.0000]
25-01-15 02:30:49 | I |         sum  error  = [   15.3625]
25-01-15 02:30:49 | I |         best error  = [   15.3625]
25-01-15 02:30:49 | I |     + error = [15.3625]
25-01-15 02:30:49 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:30:50 | I |       - range scale = [    1.0000]
25-01-15 02:30:50 | I |         sum  error  = [    6.3663]
25-01-15 02:30:50 | I |         best error  = [    6.3663]
25-01-15 02:30:50 | I |     + error = [6.3663]
25-01-15 02:30:51 | I |       - range scale = [    1.0000]
25-01-15 02:30:51 | I |         sum  error  = [   33.9743]
25-01-15 02:30:51 | I |         best error  = [   33.9743]
25-01-15 02:30:51 | I |     + error = [33.9743]
25-01-15 02:30:51 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:30:52 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:30:54 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:30:55 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:30:56 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:30:58 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:30:59 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:31:02 | I | quantizing activations for layer model.layers.0
25-01-15 02:31:02 | I | collecting info in model.layers.0
25-01-15 02:31:02 | I | collecting info in model.layers.0
25-01-15 02:31:02 | I | collecting info in model.layers.0
25-01-15 02:31:02 | I | collecting info in model.layers.0
25-01-15 02:31:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:05 | I | forward this layer
25-01-15 02:31:05 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/23.pt
25-01-15 02:31:05 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/23.pt
25-01-15 02:31:05 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:31:05 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:31:05 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:31:05 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:31:05 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:31:05 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:31:05 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:31:05 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:31:05 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:31:05 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:31:05 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:31:05 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:31:05 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:31:05 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:31:05 | I | [0] done with optimizer step
25-01-15 02:31:05 | I | epoch 001:     12 / 409600000 loss=0.000173795, loss_per_token=0.355933, loss_sum=11663.2, wps=0, ups=0, wpb=32768, bsz=64, num_updates=1, lr=3e-06, gnorm=362.329, clip=100, loss_scale=0.0625, train_wall=627, cuda_gb_allocated=9.7, cuda_gb_reserved=11, cuda_gb_free=14, wall=935
25-01-15 02:31:05 | I | begin validation on "valid" subset on rank 0
25-01-15 02:31:05 | I | got valid iterator on "valid" subset on rank 0
25-01-15 02:31:05 | I | Valid: Start iterating over samples
25-01-15 02:31:05 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:31:05 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:31:05 | I | - Evaluator: gptq
25-01-15 02:31:05 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:31:05 | I | - Batch_size: 8
25-01-15 02:31:05 | I |   + Max_seq_length: 2048
25-01-15 02:31:31 | I |     - Results:
25-01-15 02:31:31 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-15 02:31:31 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-15 02:31:31 | I |       |wikitext |      1|word_perplexity|7.7078|±  |7.7078|
25-01-15 02:31:31 | I |       |val_valid|      1|word_perplexity|7.4138|±  |7.4138|
25-01-15 02:31:31 | I |       
25-01-15 02:31:31 | I | in valid, quantize current layer weights
25-01-15 02:31:32 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:46 | I | collecting info in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:31:51 | I |       - range scale = [    1.0000]
25-01-15 02:31:51 | I |         sum  error  = [    0.1249]
25-01-15 02:31:51 | I |         best error  = [    0.1249]
25-01-15 02:31:51 | I |     + error = [0.1249]
25-01-15 02:31:52 | I |       - range scale = [    1.0000]
25-01-15 02:31:52 | I |         sum  error  = [    1.3756]
25-01-15 02:31:52 | I |         best error  = [    1.3756]
25-01-15 02:31:52 | I |     + error = [1.3756]
25-01-15 02:31:53 | I |       - range scale = [    1.0000]
25-01-15 02:31:53 | I |         sum  error  = [    0.1475]
25-01-15 02:31:53 | I |         best error  = [    0.1475]
25-01-15 02:31:53 | I |     + error = [0.1475]
25-01-15 02:31:54 | I |       - range scale = [    1.0000]
25-01-15 02:31:54 | I |         sum  error  = [    1.6876]
25-01-15 02:31:54 | I |         best error  = [    1.6876]
25-01-15 02:31:54 | I |     + error = [1.6876]
25-01-15 02:31:55 | I |       - range scale = [    1.0000]
25-01-15 02:31:55 | I |         sum  error  = [    0.0123]
25-01-15 02:31:55 | I |         best error  = [    0.0123]
25-01-15 02:31:55 | I |     + error = [0.0123]
25-01-15 02:31:56 | I |       - range scale = [    1.0000]
25-01-15 02:31:56 | I |         sum  error  = [    0.1421]
25-01-15 02:31:56 | I |         best error  = [    0.1421]
25-01-15 02:31:56 | I |     + error = [0.1421]
25-01-15 02:31:56 | I |       - range scale = [    1.0000]
25-01-15 02:31:56 | I |         sum  error  = [    0.0536]
25-01-15 02:31:56 | I |         best error  = [    0.0536]
25-01-15 02:31:56 | I |     + error = [0.0536]
25-01-15 02:31:57 | I |       - range scale = [    1.0000]
25-01-15 02:31:57 | I |         sum  error  = [    0.5450]
25-01-15 02:31:57 | I |         best error  = [    0.5450]
25-01-15 02:31:57 | I |     + error = [0.5450]
25-01-15 02:31:58 | I |       - range scale = [    1.0000]
25-01-15 02:31:58 | I |         sum  error  = [    0.3252]
25-01-15 02:31:58 | I |         best error  = [    0.3252]
25-01-15 02:31:58 | I |     + error = [0.3252]
25-01-15 02:31:59 | I |       - range scale = [    1.0000]
25-01-15 02:31:59 | I |         sum  error  = [    3.7142]
25-01-15 02:31:59 | I |         best error  = [    3.7142]
25-01-15 02:31:59 | I |     + error = [3.7142]
25-01-15 02:31:59 | I |       - range scale = [    1.0000]
25-01-15 02:31:59 | I |         sum  error  = [    1.3423]
25-01-15 02:31:59 | I |         best error  = [    1.3423]
25-01-15 02:31:59 | I |     + error = [1.3423]
25-01-15 02:32:00 | I |       - range scale = [    1.0000]
25-01-15 02:32:00 | I |         sum  error  = [   15.5390]
25-01-15 02:32:00 | I |         best error  = [   15.5390]
25-01-15 02:32:00 | I |     + error = [15.5390]
25-01-15 02:32:01 | I |       - range scale = [    1.0000]
25-01-15 02:32:01 | I |         sum  error  = [    8.4956]
25-01-15 02:32:01 | I |         best error  = [    8.4956]
25-01-15 02:32:01 | I |     + error = [8.4956]
25-01-15 02:32:02 | I |       - range scale = [    1.0000]
25-01-15 02:32:02 | I |         sum  error  = [   44.9053]
25-01-15 02:32:02 | I |         best error  = [   44.9053]
25-01-15 02:32:02 | I |     + error = [44.9053]
25-01-15 02:32:14 | I | in valid, quantize current layer acts
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:14 | I | collecting info in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:32:20 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-15 02:32:20 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:32:20 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:32:20 | I | - Evaluator: gptq
25-01-15 02:32:20 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:32:20 | I | - Batch_size: 8
25-01-15 02:32:20 | I |   + Max_seq_length: 2048
25-01-15 02:32:48 | I |     - Results:
25-01-15 02:32:48 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-15 02:32:48 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-15 02:32:48 | I |       |wikitext |      1|word_perplexity|7.7978|±  |7.7978|
25-01-15 02:32:48 | I |       |val_valid|      1|word_perplexity|7.4908|±  |7.4908|
25-01-15 02:32:48 | I |       
25-01-15 02:32:50 | W | Criterion.reduce_metrics did not log a 'loss_valid' value, which may break some functionality
25-01-15 02:33:06 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.639, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.23, wps=25688.8, wpb=4058.2, bsz=2, num_updates=1, lmquant_ppl_wikitext_all_quanted=7.70778, lmquant_ppl_val_all_quanted=7.4138, lmquant_ppl_wikitext_partly_quanted=7.79785, lmquant_ppl_val_partly_quanted=7.49077
25-01-15 02:33:06 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.639 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.23 | wps 25688.8 | wpb 4058.2 | bsz 2 | num_updates 1 | lmquant_ppl_wikitext_all_quanted 7.70778 | lmquant_ppl_val_all_quanted 7.4138 | lmquant_ppl_wikitext_partly_quanted 7.79785 | lmquant_ppl_val_partly_quanted 7.49077
25-01-15 02:33:06 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:33:06 | I | in layer model.layers.0
25-01-15 02:33:06 | I | quantizing weights for layer model.layers.0
25-01-15 02:33:06 | I | collecting info in model.layers.0
25-01-15 02:33:06 | I | collecting info in model.layers.0
25-01-15 02:33:06 | I | collecting info in model.layers.0
25-01-15 02:33:06 | I | collecting info in model.layers.0
25-01-15 02:33:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:33:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:33:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:33:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:33:07 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:33:07 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:33:08 | I |       - range scale = [    1.0000]
25-01-15 02:33:08 | I |         sum  error  = [    0.0459]
25-01-15 02:33:08 | I |         best error  = [    0.0459]
25-01-15 02:33:08 | I |     + error = [0.0459]
25-01-15 02:33:08 | I |       - range scale = [    1.0000]
25-01-15 02:33:08 | I |         sum  error  = [    0.5074]
25-01-15 02:33:08 | I |         best error  = [    0.5074]
25-01-15 02:33:08 | I |     + error = [0.5074]
25-01-15 02:33:09 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:33:09 | I |       - range scale = [    1.0000]
25-01-15 02:33:09 | I |         sum  error  = [    0.0535]
25-01-15 02:33:09 | I |         best error  = [    0.0535]
25-01-15 02:33:09 | I |     + error = [0.0535]
25-01-15 02:33:10 | I |       - range scale = [    1.0000]
25-01-15 02:33:10 | I |         sum  error  = [    0.6086]
25-01-15 02:33:10 | I |         best error  = [    0.6086]
25-01-15 02:33:10 | I |     + error = [0.6086]
25-01-15 02:33:10 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:33:11 | I |       - range scale = [    1.0000]
25-01-15 02:33:11 | I |         sum  error  = [    0.0122]
25-01-15 02:33:11 | I |         best error  = [    0.0122]
25-01-15 02:33:11 | I |     + error = [0.0122]
25-01-15 02:33:11 | I |       - range scale = [    1.0000]
25-01-15 02:33:11 | I |         sum  error  = [    0.1421]
25-01-15 02:33:11 | I |         best error  = [    0.1421]
25-01-15 02:33:11 | I |     + error = [0.1421]
25-01-15 02:33:12 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:33:12 | I |       - range scale = [    1.0000]
25-01-15 02:33:12 | I |         sum  error  = [    0.0593]
25-01-15 02:33:12 | I |         best error  = [    0.0593]
25-01-15 02:33:12 | I |     + error = [0.0593]
25-01-15 02:33:13 | I |       - range scale = [    1.0000]
25-01-15 02:33:13 | I |         sum  error  = [    0.6002]
25-01-15 02:33:13 | I |         best error  = [    0.6002]
25-01-15 02:33:13 | I |     + error = [0.6002]
25-01-15 02:33:13 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:33:14 | I |       - range scale = [    1.0000]
25-01-15 02:33:14 | I |         sum  error  = [    0.3234]
25-01-15 02:33:14 | I |         best error  = [    0.3234]
25-01-15 02:33:14 | I |     + error = [0.3234]
25-01-15 02:33:15 | I |       - range scale = [    1.0000]
25-01-15 02:33:15 | I |         sum  error  = [    3.6882]
25-01-15 02:33:15 | I |         best error  = [    3.6882]
25-01-15 02:33:15 | I |     + error = [3.6882]
25-01-15 02:33:15 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:33:15 | I |       - range scale = [    1.0000]
25-01-15 02:33:15 | I |         sum  error  = [    1.3335]
25-01-15 02:33:15 | I |         best error  = [    1.3335]
25-01-15 02:33:15 | I |     + error = [1.3335]
25-01-15 02:33:16 | I |       - range scale = [    1.0000]
25-01-15 02:33:16 | I |         sum  error  = [   15.4180]
25-01-15 02:33:16 | I |         best error  = [   15.4180]
25-01-15 02:33:16 | I |     + error = [15.4180]
25-01-15 02:33:16 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:33:17 | I |       - range scale = [    1.0000]
25-01-15 02:33:17 | I |         sum  error  = [    7.4513]
25-01-15 02:33:17 | I |         best error  = [    7.4513]
25-01-15 02:33:17 | I |     + error = [7.4513]
25-01-15 02:33:18 | I |       - range scale = [    1.0000]
25-01-15 02:33:18 | I |         sum  error  = [   41.4005]
25-01-15 02:33:18 | I |         best error  = [   41.4005]
25-01-15 02:33:18 | I |     + error = [41.4005]
25-01-15 02:33:18 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:33:19 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:33:21 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:33:22 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:33:23 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:33:25 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:33:26 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:33:29 | I | quantizing activations for layer model.layers.0
25-01-15 02:33:29 | I | collecting info in model.layers.0
25-01-15 02:33:29 | I | collecting info in model.layers.0
25-01-15 02:33:29 | I | collecting info in model.layers.0
25-01-15 02:33:29 | I | collecting info in model.layers.0
25-01-15 02:33:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:33:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:33:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:33:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:33:32 | I | forward this layer
25-01-15 02:33:32 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/24.pt
25-01-15 02:33:32 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/24.pt
25-01-15 02:33:32 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:33:32 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:33:32 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:33:32 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:33:32 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:33:32 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: True
25-01-15 02:33:32 | I | inf: first position tensor([ 45, 812], device='cuda:0')
25-01-15 02:33:32 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:33:32 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:33:32 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:33:32 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:33:32 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:33:32 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:33:32 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:33:32 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:33:32 | I | in layer model.layers.0
25-01-15 02:33:32 | I | quantizing weights for layer model.layers.0
25-01-15 02:33:32 | I | collecting info in model.layers.0
25-01-15 02:33:32 | I | collecting info in model.layers.0
25-01-15 02:33:32 | I | collecting info in model.layers.0
25-01-15 02:33:32 | I | collecting info in model.layers.0
25-01-15 02:33:33 | I | collecting calibration activations in model.layers.0
25-01-15 02:33:33 | I | collecting calibration activations in model.layers.0
25-01-15 02:33:33 | I | collecting calibration activations in model.layers.0
25-01-15 02:33:33 | I | collecting calibration activations in model.layers.0
25-01-15 02:33:33 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:33:33 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:33:34 | I |       - range scale = [    1.0000]
25-01-15 02:33:34 | I |         sum  error  = [    0.0451]
25-01-15 02:33:34 | I |         best error  = [    0.0451]
25-01-15 02:33:34 | I |     + error = [0.0451]
25-01-15 02:33:34 | I |       - range scale = [    1.0000]
25-01-15 02:33:34 | I |         sum  error  = [    0.4949]
25-01-15 02:33:34 | I |         best error  = [    0.4949]
25-01-15 02:33:34 | I |     + error = [0.4949]
25-01-15 02:33:35 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:33:35 | I |       - range scale = [    1.0000]
25-01-15 02:33:35 | I |         sum  error  = [    0.0523]
25-01-15 02:33:35 | I |         best error  = [    0.0523]
25-01-15 02:33:35 | I |     + error = [0.0523]
25-01-15 02:33:36 | I |       - range scale = [    1.0000]
25-01-15 02:33:36 | I |         sum  error  = [    0.6196]
25-01-15 02:33:36 | I |         best error  = [    0.6196]
25-01-15 02:33:36 | I |     + error = [0.6196]
25-01-15 02:33:36 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:33:37 | I |       - range scale = [    1.0000]
25-01-15 02:33:37 | I |         sum  error  = [    0.0123]
25-01-15 02:33:37 | I |         best error  = [    0.0123]
25-01-15 02:33:37 | I |     + error = [0.0123]
25-01-15 02:33:38 | I |       - range scale = [    1.0000]
25-01-15 02:33:38 | I |         sum  error  = [    0.1430]
25-01-15 02:33:38 | I |         best error  = [    0.1430]
25-01-15 02:33:38 | I |     + error = [0.1430]
25-01-15 02:33:38 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:33:38 | I |       - range scale = [    1.0000]
25-01-15 02:33:38 | I |         sum  error  = [    0.0594]
25-01-15 02:33:38 | I |         best error  = [    0.0594]
25-01-15 02:33:38 | I |     + error = [0.0594]
25-01-15 02:33:39 | I |       - range scale = [    1.0000]
25-01-15 02:33:39 | I |         sum  error  = [    0.6030]
25-01-15 02:33:39 | I |         best error  = [    0.6030]
25-01-15 02:33:39 | I |     + error = [0.6030]
25-01-15 02:33:39 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:33:40 | I |       - range scale = [    1.0000]
25-01-15 02:33:40 | I |         sum  error  = [    0.3239]
25-01-15 02:33:40 | I |         best error  = [    0.3239]
25-01-15 02:33:40 | I |     + error = [0.3239]
25-01-15 02:33:41 | I |       - range scale = [    1.0000]
25-01-15 02:33:41 | I |         sum  error  = [    3.6965]
25-01-15 02:33:41 | I |         best error  = [    3.6965]
25-01-15 02:33:41 | I |     + error = [3.6965]
25-01-15 02:33:41 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:33:41 | I |       - range scale = [    1.0000]
25-01-15 02:33:41 | I |         sum  error  = [    1.3360]
25-01-15 02:33:41 | I |         best error  = [    1.3360]
25-01-15 02:33:41 | I |     + error = [1.3360]
25-01-15 02:33:42 | I |       - range scale = [    1.0000]
25-01-15 02:33:42 | I |         sum  error  = [   15.4589]
25-01-15 02:33:42 | I |         best error  = [   15.4589]
25-01-15 02:33:42 | I |     + error = [15.4589]
25-01-15 02:33:42 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:33:43 | I |       - range scale = [    1.0000]
25-01-15 02:33:43 | I |         sum  error  = [    7.0351]
25-01-15 02:33:43 | I |         best error  = [    7.0351]
25-01-15 02:33:43 | I |     + error = [7.0351]
25-01-15 02:33:44 | I |       - range scale = [    1.0000]
25-01-15 02:33:44 | I |         sum  error  = [   38.3518]
25-01-15 02:33:44 | I |         best error  = [   38.3518]
25-01-15 02:33:44 | I |     + error = [38.3518]
25-01-15 02:33:44 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:33:45 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:33:47 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:33:48 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:33:49 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:33:51 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:33:52 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:33:56 | I | quantizing activations for layer model.layers.0
25-01-15 02:33:56 | I | collecting info in model.layers.0
25-01-15 02:33:56 | I | collecting info in model.layers.0
25-01-15 02:33:56 | I | collecting info in model.layers.0
25-01-15 02:33:56 | I | collecting info in model.layers.0
25-01-15 02:33:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:33:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:33:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:33:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:33:58 | I | forward this layer
25-01-15 02:33:58 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/25.pt
25-01-15 02:33:58 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/25.pt
25-01-15 02:33:58 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:33:58 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:33:58 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:33:58 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:33:58 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:33:58 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:33:58 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:33:58 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:33:58 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:33:58 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:33:58 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:33:58 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:33:58 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:33:58 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:33:58 | I | [1] done with optimizer step
25-01-15 02:33:58 | I | epoch 001:     13 / 409600000 loss=0.000291311, loss_per_token=0.596605, loss_sum=19549.6, wps=189.2, ups=0.01, wpb=32768, bsz=64, num_updates=2, lr=6e-06, gnorm=0.831, clip=0, loss_scale=0.0625, train_wall=52, cuda_gb_allocated=10.1, cuda_gb_reserved=11.4, cuda_gb_free=13.6, wall=1108
25-01-15 02:33:58 | I | begin validation on "valid" subset on rank 0
25-01-15 02:33:58 | I | got valid iterator on "valid" subset on rank 0
25-01-15 02:33:58 | I | Valid: Start iterating over samples
25-01-15 02:33:58 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:33:58 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:33:58 | I | - Evaluator: gptq
25-01-15 02:33:58 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:33:58 | I | - Batch_size: 8
25-01-15 02:33:58 | I |   + Max_seq_length: 2048
25-01-15 02:34:24 | I |     - Results:
25-01-15 02:34:24 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-15 02:34:24 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-15 02:34:24 | I |       |wikitext |      1|word_perplexity|7.7078|±  |7.7078|
25-01-15 02:34:24 | I |       |val_valid|      1|word_perplexity|7.4138|±  |7.4138|
25-01-15 02:34:24 | I |       
25-01-15 02:34:24 | I | in valid, quantize current layer weights
25-01-15 02:34:25 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:37 | I | collecting info in model.layers.0
25-01-15 02:34:38 | I | collecting info in model.layers.0
25-01-15 02:34:38 | I | collecting info in model.layers.0
25-01-15 02:34:38 | I | collecting info in model.layers.0
25-01-15 02:34:38 | I | collecting info in model.layers.0
25-01-15 02:34:38 | I | collecting info in model.layers.0
25-01-15 02:34:38 | I | collecting info in model.layers.0
25-01-15 02:34:38 | I | collecting info in model.layers.0
25-01-15 02:34:38 | I | collecting info in model.layers.0
25-01-15 02:34:38 | I | collecting info in model.layers.0
25-01-15 02:34:38 | I | collecting info in model.layers.0
25-01-15 02:34:38 | I | collecting info in model.layers.0
25-01-15 02:34:38 | I | collecting info in model.layers.0
25-01-15 02:34:38 | I | collecting info in model.layers.0
25-01-15 02:34:38 | I | collecting info in model.layers.0
25-01-15 02:34:38 | I | collecting info in model.layers.0
25-01-15 02:34:38 | I | collecting info in model.layers.0
25-01-15 02:34:38 | I | collecting info in model.layers.0
25-01-15 02:34:38 | I | collecting info in model.layers.0
25-01-15 02:34:38 | I | collecting info in model.layers.0
25-01-15 02:34:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:34:42 | I |       - range scale = [    1.0000]
25-01-15 02:34:42 | I |         sum  error  = [    0.1249]
25-01-15 02:34:42 | I |         best error  = [    0.1249]
25-01-15 02:34:42 | I |     + error = [0.1249]
25-01-15 02:34:43 | I |       - range scale = [    1.0000]
25-01-15 02:34:43 | I |         sum  error  = [    1.3756]
25-01-15 02:34:43 | I |         best error  = [    1.3756]
25-01-15 02:34:43 | I |     + error = [1.3756]
25-01-15 02:34:44 | I |       - range scale = [    1.0000]
25-01-15 02:34:44 | I |         sum  error  = [    0.1475]
25-01-15 02:34:44 | I |         best error  = [    0.1475]
25-01-15 02:34:44 | I |     + error = [0.1475]
25-01-15 02:34:45 | I |       - range scale = [    1.0000]
25-01-15 02:34:45 | I |         sum  error  = [    1.6876]
25-01-15 02:34:45 | I |         best error  = [    1.6876]
25-01-15 02:34:45 | I |     + error = [1.6876]
25-01-15 02:34:46 | I |       - range scale = [    1.0000]
25-01-15 02:34:46 | I |         sum  error  = [    0.0123]
25-01-15 02:34:46 | I |         best error  = [    0.0123]
25-01-15 02:34:46 | I |     + error = [0.0123]
25-01-15 02:34:47 | I |       - range scale = [    1.0000]
25-01-15 02:34:47 | I |         sum  error  = [    0.1421]
25-01-15 02:34:47 | I |         best error  = [    0.1421]
25-01-15 02:34:47 | I |     + error = [0.1421]
25-01-15 02:34:48 | I |       - range scale = [    1.0000]
25-01-15 02:34:48 | I |         sum  error  = [    0.0536]
25-01-15 02:34:48 | I |         best error  = [    0.0536]
25-01-15 02:34:48 | I |     + error = [0.0536]
25-01-15 02:34:48 | I |       - range scale = [    1.0000]
25-01-15 02:34:48 | I |         sum  error  = [    0.5450]
25-01-15 02:34:48 | I |         best error  = [    0.5450]
25-01-15 02:34:48 | I |     + error = [0.5450]
25-01-15 02:34:49 | I |       - range scale = [    1.0000]
25-01-15 02:34:49 | I |         sum  error  = [    0.3252]
25-01-15 02:34:49 | I |         best error  = [    0.3252]
25-01-15 02:34:49 | I |     + error = [0.3252]
25-01-15 02:34:50 | I |       - range scale = [    1.0000]
25-01-15 02:34:50 | I |         sum  error  = [    3.7142]
25-01-15 02:34:50 | I |         best error  = [    3.7142]
25-01-15 02:34:50 | I |     + error = [3.7142]
25-01-15 02:34:51 | I |       - range scale = [    1.0000]
25-01-15 02:34:51 | I |         sum  error  = [    1.3423]
25-01-15 02:34:51 | I |         best error  = [    1.3423]
25-01-15 02:34:51 | I |     + error = [1.3423]
25-01-15 02:34:52 | I |       - range scale = [    1.0000]
25-01-15 02:34:52 | I |         sum  error  = [   15.5390]
25-01-15 02:34:52 | I |         best error  = [   15.5390]
25-01-15 02:34:52 | I |     + error = [15.5390]
25-01-15 02:34:52 | I |       - range scale = [    1.0000]
25-01-15 02:34:52 | I |         sum  error  = [    8.4956]
25-01-15 02:34:52 | I |         best error  = [    8.4956]
25-01-15 02:34:52 | I |     + error = [8.4956]
25-01-15 02:34:53 | I |       - range scale = [    1.0000]
25-01-15 02:34:53 | I |         sum  error  = [   44.9053]
25-01-15 02:34:53 | I |         best error  = [   44.9053]
25-01-15 02:34:53 | I |     + error = [44.9053]
25-01-15 02:35:05 | I | in valid, quantize current layer acts
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:05 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting info in model.layers.0
25-01-15 02:35:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:11 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-15 02:35:11 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:35:11 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:35:11 | I | - Evaluator: gptq
25-01-15 02:35:11 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:35:11 | I | - Batch_size: 8
25-01-15 02:35:11 | I |   + Max_seq_length: 2048
25-01-15 02:35:39 | I |     - Results:
25-01-15 02:35:39 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-15 02:35:39 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-15 02:35:39 | I |       |wikitext |      1|word_perplexity|7.7978|±  |7.7978|
25-01-15 02:35:39 | I |       |val_valid|      1|word_perplexity|7.4908|±  |7.4908|
25-01-15 02:35:39 | I |       
25-01-15 02:35:57 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.639, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.23, wps=25677.2, wpb=4058.2, bsz=2, num_updates=2, lmquant_ppl_wikitext_all_quanted=7.70778, lmquant_ppl_val_all_quanted=7.4138, lmquant_ppl_wikitext_partly_quanted=7.79785, lmquant_ppl_val_partly_quanted=7.49077
25-01-15 02:35:57 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.639 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.23 | wps 25677.2 | wpb 4058.2 | bsz 2 | num_updates 2 | lmquant_ppl_wikitext_all_quanted 7.70778 | lmquant_ppl_val_all_quanted 7.4138 | lmquant_ppl_wikitext_partly_quanted 7.79785 | lmquant_ppl_val_partly_quanted 7.49077
25-01-15 02:35:57 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:35:57 | I | in layer model.layers.0
25-01-15 02:35:57 | I | quantizing weights for layer model.layers.0
25-01-15 02:35:57 | I | collecting info in model.layers.0
25-01-15 02:35:57 | I | collecting info in model.layers.0
25-01-15 02:35:57 | I | collecting info in model.layers.0
25-01-15 02:35:57 | I | collecting info in model.layers.0
25-01-15 02:35:58 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:58 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:58 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:58 | I | collecting calibration activations in model.layers.0
25-01-15 02:35:58 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:35:58 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:35:59 | I |       - range scale = [    1.0000]
25-01-15 02:35:59 | I |         sum  error  = [    0.0444]
25-01-15 02:35:59 | I |         best error  = [    0.0444]
25-01-15 02:35:59 | I |     + error = [0.0444]
25-01-15 02:36:00 | I |       - range scale = [    1.0000]
25-01-15 02:36:00 | I |         sum  error  = [    0.4922]
25-01-15 02:36:00 | I |         best error  = [    0.4922]
25-01-15 02:36:00 | I |     + error = [0.4922]
25-01-15 02:36:00 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:36:01 | I |       - range scale = [    1.0000]
25-01-15 02:36:01 | I |         sum  error  = [    0.0523]
25-01-15 02:36:01 | I |         best error  = [    0.0523]
25-01-15 02:36:01 | I |     + error = [0.0523]
25-01-15 02:36:01 | I |       - range scale = [    1.0000]
25-01-15 02:36:01 | I |         sum  error  = [    0.5843]
25-01-15 02:36:01 | I |         best error  = [    0.5843]
25-01-15 02:36:01 | I |     + error = [0.5843]
25-01-15 02:36:01 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:36:02 | I |       - range scale = [    1.0000]
25-01-15 02:36:02 | I |         sum  error  = [    0.0123]
25-01-15 02:36:02 | I |         best error  = [    0.0123]
25-01-15 02:36:02 | I |     + error = [0.0123]
25-01-15 02:36:03 | I |       - range scale = [    1.0000]
25-01-15 02:36:03 | I |         sum  error  = [    0.1424]
25-01-15 02:36:03 | I |         best error  = [    0.1424]
25-01-15 02:36:03 | I |     + error = [0.1424]
25-01-15 02:36:03 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:36:04 | I |       - range scale = [    1.0000]
25-01-15 02:36:04 | I |         sum  error  = [    0.0555]
25-01-15 02:36:04 | I |         best error  = [    0.0555]
25-01-15 02:36:04 | I |     + error = [0.0555]
25-01-15 02:36:04 | I |       - range scale = [    1.0000]
25-01-15 02:36:04 | I |         sum  error  = [    0.5640]
25-01-15 02:36:04 | I |         best error  = [    0.5640]
25-01-15 02:36:04 | I |     + error = [0.5640]
25-01-15 02:36:04 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:36:05 | I |       - range scale = [    1.0000]
25-01-15 02:36:05 | I |         sum  error  = [    0.3237]
25-01-15 02:36:05 | I |         best error  = [    0.3237]
25-01-15 02:36:05 | I |     + error = [0.3237]
25-01-15 02:36:06 | I |       - range scale = [    1.0000]
25-01-15 02:36:06 | I |         sum  error  = [    3.6946]
25-01-15 02:36:06 | I |         best error  = [    3.6946]
25-01-15 02:36:06 | I |     + error = [3.6946]
25-01-15 02:36:06 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:36:07 | I |       - range scale = [    1.0000]
25-01-15 02:36:07 | I |         sum  error  = [    1.3356]
25-01-15 02:36:07 | I |         best error  = [    1.3356]
25-01-15 02:36:07 | I |     + error = [1.3356]
25-01-15 02:36:07 | I |       - range scale = [    1.0000]
25-01-15 02:36:07 | I |         sum  error  = [   15.4521]
25-01-15 02:36:07 | I |         best error  = [   15.4521]
25-01-15 02:36:07 | I |     + error = [15.4521]
25-01-15 02:36:08 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:36:08 | I |       - range scale = [    1.0000]
25-01-15 02:36:08 | I |         sum  error  = [    6.5471]
25-01-15 02:36:08 | I |         best error  = [    6.5471]
25-01-15 02:36:08 | I |     + error = [6.5471]
25-01-15 02:36:09 | I |       - range scale = [    1.0000]
25-01-15 02:36:09 | I |         sum  error  = [   34.6208]
25-01-15 02:36:09 | I |         best error  = [   34.6208]
25-01-15 02:36:09 | I |     + error = [34.6208]
25-01-15 02:36:09 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:36:11 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:36:12 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:36:13 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:36:15 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:36:16 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:36:17 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:36:20 | I | quantizing activations for layer model.layers.0
25-01-15 02:36:20 | I | collecting info in model.layers.0
25-01-15 02:36:21 | I | collecting info in model.layers.0
25-01-15 02:36:21 | I | collecting info in model.layers.0
25-01-15 02:36:21 | I | collecting info in model.layers.0
25-01-15 02:36:21 | I | collecting calibration activations in model.layers.0
25-01-15 02:36:21 | I | collecting calibration activations in model.layers.0
25-01-15 02:36:21 | I | collecting calibration activations in model.layers.0
25-01-15 02:36:21 | I | collecting calibration activations in model.layers.0
25-01-15 02:36:23 | I | forward this layer
25-01-15 02:36:23 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/26.pt
25-01-15 02:36:23 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/26.pt
25-01-15 02:36:23 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:36:23 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:36:23 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:36:23 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:36:23 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:36:23 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:36:23 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:36:23 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:36:23 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:36:23 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:36:23 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:36:23 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:36:23 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:36:23 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:36:23 | I | in layer model.layers.0
25-01-15 02:36:23 | I | quantizing weights for layer model.layers.0
25-01-15 02:36:23 | I | collecting info in model.layers.0
25-01-15 02:36:23 | I | collecting info in model.layers.0
25-01-15 02:36:23 | I | collecting info in model.layers.0
25-01-15 02:36:23 | I | collecting info in model.layers.0
25-01-15 02:36:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:36:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:36:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:36:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:36:24 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:36:24 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:36:25 | I |       - range scale = [    1.0000]
25-01-15 02:36:25 | I |         sum  error  = [    0.0477]
25-01-15 02:36:25 | I |         best error  = [    0.0477]
25-01-15 02:36:25 | I |     + error = [0.0477]
25-01-15 02:36:26 | I |       - range scale = [    1.0000]
25-01-15 02:36:26 | I |         sum  error  = [    0.5391]
25-01-15 02:36:26 | I |         best error  = [    0.5391]
25-01-15 02:36:26 | I |     + error = [0.5391]
25-01-15 02:36:26 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:36:26 | I |       - range scale = [    1.0000]
25-01-15 02:36:26 | I |         sum  error  = [    0.0548]
25-01-15 02:36:26 | I |         best error  = [    0.0548]
25-01-15 02:36:26 | I |     + error = [0.0548]
25-01-15 02:36:27 | I |       - range scale = [    1.0000]
25-01-15 02:36:27 | I |         sum  error  = [    0.5974]
25-01-15 02:36:27 | I |         best error  = [    0.5974]
25-01-15 02:36:27 | I |     + error = [0.5974]
25-01-15 02:36:27 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:36:28 | I |       - range scale = [    1.0000]
25-01-15 02:36:28 | I |         sum  error  = [    0.0123]
25-01-15 02:36:28 | I |         best error  = [    0.0123]
25-01-15 02:36:28 | I |     + error = [0.0123]
25-01-15 02:36:29 | I |       - range scale = [    1.0000]
25-01-15 02:36:29 | I |         sum  error  = [    0.1416]
25-01-15 02:36:29 | I |         best error  = [    0.1416]
25-01-15 02:36:29 | I |     + error = [0.1416]
25-01-15 02:36:29 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:36:29 | I |       - range scale = [    1.0000]
25-01-15 02:36:29 | I |         sum  error  = [    0.0519]
25-01-15 02:36:29 | I |         best error  = [    0.0519]
25-01-15 02:36:29 | I |     + error = [0.0519]
25-01-15 02:36:30 | I |       - range scale = [    1.0000]
25-01-15 02:36:30 | I |         sum  error  = [    0.5228]
25-01-15 02:36:30 | I |         best error  = [    0.5228]
25-01-15 02:36:30 | I |     + error = [0.5228]
25-01-15 02:36:30 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:36:31 | I |       - range scale = [    1.0000]
25-01-15 02:36:31 | I |         sum  error  = [    0.3235]
25-01-15 02:36:31 | I |         best error  = [    0.3235]
25-01-15 02:36:31 | I |     + error = [0.3235]
25-01-15 02:36:32 | I |       - range scale = [    1.0000]
25-01-15 02:36:32 | I |         sum  error  = [    3.6906]
25-01-15 02:36:32 | I |         best error  = [    3.6906]
25-01-15 02:36:32 | I |     + error = [3.6906]
25-01-15 02:36:32 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:36:32 | I |       - range scale = [    1.0000]
25-01-15 02:36:32 | I |         sum  error  = [    1.3328]
25-01-15 02:36:32 | I |         best error  = [    1.3328]
25-01-15 02:36:32 | I |     + error = [1.3328]
25-01-15 02:36:33 | I |       - range scale = [    1.0000]
25-01-15 02:36:33 | I |         sum  error  = [   15.4402]
25-01-15 02:36:33 | I |         best error  = [   15.4402]
25-01-15 02:36:33 | I |     + error = [15.4402]
25-01-15 02:36:33 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:36:34 | I |       - range scale = [    1.0000]
25-01-15 02:36:34 | I |         sum  error  = [    8.1331]
25-01-15 02:36:34 | I |         best error  = [    8.1331]
25-01-15 02:36:34 | I |     + error = [8.1331]
25-01-15 02:36:35 | I |       - range scale = [    1.0000]
25-01-15 02:36:35 | I |         sum  error  = [   42.2785]
25-01-15 02:36:35 | I |         best error  = [   42.2785]
25-01-15 02:36:35 | I |     + error = [42.2785]
25-01-15 02:36:35 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:36:36 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:36:38 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:36:39 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:36:41 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:36:42 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:36:43 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:36:47 | I | quantizing activations for layer model.layers.0
25-01-15 02:36:47 | I | collecting info in model.layers.0
25-01-15 02:36:47 | I | collecting info in model.layers.0
25-01-15 02:36:47 | I | collecting info in model.layers.0
25-01-15 02:36:47 | I | collecting info in model.layers.0
25-01-15 02:36:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:36:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:36:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:36:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:36:49 | I | forward this layer
25-01-15 02:36:49 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/27.pt
25-01-15 02:36:49 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/27.pt
25-01-15 02:36:49 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:36:49 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:36:49 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:36:49 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:36:49 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:36:49 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:36:49 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:36:49 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:36:49 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:36:49 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:36:49 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:36:49 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:36:49 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:36:49 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:36:49 | I | [2] done with optimizer step
25-01-15 02:36:49 | I | epoch 001:     14 / 409600000 loss=0.000205112, loss_per_token=0.42007, loss_sum=13764.9, wps=191.6, ups=0.01, wpb=32768, bsz=64, num_updates=3, lr=9e-06, gnorm=0.432, clip=0, loss_scale=0.0625, train_wall=52, cuda_gb_allocated=10.1, cuda_gb_reserved=11.4, cuda_gb_free=13.6, wall=1279
25-01-15 02:36:49 | I | begin validation on "valid" subset on rank 0
25-01-15 02:36:49 | I | got valid iterator on "valid" subset on rank 0
25-01-15 02:36:49 | I | Valid: Start iterating over samples
25-01-15 02:36:49 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:36:49 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:36:49 | I | - Evaluator: gptq
25-01-15 02:36:49 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:36:49 | I | - Batch_size: 8
25-01-15 02:36:49 | I |   + Max_seq_length: 2048
25-01-15 02:37:15 | I |     - Results:
25-01-15 02:37:15 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-15 02:37:15 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-15 02:37:15 | I |       |wikitext |      1|word_perplexity|7.7078|±  |7.7078|
25-01-15 02:37:15 | I |       |val_valid|      1|word_perplexity|7.4138|±  |7.4138|
25-01-15 02:37:15 | I |       
25-01-15 02:37:15 | I | in valid, quantize current layer weights
25-01-15 02:37:16 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:28 | I | collecting info in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:33 | I |       - range scale = [    1.0000]
25-01-15 02:37:33 | I |         sum  error  = [    0.1249]
25-01-15 02:37:33 | I |         best error  = [    0.1249]
25-01-15 02:37:33 | I |     + error = [0.1249]
25-01-15 02:37:34 | I |       - range scale = [    1.0000]
25-01-15 02:37:34 | I |         sum  error  = [    1.3756]
25-01-15 02:37:34 | I |         best error  = [    1.3756]
25-01-15 02:37:34 | I |     + error = [1.3756]
25-01-15 02:37:35 | I |       - range scale = [    1.0000]
25-01-15 02:37:35 | I |         sum  error  = [    0.1475]
25-01-15 02:37:35 | I |         best error  = [    0.1475]
25-01-15 02:37:35 | I |     + error = [0.1475]
25-01-15 02:37:36 | I |       - range scale = [    1.0000]
25-01-15 02:37:36 | I |         sum  error  = [    1.6876]
25-01-15 02:37:36 | I |         best error  = [    1.6876]
25-01-15 02:37:36 | I |     + error = [1.6876]
25-01-15 02:37:37 | I |       - range scale = [    1.0000]
25-01-15 02:37:37 | I |         sum  error  = [    0.0123]
25-01-15 02:37:37 | I |         best error  = [    0.0123]
25-01-15 02:37:37 | I |     + error = [0.0123]
25-01-15 02:37:37 | I |       - range scale = [    1.0000]
25-01-15 02:37:37 | I |         sum  error  = [    0.1421]
25-01-15 02:37:37 | I |         best error  = [    0.1421]
25-01-15 02:37:37 | I |     + error = [0.1421]
25-01-15 02:37:38 | I |       - range scale = [    1.0000]
25-01-15 02:37:38 | I |         sum  error  = [    0.0536]
25-01-15 02:37:38 | I |         best error  = [    0.0536]
25-01-15 02:37:38 | I |     + error = [0.0536]
25-01-15 02:37:39 | I |       - range scale = [    1.0000]
25-01-15 02:37:39 | I |         sum  error  = [    0.5450]
25-01-15 02:37:39 | I |         best error  = [    0.5450]
25-01-15 02:37:39 | I |     + error = [0.5450]
25-01-15 02:37:40 | I |       - range scale = [    1.0000]
25-01-15 02:37:40 | I |         sum  error  = [    0.3252]
25-01-15 02:37:40 | I |         best error  = [    0.3252]
25-01-15 02:37:40 | I |     + error = [0.3252]
25-01-15 02:37:41 | I |       - range scale = [    1.0000]
25-01-15 02:37:41 | I |         sum  error  = [    3.7142]
25-01-15 02:37:41 | I |         best error  = [    3.7142]
25-01-15 02:37:41 | I |     + error = [3.7142]
25-01-15 02:37:41 | I |       - range scale = [    1.0000]
25-01-15 02:37:41 | I |         sum  error  = [    1.3423]
25-01-15 02:37:41 | I |         best error  = [    1.3423]
25-01-15 02:37:41 | I |     + error = [1.3423]
25-01-15 02:37:42 | I |       - range scale = [    1.0000]
25-01-15 02:37:42 | I |         sum  error  = [   15.5390]
25-01-15 02:37:42 | I |         best error  = [   15.5390]
25-01-15 02:37:42 | I |     + error = [15.5390]
25-01-15 02:37:43 | I |       - range scale = [    1.0000]
25-01-15 02:37:43 | I |         sum  error  = [    8.4956]
25-01-15 02:37:43 | I |         best error  = [    8.4956]
25-01-15 02:37:43 | I |     + error = [8.4956]
25-01-15 02:37:44 | I |       - range scale = [    1.0000]
25-01-15 02:37:44 | I |         sum  error  = [   44.9053]
25-01-15 02:37:44 | I |         best error  = [   44.9053]
25-01-15 02:37:44 | I |     + error = [44.9053]
25-01-15 02:37:57 | I | in valid, quantize current layer acts
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:57 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting info in model.layers.0
25-01-15 02:37:58 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:58 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:58 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:58 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:58 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:58 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:58 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:58 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:58 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:58 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:58 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:58 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:37:59 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:03 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-15 02:38:03 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:38:03 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:38:03 | I | - Evaluator: gptq
25-01-15 02:38:03 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:38:03 | I | - Batch_size: 8
25-01-15 02:38:03 | I |   + Max_seq_length: 2048
25-01-15 02:38:31 | I |     - Results:
25-01-15 02:38:31 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-15 02:38:31 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-15 02:38:31 | I |       |wikitext |      1|word_perplexity|7.7978|±  |7.7978|
25-01-15 02:38:31 | I |       |val_valid|      1|word_perplexity|7.4908|±  |7.4908|
25-01-15 02:38:31 | I |       
25-01-15 02:38:49 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.639, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.23, wps=25699.3, wpb=4058.2, bsz=2, num_updates=3, lmquant_ppl_wikitext_all_quanted=7.70778, lmquant_ppl_val_all_quanted=7.4138, lmquant_ppl_wikitext_partly_quanted=7.79785, lmquant_ppl_val_partly_quanted=7.49077
25-01-15 02:38:49 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.639 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.23 | wps 25699.3 | wpb 4058.2 | bsz 2 | num_updates 3 | lmquant_ppl_wikitext_all_quanted 7.70778 | lmquant_ppl_val_all_quanted 7.4138 | lmquant_ppl_wikitext_partly_quanted 7.79785 | lmquant_ppl_val_partly_quanted 7.49077
25-01-15 02:38:50 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:38:50 | I | in layer model.layers.0
25-01-15 02:38:50 | I | quantizing weights for layer model.layers.0
25-01-15 02:38:50 | I | collecting info in model.layers.0
25-01-15 02:38:50 | I | collecting info in model.layers.0
25-01-15 02:38:50 | I | collecting info in model.layers.0
25-01-15 02:38:50 | I | collecting info in model.layers.0
25-01-15 02:38:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:38:51 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:38:51 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:38:51 | I |       - range scale = [    1.0000]
25-01-15 02:38:51 | I |         sum  error  = [    0.0474]
25-01-15 02:38:51 | I |         best error  = [    0.0474]
25-01-15 02:38:51 | I |     + error = [0.0474]
25-01-15 02:38:52 | I |       - range scale = [    1.0000]
25-01-15 02:38:52 | I |         sum  error  = [    0.5046]
25-01-15 02:38:52 | I |         best error  = [    0.5046]
25-01-15 02:38:52 | I |     + error = [0.5046]
25-01-15 02:38:52 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:38:53 | I |       - range scale = [    1.0000]
25-01-15 02:38:53 | I |         sum  error  = [    0.0566]
25-01-15 02:38:53 | I |         best error  = [    0.0566]
25-01-15 02:38:53 | I |     + error = [0.0566]
25-01-15 02:38:54 | I |       - range scale = [    1.0000]
25-01-15 02:38:54 | I |         sum  error  = [    0.6252]
25-01-15 02:38:54 | I |         best error  = [    0.6252]
25-01-15 02:38:54 | I |     + error = [0.6252]
25-01-15 02:38:54 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:38:54 | I |       - range scale = [    1.0000]
25-01-15 02:38:54 | I |         sum  error  = [    0.0123]
25-01-15 02:38:54 | I |         best error  = [    0.0123]
25-01-15 02:38:54 | I |     + error = [0.0123]
25-01-15 02:38:55 | I |       - range scale = [    1.0000]
25-01-15 02:38:55 | I |         sum  error  = [    0.1425]
25-01-15 02:38:55 | I |         best error  = [    0.1425]
25-01-15 02:38:55 | I |     + error = [0.1425]
25-01-15 02:38:55 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:38:56 | I |       - range scale = [    1.0000]
25-01-15 02:38:56 | I |         sum  error  = [    0.0594]
25-01-15 02:38:56 | I |         best error  = [    0.0594]
25-01-15 02:38:56 | I |     + error = [0.0594]
25-01-15 02:38:57 | I |       - range scale = [    1.0000]
25-01-15 02:38:57 | I |         sum  error  = [    0.6006]
25-01-15 02:38:57 | I |         best error  = [    0.6006]
25-01-15 02:38:57 | I |     + error = [0.6006]
25-01-15 02:38:57 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:38:58 | I |       - range scale = [    1.0000]
25-01-15 02:38:58 | I |         sum  error  = [    0.3241]
25-01-15 02:38:58 | I |         best error  = [    0.3241]
25-01-15 02:38:58 | I |     + error = [0.3241]
25-01-15 02:38:58 | I |       - range scale = [    1.0000]
25-01-15 02:38:58 | I |         sum  error  = [    3.6979]
25-01-15 02:38:58 | I |         best error  = [    3.6979]
25-01-15 02:38:58 | I |     + error = [3.6979]
25-01-15 02:38:59 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:38:59 | I |       - range scale = [    1.0000]
25-01-15 02:38:59 | I |         sum  error  = [    1.3359]
25-01-15 02:38:59 | I |         best error  = [    1.3359]
25-01-15 02:38:59 | I |     + error = [1.3359]
25-01-15 02:39:00 | I |       - range scale = [    1.0000]
25-01-15 02:39:00 | I |         sum  error  = [   15.4705]
25-01-15 02:39:00 | I |         best error  = [   15.4705]
25-01-15 02:39:00 | I |     + error = [15.4705]
25-01-15 02:39:00 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:39:01 | I |       - range scale = [    1.0000]
25-01-15 02:39:01 | I |         sum  error  = [    6.7869]
25-01-15 02:39:01 | I |         best error  = [    6.7869]
25-01-15 02:39:01 | I |     + error = [6.7869]
25-01-15 02:39:02 | I |       - range scale = [    1.0000]
25-01-15 02:39:02 | I |         sum  error  = [   37.2134]
25-01-15 02:39:02 | I |         best error  = [   37.2134]
25-01-15 02:39:02 | I |     + error = [37.2134]
25-01-15 02:39:02 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:39:03 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:39:04 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:39:06 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:39:07 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:39:09 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:39:10 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:39:13 | I | quantizing activations for layer model.layers.0
25-01-15 02:39:13 | I | collecting info in model.layers.0
25-01-15 02:39:13 | I | collecting info in model.layers.0
25-01-15 02:39:13 | I | collecting info in model.layers.0
25-01-15 02:39:13 | I | collecting info in model.layers.0
25-01-15 02:39:14 | I | collecting calibration activations in model.layers.0
25-01-15 02:39:14 | I | collecting calibration activations in model.layers.0
25-01-15 02:39:14 | I | collecting calibration activations in model.layers.0
25-01-15 02:39:14 | I | collecting calibration activations in model.layers.0
25-01-15 02:39:16 | I | forward this layer
25-01-15 02:39:16 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/28.pt
25-01-15 02:39:16 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/28.pt
25-01-15 02:39:16 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:39:16 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:39:16 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:39:16 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:39:16 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:39:16 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:39:16 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:39:16 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:39:16 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:39:16 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:39:16 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:39:16 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:39:16 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:39:16 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:39:16 | I | in layer model.layers.0
25-01-15 02:39:16 | I | quantizing weights for layer model.layers.0
25-01-15 02:39:16 | I | collecting info in model.layers.0
25-01-15 02:39:16 | I | collecting info in model.layers.0
25-01-15 02:39:16 | I | collecting info in model.layers.0
25-01-15 02:39:16 | I | collecting info in model.layers.0
25-01-15 02:39:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:39:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:39:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:39:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:39:17 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:39:17 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:39:18 | I |       - range scale = [    1.0000]
25-01-15 02:39:18 | I |         sum  error  = [    0.0449]
25-01-15 02:39:18 | I |         best error  = [    0.0449]
25-01-15 02:39:18 | I |     + error = [0.0449]
25-01-15 02:39:18 | I |       - range scale = [    1.0000]
25-01-15 02:39:18 | I |         sum  error  = [    0.4717]
25-01-15 02:39:18 | I |         best error  = [    0.4717]
25-01-15 02:39:18 | I |     + error = [0.4717]
25-01-15 02:39:19 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:39:19 | I |       - range scale = [    1.0000]
25-01-15 02:39:19 | I |         sum  error  = [    0.0550]
25-01-15 02:39:19 | I |         best error  = [    0.0550]
25-01-15 02:39:19 | I |     + error = [0.0550]
25-01-15 02:39:20 | I |       - range scale = [    1.0000]
25-01-15 02:39:20 | I |         sum  error  = [    0.6114]
25-01-15 02:39:20 | I |         best error  = [    0.6114]
25-01-15 02:39:20 | I |     + error = [0.6114]
25-01-15 02:39:20 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:39:21 | I |       - range scale = [    1.0000]
25-01-15 02:39:21 | I |         sum  error  = [    0.0122]
25-01-15 02:39:21 | I |         best error  = [    0.0122]
25-01-15 02:39:21 | I |     + error = [0.0122]
25-01-15 02:39:22 | I |       - range scale = [    1.0000]
25-01-15 02:39:22 | I |         sum  error  = [    0.1437]
25-01-15 02:39:22 | I |         best error  = [    0.1437]
25-01-15 02:39:22 | I |     + error = [0.1437]
25-01-15 02:39:22 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:39:23 | I |       - range scale = [    1.0000]
25-01-15 02:39:23 | I |         sum  error  = [    0.0634]
25-01-15 02:39:23 | I |         best error  = [    0.0634]
25-01-15 02:39:23 | I |     + error = [0.0634]
25-01-15 02:39:23 | I |       - range scale = [    1.0000]
25-01-15 02:39:23 | I |         sum  error  = [    0.6456]
25-01-15 02:39:23 | I |         best error  = [    0.6456]
25-01-15 02:39:23 | I |     + error = [0.6456]
25-01-15 02:39:23 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:39:24 | I |       - range scale = [    1.0000]
25-01-15 02:39:24 | I |         sum  error  = [    0.3241]
25-01-15 02:39:24 | I |         best error  = [    0.3241]
25-01-15 02:39:24 | I |     + error = [0.3241]
25-01-15 02:39:25 | I |       - range scale = [    1.0000]
25-01-15 02:39:25 | I |         sum  error  = [    3.7027]
25-01-15 02:39:25 | I |         best error  = [    3.7027]
25-01-15 02:39:25 | I |     + error = [3.7027]
25-01-15 02:39:25 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:39:26 | I |       - range scale = [    1.0000]
25-01-15 02:39:26 | I |         sum  error  = [    1.3399]
25-01-15 02:39:26 | I |         best error  = [    1.3399]
25-01-15 02:39:26 | I |     + error = [1.3399]
25-01-15 02:39:27 | I |       - range scale = [    1.0000]
25-01-15 02:39:27 | I |         sum  error  = [   15.4860]
25-01-15 02:39:27 | I |         best error  = [   15.4860]
25-01-15 02:39:27 | I |     + error = [15.4860]
25-01-15 02:39:27 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:39:27 | I |       - range scale = [    1.0000]
25-01-15 02:39:27 | I |         sum  error  = [    6.2927]
25-01-15 02:39:27 | I |         best error  = [    6.2927]
25-01-15 02:39:27 | I |     + error = [6.2927]
25-01-15 02:39:28 | I |       - range scale = [    1.0000]
25-01-15 02:39:28 | I |         sum  error  = [   35.1970]
25-01-15 02:39:28 | I |         best error  = [   35.1970]
25-01-15 02:39:28 | I |     + error = [35.1970]
25-01-15 02:39:28 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:39:30 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:39:31 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:39:33 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:39:34 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:39:35 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:39:37 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:39:40 | I | quantizing activations for layer model.layers.0
25-01-15 02:39:40 | I | collecting info in model.layers.0
25-01-15 02:39:40 | I | collecting info in model.layers.0
25-01-15 02:39:40 | I | collecting info in model.layers.0
25-01-15 02:39:40 | I | collecting info in model.layers.0
25-01-15 02:39:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:39:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:39:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:39:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:39:43 | I | forward this layer
25-01-15 02:39:43 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/29.pt
25-01-15 02:39:43 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/29.pt
25-01-15 02:39:43 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:39:43 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:39:43 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:39:43 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:39:43 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:39:43 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:39:43 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:39:43 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:39:43 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:39:43 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:39:43 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:39:43 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:39:43 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:39:43 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:39:43 | I | [3] done with optimizer step
25-01-15 02:39:43 | I | epoch 001:     15 / 409600000 loss=0.000153282, loss_per_token=0.313922, loss_sum=10286.6, wps=188.6, ups=0.01, wpb=32768, bsz=64, num_updates=4, lr=1.2e-05, gnorm=0.39, clip=0, loss_scale=0.0625, train_wall=54, cuda_gb_allocated=10.1, cuda_gb_reserved=11.4, cuda_gb_free=13.6, wall=1453
25-01-15 02:39:43 | I | begin validation on "valid" subset on rank 0
25-01-15 02:39:43 | I | got valid iterator on "valid" subset on rank 0
25-01-15 02:39:43 | I | Valid: Start iterating over samples
25-01-15 02:39:43 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:39:43 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:39:43 | I | - Evaluator: gptq
25-01-15 02:39:43 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:39:43 | I | - Batch_size: 8
25-01-15 02:39:43 | I |   + Max_seq_length: 2048
25-01-15 02:40:09 | I |     - Results:
25-01-15 02:40:09 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-15 02:40:09 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-15 02:40:09 | I |       |wikitext |      1|word_perplexity|7.7078|±  |7.7078|
25-01-15 02:40:09 | I |       |val_valid|      1|word_perplexity|7.4138|±  |7.4138|
25-01-15 02:40:09 | I |       
25-01-15 02:40:09 | I | in valid, quantize current layer weights
25-01-15 02:40:10 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:22 | I | collecting info in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:27 | I |       - range scale = [    1.0000]
25-01-15 02:40:27 | I |         sum  error  = [    0.1249]
25-01-15 02:40:27 | I |         best error  = [    0.1249]
25-01-15 02:40:27 | I |     + error = [0.1249]
25-01-15 02:40:28 | I |       - range scale = [    1.0000]
25-01-15 02:40:28 | I |         sum  error  = [    1.3756]
25-01-15 02:40:28 | I |         best error  = [    1.3756]
25-01-15 02:40:28 | I |     + error = [1.3756]
25-01-15 02:40:29 | I |       - range scale = [    1.0000]
25-01-15 02:40:29 | I |         sum  error  = [    0.1475]
25-01-15 02:40:29 | I |         best error  = [    0.1475]
25-01-15 02:40:29 | I |     + error = [0.1475]
25-01-15 02:40:30 | I |       - range scale = [    1.0000]
25-01-15 02:40:30 | I |         sum  error  = [    1.6876]
25-01-15 02:40:30 | I |         best error  = [    1.6876]
25-01-15 02:40:30 | I |     + error = [1.6876]
25-01-15 02:40:31 | I |       - range scale = [    1.0000]
25-01-15 02:40:31 | I |         sum  error  = [    0.0123]
25-01-15 02:40:31 | I |         best error  = [    0.0123]
25-01-15 02:40:31 | I |     + error = [0.0123]
25-01-15 02:40:31 | I |       - range scale = [    1.0000]
25-01-15 02:40:31 | I |         sum  error  = [    0.1421]
25-01-15 02:40:31 | I |         best error  = [    0.1421]
25-01-15 02:40:31 | I |     + error = [0.1421]
25-01-15 02:40:32 | I |       - range scale = [    1.0000]
25-01-15 02:40:32 | I |         sum  error  = [    0.0536]
25-01-15 02:40:32 | I |         best error  = [    0.0536]
25-01-15 02:40:32 | I |     + error = [0.0536]
25-01-15 02:40:33 | I |       - range scale = [    1.0000]
25-01-15 02:40:33 | I |         sum  error  = [    0.5450]
25-01-15 02:40:33 | I |         best error  = [    0.5450]
25-01-15 02:40:33 | I |     + error = [0.5450]
25-01-15 02:40:34 | I |       - range scale = [    1.0000]
25-01-15 02:40:34 | I |         sum  error  = [    0.3252]
25-01-15 02:40:34 | I |         best error  = [    0.3252]
25-01-15 02:40:34 | I |     + error = [0.3252]
25-01-15 02:40:35 | I |       - range scale = [    1.0000]
25-01-15 02:40:35 | I |         sum  error  = [    3.7142]
25-01-15 02:40:35 | I |         best error  = [    3.7142]
25-01-15 02:40:35 | I |     + error = [3.7142]
25-01-15 02:40:36 | I |       - range scale = [    1.0000]
25-01-15 02:40:36 | I |         sum  error  = [    1.3423]
25-01-15 02:40:36 | I |         best error  = [    1.3423]
25-01-15 02:40:36 | I |     + error = [1.3423]
25-01-15 02:40:36 | I |       - range scale = [    1.0000]
25-01-15 02:40:36 | I |         sum  error  = [   15.5390]
25-01-15 02:40:36 | I |         best error  = [   15.5390]
25-01-15 02:40:36 | I |     + error = [15.5390]
25-01-15 02:40:37 | I |       - range scale = [    1.0000]
25-01-15 02:40:37 | I |         sum  error  = [    8.4956]
25-01-15 02:40:37 | I |         best error  = [    8.4956]
25-01-15 02:40:37 | I |     + error = [8.4956]
25-01-15 02:40:38 | I |       - range scale = [    1.0000]
25-01-15 02:40:38 | I |         sum  error  = [   44.9053]
25-01-15 02:40:38 | I |         best error  = [   44.9053]
25-01-15 02:40:38 | I |     + error = [44.9053]
25-01-15 02:40:51 | I | in valid, quantize current layer acts
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:51 | I | collecting info in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:40:57 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-15 02:40:57 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:40:57 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:40:57 | I | - Evaluator: gptq
25-01-15 02:40:57 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:40:57 | I | - Batch_size: 8
25-01-15 02:40:57 | I |   + Max_seq_length: 2048
25-01-15 02:41:25 | I |     - Results:
25-01-15 02:41:25 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-15 02:41:25 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-15 02:41:25 | I |       |wikitext |      1|word_perplexity|7.7978|±  |7.7978|
25-01-15 02:41:25 | I |       |val_valid|      1|word_perplexity|7.4908|±  |7.4908|
25-01-15 02:41:25 | I |       
25-01-15 02:41:43 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.639, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.23, wps=25600.9, wpb=4058.2, bsz=2, num_updates=4, lmquant_ppl_wikitext_all_quanted=7.70778, lmquant_ppl_val_all_quanted=7.4138, lmquant_ppl_wikitext_partly_quanted=7.79785, lmquant_ppl_val_partly_quanted=7.49077
25-01-15 02:41:43 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.639 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.23 | wps 25600.9 | wpb 4058.2 | bsz 2 | num_updates 4 | lmquant_ppl_wikitext_all_quanted 7.70778 | lmquant_ppl_val_all_quanted 7.4138 | lmquant_ppl_wikitext_partly_quanted 7.79785 | lmquant_ppl_val_partly_quanted 7.49077
25-01-15 02:41:43 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:41:43 | I | in layer model.layers.0
25-01-15 02:41:43 | I | quantizing weights for layer model.layers.0
25-01-15 02:41:43 | I | collecting info in model.layers.0
25-01-15 02:41:43 | I | collecting info in model.layers.0
25-01-15 02:41:43 | I | collecting info in model.layers.0
25-01-15 02:41:43 | I | collecting info in model.layers.0
25-01-15 02:41:44 | I | collecting calibration activations in model.layers.0
25-01-15 02:41:44 | I | collecting calibration activations in model.layers.0
25-01-15 02:41:44 | I | collecting calibration activations in model.layers.0
25-01-15 02:41:44 | I | collecting calibration activations in model.layers.0
25-01-15 02:41:44 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:41:44 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:41:45 | I |       - range scale = [    1.0000]
25-01-15 02:41:45 | I |         sum  error  = [    0.0448]
25-01-15 02:41:45 | I |         best error  = [    0.0448]
25-01-15 02:41:45 | I |     + error = [0.0448]
25-01-15 02:41:46 | I |       - range scale = [    1.0000]
25-01-15 02:41:46 | I |         sum  error  = [    0.4733]
25-01-15 02:41:46 | I |         best error  = [    0.4733]
25-01-15 02:41:46 | I |     + error = [0.4733]
25-01-15 02:41:46 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:41:47 | I |       - range scale = [    1.0000]
25-01-15 02:41:47 | I |         sum  error  = [    0.0516]
25-01-15 02:41:47 | I |         best error  = [    0.0516]
25-01-15 02:41:47 | I |     + error = [0.0516]
25-01-15 02:41:47 | I |       - range scale = [    1.0000]
25-01-15 02:41:47 | I |         sum  error  = [    0.5961]
25-01-15 02:41:47 | I |         best error  = [    0.5961]
25-01-15 02:41:47 | I |     + error = [0.5961]
25-01-15 02:41:47 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:41:48 | I |       - range scale = [    1.0000]
25-01-15 02:41:48 | I |         sum  error  = [    0.0124]
25-01-15 02:41:48 | I |         best error  = [    0.0124]
25-01-15 02:41:48 | I |     + error = [0.0124]
25-01-15 02:41:49 | I |       - range scale = [    1.0000]
25-01-15 02:41:49 | I |         sum  error  = [    0.1426]
25-01-15 02:41:49 | I |         best error  = [    0.1426]
25-01-15 02:41:49 | I |     + error = [0.1426]
25-01-15 02:41:49 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:41:50 | I |       - range scale = [    1.0000]
25-01-15 02:41:50 | I |         sum  error  = [    0.0564]
25-01-15 02:41:50 | I |         best error  = [    0.0564]
25-01-15 02:41:50 | I |     + error = [0.0564]
25-01-15 02:41:50 | I |       - range scale = [    1.0000]
25-01-15 02:41:50 | I |         sum  error  = [    0.5765]
25-01-15 02:41:50 | I |         best error  = [    0.5765]
25-01-15 02:41:50 | I |     + error = [0.5765]
25-01-15 02:41:50 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:41:51 | I |       - range scale = [    1.0000]
25-01-15 02:41:51 | I |         sum  error  = [    0.3234]
25-01-15 02:41:51 | I |         best error  = [    0.3234]
25-01-15 02:41:51 | I |     + error = [0.3234]
25-01-15 02:41:52 | I |       - range scale = [    1.0000]
25-01-15 02:41:52 | I |         sum  error  = [    3.6955]
25-01-15 02:41:52 | I |         best error  = [    3.6955]
25-01-15 02:41:52 | I |     + error = [3.6955]
25-01-15 02:41:52 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:41:53 | I |       - range scale = [    1.0000]
25-01-15 02:41:53 | I |         sum  error  = [    1.3374]
25-01-15 02:41:53 | I |         best error  = [    1.3374]
25-01-15 02:41:53 | I |     + error = [1.3374]
25-01-15 02:41:54 | I |       - range scale = [    1.0000]
25-01-15 02:41:54 | I |         sum  error  = [   15.4603]
25-01-15 02:41:54 | I |         best error  = [   15.4603]
25-01-15 02:41:54 | I |     + error = [15.4603]
25-01-15 02:41:54 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:41:54 | I |       - range scale = [    1.0000]
25-01-15 02:41:54 | I |         sum  error  = [    5.4797]
25-01-15 02:41:54 | I |         best error  = [    5.4797]
25-01-15 02:41:54 | I |     + error = [5.4797]
25-01-15 02:41:55 | I |       - range scale = [    1.0000]
25-01-15 02:41:55 | I |         sum  error  = [   28.9811]
25-01-15 02:41:55 | I |         best error  = [   28.9811]
25-01-15 02:41:55 | I |     + error = [28.9811]
25-01-15 02:41:55 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:41:57 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:41:58 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:42:00 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:42:01 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:42:02 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:42:04 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:42:07 | I | quantizing activations for layer model.layers.0
25-01-15 02:42:07 | I | collecting info in model.layers.0
25-01-15 02:42:07 | I | collecting info in model.layers.0
25-01-15 02:42:07 | I | collecting info in model.layers.0
25-01-15 02:42:07 | I | collecting info in model.layers.0
25-01-15 02:42:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:42:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:42:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:42:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:42:10 | I | forward this layer
25-01-15 02:42:10 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/30.pt
25-01-15 02:42:10 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/30.pt
25-01-15 02:42:10 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:42:10 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:42:10 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:42:10 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:42:10 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:42:10 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:42:10 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:42:10 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:42:10 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:42:10 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:42:10 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:42:10 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:42:10 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:42:10 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:42:10 | I | in layer model.layers.0
25-01-15 02:42:10 | I | quantizing weights for layer model.layers.0
25-01-15 02:42:10 | I | collecting info in model.layers.0
25-01-15 02:42:10 | I | collecting info in model.layers.0
25-01-15 02:42:10 | I | collecting info in model.layers.0
25-01-15 02:42:10 | I | collecting info in model.layers.0
25-01-15 02:42:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:42:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:42:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:42:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:42:11 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:42:11 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:42:12 | I |       - range scale = [    1.0000]
25-01-15 02:42:12 | I |         sum  error  = [    0.0459]
25-01-15 02:42:12 | I |         best error  = [    0.0459]
25-01-15 02:42:12 | I |     + error = [0.0459]
25-01-15 02:42:12 | I |       - range scale = [    1.0000]
25-01-15 02:42:12 | I |         sum  error  = [    0.5062]
25-01-15 02:42:12 | I |         best error  = [    0.5062]
25-01-15 02:42:12 | I |     + error = [0.5062]
25-01-15 02:42:12 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:42:13 | I |       - range scale = [    1.0000]
25-01-15 02:42:13 | I |         sum  error  = [    0.0528]
25-01-15 02:42:13 | I |         best error  = [    0.0528]
25-01-15 02:42:13 | I |     + error = [0.0528]
25-01-15 02:42:14 | I |       - range scale = [    1.0000]
25-01-15 02:42:14 | I |         sum  error  = [    0.6133]
25-01-15 02:42:14 | I |         best error  = [    0.6133]
25-01-15 02:42:14 | I |     + error = [0.6133]
25-01-15 02:42:14 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:42:15 | I |       - range scale = [    1.0000]
25-01-15 02:42:15 | I |         sum  error  = [    0.0123]
25-01-15 02:42:15 | I |         best error  = [    0.0123]
25-01-15 02:42:15 | I |     + error = [0.0123]
25-01-15 02:42:15 | I |       - range scale = [    1.0000]
25-01-15 02:42:15 | I |         sum  error  = [    0.1425]
25-01-15 02:42:15 | I |         best error  = [    0.1425]
25-01-15 02:42:15 | I |     + error = [0.1425]
25-01-15 02:42:15 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:42:16 | I |       - range scale = [    1.0000]
25-01-15 02:42:16 | I |         sum  error  = [    0.0571]
25-01-15 02:42:16 | I |         best error  = [    0.0571]
25-01-15 02:42:16 | I |     + error = [0.0571]
25-01-15 02:42:17 | I |       - range scale = [    1.0000]
25-01-15 02:42:17 | I |         sum  error  = [    0.5782]
25-01-15 02:42:17 | I |         best error  = [    0.5782]
25-01-15 02:42:17 | I |     + error = [0.5782]
25-01-15 02:42:17 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:42:18 | I |       - range scale = [    1.0000]
25-01-15 02:42:18 | I |         sum  error  = [    0.3229]
25-01-15 02:42:18 | I |         best error  = [    0.3229]
25-01-15 02:42:18 | I |     + error = [0.3229]
25-01-15 02:42:18 | I |       - range scale = [    1.0000]
25-01-15 02:42:18 | I |         sum  error  = [    3.6954]
25-01-15 02:42:18 | I |         best error  = [    3.6954]
25-01-15 02:42:18 | I |     + error = [3.6954]
25-01-15 02:42:19 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:42:19 | I |       - range scale = [    1.0000]
25-01-15 02:42:19 | I |         sum  error  = [    1.3365]
25-01-15 02:42:19 | I |         best error  = [    1.3365]
25-01-15 02:42:19 | I |     + error = [1.3365]
25-01-15 02:42:20 | I |       - range scale = [    1.0000]
25-01-15 02:42:20 | I |         sum  error  = [   15.4577]
25-01-15 02:42:20 | I |         best error  = [   15.4577]
25-01-15 02:42:20 | I |     + error = [15.4577]
25-01-15 02:42:20 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:42:21 | I |       - range scale = [    1.0000]
25-01-15 02:42:21 | I |         sum  error  = [    7.4911]
25-01-15 02:42:21 | I |         best error  = [    7.4911]
25-01-15 02:42:21 | I |     + error = [7.4911]
25-01-15 02:42:22 | I |       - range scale = [    1.0000]
25-01-15 02:42:22 | I |         sum  error  = [   38.8311]
25-01-15 02:42:22 | I |         best error  = [   38.8311]
25-01-15 02:42:22 | I |     + error = [38.8311]
25-01-15 02:42:22 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:42:23 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:42:25 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:42:26 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:42:28 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:42:29 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:42:30 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:42:34 | I | quantizing activations for layer model.layers.0
25-01-15 02:42:34 | I | collecting info in model.layers.0
25-01-15 02:42:34 | I | collecting info in model.layers.0
25-01-15 02:42:34 | I | collecting info in model.layers.0
25-01-15 02:42:34 | I | collecting info in model.layers.0
25-01-15 02:42:34 | I | collecting calibration activations in model.layers.0
25-01-15 02:42:34 | I | collecting calibration activations in model.layers.0
25-01-15 02:42:34 | I | collecting calibration activations in model.layers.0
25-01-15 02:42:34 | I | collecting calibration activations in model.layers.0
25-01-15 02:42:36 | I | forward this layer
25-01-15 02:42:36 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/31.pt
25-01-15 02:42:36 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/31.pt
25-01-15 02:42:36 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:42:36 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:42:36 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:42:36 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:42:36 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:42:36 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:42:36 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:42:36 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:42:36 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:42:36 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:42:36 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:42:36 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:42:36 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:42:36 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:42:36 | I | [4] done with optimizer step
25-01-15 02:42:36 | I | epoch 001:     16 / 409600000 loss=0.000221295, loss_per_token=0.453211, loss_sum=14850.8, wps=189.2, ups=0.01, wpb=32768, bsz=64, num_updates=5, lr=1.5e-05, gnorm=0.513, clip=0, loss_scale=0.0625, train_wall=53, cuda_gb_allocated=10.1, cuda_gb_reserved=11.4, cuda_gb_free=13.6, wall=1626
25-01-15 02:42:36 | I | begin validation on "valid" subset on rank 0
25-01-15 02:42:36 | I | got valid iterator on "valid" subset on rank 0
25-01-15 02:42:36 | I | Valid: Start iterating over samples
25-01-15 02:42:36 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:42:36 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:42:36 | I | - Evaluator: gptq
25-01-15 02:42:36 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:42:36 | I | - Batch_size: 8
25-01-15 02:42:36 | I |   + Max_seq_length: 2048
25-01-15 02:43:02 | I |     - Results:
25-01-15 02:43:02 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-15 02:43:02 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-15 02:43:02 | I |       |wikitext |      1|word_perplexity|7.7078|±  |7.7078|
25-01-15 02:43:02 | I |       |val_valid|      1|word_perplexity|7.4138|±  |7.4138|
25-01-15 02:43:02 | I |       
25-01-15 02:43:02 | I | in valid, quantize current layer weights
25-01-15 02:43:03 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:15 | I | collecting info in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:20 | I |       - range scale = [    1.0000]
25-01-15 02:43:20 | I |         sum  error  = [    0.1249]
25-01-15 02:43:20 | I |         best error  = [    0.1249]
25-01-15 02:43:20 | I |     + error = [0.1249]
25-01-15 02:43:21 | I |       - range scale = [    1.0000]
25-01-15 02:43:21 | I |         sum  error  = [    1.3756]
25-01-15 02:43:21 | I |         best error  = [    1.3756]
25-01-15 02:43:21 | I |     + error = [1.3756]
25-01-15 02:43:22 | I |       - range scale = [    1.0000]
25-01-15 02:43:22 | I |         sum  error  = [    0.1475]
25-01-15 02:43:22 | I |         best error  = [    0.1475]
25-01-15 02:43:22 | I |     + error = [0.1475]
25-01-15 02:43:23 | I |       - range scale = [    1.0000]
25-01-15 02:43:23 | I |         sum  error  = [    1.6876]
25-01-15 02:43:23 | I |         best error  = [    1.6876]
25-01-15 02:43:23 | I |     + error = [1.6876]
25-01-15 02:43:24 | I |       - range scale = [    1.0000]
25-01-15 02:43:24 | I |         sum  error  = [    0.0123]
25-01-15 02:43:24 | I |         best error  = [    0.0123]
25-01-15 02:43:24 | I |     + error = [0.0123]
25-01-15 02:43:24 | I |       - range scale = [    1.0000]
25-01-15 02:43:24 | I |         sum  error  = [    0.1421]
25-01-15 02:43:24 | I |         best error  = [    0.1421]
25-01-15 02:43:24 | I |     + error = [0.1421]
25-01-15 02:43:25 | I |       - range scale = [    1.0000]
25-01-15 02:43:25 | I |         sum  error  = [    0.0536]
25-01-15 02:43:25 | I |         best error  = [    0.0536]
25-01-15 02:43:25 | I |     + error = [0.0536]
25-01-15 02:43:26 | I |       - range scale = [    1.0000]
25-01-15 02:43:26 | I |         sum  error  = [    0.5450]
25-01-15 02:43:26 | I |         best error  = [    0.5450]
25-01-15 02:43:26 | I |     + error = [0.5450]
25-01-15 02:43:27 | I |       - range scale = [    1.0000]
25-01-15 02:43:27 | I |         sum  error  = [    0.3252]
25-01-15 02:43:27 | I |         best error  = [    0.3252]
25-01-15 02:43:27 | I |     + error = [0.3252]
25-01-15 02:43:27 | I |       - range scale = [    1.0000]
25-01-15 02:43:27 | I |         sum  error  = [    3.7142]
25-01-15 02:43:27 | I |         best error  = [    3.7142]
25-01-15 02:43:27 | I |     + error = [3.7142]
25-01-15 02:43:28 | I |       - range scale = [    1.0000]
25-01-15 02:43:28 | I |         sum  error  = [    1.3423]
25-01-15 02:43:28 | I |         best error  = [    1.3423]
25-01-15 02:43:28 | I |     + error = [1.3423]
25-01-15 02:43:29 | I |       - range scale = [    1.0000]
25-01-15 02:43:29 | I |         sum  error  = [   15.5390]
25-01-15 02:43:29 | I |         best error  = [   15.5390]
25-01-15 02:43:29 | I |     + error = [15.5390]
25-01-15 02:43:30 | I |       - range scale = [    1.0000]
25-01-15 02:43:30 | I |         sum  error  = [    8.4956]
25-01-15 02:43:30 | I |         best error  = [    8.4956]
25-01-15 02:43:30 | I |     + error = [8.4956]
25-01-15 02:43:31 | I |       - range scale = [    1.0000]
25-01-15 02:43:31 | I |         sum  error  = [   44.9053]
25-01-15 02:43:31 | I |         best error  = [   44.9053]
25-01-15 02:43:31 | I |     + error = [44.9053]
25-01-15 02:43:44 | I | in valid, quantize current layer acts
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:44 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting info in model.layers.0
25-01-15 02:43:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:46 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:43:50 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-15 02:43:50 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:43:50 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:43:50 | I | - Evaluator: gptq
25-01-15 02:43:50 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:43:50 | I | - Batch_size: 8
25-01-15 02:43:50 | I |   + Max_seq_length: 2048
25-01-15 02:44:18 | I |     - Results:
25-01-15 02:44:18 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-15 02:44:18 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-15 02:44:18 | I |       |wikitext |      1|word_perplexity|7.7978|±  |7.7978|
25-01-15 02:44:18 | I |       |val_valid|      1|word_perplexity|7.4908|±  |7.4908|
25-01-15 02:44:18 | I |       
25-01-15 02:44:36 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.639, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.23, wps=25687.5, wpb=4058.2, bsz=2, num_updates=5, lmquant_ppl_wikitext_all_quanted=7.70778, lmquant_ppl_val_all_quanted=7.4138, lmquant_ppl_wikitext_partly_quanted=7.79785, lmquant_ppl_val_partly_quanted=7.49077
25-01-15 02:44:36 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.639 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.23 | wps 25687.5 | wpb 4058.2 | bsz 2 | num_updates 5 | lmquant_ppl_wikitext_all_quanted 7.70778 | lmquant_ppl_val_all_quanted 7.4138 | lmquant_ppl_wikitext_partly_quanted 7.79785 | lmquant_ppl_val_partly_quanted 7.49077
25-01-15 02:44:37 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:44:37 | I | in layer model.layers.0
25-01-15 02:44:37 | I | quantizing weights for layer model.layers.0
25-01-15 02:44:37 | I | collecting info in model.layers.0
25-01-15 02:44:37 | I | collecting info in model.layers.0
25-01-15 02:44:37 | I | collecting info in model.layers.0
25-01-15 02:44:37 | I | collecting info in model.layers.0
25-01-15 02:44:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:44:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:44:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:44:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:44:38 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:44:38 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:44:38 | I |       - range scale = [    1.0000]
25-01-15 02:44:38 | I |         sum  error  = [    0.0474]
25-01-15 02:44:38 | I |         best error  = [    0.0474]
25-01-15 02:44:38 | I |     + error = [0.0474]
25-01-15 02:44:39 | I |       - range scale = [    1.0000]
25-01-15 02:44:39 | I |         sum  error  = [    0.5304]
25-01-15 02:44:39 | I |         best error  = [    0.5304]
25-01-15 02:44:39 | I |     + error = [0.5304]
25-01-15 02:44:39 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:44:40 | I |       - range scale = [    1.0000]
25-01-15 02:44:40 | I |         sum  error  = [    0.0559]
25-01-15 02:44:40 | I |         best error  = [    0.0559]
25-01-15 02:44:40 | I |     + error = [0.0559]
25-01-15 02:44:40 | I |       - range scale = [    1.0000]
25-01-15 02:44:40 | I |         sum  error  = [    0.6238]
25-01-15 02:44:40 | I |         best error  = [    0.6238]
25-01-15 02:44:40 | I |     + error = [0.6238]
25-01-15 02:44:41 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:44:41 | I |       - range scale = [    1.0000]
25-01-15 02:44:41 | I |         sum  error  = [    0.0123]
25-01-15 02:44:41 | I |         best error  = [    0.0123]
25-01-15 02:44:41 | I |     + error = [0.0123]
25-01-15 02:44:42 | I |       - range scale = [    1.0000]
25-01-15 02:44:42 | I |         sum  error  = [    0.1422]
25-01-15 02:44:42 | I |         best error  = [    0.1422]
25-01-15 02:44:42 | I |     + error = [0.1422]
25-01-15 02:44:42 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:44:43 | I |       - range scale = [    1.0000]
25-01-15 02:44:43 | I |         sum  error  = [    0.0540]
25-01-15 02:44:43 | I |         best error  = [    0.0540]
25-01-15 02:44:43 | I |     + error = [0.0540]
25-01-15 02:44:43 | I |       - range scale = [    1.0000]
25-01-15 02:44:43 | I |         sum  error  = [    0.5485]
25-01-15 02:44:43 | I |         best error  = [    0.5485]
25-01-15 02:44:43 | I |     + error = [0.5485]
25-01-15 02:44:44 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:44:44 | I |       - range scale = [    1.0000]
25-01-15 02:44:44 | I |         sum  error  = [    0.3234]
25-01-15 02:44:44 | I |         best error  = [    0.3234]
25-01-15 02:44:44 | I |     + error = [0.3234]
25-01-15 02:44:45 | I |       - range scale = [    1.0000]
25-01-15 02:44:45 | I |         sum  error  = [    3.6896]
25-01-15 02:44:45 | I |         best error  = [    3.6896]
25-01-15 02:44:45 | I |     + error = [3.6896]
25-01-15 02:44:45 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:44:46 | I |       - range scale = [    1.0000]
25-01-15 02:44:46 | I |         sum  error  = [    1.3348]
25-01-15 02:44:46 | I |         best error  = [    1.3348]
25-01-15 02:44:46 | I |     + error = [1.3348]
25-01-15 02:44:47 | I |       - range scale = [    1.0000]
25-01-15 02:44:47 | I |         sum  error  = [   15.4433]
25-01-15 02:44:47 | I |         best error  = [   15.4433]
25-01-15 02:44:47 | I |     + error = [15.4433]
25-01-15 02:44:47 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:44:47 | I |       - range scale = [    1.0000]
25-01-15 02:44:47 | I |         sum  error  = [    8.2711]
25-01-15 02:44:47 | I |         best error  = [    8.2711]
25-01-15 02:44:47 | I |     + error = [8.2711]
25-01-15 02:44:48 | I |       - range scale = [    1.0000]
25-01-15 02:44:48 | I |         sum  error  = [   43.0389]
25-01-15 02:44:48 | I |         best error  = [   43.0389]
25-01-15 02:44:48 | I |     + error = [43.0389]
25-01-15 02:44:48 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:44:50 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:44:51 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:44:53 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:44:54 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:44:55 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:44:57 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:45:00 | I | quantizing activations for layer model.layers.0
25-01-15 02:45:00 | I | collecting info in model.layers.0
25-01-15 02:45:00 | I | collecting info in model.layers.0
25-01-15 02:45:00 | I | collecting info in model.layers.0
25-01-15 02:45:00 | I | collecting info in model.layers.0
25-01-15 02:45:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:45:00 | I | collecting calibration activations in model.layers.0
25-01-15 02:45:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:45:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:45:02 | I | forward this layer
25-01-15 02:45:02 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/32.pt
25-01-15 02:45:02 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/32.pt
25-01-15 02:45:03 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:45:03 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:45:03 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:45:03 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:45:03 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:45:03 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:45:03 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:45:03 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:45:03 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:45:03 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:45:03 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:45:03 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:45:03 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:45:03 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:45:03 | I | in layer model.layers.0
25-01-15 02:45:03 | I | quantizing weights for layer model.layers.0
25-01-15 02:45:03 | I | collecting info in model.layers.0
25-01-15 02:45:03 | I | collecting info in model.layers.0
25-01-15 02:45:03 | I | collecting info in model.layers.0
25-01-15 02:45:03 | I | collecting info in model.layers.0
25-01-15 02:45:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:45:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:45:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:45:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:45:04 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:45:04 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:45:04 | I |       - range scale = [    1.0000]
25-01-15 02:45:04 | I |         sum  error  = [    0.0487]
25-01-15 02:45:04 | I |         best error  = [    0.0487]
25-01-15 02:45:04 | I |     + error = [0.0487]
25-01-15 02:45:05 | I |       - range scale = [    1.0000]
25-01-15 02:45:05 | I |         sum  error  = [    0.5422]
25-01-15 02:45:05 | I |         best error  = [    0.5422]
25-01-15 02:45:05 | I |     + error = [0.5422]
25-01-15 02:45:05 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:45:06 | I |       - range scale = [    1.0000]
25-01-15 02:45:06 | I |         sum  error  = [    0.0574]
25-01-15 02:45:06 | I |         best error  = [    0.0574]
25-01-15 02:45:06 | I |     + error = [0.0574]
25-01-15 02:45:07 | I |       - range scale = [    1.0000]
25-01-15 02:45:07 | I |         sum  error  = [    0.6337]
25-01-15 02:45:07 | I |         best error  = [    0.6337]
25-01-15 02:45:07 | I |     + error = [0.6337]
25-01-15 02:45:07 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:45:07 | I |       - range scale = [    1.0000]
25-01-15 02:45:07 | I |         sum  error  = [    0.0123]
25-01-15 02:45:07 | I |         best error  = [    0.0123]
25-01-15 02:45:07 | I |     + error = [0.0123]
25-01-15 02:45:08 | I |       - range scale = [    1.0000]
25-01-15 02:45:08 | I |         sum  error  = [    0.1422]
25-01-15 02:45:08 | I |         best error  = [    0.1422]
25-01-15 02:45:08 | I |     + error = [0.1422]
25-01-15 02:45:08 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:45:09 | I |       - range scale = [    1.0000]
25-01-15 02:45:09 | I |         sum  error  = [    0.0552]
25-01-15 02:45:09 | I |         best error  = [    0.0552]
25-01-15 02:45:09 | I |     + error = [0.0552]
25-01-15 02:45:10 | I |       - range scale = [    1.0000]
25-01-15 02:45:10 | I |         sum  error  = [    0.5576]
25-01-15 02:45:10 | I |         best error  = [    0.5576]
25-01-15 02:45:10 | I |     + error = [0.5576]
25-01-15 02:45:10 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:45:10 | I |       - range scale = [    1.0000]
25-01-15 02:45:10 | I |         sum  error  = [    0.3234]
25-01-15 02:45:10 | I |         best error  = [    0.3234]
25-01-15 02:45:10 | I |     + error = [0.3234]
25-01-15 02:45:11 | I |       - range scale = [    1.0000]
25-01-15 02:45:11 | I |         sum  error  = [    3.6865]
25-01-15 02:45:11 | I |         best error  = [    3.6865]
25-01-15 02:45:11 | I |     + error = [3.6865]
25-01-15 02:45:11 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:45:12 | I |       - range scale = [    1.0000]
25-01-15 02:45:12 | I |         sum  error  = [    1.3334]
25-01-15 02:45:12 | I |         best error  = [    1.3334]
25-01-15 02:45:12 | I |     + error = [1.3334]
25-01-15 02:45:13 | I |       - range scale = [    1.0000]
25-01-15 02:45:13 | I |         sum  error  = [   15.4303]
25-01-15 02:45:13 | I |         best error  = [   15.4303]
25-01-15 02:45:13 | I |     + error = [15.4303]
25-01-15 02:45:13 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:45:14 | I |       - range scale = [    1.0000]
25-01-15 02:45:14 | I |         sum  error  = [    9.0849]
25-01-15 02:45:14 | I |         best error  = [    9.0849]
25-01-15 02:45:14 | I |     + error = [9.0849]
25-01-15 02:45:14 | I |       - range scale = [    1.0000]
25-01-15 02:45:14 | I |         sum  error  = [   49.0941]
25-01-15 02:45:14 | I |         best error  = [   49.0941]
25-01-15 02:45:14 | I |     + error = [49.0941]
25-01-15 02:45:15 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:45:16 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:45:17 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:45:19 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:45:20 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:45:21 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:45:23 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:45:26 | I | quantizing activations for layer model.layers.0
25-01-15 02:45:26 | I | collecting info in model.layers.0
25-01-15 02:45:26 | I | collecting info in model.layers.0
25-01-15 02:45:26 | I | collecting info in model.layers.0
25-01-15 02:45:26 | I | collecting info in model.layers.0
25-01-15 02:45:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:45:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:45:27 | I | collecting calibration activations in model.layers.0
25-01-15 02:45:27 | I | collecting calibration activations in model.layers.0
25-01-15 02:45:28 | I | forward this layer
25-01-15 02:45:28 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/33.pt
25-01-15 02:45:28 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/33.pt
25-01-15 02:45:29 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:45:29 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:45:29 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:45:29 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:45:29 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:45:29 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:45:29 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:45:29 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:45:29 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:45:29 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:45:29 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:45:29 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:45:29 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:45:29 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:45:29 | I | [5] done with optimizer step
25-01-15 02:45:29 | I | epoch 001:     17 / 409600000 loss=0.000233736, loss_per_token=0.478692, loss_sum=15685.8, wps=190.2, ups=0.01, wpb=32768, bsz=64, num_updates=6, lr=1.8e-05, gnorm=0.509, clip=0, loss_scale=0.0625, train_wall=52, cuda_gb_allocated=10.1, cuda_gb_reserved=11.4, cuda_gb_free=13.6, wall=1798
25-01-15 02:45:29 | I | begin validation on "valid" subset on rank 0
25-01-15 02:45:29 | I | got valid iterator on "valid" subset on rank 0
25-01-15 02:45:29 | I | Valid: Start iterating over samples
25-01-15 02:45:29 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:45:29 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:45:29 | I | - Evaluator: gptq
25-01-15 02:45:29 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:45:29 | I | - Batch_size: 8
25-01-15 02:45:29 | I |   + Max_seq_length: 2048
25-01-15 02:45:55 | I |     - Results:
25-01-15 02:45:55 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-15 02:45:55 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-15 02:45:55 | I |       |wikitext |      1|word_perplexity|7.7078|±  |7.7078|
25-01-15 02:45:55 | I |       |val_valid|      1|word_perplexity|7.4138|±  |7.4138|
25-01-15 02:45:55 | I |       
25-01-15 02:45:55 | I | in valid, quantize current layer weights
25-01-15 02:45:55 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:07 | I | collecting info in model.layers.0
25-01-15 02:46:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:09 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:12 | I |       - range scale = [    1.0000]
25-01-15 02:46:12 | I |         sum  error  = [    0.1249]
25-01-15 02:46:12 | I |         best error  = [    0.1249]
25-01-15 02:46:12 | I |     + error = [0.1249]
25-01-15 02:46:13 | I |       - range scale = [    1.0000]
25-01-15 02:46:13 | I |         sum  error  = [    1.3756]
25-01-15 02:46:13 | I |         best error  = [    1.3756]
25-01-15 02:46:13 | I |     + error = [1.3756]
25-01-15 02:46:15 | I |       - range scale = [    1.0000]
25-01-15 02:46:15 | I |         sum  error  = [    0.1475]
25-01-15 02:46:15 | I |         best error  = [    0.1475]
25-01-15 02:46:15 | I |     + error = [0.1475]
25-01-15 02:46:15 | I |       - range scale = [    1.0000]
25-01-15 02:46:15 | I |         sum  error  = [    1.6876]
25-01-15 02:46:15 | I |         best error  = [    1.6876]
25-01-15 02:46:15 | I |     + error = [1.6876]
25-01-15 02:46:16 | I |       - range scale = [    1.0000]
25-01-15 02:46:16 | I |         sum  error  = [    0.0123]
25-01-15 02:46:16 | I |         best error  = [    0.0123]
25-01-15 02:46:16 | I |     + error = [0.0123]
25-01-15 02:46:17 | I |       - range scale = [    1.0000]
25-01-15 02:46:17 | I |         sum  error  = [    0.1421]
25-01-15 02:46:17 | I |         best error  = [    0.1421]
25-01-15 02:46:17 | I |     + error = [0.1421]
25-01-15 02:46:18 | I |       - range scale = [    1.0000]
25-01-15 02:46:18 | I |         sum  error  = [    0.0536]
25-01-15 02:46:18 | I |         best error  = [    0.0536]
25-01-15 02:46:18 | I |     + error = [0.0536]
25-01-15 02:46:19 | I |       - range scale = [    1.0000]
25-01-15 02:46:19 | I |         sum  error  = [    0.5450]
25-01-15 02:46:19 | I |         best error  = [    0.5450]
25-01-15 02:46:19 | I |     + error = [0.5450]
25-01-15 02:46:19 | I |       - range scale = [    1.0000]
25-01-15 02:46:19 | I |         sum  error  = [    0.3252]
25-01-15 02:46:19 | I |         best error  = [    0.3252]
25-01-15 02:46:19 | I |     + error = [0.3252]
25-01-15 02:46:20 | I |       - range scale = [    1.0000]
25-01-15 02:46:20 | I |         sum  error  = [    3.7142]
25-01-15 02:46:20 | I |         best error  = [    3.7142]
25-01-15 02:46:20 | I |     + error = [3.7142]
25-01-15 02:46:21 | I |       - range scale = [    1.0000]
25-01-15 02:46:21 | I |         sum  error  = [    1.3423]
25-01-15 02:46:21 | I |         best error  = [    1.3423]
25-01-15 02:46:21 | I |     + error = [1.3423]
25-01-15 02:46:22 | I |       - range scale = [    1.0000]
25-01-15 02:46:22 | I |         sum  error  = [   15.5390]
25-01-15 02:46:22 | I |         best error  = [   15.5390]
25-01-15 02:46:22 | I |     + error = [15.5390]
25-01-15 02:46:23 | I |       - range scale = [    1.0000]
25-01-15 02:46:23 | I |         sum  error  = [    8.4956]
25-01-15 02:46:23 | I |         best error  = [    8.4956]
25-01-15 02:46:23 | I |     + error = [8.4956]
25-01-15 02:46:23 | I |       - range scale = [    1.0000]
25-01-15 02:46:23 | I |         sum  error  = [   44.9053]
25-01-15 02:46:23 | I |         best error  = [   44.9053]
25-01-15 02:46:23 | I |     + error = [44.9053]
25-01-15 02:46:36 | I | in valid, quantize current layer acts
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:36 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting info in model.layers.0
25-01-15 02:46:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:37 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:46:42 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-15 02:46:42 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:46:42 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:46:42 | I | - Evaluator: gptq
25-01-15 02:46:42 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:46:42 | I | - Batch_size: 8
25-01-15 02:46:42 | I |   + Max_seq_length: 2048
25-01-15 02:47:10 | I |     - Results:
25-01-15 02:47:10 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-15 02:47:10 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-15 02:47:10 | I |       |wikitext |      1|word_perplexity|7.7978|±  |7.7978|
25-01-15 02:47:10 | I |       |val_valid|      1|word_perplexity|7.4908|±  |7.4908|
25-01-15 02:47:10 | I |       
25-01-15 02:47:28 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.639, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.23, wps=25677.5, wpb=4058.2, bsz=2, num_updates=6, lmquant_ppl_wikitext_all_quanted=7.70778, lmquant_ppl_val_all_quanted=7.4138, lmquant_ppl_wikitext_partly_quanted=7.79785, lmquant_ppl_val_partly_quanted=7.49077
25-01-15 02:47:28 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.639 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.23 | wps 25677.5 | wpb 4058.2 | bsz 2 | num_updates 6 | lmquant_ppl_wikitext_all_quanted 7.70778 | lmquant_ppl_val_all_quanted 7.4138 | lmquant_ppl_wikitext_partly_quanted 7.79785 | lmquant_ppl_val_partly_quanted 7.49077
25-01-15 02:47:28 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:47:28 | I | in layer model.layers.0
25-01-15 02:47:28 | I | quantizing weights for layer model.layers.0
25-01-15 02:47:28 | I | collecting info in model.layers.0
25-01-15 02:47:28 | I | collecting info in model.layers.0
25-01-15 02:47:28 | I | collecting info in model.layers.0
25-01-15 02:47:28 | I | collecting info in model.layers.0
25-01-15 02:47:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:47:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:47:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:47:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:47:29 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:47:29 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:47:30 | I |       - range scale = [    1.0000]
25-01-15 02:47:30 | I |         sum  error  = [    0.0475]
25-01-15 02:47:30 | I |         best error  = [    0.0475]
25-01-15 02:47:30 | I |     + error = [0.0475]
25-01-15 02:47:31 | I |       - range scale = [    1.0000]
25-01-15 02:47:31 | I |         sum  error  = [    0.5324]
25-01-15 02:47:31 | I |         best error  = [    0.5324]
25-01-15 02:47:31 | I |     + error = [0.5324]
25-01-15 02:47:31 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:47:32 | I |       - range scale = [    1.0000]
25-01-15 02:47:32 | I |         sum  error  = [    0.0562]
25-01-15 02:47:32 | I |         best error  = [    0.0562]
25-01-15 02:47:32 | I |     + error = [0.0562]
25-01-15 02:47:32 | I |       - range scale = [    1.0000]
25-01-15 02:47:32 | I |         sum  error  = [    0.6305]
25-01-15 02:47:32 | I |         best error  = [    0.6305]
25-01-15 02:47:32 | I |     + error = [0.6305]
25-01-15 02:47:33 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:47:33 | I |       - range scale = [    1.0000]
25-01-15 02:47:33 | I |         sum  error  = [    0.0123]
25-01-15 02:47:33 | I |         best error  = [    0.0123]
25-01-15 02:47:33 | I |     + error = [0.0123]
25-01-15 02:47:34 | I |       - range scale = [    1.0000]
25-01-15 02:47:34 | I |         sum  error  = [    0.1421]
25-01-15 02:47:34 | I |         best error  = [    0.1421]
25-01-15 02:47:34 | I |     + error = [0.1421]
25-01-15 02:47:34 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:47:35 | I |       - range scale = [    1.0000]
25-01-15 02:47:35 | I |         sum  error  = [    0.0551]
25-01-15 02:47:35 | I |         best error  = [    0.0551]
25-01-15 02:47:35 | I |     + error = [0.0551]
25-01-15 02:47:35 | I |       - range scale = [    1.0000]
25-01-15 02:47:35 | I |         sum  error  = [    0.5611]
25-01-15 02:47:35 | I |         best error  = [    0.5611]
25-01-15 02:47:35 | I |     + error = [0.5611]
25-01-15 02:47:36 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:47:36 | I |       - range scale = [    1.0000]
25-01-15 02:47:36 | I |         sum  error  = [    0.3229]
25-01-15 02:47:36 | I |         best error  = [    0.3229]
25-01-15 02:47:36 | I |     + error = [0.3229]
25-01-15 02:47:37 | I |       - range scale = [    1.0000]
25-01-15 02:47:37 | I |         sum  error  = [    3.6859]
25-01-15 02:47:37 | I |         best error  = [    3.6859]
25-01-15 02:47:37 | I |     + error = [3.6859]
25-01-15 02:47:37 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:47:38 | I |       - range scale = [    1.0000]
25-01-15 02:47:38 | I |         sum  error  = [    1.3319]
25-01-15 02:47:38 | I |         best error  = [    1.3319]
25-01-15 02:47:38 | I |     + error = [1.3319]
25-01-15 02:47:39 | I |       - range scale = [    1.0000]
25-01-15 02:47:39 | I |         sum  error  = [   15.4272]
25-01-15 02:47:39 | I |         best error  = [   15.4272]
25-01-15 02:47:39 | I |     + error = [15.4272]
25-01-15 02:47:39 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:47:39 | I |       - range scale = [    1.0000]
25-01-15 02:47:39 | I |         sum  error  = [    8.7546]
25-01-15 02:47:39 | I |         best error  = [    8.7546]
25-01-15 02:47:39 | I |     + error = [8.7546]
25-01-15 02:47:40 | I |       - range scale = [    1.0000]
25-01-15 02:47:40 | I |         sum  error  = [   46.7565]
25-01-15 02:47:40 | I |         best error  = [   46.7565]
25-01-15 02:47:40 | I |     + error = [46.7565]
25-01-15 02:47:40 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:47:42 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:47:43 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:47:45 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:47:46 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:47:48 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:47:49 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:47:52 | I | quantizing activations for layer model.layers.0
25-01-15 02:47:52 | I | collecting info in model.layers.0
25-01-15 02:47:52 | I | collecting info in model.layers.0
25-01-15 02:47:52 | I | collecting info in model.layers.0
25-01-15 02:47:52 | I | collecting info in model.layers.0
25-01-15 02:47:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:47:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:47:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:47:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:47:55 | I | forward this layer
25-01-15 02:47:55 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/34.pt
25-01-15 02:47:55 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/34.pt
25-01-15 02:47:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:47:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:47:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:47:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:47:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:47:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:47:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:47:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:47:55 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:47:55 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:47:55 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:47:55 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:47:55 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:47:55 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:47:55 | I | in layer model.layers.0
25-01-15 02:47:55 | I | quantizing weights for layer model.layers.0
25-01-15 02:47:55 | I | collecting info in model.layers.0
25-01-15 02:47:55 | I | collecting info in model.layers.0
25-01-15 02:47:55 | I | collecting info in model.layers.0
25-01-15 02:47:55 | I | collecting info in model.layers.0
25-01-15 02:47:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:47:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:47:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:47:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:47:56 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:47:56 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:47:57 | I |       - range scale = [    1.0000]
25-01-15 02:47:57 | I |         sum  error  = [    0.0484]
25-01-15 02:47:57 | I |         best error  = [    0.0484]
25-01-15 02:47:57 | I |     + error = [0.0484]
25-01-15 02:47:58 | I |       - range scale = [    1.0000]
25-01-15 02:47:58 | I |         sum  error  = [    0.5421]
25-01-15 02:47:58 | I |         best error  = [    0.5421]
25-01-15 02:47:58 | I |     + error = [0.5421]
25-01-15 02:47:58 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:47:58 | I |       - range scale = [    1.0000]
25-01-15 02:47:58 | I |         sum  error  = [    0.0570]
25-01-15 02:47:58 | I |         best error  = [    0.0570]
25-01-15 02:47:58 | I |     + error = [0.0570]
25-01-15 02:47:59 | I |       - range scale = [    1.0000]
25-01-15 02:47:59 | I |         sum  error  = [    0.6431]
25-01-15 02:47:59 | I |         best error  = [    0.6431]
25-01-15 02:47:59 | I |     + error = [0.6431]
25-01-15 02:47:59 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:48:00 | I |       - range scale = [    1.0000]
25-01-15 02:48:00 | I |         sum  error  = [    0.0123]
25-01-15 02:48:00 | I |         best error  = [    0.0123]
25-01-15 02:48:00 | I |     + error = [0.0123]
25-01-15 02:48:01 | I |       - range scale = [    1.0000]
25-01-15 02:48:01 | I |         sum  error  = [    0.1423]
25-01-15 02:48:01 | I |         best error  = [    0.1423]
25-01-15 02:48:01 | I |     + error = [0.1423]
25-01-15 02:48:01 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:48:01 | I |       - range scale = [    1.0000]
25-01-15 02:48:01 | I |         sum  error  = [    0.0549]
25-01-15 02:48:01 | I |         best error  = [    0.0549]
25-01-15 02:48:01 | I |     + error = [0.0549]
25-01-15 02:48:02 | I |       - range scale = [    1.0000]
25-01-15 02:48:02 | I |         sum  error  = [    0.5569]
25-01-15 02:48:02 | I |         best error  = [    0.5569]
25-01-15 02:48:02 | I |     + error = [0.5569]
25-01-15 02:48:02 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:48:03 | I |       - range scale = [    1.0000]
25-01-15 02:48:03 | I |         sum  error  = [    0.3236]
25-01-15 02:48:03 | I |         best error  = [    0.3236]
25-01-15 02:48:03 | I |     + error = [0.3236]
25-01-15 02:48:04 | I |       - range scale = [    1.0000]
25-01-15 02:48:04 | I |         sum  error  = [    3.6885]
25-01-15 02:48:04 | I |         best error  = [    3.6885]
25-01-15 02:48:04 | I |     + error = [3.6885]
25-01-15 02:48:04 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:48:05 | I |       - range scale = [    1.0000]
25-01-15 02:48:05 | I |         sum  error  = [    1.3343]
25-01-15 02:48:05 | I |         best error  = [    1.3343]
25-01-15 02:48:05 | I |     + error = [1.3343]
25-01-15 02:48:05 | I |       - range scale = [    1.0000]
25-01-15 02:48:05 | I |         sum  error  = [   15.4394]
25-01-15 02:48:05 | I |         best error  = [   15.4394]
25-01-15 02:48:05 | I |     + error = [15.4394]
25-01-15 02:48:06 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:48:06 | I |       - range scale = [    1.0000]
25-01-15 02:48:06 | I |         sum  error  = [    9.0898]
25-01-15 02:48:06 | I |         best error  = [    9.0898]
25-01-15 02:48:06 | I |     + error = [9.0898]
25-01-15 02:48:07 | I |       - range scale = [    1.0000]
25-01-15 02:48:07 | I |         sum  error  = [   48.0929]
25-01-15 02:48:07 | I |         best error  = [   48.0929]
25-01-15 02:48:07 | I |     + error = [48.0929]
25-01-15 02:48:07 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:48:09 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:48:10 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:48:11 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:48:13 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:48:14 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:48:16 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:48:19 | I | quantizing activations for layer model.layers.0
25-01-15 02:48:19 | I | collecting info in model.layers.0
25-01-15 02:48:19 | I | collecting info in model.layers.0
25-01-15 02:48:19 | I | collecting info in model.layers.0
25-01-15 02:48:19 | I | collecting info in model.layers.0
25-01-15 02:48:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:48:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:48:20 | I | collecting calibration activations in model.layers.0
25-01-15 02:48:20 | I | collecting calibration activations in model.layers.0
25-01-15 02:48:21 | I | forward this layer
25-01-15 02:48:21 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/35.pt
25-01-15 02:48:21 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/35.pt
25-01-15 02:48:22 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:48:22 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:48:22 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:48:22 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:48:22 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:48:22 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:48:22 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:48:22 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:48:22 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:48:22 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:48:22 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:48:22 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:48:22 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:48:22 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:48:22 | I | [6] done with optimizer step
25-01-15 02:48:22 | I | epoch 001:     18 / 409600000 loss=0.000232007, loss_per_token=0.475149, loss_sum=15569.7, wps=189.3, ups=0.01, wpb=32768, bsz=64, num_updates=7, lr=2.1e-05, gnorm=0.501, clip=0, loss_scale=0.0625, train_wall=53, cuda_gb_allocated=10.1, cuda_gb_reserved=11.4, cuda_gb_free=13.6, wall=1971
25-01-15 02:48:22 | I | begin validation on "valid" subset on rank 0
25-01-15 02:48:22 | I | got valid iterator on "valid" subset on rank 0
25-01-15 02:48:22 | I | Valid: Start iterating over samples
25-01-15 02:48:22 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:48:22 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:48:22 | I | - Evaluator: gptq
25-01-15 02:48:22 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:48:22 | I | - Batch_size: 8
25-01-15 02:48:22 | I |   + Max_seq_length: 2048
25-01-15 02:48:48 | I |     - Results:
25-01-15 02:48:48 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-15 02:48:48 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-15 02:48:48 | I |       |wikitext |      1|word_perplexity|7.7078|±  |7.7078|
25-01-15 02:48:48 | I |       |val_valid|      1|word_perplexity|7.4138|±  |7.4138|
25-01-15 02:48:48 | I |       
25-01-15 02:48:48 | I | in valid, quantize current layer weights
25-01-15 02:48:48 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:00 | I | collecting info in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:01 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:03 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:04 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:05 | I |       - range scale = [    1.0000]
25-01-15 02:49:05 | I |         sum  error  = [    0.1249]
25-01-15 02:49:05 | I |         best error  = [    0.1249]
25-01-15 02:49:05 | I |     + error = [0.1249]
25-01-15 02:49:06 | I |       - range scale = [    1.0000]
25-01-15 02:49:06 | I |         sum  error  = [    1.3756]
25-01-15 02:49:06 | I |         best error  = [    1.3756]
25-01-15 02:49:06 | I |     + error = [1.3756]
25-01-15 02:49:07 | I |       - range scale = [    1.0000]
25-01-15 02:49:07 | I |         sum  error  = [    0.1475]
25-01-15 02:49:07 | I |         best error  = [    0.1475]
25-01-15 02:49:07 | I |     + error = [0.1475]
25-01-15 02:49:08 | I |       - range scale = [    1.0000]
25-01-15 02:49:08 | I |         sum  error  = [    1.6876]
25-01-15 02:49:08 | I |         best error  = [    1.6876]
25-01-15 02:49:08 | I |     + error = [1.6876]
25-01-15 02:49:09 | I |       - range scale = [    1.0000]
25-01-15 02:49:09 | I |         sum  error  = [    0.0123]
25-01-15 02:49:09 | I |         best error  = [    0.0123]
25-01-15 02:49:09 | I |     + error = [0.0123]
25-01-15 02:49:10 | I |       - range scale = [    1.0000]
25-01-15 02:49:10 | I |         sum  error  = [    0.1421]
25-01-15 02:49:10 | I |         best error  = [    0.1421]
25-01-15 02:49:10 | I |     + error = [0.1421]
25-01-15 02:49:11 | I |       - range scale = [    1.0000]
25-01-15 02:49:11 | I |         sum  error  = [    0.0536]
25-01-15 02:49:11 | I |         best error  = [    0.0536]
25-01-15 02:49:11 | I |     + error = [0.0536]
25-01-15 02:49:11 | I |       - range scale = [    1.0000]
25-01-15 02:49:11 | I |         sum  error  = [    0.5450]
25-01-15 02:49:11 | I |         best error  = [    0.5450]
25-01-15 02:49:11 | I |     + error = [0.5450]
25-01-15 02:49:12 | I |       - range scale = [    1.0000]
25-01-15 02:49:12 | I |         sum  error  = [    0.3252]
25-01-15 02:49:12 | I |         best error  = [    0.3252]
25-01-15 02:49:12 | I |     + error = [0.3252]
25-01-15 02:49:13 | I |       - range scale = [    1.0000]
25-01-15 02:49:13 | I |         sum  error  = [    3.7142]
25-01-15 02:49:13 | I |         best error  = [    3.7142]
25-01-15 02:49:13 | I |     + error = [3.7142]
25-01-15 02:49:14 | I |       - range scale = [    1.0000]
25-01-15 02:49:14 | I |         sum  error  = [    1.3423]
25-01-15 02:49:14 | I |         best error  = [    1.3423]
25-01-15 02:49:14 | I |     + error = [1.3423]
25-01-15 02:49:15 | I |       - range scale = [    1.0000]
25-01-15 02:49:15 | I |         sum  error  = [   15.5390]
25-01-15 02:49:15 | I |         best error  = [   15.5390]
25-01-15 02:49:15 | I |     + error = [15.5390]
25-01-15 02:49:16 | I |       - range scale = [    1.0000]
25-01-15 02:49:16 | I |         sum  error  = [    8.4956]
25-01-15 02:49:16 | I |         best error  = [    8.4956]
25-01-15 02:49:16 | I |     + error = [8.4956]
25-01-15 02:49:16 | I |       - range scale = [    1.0000]
25-01-15 02:49:16 | I |         sum  error  = [   44.9053]
25-01-15 02:49:16 | I |         best error  = [   44.9053]
25-01-15 02:49:16 | I |     + error = [44.9053]
25-01-15 02:49:28 | I | in valid, quantize current layer acts
25-01-15 02:49:28 | I | collecting info in model.layers.0
25-01-15 02:49:28 | I | collecting info in model.layers.0
25-01-15 02:49:28 | I | collecting info in model.layers.0
25-01-15 02:49:28 | I | collecting info in model.layers.0
25-01-15 02:49:28 | I | collecting info in model.layers.0
25-01-15 02:49:28 | I | collecting info in model.layers.0
25-01-15 02:49:28 | I | collecting info in model.layers.0
25-01-15 02:49:28 | I | collecting info in model.layers.0
25-01-15 02:49:28 | I | collecting info in model.layers.0
25-01-15 02:49:28 | I | collecting info in model.layers.0
25-01-15 02:49:28 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting info in model.layers.0
25-01-15 02:49:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:30 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:32 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:33 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:33 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:33 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:33 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:33 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:33 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:33 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:33 | I | collecting calibration activations in model.layers.0
25-01-15 02:49:35 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-15 02:49:35 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:49:35 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:49:35 | I | - Evaluator: gptq
25-01-15 02:49:35 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:49:35 | I | - Batch_size: 8
25-01-15 02:49:35 | I |   + Max_seq_length: 2048
25-01-15 02:50:02 | I |     - Results:
25-01-15 02:50:02 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-15 02:50:02 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-15 02:50:02 | I |       |wikitext |      1|word_perplexity|7.7978|±  |7.7978|
25-01-15 02:50:02 | I |       |val_valid|      1|word_perplexity|7.4908|±  |7.4908|
25-01-15 02:50:02 | I |       
25-01-15 02:50:20 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.639, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.23, wps=25696.3, wpb=4058.2, bsz=2, num_updates=7, lmquant_ppl_wikitext_all_quanted=7.70778, lmquant_ppl_val_all_quanted=7.4138, lmquant_ppl_wikitext_partly_quanted=7.79785, lmquant_ppl_val_partly_quanted=7.49077
25-01-15 02:50:20 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.639 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.23 | wps 25696.3 | wpb 4058.2 | bsz 2 | num_updates 7 | lmquant_ppl_wikitext_all_quanted 7.70778 | lmquant_ppl_val_all_quanted 7.4138 | lmquant_ppl_wikitext_partly_quanted 7.79785 | lmquant_ppl_val_partly_quanted 7.49077
25-01-15 02:50:21 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:50:21 | I | in layer model.layers.0
25-01-15 02:50:21 | I | quantizing weights for layer model.layers.0
25-01-15 02:50:21 | I | collecting info in model.layers.0
25-01-15 02:50:21 | I | collecting info in model.layers.0
25-01-15 02:50:21 | I | collecting info in model.layers.0
25-01-15 02:50:21 | I | collecting info in model.layers.0
25-01-15 02:50:21 | I | collecting calibration activations in model.layers.0
25-01-15 02:50:21 | I | collecting calibration activations in model.layers.0
25-01-15 02:50:21 | I | collecting calibration activations in model.layers.0
25-01-15 02:50:21 | I | collecting calibration activations in model.layers.0
25-01-15 02:50:22 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:50:22 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:50:22 | I |       - range scale = [    1.0000]
25-01-15 02:50:22 | I |         sum  error  = [    0.0475]
25-01-15 02:50:22 | I |         best error  = [    0.0475]
25-01-15 02:50:22 | I |     + error = [0.0475]
25-01-15 02:50:23 | I |       - range scale = [    1.0000]
25-01-15 02:50:23 | I |         sum  error  = [    0.5286]
25-01-15 02:50:23 | I |         best error  = [    0.5286]
25-01-15 02:50:23 | I |     + error = [0.5286]
25-01-15 02:50:23 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:50:24 | I |       - range scale = [    1.0000]
25-01-15 02:50:24 | I |         sum  error  = [    0.0568]
25-01-15 02:50:24 | I |         best error  = [    0.0568]
25-01-15 02:50:24 | I |     + error = [0.0568]
25-01-15 02:50:24 | I |       - range scale = [    1.0000]
25-01-15 02:50:24 | I |         sum  error  = [    0.6350]
25-01-15 02:50:24 | I |         best error  = [    0.6350]
25-01-15 02:50:24 | I |     + error = [0.6350]
25-01-15 02:50:25 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:50:25 | I |       - range scale = [    1.0000]
25-01-15 02:50:25 | I |         sum  error  = [    0.0123]
25-01-15 02:50:25 | I |         best error  = [    0.0123]
25-01-15 02:50:25 | I |     + error = [0.0123]
25-01-15 02:50:26 | I |       - range scale = [    1.0000]
25-01-15 02:50:26 | I |         sum  error  = [    0.1422]
25-01-15 02:50:26 | I |         best error  = [    0.1422]
25-01-15 02:50:26 | I |     + error = [0.1422]
25-01-15 02:50:26 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:50:27 | I |       - range scale = [    1.0000]
25-01-15 02:50:27 | I |         sum  error  = [    0.0568]
25-01-15 02:50:27 | I |         best error  = [    0.0568]
25-01-15 02:50:27 | I |     + error = [0.0568]
25-01-15 02:50:28 | I |       - range scale = [    1.0000]
25-01-15 02:50:28 | I |         sum  error  = [    0.5760]
25-01-15 02:50:28 | I |         best error  = [    0.5760]
25-01-15 02:50:28 | I |     + error = [0.5760]
25-01-15 02:50:28 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:50:28 | I |       - range scale = [    1.0000]
25-01-15 02:50:28 | I |         sum  error  = [    0.3231]
25-01-15 02:50:28 | I |         best error  = [    0.3231]
25-01-15 02:50:28 | I |     + error = [0.3231]
25-01-15 02:50:29 | I |       - range scale = [    1.0000]
25-01-15 02:50:29 | I |         sum  error  = [    3.6847]
25-01-15 02:50:29 | I |         best error  = [    3.6847]
25-01-15 02:50:29 | I |     + error = [3.6847]
25-01-15 02:50:29 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:50:30 | I |       - range scale = [    1.0000]
25-01-15 02:50:30 | I |         sum  error  = [    1.3309]
25-01-15 02:50:30 | I |         best error  = [    1.3309]
25-01-15 02:50:30 | I |     + error = [1.3309]
25-01-15 02:50:31 | I |       - range scale = [    1.0000]
25-01-15 02:50:31 | I |         sum  error  = [   15.4193]
25-01-15 02:50:31 | I |         best error  = [   15.4193]
25-01-15 02:50:31 | I |     + error = [15.4193]
25-01-15 02:50:31 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:50:32 | I |       - range scale = [    1.0000]
25-01-15 02:50:32 | I |         sum  error  = [    9.2582]
25-01-15 02:50:32 | I |         best error  = [    9.2582]
25-01-15 02:50:32 | I |     + error = [9.2582]
25-01-15 02:50:32 | I |       - range scale = [    1.0000]
25-01-15 02:50:32 | I |         sum  error  = [   49.7303]
25-01-15 02:50:32 | I |         best error  = [   49.7303]
25-01-15 02:50:32 | I |     + error = [49.7303]
25-01-15 02:50:33 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:50:34 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:50:35 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:50:37 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:50:38 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:50:39 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:50:41 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:50:44 | I | quantizing activations for layer model.layers.0
25-01-15 02:50:44 | I | collecting info in model.layers.0
25-01-15 02:50:44 | I | collecting info in model.layers.0
25-01-15 02:50:44 | I | collecting info in model.layers.0
25-01-15 02:50:44 | I | collecting info in model.layers.0
25-01-15 02:50:44 | I | collecting calibration activations in model.layers.0
25-01-15 02:50:44 | I | collecting calibration activations in model.layers.0
25-01-15 02:50:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:50:45 | I | collecting calibration activations in model.layers.0
25-01-15 02:50:46 | I | forward this layer
25-01-15 02:50:46 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/36.pt
25-01-15 02:50:46 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/36.pt
25-01-15 02:50:47 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:50:47 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:50:47 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:50:47 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:50:47 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:50:47 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:50:47 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:50:47 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:50:47 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:50:47 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:50:47 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:50:47 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:50:47 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:50:47 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:50:47 | I | in layer model.layers.0
25-01-15 02:50:47 | I | quantizing weights for layer model.layers.0
25-01-15 02:50:47 | I | collecting info in model.layers.0
25-01-15 02:50:47 | I | collecting info in model.layers.0
25-01-15 02:50:47 | I | collecting info in model.layers.0
25-01-15 02:50:47 | I | collecting info in model.layers.0
25-01-15 02:50:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:50:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:50:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:50:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:50:48 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:50:48 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:50:48 | I |       - range scale = [    1.0000]
25-01-15 02:50:48 | I |         sum  error  = [    0.0484]
25-01-15 02:50:48 | I |         best error  = [    0.0484]
25-01-15 02:50:48 | I |     + error = [0.0484]
25-01-15 02:50:49 | I |       - range scale = [    1.0000]
25-01-15 02:50:49 | I |         sum  error  = [    0.5402]
25-01-15 02:50:49 | I |         best error  = [    0.5402]
25-01-15 02:50:49 | I |     + error = [0.5402]
25-01-15 02:50:49 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:50:50 | I |       - range scale = [    1.0000]
25-01-15 02:50:50 | I |         sum  error  = [    0.0578]
25-01-15 02:50:50 | I |         best error  = [    0.0578]
25-01-15 02:50:50 | I |     + error = [0.0578]
25-01-15 02:50:51 | I |       - range scale = [    1.0000]
25-01-15 02:50:51 | I |         sum  error  = [    0.6376]
25-01-15 02:50:51 | I |         best error  = [    0.6376]
25-01-15 02:50:51 | I |     + error = [0.6376]
25-01-15 02:50:51 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:50:52 | I |       - range scale = [    1.0000]
25-01-15 02:50:52 | I |         sum  error  = [    0.0123]
25-01-15 02:50:52 | I |         best error  = [    0.0123]
25-01-15 02:50:52 | I |     + error = [0.0123]
25-01-15 02:50:52 | I |       - range scale = [    1.0000]
25-01-15 02:50:52 | I |         sum  error  = [    0.1419]
25-01-15 02:50:52 | I |         best error  = [    0.1419]
25-01-15 02:50:52 | I |     + error = [0.1419]
25-01-15 02:50:52 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:50:53 | I |       - range scale = [    1.0000]
25-01-15 02:50:53 | I |         sum  error  = [    0.0550]
25-01-15 02:50:53 | I |         best error  = [    0.0550]
25-01-15 02:50:53 | I |     + error = [0.0550]
25-01-15 02:50:54 | I |       - range scale = [    1.0000]
25-01-15 02:50:54 | I |         sum  error  = [    0.5571]
25-01-15 02:50:54 | I |         best error  = [    0.5571]
25-01-15 02:50:54 | I |     + error = [0.5571]
25-01-15 02:50:54 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:50:55 | I |       - range scale = [    1.0000]
25-01-15 02:50:55 | I |         sum  error  = [    0.3232]
25-01-15 02:50:55 | I |         best error  = [    0.3232]
25-01-15 02:50:55 | I |     + error = [0.3232]
25-01-15 02:50:55 | I |       - range scale = [    1.0000]
25-01-15 02:50:55 | I |         sum  error  = [    3.6855]
25-01-15 02:50:55 | I |         best error  = [    3.6855]
25-01-15 02:50:55 | I |     + error = [3.6855]
25-01-15 02:50:56 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:50:56 | I |       - range scale = [    1.0000]
25-01-15 02:50:56 | I |         sum  error  = [    1.3314]
25-01-15 02:50:56 | I |         best error  = [    1.3314]
25-01-15 02:50:56 | I |     + error = [1.3314]
25-01-15 02:50:57 | I |       - range scale = [    1.0000]
25-01-15 02:50:57 | I |         sum  error  = [   15.4232]
25-01-15 02:50:57 | I |         best error  = [   15.4232]
25-01-15 02:50:57 | I |     + error = [15.4232]
25-01-15 02:50:57 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:50:58 | I |       - range scale = [    1.0000]
25-01-15 02:50:58 | I |         sum  error  = [    9.2635]
25-01-15 02:50:58 | I |         best error  = [    9.2635]
25-01-15 02:50:58 | I |     + error = [9.2635]
25-01-15 02:50:59 | I |       - range scale = [    1.0000]
25-01-15 02:50:59 | I |         sum  error  = [   49.4252]
25-01-15 02:50:59 | I |         best error  = [   49.4252]
25-01-15 02:50:59 | I |     + error = [49.4252]
25-01-15 02:50:59 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:51:00 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:51:02 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:51:03 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:51:05 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:51:06 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:51:07 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:51:11 | I | quantizing activations for layer model.layers.0
25-01-15 02:51:11 | I | collecting info in model.layers.0
25-01-15 02:51:11 | I | collecting info in model.layers.0
25-01-15 02:51:11 | I | collecting info in model.layers.0
25-01-15 02:51:11 | I | collecting info in model.layers.0
25-01-15 02:51:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:13 | I | forward this layer
25-01-15 02:51:13 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/37.pt
25-01-15 02:51:13 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/37.pt
25-01-15 02:51:13 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:51:13 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:51:13 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:51:13 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:51:13 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:51:13 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:51:13 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:51:13 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:51:13 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:51:13 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:51:13 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:51:13 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:51:13 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:51:13 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:51:13 | I | [7] done with optimizer step
25-01-15 02:51:13 | I | epoch 001:     19 / 409600000 loss=0.000215446, loss_per_token=0.441233, loss_sum=14458.3, wps=190.7, ups=0.01, wpb=32768, bsz=64, num_updates=8, lr=2.4e-05, gnorm=0.472, clip=0, loss_scale=0.0625, train_wall=53, cuda_gb_allocated=10.1, cuda_gb_reserved=11.4, cuda_gb_free=13.6, wall=2143
25-01-15 02:51:13 | I | begin validation on "valid" subset on rank 0
25-01-15 02:51:14 | I | got valid iterator on "valid" subset on rank 0
25-01-15 02:51:14 | I | Valid: Start iterating over samples
25-01-15 02:51:14 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:51:14 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:51:14 | I | - Evaluator: gptq
25-01-15 02:51:14 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:51:14 | I | - Batch_size: 8
25-01-15 02:51:14 | I |   + Max_seq_length: 2048
25-01-15 02:51:39 | I |     - Results:
25-01-15 02:51:40 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-15 02:51:40 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-15 02:51:40 | I |       |wikitext |      1|word_perplexity|7.7078|±  |7.7078|
25-01-15 02:51:40 | I |       |val_valid|      1|word_perplexity|7.4138|±  |7.4138|
25-01-15 02:51:40 | I |       
25-01-15 02:51:40 | I | in valid, quantize current layer weights
25-01-15 02:51:40 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:52 | I | collecting info in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:54 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:55 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:56 | I | collecting calibration activations in model.layers.0
25-01-15 02:51:57 | I |       - range scale = [    1.0000]
25-01-15 02:51:57 | I |         sum  error  = [    0.1249]
25-01-15 02:51:57 | I |         best error  = [    0.1249]
25-01-15 02:51:57 | I |     + error = [0.1249]
25-01-15 02:51:58 | I |       - range scale = [    1.0000]
25-01-15 02:51:58 | I |         sum  error  = [    1.3756]
25-01-15 02:51:58 | I |         best error  = [    1.3756]
25-01-15 02:51:58 | I |     + error = [1.3756]
25-01-15 02:51:59 | I |       - range scale = [    1.0000]
25-01-15 02:51:59 | I |         sum  error  = [    0.1475]
25-01-15 02:51:59 | I |         best error  = [    0.1475]
25-01-15 02:51:59 | I |     + error = [0.1475]
25-01-15 02:52:00 | I |       - range scale = [    1.0000]
25-01-15 02:52:00 | I |         sum  error  = [    1.6876]
25-01-15 02:52:00 | I |         best error  = [    1.6876]
25-01-15 02:52:00 | I |     + error = [1.6876]
25-01-15 02:52:01 | I |       - range scale = [    1.0000]
25-01-15 02:52:01 | I |         sum  error  = [    0.0123]
25-01-15 02:52:01 | I |         best error  = [    0.0123]
25-01-15 02:52:01 | I |     + error = [0.0123]
25-01-15 02:52:02 | I |       - range scale = [    1.0000]
25-01-15 02:52:02 | I |         sum  error  = [    0.1421]
25-01-15 02:52:02 | I |         best error  = [    0.1421]
25-01-15 02:52:02 | I |     + error = [0.1421]
25-01-15 02:52:03 | I |       - range scale = [    1.0000]
25-01-15 02:52:03 | I |         sum  error  = [    0.0536]
25-01-15 02:52:03 | I |         best error  = [    0.0536]
25-01-15 02:52:03 | I |     + error = [0.0536]
25-01-15 02:52:03 | I |       - range scale = [    1.0000]
25-01-15 02:52:03 | I |         sum  error  = [    0.5450]
25-01-15 02:52:03 | I |         best error  = [    0.5450]
25-01-15 02:52:03 | I |     + error = [0.5450]
25-01-15 02:52:04 | I |       - range scale = [    1.0000]
25-01-15 02:52:04 | I |         sum  error  = [    0.3252]
25-01-15 02:52:04 | I |         best error  = [    0.3252]
25-01-15 02:52:04 | I |     + error = [0.3252]
25-01-15 02:52:05 | I |       - range scale = [    1.0000]
25-01-15 02:52:05 | I |         sum  error  = [    3.7142]
25-01-15 02:52:05 | I |         best error  = [    3.7142]
25-01-15 02:52:05 | I |     + error = [3.7142]
25-01-15 02:52:06 | I |       - range scale = [    1.0000]
25-01-15 02:52:06 | I |         sum  error  = [    1.3423]
25-01-15 02:52:06 | I |         best error  = [    1.3423]
25-01-15 02:52:06 | I |     + error = [1.3423]
25-01-15 02:52:06 | I |       - range scale = [    1.0000]
25-01-15 02:52:06 | I |         sum  error  = [   15.5390]
25-01-15 02:52:06 | I |         best error  = [   15.5390]
25-01-15 02:52:06 | I |     + error = [15.5390]
25-01-15 02:52:07 | I |       - range scale = [    1.0000]
25-01-15 02:52:07 | I |         sum  error  = [    8.4956]
25-01-15 02:52:07 | I |         best error  = [    8.4956]
25-01-15 02:52:07 | I |     + error = [8.4956]
25-01-15 02:52:08 | I |       - range scale = [    1.0000]
25-01-15 02:52:08 | I |         sum  error  = [   44.9053]
25-01-15 02:52:08 | I |         best error  = [   44.9053]
25-01-15 02:52:08 | I |     + error = [44.9053]
25-01-15 02:52:22 | I | in valid, quantize current layer acts
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:22 | I | collecting info in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:23 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:24 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:25 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:52:28 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-15 02:52:28 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:52:28 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:52:28 | I | - Evaluator: gptq
25-01-15 02:52:28 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:52:28 | I | - Batch_size: 8
25-01-15 02:52:28 | I |   + Max_seq_length: 2048
25-01-15 02:52:56 | I |     - Results:
25-01-15 02:52:56 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-15 02:52:56 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-15 02:52:56 | I |       |wikitext |      1|word_perplexity|7.7978|±  |7.7978|
25-01-15 02:52:56 | I |       |val_valid|      1|word_perplexity|7.4908|±  |7.4908|
25-01-15 02:52:56 | I |       
25-01-15 02:53:14 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.639, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.23, wps=25600.7, wpb=4058.2, bsz=2, num_updates=8, lmquant_ppl_wikitext_all_quanted=7.70778, lmquant_ppl_val_all_quanted=7.4138, lmquant_ppl_wikitext_partly_quanted=7.79785, lmquant_ppl_val_partly_quanted=7.49077
25-01-15 02:53:14 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.639 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.23 | wps 25600.7 | wpb 4058.2 | bsz 2 | num_updates 8 | lmquant_ppl_wikitext_all_quanted 7.70778 | lmquant_ppl_val_all_quanted 7.4138 | lmquant_ppl_wikitext_partly_quanted 7.79785 | lmquant_ppl_val_partly_quanted 7.49077
25-01-15 02:53:14 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:53:14 | I | in layer model.layers.0
25-01-15 02:53:14 | I | quantizing weights for layer model.layers.0
25-01-15 02:53:14 | I | collecting info in model.layers.0
25-01-15 02:53:14 | I | collecting info in model.layers.0
25-01-15 02:53:14 | I | collecting info in model.layers.0
25-01-15 02:53:14 | I | collecting info in model.layers.0
25-01-15 02:53:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:53:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:53:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:53:15 | I | collecting calibration activations in model.layers.0
25-01-15 02:53:15 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:53:15 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:53:16 | I |       - range scale = [    1.0000]
25-01-15 02:53:16 | I |         sum  error  = [    0.0449]
25-01-15 02:53:16 | I |         best error  = [    0.0449]
25-01-15 02:53:16 | I |     + error = [0.0449]
25-01-15 02:53:16 | I |       - range scale = [    1.0000]
25-01-15 02:53:16 | I |         sum  error  = [    0.5091]
25-01-15 02:53:16 | I |         best error  = [    0.5091]
25-01-15 02:53:17 | I |     + error = [0.5091]
25-01-15 02:53:17 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:53:17 | I |       - range scale = [    1.0000]
25-01-15 02:53:17 | I |         sum  error  = [    0.0549]
25-01-15 02:53:17 | I |         best error  = [    0.0549]
25-01-15 02:53:17 | I |     + error = [0.0549]
25-01-15 02:53:18 | I |       - range scale = [    1.0000]
25-01-15 02:53:18 | I |         sum  error  = [    0.6154]
25-01-15 02:53:18 | I |         best error  = [    0.6154]
25-01-15 02:53:18 | I |     + error = [0.6154]
25-01-15 02:53:18 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:53:19 | I |       - range scale = [    1.0000]
25-01-15 02:53:19 | I |         sum  error  = [    0.0123]
25-01-15 02:53:19 | I |         best error  = [    0.0123]
25-01-15 02:53:19 | I |     + error = [0.0123]
25-01-15 02:53:20 | I |       - range scale = [    1.0000]
25-01-15 02:53:20 | I |         sum  error  = [    0.1418]
25-01-15 02:53:20 | I |         best error  = [    0.1418]
25-01-15 02:53:20 | I |     + error = [0.1418]
25-01-15 02:53:20 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:53:21 | I |       - range scale = [    1.0000]
25-01-15 02:53:21 | I |         sum  error  = [    0.0551]
25-01-15 02:53:21 | I |         best error  = [    0.0551]
25-01-15 02:53:21 | I |     + error = [0.0551]
25-01-15 02:53:21 | I |       - range scale = [    1.0000]
25-01-15 02:53:21 | I |         sum  error  = [    0.5593]
25-01-15 02:53:21 | I |         best error  = [    0.5593]
25-01-15 02:53:21 | I |     + error = [0.5593]
25-01-15 02:53:21 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:53:22 | I |       - range scale = [    1.0000]
25-01-15 02:53:22 | I |         sum  error  = [    0.3236]
25-01-15 02:53:22 | I |         best error  = [    0.3236]
25-01-15 02:53:22 | I |     + error = [0.3236]
25-01-15 02:53:23 | I |       - range scale = [    1.0000]
25-01-15 02:53:23 | I |         sum  error  = [    3.6915]
25-01-15 02:53:23 | I |         best error  = [    3.6915]
25-01-15 02:53:23 | I |     + error = [3.6915]
25-01-15 02:53:23 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:53:24 | I |       - range scale = [    1.0000]
25-01-15 02:53:24 | I |         sum  error  = [    1.3352]
25-01-15 02:53:24 | I |         best error  = [    1.3352]
25-01-15 02:53:24 | I |     + error = [1.3352]
25-01-15 02:53:24 | I |       - range scale = [    1.0000]
25-01-15 02:53:24 | I |         sum  error  = [   15.4494]
25-01-15 02:53:24 | I |         best error  = [   15.4494]
25-01-15 02:53:25 | I |     + error = [15.4494]
25-01-15 02:53:25 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:53:25 | I |       - range scale = [    1.0000]
25-01-15 02:53:25 | I |         sum  error  = [    7.6749]
25-01-15 02:53:25 | I |         best error  = [    7.6749]
25-01-15 02:53:25 | I |     + error = [7.6749]
25-01-15 02:53:26 | I |       - range scale = [    1.0000]
25-01-15 02:53:26 | I |         sum  error  = [   39.6840]
25-01-15 02:53:26 | I |         best error  = [   39.6840]
25-01-15 02:53:26 | I |     + error = [39.6840]
25-01-15 02:53:26 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:53:28 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:53:29 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:53:30 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:53:32 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:53:33 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:53:35 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:53:38 | I | quantizing activations for layer model.layers.0
25-01-15 02:53:38 | I | collecting info in model.layers.0
25-01-15 02:53:38 | I | collecting info in model.layers.0
25-01-15 02:53:38 | I | collecting info in model.layers.0
25-01-15 02:53:38 | I | collecting info in model.layers.0
25-01-15 02:53:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:53:38 | I | collecting calibration activations in model.layers.0
25-01-15 02:53:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:53:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:53:41 | I | forward this layer
25-01-15 02:53:41 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/38.pt
25-01-15 02:53:41 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/38.pt
25-01-15 02:53:41 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:53:41 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:53:41 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:53:41 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:53:41 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:53:41 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:53:41 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:53:41 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:53:41 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:53:41 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:53:41 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:53:41 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:53:41 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:53:41 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:53:41 | I | in layer model.layers.0
25-01-15 02:53:41 | I | quantizing weights for layer model.layers.0
25-01-15 02:53:41 | I | collecting info in model.layers.0
25-01-15 02:53:41 | I | collecting info in model.layers.0
25-01-15 02:53:41 | I | collecting info in model.layers.0
25-01-15 02:53:41 | I | collecting info in model.layers.0
25-01-15 02:53:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:53:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:53:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:53:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:53:42 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:53:42 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:53:43 | I |       - range scale = [    1.0000]
25-01-15 02:53:43 | I |         sum  error  = [    0.0457]
25-01-15 02:53:43 | I |         best error  = [    0.0457]
25-01-15 02:53:43 | I |     + error = [0.0457]
25-01-15 02:53:43 | I |       - range scale = [    1.0000]
25-01-15 02:53:43 | I |         sum  error  = [    0.5065]
25-01-15 02:53:43 | I |         best error  = [    0.5065]
25-01-15 02:53:43 | I |     + error = [0.5065]
25-01-15 02:53:43 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:53:44 | I |       - range scale = [    1.0000]
25-01-15 02:53:44 | I |         sum  error  = [    0.0526]
25-01-15 02:53:44 | I |         best error  = [    0.0526]
25-01-15 02:53:44 | I |     + error = [0.0526]
25-01-15 02:53:45 | I |       - range scale = [    1.0000]
25-01-15 02:53:45 | I |         sum  error  = [    0.5834]
25-01-15 02:53:45 | I |         best error  = [    0.5834]
25-01-15 02:53:45 | I |     + error = [0.5834]
25-01-15 02:53:45 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:53:46 | I |       - range scale = [    1.0000]
25-01-15 02:53:46 | I |         sum  error  = [    0.0122]
25-01-15 02:53:46 | I |         best error  = [    0.0122]
25-01-15 02:53:46 | I |     + error = [0.0122]
25-01-15 02:53:46 | I |       - range scale = [    1.0000]
25-01-15 02:53:46 | I |         sum  error  = [    0.1413]
25-01-15 02:53:46 | I |         best error  = [    0.1413]
25-01-15 02:53:46 | I |     + error = [0.1413]
25-01-15 02:53:47 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:53:47 | I |       - range scale = [    1.0000]
25-01-15 02:53:47 | I |         sum  error  = [    0.0492]
25-01-15 02:53:47 | I |         best error  = [    0.0492]
25-01-15 02:53:47 | I |     + error = [0.0492]
25-01-15 02:53:48 | I |       - range scale = [    1.0000]
25-01-15 02:53:48 | I |         sum  error  = [    0.5020]
25-01-15 02:53:48 | I |         best error  = [    0.5020]
25-01-15 02:53:48 | I |     + error = [0.5020]
25-01-15 02:53:48 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:53:49 | I |       - range scale = [    1.0000]
25-01-15 02:53:49 | I |         sum  error  = [    0.3222]
25-01-15 02:53:49 | I |         best error  = [    0.3222]
25-01-15 02:53:49 | I |     + error = [0.3222]
25-01-15 02:53:50 | I |       - range scale = [    1.0000]
25-01-15 02:53:50 | I |         sum  error  = [    3.6785]
25-01-15 02:53:50 | I |         best error  = [    3.6785]
25-01-15 02:53:50 | I |     + error = [3.6785]
25-01-15 02:53:50 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:53:50 | I |       - range scale = [    1.0000]
25-01-15 02:53:50 | I |         sum  error  = [    1.3321]
25-01-15 02:53:50 | I |         best error  = [    1.3321]
25-01-15 02:53:50 | I |     + error = [1.3321]
25-01-15 02:53:51 | I |       - range scale = [    1.0000]
25-01-15 02:53:51 | I |         sum  error  = [   15.3907]
25-01-15 02:53:51 | I |         best error  = [   15.3907]
25-01-15 02:53:51 | I |     + error = [15.3907]
25-01-15 02:53:51 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:53:52 | I |       - range scale = [    1.0000]
25-01-15 02:53:52 | I |         sum  error  = [    6.7596]
25-01-15 02:53:52 | I |         best error  = [    6.7596]
25-01-15 02:53:52 | I |     + error = [6.7596]
25-01-15 02:53:53 | I |       - range scale = [    1.0000]
25-01-15 02:53:53 | I |         sum  error  = [   34.4831]
25-01-15 02:53:53 | I |         best error  = [   34.4831]
25-01-15 02:53:53 | I |     + error = [34.4831]
25-01-15 02:53:53 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:53:54 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:53:56 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:53:57 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:53:59 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:54:00 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:54:02 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:54:05 | I | quantizing activations for layer model.layers.0
25-01-15 02:54:05 | I | collecting info in model.layers.0
25-01-15 02:54:05 | I | collecting info in model.layers.0
25-01-15 02:54:05 | I | collecting info in model.layers.0
25-01-15 02:54:05 | I | collecting info in model.layers.0
25-01-15 02:54:05 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:06 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:08 | I | forward this layer
25-01-15 02:54:08 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/39.pt
25-01-15 02:54:08 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/39.pt
25-01-15 02:54:08 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:54:08 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:54:08 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:54:08 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:54:08 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:54:08 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:54:08 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:54:08 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:54:08 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:54:08 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:54:08 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:54:08 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:54:08 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:54:08 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:54:08 | I | [8] done with optimizer step
25-01-15 02:54:08 | I | epoch 001:     20 / 409600000 loss=0.000215277, loss_per_token=0.440887, loss_sum=14447, wps=188.1, ups=0.01, wpb=32768, bsz=64, num_updates=9, lr=2.7e-05, gnorm=0.494, clip=0, loss_scale=0.0625, train_wall=54, cuda_gb_allocated=10.1, cuda_gb_reserved=11.4, cuda_gb_free=13.6, wall=2317
25-01-15 02:54:08 | I | begin validation on "valid" subset on rank 0
25-01-15 02:54:08 | I | got valid iterator on "valid" subset on rank 0
25-01-15 02:54:08 | I | Valid: Start iterating over samples
25-01-15 02:54:08 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:54:08 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:54:08 | I | - Evaluator: gptq
25-01-15 02:54:08 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:54:08 | I | - Batch_size: 8
25-01-15 02:54:08 | I |   + Max_seq_length: 2048
25-01-15 02:54:34 | I |     - Results:
25-01-15 02:54:34 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-15 02:54:34 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-15 02:54:34 | I |       |wikitext |      1|word_perplexity|7.7078|±  |7.7078|
25-01-15 02:54:34 | I |       |val_valid|      1|word_perplexity|7.4138|±  |7.4138|
25-01-15 02:54:34 | I |       
25-01-15 02:54:34 | I | in valid, quantize current layer weights
25-01-15 02:54:34 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:46 | I | collecting info in model.layers.0
25-01-15 02:54:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:47 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:48 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:49 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:50 | I | collecting calibration activations in model.layers.0
25-01-15 02:54:51 | I |       - range scale = [    1.0000]
25-01-15 02:54:51 | I |         sum  error  = [    0.1249]
25-01-15 02:54:51 | I |         best error  = [    0.1249]
25-01-15 02:54:51 | I |     + error = [0.1249]
25-01-15 02:54:52 | I |       - range scale = [    1.0000]
25-01-15 02:54:52 | I |         sum  error  = [    1.3756]
25-01-15 02:54:52 | I |         best error  = [    1.3756]
25-01-15 02:54:52 | I |     + error = [1.3756]
25-01-15 02:54:53 | I |       - range scale = [    1.0000]
25-01-15 02:54:53 | I |         sum  error  = [    0.1475]
25-01-15 02:54:53 | I |         best error  = [    0.1475]
25-01-15 02:54:53 | I |     + error = [0.1475]
25-01-15 02:54:54 | I |       - range scale = [    1.0000]
25-01-15 02:54:54 | I |         sum  error  = [    1.6876]
25-01-15 02:54:54 | I |         best error  = [    1.6876]
25-01-15 02:54:54 | I |     + error = [1.6876]
25-01-15 02:54:55 | I |       - range scale = [    1.0000]
25-01-15 02:54:55 | I |         sum  error  = [    0.0123]
25-01-15 02:54:55 | I |         best error  = [    0.0123]
25-01-15 02:54:55 | I |     + error = [0.0123]
25-01-15 02:54:56 | I |       - range scale = [    1.0000]
25-01-15 02:54:56 | I |         sum  error  = [    0.1421]
25-01-15 02:54:56 | I |         best error  = [    0.1421]
25-01-15 02:54:56 | I |     + error = [0.1421]
25-01-15 02:54:57 | I |       - range scale = [    1.0000]
25-01-15 02:54:57 | I |         sum  error  = [    0.0536]
25-01-15 02:54:57 | I |         best error  = [    0.0536]
25-01-15 02:54:57 | I |     + error = [0.0536]
25-01-15 02:54:57 | I |       - range scale = [    1.0000]
25-01-15 02:54:57 | I |         sum  error  = [    0.5450]
25-01-15 02:54:57 | I |         best error  = [    0.5450]
25-01-15 02:54:57 | I |     + error = [0.5450]
25-01-15 02:54:58 | I |       - range scale = [    1.0000]
25-01-15 02:54:58 | I |         sum  error  = [    0.3252]
25-01-15 02:54:58 | I |         best error  = [    0.3252]
25-01-15 02:54:58 | I |     + error = [0.3252]
25-01-15 02:54:59 | I |       - range scale = [    1.0000]
25-01-15 02:54:59 | I |         sum  error  = [    3.7142]
25-01-15 02:54:59 | I |         best error  = [    3.7142]
25-01-15 02:54:59 | I |     + error = [3.7142]
25-01-15 02:55:00 | I |       - range scale = [    1.0000]
25-01-15 02:55:00 | I |         sum  error  = [    1.3423]
25-01-15 02:55:00 | I |         best error  = [    1.3423]
25-01-15 02:55:00 | I |     + error = [1.3423]
25-01-15 02:55:01 | I |       - range scale = [    1.0000]
25-01-15 02:55:01 | I |         sum  error  = [   15.5390]
25-01-15 02:55:01 | I |         best error  = [   15.5390]
25-01-15 02:55:01 | I |     + error = [15.5390]
25-01-15 02:55:01 | I |       - range scale = [    1.0000]
25-01-15 02:55:01 | I |         sum  error  = [    8.4956]
25-01-15 02:55:01 | I |         best error  = [    8.4956]
25-01-15 02:55:01 | I |     + error = [8.4956]
25-01-15 02:55:02 | I |       - range scale = [    1.0000]
25-01-15 02:55:02 | I |         sum  error  = [   44.9053]
25-01-15 02:55:02 | I |         best error  = [   44.9053]
25-01-15 02:55:02 | I |     + error = [44.9053]
25-01-15 02:55:15 | I | in valid, quantize current layer acts
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:15 | I | collecting info in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:16 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:17 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:18 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:19 | I | collecting calibration activations in model.layers.0
25-01-15 02:55:21 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-15 02:55:21 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:55:21 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:55:21 | I | - Evaluator: gptq
25-01-15 02:55:21 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:55:21 | I | - Batch_size: 8
25-01-15 02:55:21 | I |   + Max_seq_length: 2048
25-01-15 02:55:49 | I |     - Results:
25-01-15 02:55:49 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-15 02:55:49 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-15 02:55:49 | I |       |wikitext |      1|word_perplexity|7.7978|±  |7.7978|
25-01-15 02:55:49 | I |       |val_valid|      1|word_perplexity|7.4908|±  |7.4908|
25-01-15 02:55:49 | I |       
25-01-15 02:56:07 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.639, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.23, wps=25650.4, wpb=4058.2, bsz=2, num_updates=9, lmquant_ppl_wikitext_all_quanted=7.70778, lmquant_ppl_val_all_quanted=7.4138, lmquant_ppl_wikitext_partly_quanted=7.79785, lmquant_ppl_val_partly_quanted=7.49077
25-01-15 02:56:07 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.639 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.23 | wps 25650.4 | wpb 4058.2 | bsz 2 | num_updates 9 | lmquant_ppl_wikitext_all_quanted 7.70778 | lmquant_ppl_val_all_quanted 7.4138 | lmquant_ppl_wikitext_partly_quanted 7.79785 | lmquant_ppl_val_partly_quanted 7.49077
25-01-15 02:56:07 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:56:07 | I | in layer model.layers.0
25-01-15 02:56:07 | I | quantizing weights for layer model.layers.0
25-01-15 02:56:07 | I | collecting info in model.layers.0
25-01-15 02:56:07 | I | collecting info in model.layers.0
25-01-15 02:56:07 | I | collecting info in model.layers.0
25-01-15 02:56:07 | I | collecting info in model.layers.0
25-01-15 02:56:07 | I | collecting calibration activations in model.layers.0
25-01-15 02:56:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:56:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:56:08 | I | collecting calibration activations in model.layers.0
25-01-15 02:56:08 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:56:08 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:56:09 | I |       - range scale = [    1.0000]
25-01-15 02:56:09 | I |         sum  error  = [    0.0453]
25-01-15 02:56:09 | I |         best error  = [    0.0453]
25-01-15 02:56:09 | I |     + error = [0.0453]
25-01-15 02:56:09 | I |       - range scale = [    1.0000]
25-01-15 02:56:09 | I |         sum  error  = [    0.4999]
25-01-15 02:56:09 | I |         best error  = [    0.4999]
25-01-15 02:56:09 | I |     + error = [0.4999]
25-01-15 02:56:10 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:56:10 | I |       - range scale = [    1.0000]
25-01-15 02:56:10 | I |         sum  error  = [    0.0533]
25-01-15 02:56:10 | I |         best error  = [    0.0533]
25-01-15 02:56:10 | I |     + error = [0.0533]
25-01-15 02:56:11 | I |       - range scale = [    1.0000]
25-01-15 02:56:11 | I |         sum  error  = [    0.6195]
25-01-15 02:56:11 | I |         best error  = [    0.6195]
25-01-15 02:56:11 | I |     + error = [0.6195]
25-01-15 02:56:11 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:56:12 | I |       - range scale = [    1.0000]
25-01-15 02:56:12 | I |         sum  error  = [    0.0124]
25-01-15 02:56:12 | I |         best error  = [    0.0124]
25-01-15 02:56:12 | I |     + error = [0.0124]
25-01-15 02:56:12 | I |       - range scale = [    1.0000]
25-01-15 02:56:12 | I |         sum  error  = [    0.1424]
25-01-15 02:56:12 | I |         best error  = [    0.1424]
25-01-15 02:56:12 | I |     + error = [0.1424]
25-01-15 02:56:13 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:56:13 | I |       - range scale = [    1.0000]
25-01-15 02:56:13 | I |         sum  error  = [    0.0564]
25-01-15 02:56:13 | I |         best error  = [    0.0564]
25-01-15 02:56:13 | I |     + error = [0.0564]
25-01-15 02:56:14 | I |       - range scale = [    1.0000]
25-01-15 02:56:14 | I |         sum  error  = [    0.5737]
25-01-15 02:56:14 | I |         best error  = [    0.5737]
25-01-15 02:56:14 | I |     + error = [0.5737]
25-01-15 02:56:14 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:56:15 | I |       - range scale = [    1.0000]
25-01-15 02:56:15 | I |         sum  error  = [    0.3233]
25-01-15 02:56:15 | I |         best error  = [    0.3233]
25-01-15 02:56:15 | I |     + error = [0.3233]
25-01-15 02:56:15 | I |       - range scale = [    1.0000]
25-01-15 02:56:15 | I |         sum  error  = [    3.6935]
25-01-15 02:56:15 | I |         best error  = [    3.6935]
25-01-15 02:56:15 | I |     + error = [3.6935]
25-01-15 02:56:16 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:56:16 | I |       - range scale = [    1.0000]
25-01-15 02:56:16 | I |         sum  error  = [    1.3350]
25-01-15 02:56:16 | I |         best error  = [    1.3350]
25-01-15 02:56:16 | I |     + error = [1.3350]
25-01-15 02:56:17 | I |       - range scale = [    1.0000]
25-01-15 02:56:17 | I |         sum  error  = [   15.4504]
25-01-15 02:56:17 | I |         best error  = [   15.4504]
25-01-15 02:56:17 | I |     + error = [15.4504]
25-01-15 02:56:17 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:56:18 | I |       - range scale = [    1.0000]
25-01-15 02:56:18 | I |         sum  error  = [    7.5675]
25-01-15 02:56:18 | I |         best error  = [    7.5675]
25-01-15 02:56:18 | I |     + error = [7.5675]
25-01-15 02:56:19 | I |       - range scale = [    1.0000]
25-01-15 02:56:19 | I |         sum  error  = [   41.3229]
25-01-15 02:56:19 | I |         best error  = [   41.3229]
25-01-15 02:56:19 | I |     + error = [41.3229]
25-01-15 02:56:19 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:56:20 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:56:22 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:56:23 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:56:24 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:56:26 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:56:27 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:56:31 | I | quantizing activations for layer model.layers.0
25-01-15 02:56:31 | I | collecting info in model.layers.0
25-01-15 02:56:31 | I | collecting info in model.layers.0
25-01-15 02:56:31 | I | collecting info in model.layers.0
25-01-15 02:56:31 | I | collecting info in model.layers.0
25-01-15 02:56:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:56:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:56:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:56:31 | I | collecting calibration activations in model.layers.0
25-01-15 02:56:33 | I | forward this layer
25-01-15 02:56:33 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/40.pt
25-01-15 02:56:33 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/40.pt
25-01-15 02:56:33 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:56:33 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:56:33 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:56:33 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:56:33 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:56:33 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:56:33 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:56:33 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:56:33 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:56:33 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:56:33 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:56:33 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:56:33 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:56:33 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:56:33 | I | in layer model.layers.0
25-01-15 02:56:33 | I | quantizing weights for layer model.layers.0
25-01-15 02:56:33 | I | collecting info in model.layers.0
25-01-15 02:56:33 | I | collecting info in model.layers.0
25-01-15 02:56:33 | I | collecting info in model.layers.0
25-01-15 02:56:33 | I | collecting info in model.layers.0
25-01-15 02:56:34 | I | collecting calibration activations in model.layers.0
25-01-15 02:56:34 | I | collecting calibration activations in model.layers.0
25-01-15 02:56:34 | I | collecting calibration activations in model.layers.0
25-01-15 02:56:34 | I | collecting calibration activations in model.layers.0
25-01-15 02:56:34 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:56:34 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:56:35 | I |       - range scale = [    1.0000]
25-01-15 02:56:35 | I |         sum  error  = [    0.0461]
25-01-15 02:56:35 | I |         best error  = [    0.0461]
25-01-15 02:56:35 | I |     + error = [0.0461]
25-01-15 02:56:36 | I |       - range scale = [    1.0000]
25-01-15 02:56:36 | I |         sum  error  = [    0.5129]
25-01-15 02:56:36 | I |         best error  = [    0.5129]
25-01-15 02:56:36 | I |     + error = [0.5129]
25-01-15 02:56:36 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:56:37 | I |       - range scale = [    1.0000]
25-01-15 02:56:37 | I |         sum  error  = [    0.0501]
25-01-15 02:56:37 | I |         best error  = [    0.0501]
25-01-15 02:56:37 | I |     + error = [0.0501]
25-01-15 02:56:37 | I |       - range scale = [    1.0000]
25-01-15 02:56:37 | I |         sum  error  = [    0.5641]
25-01-15 02:56:37 | I |         best error  = [    0.5641]
25-01-15 02:56:37 | I |     + error = [0.5641]
25-01-15 02:56:37 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:56:38 | I |       - range scale = [    1.0000]
25-01-15 02:56:38 | I |         sum  error  = [    0.0121]
25-01-15 02:56:38 | I |         best error  = [    0.0121]
25-01-15 02:56:38 | I |     + error = [0.0121]
25-01-15 02:56:39 | I |       - range scale = [    1.0000]
25-01-15 02:56:39 | I |         sum  error  = [    0.1409]
25-01-15 02:56:39 | I |         best error  = [    0.1409]
25-01-15 02:56:39 | I |     + error = [0.1409]
25-01-15 02:56:39 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:56:40 | I |       - range scale = [    1.0000]
25-01-15 02:56:40 | I |         sum  error  = [    0.0531]
25-01-15 02:56:40 | I |         best error  = [    0.0531]
25-01-15 02:56:40 | I |     + error = [0.0531]
25-01-15 02:56:40 | I |       - range scale = [    1.0000]
25-01-15 02:56:40 | I |         sum  error  = [    0.5383]
25-01-15 02:56:40 | I |         best error  = [    0.5383]
25-01-15 02:56:40 | I |     + error = [0.5383]
25-01-15 02:56:40 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:56:41 | I |       - range scale = [    1.0000]
25-01-15 02:56:41 | I |         sum  error  = [    0.3223]
25-01-15 02:56:41 | I |         best error  = [    0.3223]
25-01-15 02:56:41 | I |     + error = [0.3223]
25-01-15 02:56:42 | I |       - range scale = [    1.0000]
25-01-15 02:56:42 | I |         sum  error  = [    3.6782]
25-01-15 02:56:42 | I |         best error  = [    3.6782]
25-01-15 02:56:42 | I |     + error = [3.6782]
25-01-15 02:56:42 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:56:43 | I |       - range scale = [    1.0000]
25-01-15 02:56:43 | I |         sum  error  = [    1.3310]
25-01-15 02:56:43 | I |         best error  = [    1.3310]
25-01-15 02:56:43 | I |     + error = [1.3310]
25-01-15 02:56:43 | I |       - range scale = [    1.0000]
25-01-15 02:56:43 | I |         sum  error  = [   15.3855]
25-01-15 02:56:43 | I |         best error  = [   15.3855]
25-01-15 02:56:43 | I |     + error = [15.3855]
25-01-15 02:56:44 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:56:44 | I |       - range scale = [    1.0000]
25-01-15 02:56:44 | I |         sum  error  = [    7.2536]
25-01-15 02:56:44 | I |         best error  = [    7.2536]
25-01-15 02:56:44 | I |     + error = [7.2536]
25-01-15 02:56:45 | I |       - range scale = [    1.0000]
25-01-15 02:56:45 | I |         sum  error  = [   38.6032]
25-01-15 02:56:45 | I |         best error  = [   38.6032]
25-01-15 02:56:45 | I |     + error = [38.6032]
25-01-15 02:56:45 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:56:47 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:56:48 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:56:49 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:56:51 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:56:52 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:56:53 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:56:57 | I | quantizing activations for layer model.layers.0
25-01-15 02:56:57 | I | collecting info in model.layers.0
25-01-15 02:56:57 | I | collecting info in model.layers.0
25-01-15 02:56:57 | I | collecting info in model.layers.0
25-01-15 02:56:57 | I | collecting info in model.layers.0
25-01-15 02:56:57 | I | collecting calibration activations in model.layers.0
25-01-15 02:56:57 | I | collecting calibration activations in model.layers.0
25-01-15 02:56:57 | I | collecting calibration activations in model.layers.0
25-01-15 02:56:57 | I | collecting calibration activations in model.layers.0
25-01-15 02:56:59 | I | forward this layer
25-01-15 02:56:59 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/41.pt
25-01-15 02:56:59 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/41.pt
25-01-15 02:56:59 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:56:59 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:56:59 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:56:59 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:56:59 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:56:59 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:56:59 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:56:59 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:56:59 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:56:59 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:56:59 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:56:59 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:56:59 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:56:59 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:56:59 | I | [9] done with optimizer step
25-01-15 02:56:59 | I | epoch 001:     21 / 409600000 loss=0.000194368, loss_per_token=0.398065, loss_sum=13043.8, wps=191.1, ups=0.01, wpb=32768, bsz=64, num_updates=10, lr=3e-05, gnorm=0.41, clip=0, loss_scale=0.0625, train_wall=52, cuda_gb_allocated=10.1, cuda_gb_reserved=11.4, cuda_gb_free=13.6, wall=2489
25-01-15 02:56:59 | I | begin validation on "valid" subset on rank 0
25-01-15 02:56:59 | I | got valid iterator on "valid" subset on rank 0
25-01-15 02:56:59 | I | Valid: Start iterating over samples
25-01-15 02:56:59 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:56:59 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:56:59 | I | - Evaluator: gptq
25-01-15 02:56:59 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:56:59 | I | - Batch_size: 8
25-01-15 02:56:59 | I |   + Max_seq_length: 2048
25-01-15 02:57:25 | I |     - Results:
25-01-15 02:57:25 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-15 02:57:25 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-15 02:57:25 | I |       |wikitext |      1|word_perplexity|7.7078|±  |7.7078|
25-01-15 02:57:25 | I |       |val_valid|      1|word_perplexity|7.4138|±  |7.4138|
25-01-15 02:57:25 | I |       
25-01-15 02:57:25 | I | in valid, quantize current layer weights
25-01-15 02:57:26 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:38 | I | collecting info in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:39 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:40 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:41 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:42 | I | collecting calibration activations in model.layers.0
25-01-15 02:57:43 | I |       - range scale = [    1.0000]
25-01-15 02:57:43 | I |         sum  error  = [    0.1249]
25-01-15 02:57:43 | I |         best error  = [    0.1249]
25-01-15 02:57:43 | I |     + error = [0.1249]
25-01-15 02:57:44 | I |       - range scale = [    1.0000]
25-01-15 02:57:44 | I |         sum  error  = [    1.3756]
25-01-15 02:57:44 | I |         best error  = [    1.3756]
25-01-15 02:57:44 | I |     + error = [1.3756]
25-01-15 02:57:45 | I |       - range scale = [    1.0000]
25-01-15 02:57:45 | I |         sum  error  = [    0.1475]
25-01-15 02:57:45 | I |         best error  = [    0.1475]
25-01-15 02:57:45 | I |     + error = [0.1475]
25-01-15 02:57:46 | I |       - range scale = [    1.0000]
25-01-15 02:57:46 | I |         sum  error  = [    1.6876]
25-01-15 02:57:46 | I |         best error  = [    1.6876]
25-01-15 02:57:46 | I |     + error = [1.6876]
25-01-15 02:57:47 | I |       - range scale = [    1.0000]
25-01-15 02:57:47 | I |         sum  error  = [    0.0123]
25-01-15 02:57:47 | I |         best error  = [    0.0123]
25-01-15 02:57:47 | I |     + error = [0.0123]
25-01-15 02:57:48 | I |       - range scale = [    1.0000]
25-01-15 02:57:48 | I |         sum  error  = [    0.1421]
25-01-15 02:57:48 | I |         best error  = [    0.1421]
25-01-15 02:57:48 | I |     + error = [0.1421]
25-01-15 02:57:49 | I |       - range scale = [    1.0000]
25-01-15 02:57:49 | I |         sum  error  = [    0.0536]
25-01-15 02:57:49 | I |         best error  = [    0.0536]
25-01-15 02:57:49 | I |     + error = [0.0536]
25-01-15 02:57:49 | I |       - range scale = [    1.0000]
25-01-15 02:57:49 | I |         sum  error  = [    0.5450]
25-01-15 02:57:49 | I |         best error  = [    0.5450]
25-01-15 02:57:49 | I |     + error = [0.5450]
25-01-15 02:57:50 | I |       - range scale = [    1.0000]
25-01-15 02:57:50 | I |         sum  error  = [    0.3252]
25-01-15 02:57:50 | I |         best error  = [    0.3252]
25-01-15 02:57:50 | I |     + error = [0.3252]
25-01-15 02:57:51 | I |       - range scale = [    1.0000]
25-01-15 02:57:51 | I |         sum  error  = [    3.7142]
25-01-15 02:57:51 | I |         best error  = [    3.7142]
25-01-15 02:57:51 | I |     + error = [3.7142]
25-01-15 02:57:52 | I |       - range scale = [    1.0000]
25-01-15 02:57:52 | I |         sum  error  = [    1.3423]
25-01-15 02:57:52 | I |         best error  = [    1.3423]
25-01-15 02:57:52 | I |     + error = [1.3423]
25-01-15 02:57:53 | I |       - range scale = [    1.0000]
25-01-15 02:57:53 | I |         sum  error  = [   15.5390]
25-01-15 02:57:53 | I |         best error  = [   15.5390]
25-01-15 02:57:53 | I |     + error = [15.5390]
25-01-15 02:57:53 | I |       - range scale = [    1.0000]
25-01-15 02:57:53 | I |         sum  error  = [    8.4956]
25-01-15 02:57:53 | I |         best error  = [    8.4956]
25-01-15 02:57:53 | I |     + error = [8.4956]
25-01-15 02:57:54 | I |       - range scale = [    1.0000]
25-01-15 02:57:54 | I |         sum  error  = [   44.9053]
25-01-15 02:57:54 | I |         best error  = [   44.9053]
25-01-15 02:57:54 | I |     + error = [44.9053]
25-01-15 02:58:09 | I | in valid, quantize current layer acts
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:09 | I | collecting info in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:10 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:11 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:12 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:13 | I | collecting calibration activations in model.layers.0
25-01-15 02:58:15 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-15 02:58:15 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:58:15 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:58:15 | I | - Evaluator: gptq
25-01-15 02:58:15 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:58:15 | I | - Batch_size: 8
25-01-15 02:58:15 | I |   + Max_seq_length: 2048
25-01-15 02:58:43 | I |     - Results:
25-01-15 02:58:43 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-15 02:58:43 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-15 02:58:43 | I |       |wikitext |      1|word_perplexity|7.7978|±  |7.7978|
25-01-15 02:58:43 | I |       |val_valid|      1|word_perplexity|7.4908|±  |7.4908|
25-01-15 02:58:43 | I |       
25-01-15 02:59:01 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.639, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.23, wps=25701.5, wpb=4058.2, bsz=2, num_updates=10, lmquant_ppl_wikitext_all_quanted=7.70778, lmquant_ppl_val_all_quanted=7.4138, lmquant_ppl_wikitext_partly_quanted=7.79785, lmquant_ppl_val_partly_quanted=7.49077
25-01-15 02:59:01 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.639 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.23 | wps 25701.5 | wpb 4058.2 | bsz 2 | num_updates 10 | lmquant_ppl_wikitext_all_quanted 7.70778 | lmquant_ppl_val_all_quanted 7.4138 | lmquant_ppl_wikitext_partly_quanted 7.79785 | lmquant_ppl_val_partly_quanted 7.49077
25-01-15 02:59:01 | I | TRAIN CURRENT LAYER_IDX = 0
25-01-15 02:59:01 | I | in layer model.layers.0
25-01-15 02:59:01 | I | quantizing weights for layer model.layers.0
25-01-15 02:59:01 | I | collecting info in model.layers.0
25-01-15 02:59:01 | I | collecting info in model.layers.0
25-01-15 02:59:01 | I | collecting info in model.layers.0
25-01-15 02:59:01 | I | collecting info in model.layers.0
25-01-15 02:59:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:59:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:59:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:59:02 | I | collecting calibration activations in model.layers.0
25-01-15 02:59:02 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:59:02 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:59:03 | I |       - range scale = [    1.0000]
25-01-15 02:59:03 | I |         sum  error  = [    0.0464]
25-01-15 02:59:03 | I |         best error  = [    0.0464]
25-01-15 02:59:03 | I |     + error = [0.0464]
25-01-15 02:59:04 | I |       - range scale = [    1.0000]
25-01-15 02:59:04 | I |         sum  error  = [    0.5292]
25-01-15 02:59:04 | I |         best error  = [    0.5292]
25-01-15 02:59:04 | I |     + error = [0.5292]
25-01-15 02:59:04 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:59:05 | I |       - range scale = [    1.0000]
25-01-15 02:59:05 | I |         sum  error  = [    0.0500]
25-01-15 02:59:05 | I |         best error  = [    0.0500]
25-01-15 02:59:05 | I |     + error = [0.0500]
25-01-15 02:59:05 | I |       - range scale = [    1.0000]
25-01-15 02:59:05 | I |         sum  error  = [    0.5547]
25-01-15 02:59:05 | I |         best error  = [    0.5547]
25-01-15 02:59:05 | I |     + error = [0.5547]
25-01-15 02:59:05 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:59:06 | I |       - range scale = [    1.0000]
25-01-15 02:59:06 | I |         sum  error  = [    0.0122]
25-01-15 02:59:06 | I |         best error  = [    0.0122]
25-01-15 02:59:06 | I |     + error = [0.0122]
25-01-15 02:59:07 | I |       - range scale = [    1.0000]
25-01-15 02:59:07 | I |         sum  error  = [    0.1407]
25-01-15 02:59:07 | I |         best error  = [    0.1407]
25-01-15 02:59:07 | I |     + error = [0.1407]
25-01-15 02:59:07 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:59:08 | I |       - range scale = [    1.0000]
25-01-15 02:59:08 | I |         sum  error  = [    0.0536]
25-01-15 02:59:08 | I |         best error  = [    0.0536]
25-01-15 02:59:08 | I |     + error = [0.0536]
25-01-15 02:59:08 | I |       - range scale = [    1.0000]
25-01-15 02:59:08 | I |         sum  error  = [    0.5397]
25-01-15 02:59:08 | I |         best error  = [    0.5397]
25-01-15 02:59:08 | I |     + error = [0.5397]
25-01-15 02:59:09 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:59:09 | I |       - range scale = [    1.0000]
25-01-15 02:59:09 | I |         sum  error  = [    0.3228]
25-01-15 02:59:09 | I |         best error  = [    0.3228]
25-01-15 02:59:09 | I |     + error = [0.3228]
25-01-15 02:59:10 | I |       - range scale = [    1.0000]
25-01-15 02:59:10 | I |         sum  error  = [    3.6797]
25-01-15 02:59:10 | I |         best error  = [    3.6797]
25-01-15 02:59:10 | I |     + error = [3.6797]
25-01-15 02:59:10 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:59:11 | I |       - range scale = [    1.0000]
25-01-15 02:59:11 | I |         sum  error  = [    1.3289]
25-01-15 02:59:11 | I |         best error  = [    1.3289]
25-01-15 02:59:11 | I |     + error = [1.3289]
25-01-15 02:59:12 | I |       - range scale = [    1.0000]
25-01-15 02:59:12 | I |         sum  error  = [   15.3966]
25-01-15 02:59:12 | I |         best error  = [   15.3966]
25-01-15 02:59:12 | I |     + error = [15.3966]
25-01-15 02:59:12 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:59:13 | I |       - range scale = [    1.0000]
25-01-15 02:59:13 | I |         sum  error  = [    8.6445]
25-01-15 02:59:13 | I |         best error  = [    8.6445]
25-01-15 02:59:13 | I |     + error = [8.6445]
25-01-15 02:59:13 | I |       - range scale = [    1.0000]
25-01-15 02:59:13 | I |         sum  error  = [   46.9618]
25-01-15 02:59:13 | I |         best error  = [   46.9618]
25-01-15 02:59:13 | I |     + error = [46.9618]
25-01-15 02:59:14 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:59:15 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:59:16 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:59:18 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:59:19 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:59:21 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:59:22 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:59:25 | I | quantizing activations for layer model.layers.0
25-01-15 02:59:25 | I | collecting info in model.layers.0
25-01-15 02:59:25 | I | collecting info in model.layers.0
25-01-15 02:59:25 | I | collecting info in model.layers.0
25-01-15 02:59:25 | I | collecting info in model.layers.0
25-01-15 02:59:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:59:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:59:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:59:26 | I | collecting calibration activations in model.layers.0
25-01-15 02:59:28 | I | forward this layer
25-01-15 02:59:28 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/42.pt
25-01-15 02:59:28 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/42.pt
25-01-15 02:59:28 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:59:28 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:59:28 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:59:28 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:59:28 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:59:28 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:59:28 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:59:28 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:59:28 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:59:28 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:59:28 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:59:28 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:59:28 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:59:28 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:59:28 | I | in layer model.layers.0
25-01-15 02:59:28 | I | quantizing weights for layer model.layers.0
25-01-15 02:59:28 | I | collecting info in model.layers.0
25-01-15 02:59:28 | I | collecting info in model.layers.0
25-01-15 02:59:28 | I | collecting info in model.layers.0
25-01-15 02:59:28 | I | collecting info in model.layers.0
25-01-15 02:59:28 | I | collecting calibration activations in model.layers.0
25-01-15 02:59:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:59:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:59:29 | I | collecting calibration activations in model.layers.0
25-01-15 02:59:29 | I | - Quantizing decoder layer model.layers.0
25-01-15 02:59:29 | I |   - Calibrating model.layers.0.self_attn.q_proj.weight
25-01-15 02:59:30 | I |       - range scale = [    1.0000]
25-01-15 02:59:30 | I |         sum  error  = [    0.0423]
25-01-15 02:59:30 | I |         best error  = [    0.0423]
25-01-15 02:59:30 | I |     + error = [0.0423]
25-01-15 02:59:30 | I |       - range scale = [    1.0000]
25-01-15 02:59:30 | I |         sum  error  = [    0.4795]
25-01-15 02:59:30 | I |         best error  = [    0.4795]
25-01-15 02:59:30 | I |     + error = [0.4795]
25-01-15 02:59:31 | I |   - Calibrating model.layers.0.self_attn.k_proj.weight
25-01-15 02:59:31 | I |       - range scale = [    1.0000]
25-01-15 02:59:31 | I |         sum  error  = [    0.0542]
25-01-15 02:59:31 | I |         best error  = [    0.0542]
25-01-15 02:59:31 | I |     + error = [0.0542]
25-01-15 02:59:32 | I |       - range scale = [    1.0000]
25-01-15 02:59:32 | I |         sum  error  = [    0.5931]
25-01-15 02:59:32 | I |         best error  = [    0.5931]
25-01-15 02:59:32 | I |     + error = [0.5931]
25-01-15 02:59:32 | I |   - Calibrating model.layers.0.self_attn.v_proj.weight
25-01-15 02:59:33 | I |       - range scale = [    1.0000]
25-01-15 02:59:33 | I |         sum  error  = [    0.0123]
25-01-15 02:59:33 | I |         best error  = [    0.0123]
25-01-15 02:59:33 | I |     + error = [0.0123]
25-01-15 02:59:34 | I |       - range scale = [    1.0000]
25-01-15 02:59:34 | I |         sum  error  = [    0.1425]
25-01-15 02:59:34 | I |         best error  = [    0.1425]
25-01-15 02:59:34 | I |     + error = [0.1425]
25-01-15 02:59:34 | I |   - Calibrating model.layers.0.self_attn.o_proj.weight
25-01-15 02:59:35 | I |       - range scale = [    1.0000]
25-01-15 02:59:35 | I |         sum  error  = [    0.0544]
25-01-15 02:59:35 | I |         best error  = [    0.0544]
25-01-15 02:59:35 | I |     + error = [0.0544]
25-01-15 02:59:35 | I |       - range scale = [    1.0000]
25-01-15 02:59:35 | I |         sum  error  = [    0.5575]
25-01-15 02:59:35 | I |         best error  = [    0.5575]
25-01-15 02:59:35 | I |     + error = [0.5575]
25-01-15 02:59:35 | I |   - Calibrating model.layers.0.mlp.up_proj.weight
25-01-15 02:59:36 | I |       - range scale = [    1.0000]
25-01-15 02:59:36 | I |         sum  error  = [    0.3236]
25-01-15 02:59:36 | I |         best error  = [    0.3236]
25-01-15 02:59:36 | I |     + error = [0.3236]
25-01-15 02:59:37 | I |       - range scale = [    1.0000]
25-01-15 02:59:37 | I |         sum  error  = [    3.6982]
25-01-15 02:59:37 | I |         best error  = [    3.6982]
25-01-15 02:59:37 | I |     + error = [3.6982]
25-01-15 02:59:37 | I |   - Calibrating model.layers.0.mlp.gate_proj.weight
25-01-15 02:59:38 | I |       - range scale = [    1.0000]
25-01-15 02:59:38 | I |         sum  error  = [    1.3357]
25-01-15 02:59:38 | I |         best error  = [    1.3357]
25-01-15 02:59:38 | I |     + error = [1.3357]
25-01-15 02:59:38 | I |       - range scale = [    1.0000]
25-01-15 02:59:38 | I |         sum  error  = [   15.4716]
25-01-15 02:59:38 | I |         best error  = [   15.4716]
25-01-15 02:59:38 | I |     + error = [15.4716]
25-01-15 02:59:39 | I |   - Calibrating model.layers.0.mlp.down_proj.weight
25-01-15 02:59:39 | I |       - range scale = [    1.0000]
25-01-15 02:59:39 | I |         sum  error  = [    6.1083]
25-01-15 02:59:39 | I |         best error  = [    6.1083]
25-01-15 02:59:39 | I |     + error = [6.1083]
25-01-15 02:59:40 | I |       - range scale = [    1.0000]
25-01-15 02:59:40 | I |         sum  error  = [   32.6761]
25-01-15 02:59:40 | I |         best error  = [   32.6761]
25-01-15 02:59:40 | I |     + error = [32.6761]
25-01-15 02:59:40 | I |   - Quantizing model.layers.0.self_attn.q_proj.weight
25-01-15 02:59:42 | I |   - Quantizing model.layers.0.self_attn.k_proj.weight
25-01-15 02:59:43 | I |   - Quantizing model.layers.0.self_attn.v_proj.weight
25-01-15 02:59:44 | I |   - Quantizing model.layers.0.self_attn.o_proj.weight
25-01-15 02:59:46 | I |   - Quantizing model.layers.0.mlp.up_proj.weight
25-01-15 02:59:47 | I |   - Quantizing model.layers.0.mlp.gate_proj.weight
25-01-15 02:59:49 | I |   - Quantizing model.layers.0.mlp.down_proj.weight
25-01-15 02:59:52 | I | quantizing activations for layer model.layers.0
25-01-15 02:59:52 | I | collecting info in model.layers.0
25-01-15 02:59:52 | I | collecting info in model.layers.0
25-01-15 02:59:52 | I | collecting info in model.layers.0
25-01-15 02:59:52 | I | collecting info in model.layers.0
25-01-15 02:59:52 | I | collecting calibration activations in model.layers.0
25-01-15 02:59:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:59:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:59:53 | I | collecting calibration activations in model.layers.0
25-01-15 02:59:55 | I | forward this layer
25-01-15 02:59:55 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_input_args_layer_0/43.pt
25-01-15 02:59:55 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_with_preprocess_llama_1.1b/shard/val_teacher_output_layer_0/43.pt
25-01-15 02:59:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has nan: False
25-01-15 02:59:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.q_proj has inf: False
25-01-15 02:59:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has nan: False
25-01-15 02:59:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.k_proj has inf: False
25-01-15 02:59:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has nan: False
25-01-15 02:59:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.v_proj has inf: False
25-01-15 02:59:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has nan: False
25-01-15 02:59:55 | I | In layer model.layers.0, gradient of model.layers.0.self_attn.o_proj has inf: False
25-01-15 02:59:55 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has nan: False
25-01-15 02:59:55 | I | In layer model.layers.0, gradient of model.layers.0.mlp.up_proj has inf: False
25-01-15 02:59:55 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has nan: False
25-01-15 02:59:55 | I | In layer model.layers.0, gradient of model.layers.0.mlp.gate_proj has inf: False
25-01-15 02:59:55 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has nan: False
25-01-15 02:59:55 | I | In layer model.layers.0, gradient of model.layers.0.mlp.down_proj has inf: False
25-01-15 02:59:55 | I | [10] done with optimizer step
25-01-15 02:59:55 | I | epoch 001:     22 / 409600000 loss=0.000203306, loss_per_token=0.416371, loss_sum=13643.6, wps=186.6, ups=0.01, wpb=32768, bsz=64, num_updates=11, lr=3.3e-05, gnorm=0.481, clip=0, loss_scale=0.0625, train_wall=54, cuda_gb_allocated=10.1, cuda_gb_reserved=11.4, cuda_gb_free=13.6, wall=2664
25-01-15 02:59:55 | I | begin validation on "valid" subset on rank 0
25-01-15 02:59:55 | I | got valid iterator on "valid" subset on rank 0
25-01-15 02:59:55 | I | Valid: Start iterating over samples
25-01-15 02:59:55 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-15 02:59:55 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-15 02:59:55 | I | - Evaluator: gptq
25-01-15 02:59:55 | I | - Tasks: ['wikitext', 'val_valid']
25-01-15 02:59:55 | I | - Batch_size: 8
25-01-15 02:59:55 | I |   + Max_seq_length: 2048
