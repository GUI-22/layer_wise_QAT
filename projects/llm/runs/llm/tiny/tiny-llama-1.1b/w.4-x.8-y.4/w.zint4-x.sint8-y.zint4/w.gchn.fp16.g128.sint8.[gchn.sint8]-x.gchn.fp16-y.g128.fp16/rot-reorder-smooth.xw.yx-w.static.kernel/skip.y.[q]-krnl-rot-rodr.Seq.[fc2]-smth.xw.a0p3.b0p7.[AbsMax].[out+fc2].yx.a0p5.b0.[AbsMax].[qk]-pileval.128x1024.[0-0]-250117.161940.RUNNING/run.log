25-01-17 16:19:40 | I | === Configurations ===
25-01-17 16:19:40 | I | LlmRunConfig(
25-01-17 16:19:40 | I |   model=LlmModelConfig(
25-01-17 16:19:40 | I |     name=tiny-llama-1.1b,
25-01-17 16:19:40 | I |     path=/data/gyy/TinyLlama,
25-01-17 16:19:40 | I |     root=/dataset/models,
25-01-17 16:19:40 | I |     local_path=/dataset/models/tiny/tiny-llama-1.1b,
25-01-17 16:19:40 | I |     local_root=/dataset/models,
25-01-17 16:19:40 | I |     family=tiny,
25-01-17 16:19:40 | I |     size=1.1),
25-01-17 16:19:40 | I |   eval=LlmEvalConfig(
25-01-17 16:19:40 | I |     num_gpus=1,
25-01-17 16:19:40 | I |     batch_size=8,
25-01-17 16:19:40 | I |     output_root=runs,
25-01-17 16:19:40 | I |     output_dirname=skip.y.[q]-krnl-rot-rodr.Seq.[fc2]-smth.xw.a0p3.b0p7.[AbsMax].[out+fc2].yx.a0p5.b0.[AbsMax].[qk]-pileval.128x1024.[0-0]-250117.161940,
25-01-17 16:19:40 | I |     attach_timestamp=True,
25-01-17 16:19:40 | I |     timestamp=250117.161940,
25-01-17 16:19:40 | I |     output_dirname_without_timestamp=skip.y.[q]-krnl-rot-rodr.Seq.[fc2]-smth.xw.a0p3.b0p7.[AbsMax].[out+fc2].yx.a0p5.b0.[AbsMax].[qk]-pileval.128x1024.[0-0],
25-01-17 16:19:40 | I |     tasks=['wikitext'],
25-01-17 16:19:40 | I |     max_seq_length=-4096,
25-01-17 16:19:40 | I |     evaluator=gptq),
25-01-17 16:19:40 | I |   calib=LlmCalibConfig(
25-01-17 16:19:40 | I |     data=pileval,
25-01-17 16:19:40 | I |     num_samples=128,
25-01-17 16:19:40 | I |     cache_root=runs,
25-01-17 16:19:40 | I |     cache_dirpath=runs/llm/cache/pileval.128x1024.[0-0],
25-01-17 16:19:40 | I |     dataset_path=mit-han-lab/pile-val-backup,
25-01-17 16:19:40 | I |     seq_length=1024,
25-01-17 16:19:40 | I |     min_seq_length=0,
25-01-17 16:19:40 | I |     max_seq_length=0,
25-01-17 16:19:40 | I |     local_dataset_path=/dataset/pile),
25-01-17 16:19:40 | I |   quant=LlmQuantConfig(
25-01-17 16:19:40 | I |     wgts=WeightQuantizerConfig(
25-01-17 16:19:40 | I |       dtype=zint4,
25-01-17 16:19:40 | I |       group_shapes=((1, -1, -1), (1, 128, -1)),
25-01-17 16:19:40 | I |       group_scale_dtypes=(torch.float16, sint8),
25-01-17 16:19:40 | I |       compute_dtype=sint8,
25-01-17 16:19:40 | I |       compute_group_level=0,
25-01-17 16:19:40 | I |       saturate_compute_dtype=False,
25-01-17 16:19:40 | I |       exponent_scaling_level=2,
25-01-17 16:19:40 | I |       skips=['embed', 'head', 'router'],
25-01-17 16:19:40 | I |       static=True,
25-01-17 16:19:40 | I |       calib_kernel=QuantizerKernelConfig(
25-01-17 16:19:40 | I |         _kernels={'proj_1st': QuantGPTQConfig(includes=['proj_1st', 'proj_2nd', 'proj_out', 'proj_qkv'], damp_percentage=0.01, block_size=128, num_inv_tries=250, hessian_block_size=512), 'proj_2nd': QuantGPTQConfig(includes=['proj_1st', 'proj_2nd', 'proj_out', 'proj_qkv'], damp_percentage=0.01, block_size=128, num_inv_tries=250, hessian_block_size=512), 'proj_out': QuantGPTQConfig(includes=['proj_1st', 'proj_2nd', 'proj_out', 'proj_qkv'], damp_percentage=0.01, block_size=128, num_inv_tries=250, hessian_block_size=512), 'proj_qkv': QuantGPTQConfig(includes=['proj_1st', 'proj_2nd', 'proj_out', 'proj_qkv'], damp_percentage=0.01, block_size=128, num_inv_tries=250, hessian_block_size=512)},
25-01-17 16:19:40 | I |         gptq=QuantGPTQConfig(
25-01-17 16:19:40 | I |           includes=['proj_1st', 'proj_2nd', 'proj_out', 'proj_qkv'],
25-01-17 16:19:40 | I |           damp_percentage=0.01,
25-01-17 16:19:40 | I |           block_size=128,
25-01-17 16:19:40 | I |           num_inv_tries=250,
25-01-17 16:19:40 | I |           hessian_block_size=512)),
25-01-17 16:19:40 | I |       calib_range=DynamicRangeCalibConfig(
25-01-17 16:19:40 | I |         degree=2,
25-01-17 16:19:40 | I |         skips=[],
25-01-17 16:19:40 | I |         objective=SearchBasedCalibObjective.OutputsError,
25-01-17 16:19:40 | I |         strategy=SearchBasedCalibStrategy.Manual,
25-01-17 16:19:40 | I |         granularity=SearchBasedCalibGranularity.Group,
25-01-17 16:19:40 | I |         element_batch_size=64,
25-01-17 16:19:40 | I |         sample_batch_size=-1,
25-01-17 16:19:40 | I |         element_size=512,
25-01-17 16:19:40 | I |         sample_size=-1,
25-01-17 16:19:40 | I |         pre_reshape=True,
25-01-17 16:19:40 | I |         outputs_device=cpu,
25-01-17 16:19:40 | I |         allow_kernel_calib=False,
25-01-17 16:19:40 | I |         ratio=1.0,
25-01-17 16:19:40 | I |         max_shrink=0.2,
25-01-17 16:19:40 | I |         max_expand=1.0,
25-01-17 16:19:40 | I |         num_grids=80)),
25-01-17 16:19:40 | I |     ipts=ActivationQuantizerConfig(
25-01-17 16:19:40 | I |       dtype=sint8,
25-01-17 16:19:40 | I |       group_shapes=((1, -1, -1),),
25-01-17 16:19:40 | I |       group_scale_dtypes=(torch.float16,),
25-01-17 16:19:40 | I |       compute_dtype=None,
25-01-17 16:19:40 | I |       compute_group_level=-1,
25-01-17 16:19:40 | I |       saturate_compute_dtype=False,
25-01-17 16:19:40 | I |       exponent_scaling_level=1,
25-01-17 16:19:40 | I |       skips=['embed', 'head', 'router'],
25-01-17 16:19:40 | I |       static=False,
25-01-17 16:19:40 | I |       calib_kernel=None,
25-01-17 16:19:40 | I |       calib_range=None),
25-01-17 16:19:40 | I |     opts=ActivationQuantizerConfig(
25-01-17 16:19:40 | I |       dtype=zint4,
25-01-17 16:19:40 | I |       group_shapes=((1, 128, -1),),
25-01-17 16:19:40 | I |       group_scale_dtypes=(torch.float16,),
25-01-17 16:19:40 | I |       compute_dtype=None,
25-01-17 16:19:40 | I |       compute_group_level=-1,
25-01-17 16:19:40 | I |       saturate_compute_dtype=False,
25-01-17 16:19:40 | I |       exponent_scaling_level=1,
25-01-17 16:19:40 | I |       skips=['attn_q'],
25-01-17 16:19:40 | I |       static=False,
25-01-17 16:19:40 | I |       calib_kernel=None,
25-01-17 16:19:40 | I |       calib_range=None),
25-01-17 16:19:40 | I |     rotation=QuantRotationConfig(
25-01-17 16:19:40 | I |       random=False,
25-01-17 16:19:40 | I |       transforms=[]),
25-01-17 16:19:40 | I |     reorder=QuantReorderConfig(
25-01-17 16:19:40 | I |       degree=2,
25-01-17 16:19:40 | I |       skips=['proj_out', 'proj_qkv', 'residual'],
25-01-17 16:19:40 | I |       objective=SearchBasedCalibObjective.OutputsError,
25-01-17 16:19:40 | I |       strategy=SearchBasedCalibStrategy.Manual,
25-01-17 16:19:40 | I |       granularity=SearchBasedCalibGranularity.Layer,
25-01-17 16:19:40 | I |       element_batch_size=-1,
25-01-17 16:19:40 | I |       sample_batch_size=-1,
25-01-17 16:19:40 | I |       element_size=-1,
25-01-17 16:19:40 | I |       sample_size=-1,
25-01-17 16:19:40 | I |       pre_reshape=True,
25-01-17 16:19:40 | I |       outputs_device=cpu,
25-01-17 16:19:40 | I |       allow_kernel_calib=False,
25-01-17 16:19:40 | I |       channel_metric=ChannelMetric.InputsAbsMax,
25-01-17 16:19:40 | I |       channel_index=ChannelIndex.Sequential,
25-01-17 16:19:40 | I |       dynamic=False),
25-01-17 16:19:40 | I |     smooth=QuantSmoothConfig(
25-01-17 16:19:40 | I |       xw=QuantSmoothCalibConfig(
25-01-17 16:19:40 | I |         degree=2,
25-01-17 16:19:40 | I |         skips=['proj_1st', 'proj_qkv'],
25-01-17 16:19:40 | I |         objective=SearchBasedCalibObjective.OutputsError,
25-01-17 16:19:40 | I |         strategy=SearchBasedCalibStrategy.Manual,
25-01-17 16:19:40 | I |         granularity=SearchBasedCalibGranularity.Layer,
25-01-17 16:19:40 | I |         element_batch_size=-1,
25-01-17 16:19:40 | I |         sample_batch_size=-1,
25-01-17 16:19:40 | I |         element_size=-1,
25-01-17 16:19:40 | I |         sample_size=-1,
25-01-17 16:19:40 | I |         pre_reshape=True,
25-01-17 16:19:40 | I |         outputs_device=cpu,
25-01-17 16:19:40 | I |         allow_kernel_calib=False,
25-01-17 16:19:40 | I |         ranges=[(<RangeMode.AbsMax: 1>, <RangeMode.AbsMax: 1>)],
25-01-17 16:19:40 | I |         x_ranges=[<RangeMode.AbsMax: 1>],
25-01-17 16:19:40 | I |         w_ranges=[<RangeMode.AbsMax: 1>],
25-01-17 16:19:40 | I |         alpha=0.3,
25-01-17 16:19:40 | I |         beta=0.7,
25-01-17 16:19:40 | I |         num_grids=20),
25-01-17 16:19:40 | I |       yx=QuantSmoothCalibConfig(
25-01-17 16:19:40 | I |         degree=2,
25-01-17 16:19:40 | I |         skips=[],
25-01-17 16:19:40 | I |         objective=SearchBasedCalibObjective.OutputsError,
25-01-17 16:19:40 | I |         strategy=SearchBasedCalibStrategy.Manual,
25-01-17 16:19:40 | I |         granularity=SearchBasedCalibGranularity.Layer,
25-01-17 16:19:40 | I |         element_batch_size=-1,
25-01-17 16:19:40 | I |         sample_batch_size=-1,
25-01-17 16:19:40 | I |         element_size=-1,
25-01-17 16:19:40 | I |         sample_size=-1,
25-01-17 16:19:40 | I |         pre_reshape=True,
25-01-17 16:19:40 | I |         outputs_device=cpu,
25-01-17 16:19:40 | I |         allow_kernel_calib=False,
25-01-17 16:19:40 | I |         ranges=[(<RangeMode.AbsMax: 1>, <RangeMode.AbsMax: 1>)],
25-01-17 16:19:40 | I |         x_ranges=[<RangeMode.AbsMax: 1>],
25-01-17 16:19:40 | I |         w_ranges=[<RangeMode.AbsMax: 1>],
25-01-17 16:19:40 | I |         alpha=0.5,
25-01-17 16:19:40 | I |         beta=0.0,
25-01-17 16:19:40 | I |         num_grids=20)),
25-01-17 16:19:40 | I |     bias_correction=False,
25-01-17 16:19:40 | I |     post_rotary=True,
25-01-17 16:19:40 | I |     develop_dtype=torch.float32,
25-01-17 16:19:40 | I |     select_wgts=None,
25-01-17 16:19:40 | I |     select_ipts=None,
25-01-17 16:19:40 | I |     select_opts=None,
25-01-17 16:19:40 | I |     keywords_i={'proj_qkv': ['q_proj', 'k_proj', 'v_proj'], 'proj_out': ['out_proj', 'o_proj'], 'proj_1st': ['fc1', 'up_proj', 'gate_proj', 'w1', 'w3'], 'proj_2nd': ['fc2', 'down_proj', 'w2'], 'head': ['output', 'score', 'qa_outputs'], 'embed': ['embed', 'lm_head', 'embed_out'], 'router': ['block_sparse_moe']},
25-01-17 16:19:40 | I |     keywords_w={'proj_qkv': ['q_proj', 'k_proj', 'v_proj'], 'proj_out': ['out_proj', 'o_proj'], 'proj_1st': ['fc1', 'up_proj', 'gate_proj', 'w1', 'w3'], 'proj_2nd': ['fc2', 'down_proj', 'w2'], 'head': ['output', 'score', 'qa_outputs'], 'embed': ['embed', 'lm_head', 'embed_out'], 'router': ['block_sparse_moe.gate']},
25-01-17 16:19:40 | I |     keywords_o={'attn_q': ['q_rotary_emb'], 'attn_k': ['k_rotary_emb'], 'attn_v': ['v_proj']},
25-01-17 16:19:40 | I |     module_types_i=(<class 'torch.nn.modules.linear.Linear'>, <class 'transformers.models.mixtral.modeling_mixtral.MixtralSparseMoeBlock'>),
25-01-17 16:19:40 | I |     module_types_w=(<class 'torch.nn.modules.linear.Linear'>,),
25-01-17 16:19:40 | I |     module_types_o=(<class 'torch.nn.modules.linear.Linear'>, <class 'lmquant.llm.nn.attention.RotaryEmbedding'>),
25-01-17 16:19:40 | I |     num_hidden_layers=-1),
25-01-17 16:19:40 | I |   seed=12345,
25-01-17 16:19:40 | I |   save_model=True,
25-01-17 16:19:40 | I |   output_dirpath=runs/llm/tiny/tiny-llama-1.1b/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/rot-reorder-smooth.xw.yx-w.static.kernel/skip.y.[q]-krnl-rot-rodr.Seq.[fc2]-smth.xw.a0p3.b0p7.[AbsMax].[out+fc2].yx.a0p5.b0.[AbsMax].[qk]-pileval.128x1024.[0-0]-250117.161940,
25-01-17 16:19:40 | I |   cache_dirpath=LlmQuantCachePath(rotation='runs/llm/cache/rotation/hadamard', reorder='runs/llm/cache/pileval.128x1024.[0-0]/reorder/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]', smooth='runs/llm/cache/pileval.128x1024.[0-0]/smooth/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]/smooth.xw.OutputsError.Manual.Layer.d2.en1.sn1-yx.OutputsError.Manual.Layer.d2.en1.sn1/smooth.xw.[x.AbsMax.w.AbsMax]-yx.[x.AbsMax.w.AbsMax]/smooth.xw.a0p3.b0p7-yx.a0p5.b0/smooth.xw.skip.[proj_1st+proj_qkv]-yx.skip.[]', wgts='runs/llm/cache/pileval.128x1024.[0-0]/wgts/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]/smooth.xw.OutputsError.Manual.Layer.d2.en1.sn1-yx.OutputsError.Manual.Layer.d2.en1.sn1/smooth.xw.[x.AbsMax.w.AbsMax]-yx.[x.AbsMax.w.AbsMax]/smooth.xw.a0p3.b0p7-yx.a0p5.b0/smooth.xw.skip.[proj_1st+proj_qkv]-yx.skip.[]/w.kernel.gptq.d0p01.b128/w.kernel.gptq.include.[proj_1st+proj_2nd+proj_out+proj_qkv]/w.range.OutputsError.Manual.Group.d2.e512.sn1/w.range.r.[1].static/w.range.skip.[]', acts=''),
25-01-17 16:19:40 | I |   cache_path=LlmQuantCachePath(rotation='runs/llm/cache/rotation/hadamard/tiny-llama-1.1b.pt', reorder='runs/llm/cache/pileval.128x1024.[0-0]/reorder/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]/tiny-llama-1.1b.pt', smooth='runs/llm/cache/pileval.128x1024.[0-0]/smooth/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]/smooth.xw.OutputsError.Manual.Layer.d2.en1.sn1-yx.OutputsError.Manual.Layer.d2.en1.sn1/smooth.xw.[x.AbsMax.w.AbsMax]-yx.[x.AbsMax.w.AbsMax]/smooth.xw.a0p3.b0p7-yx.a0p5.b0/smooth.xw.skip.[proj_1st+proj_qkv]-yx.skip.[]/tiny-llama-1.1b.pt', wgts='runs/llm/cache/pileval.128x1024.[0-0]/wgts/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/w.skip.[embed+head+router]-x.skip.[embed+head+router]-y.skip.[attn_q]/rotate.hadamard/reorder.OutputsError.Manual.Layer.d2.en1.sn1/reorder.InputsAbsMax.Sequential/reorder.skip.[proj_out+proj_qkv+residual]/smooth.xw.OutputsError.Manual.Layer.d2.en1.sn1-yx.OutputsError.Manual.Layer.d2.en1.sn1/smooth.xw.[x.AbsMax.w.AbsMax]-yx.[x.AbsMax.w.AbsMax]/smooth.xw.a0p3.b0p7-yx.a0p5.b0/smooth.xw.skip.[proj_1st+proj_qkv]-yx.skip.[]/w.kernel.gptq.d0p01.b128/w.kernel.gptq.include.[proj_1st+proj_2nd+proj_out+proj_qkv]/w.range.OutputsError.Manual.Group.d2.e512.sn1/w.range.r.[1].static/w.range.skip.[]/tiny-llama-1.1b.pt', acts=''),
25-01-17 16:19:40 | I |   fairseq_args=/data/gyy/lmquant-main/projects/llm/configs/fairseq_args_1.1b_without_preprocess.json,
25-01-17 16:19:40 | I |   gen_teacher_opts=False,
25-01-17 16:19:40 | I |   enable_cache=True,
25-01-17 16:19:40 | I |   with_preprocess=False)
25-01-17 16:19:40 | I | === Dumped Configurations ===
25-01-17 16:19:40 | I | { 'calib': { 'cache_root': 'runs',
25-01-17 16:19:40 | I |              'data': 'pileval',
25-01-17 16:19:40 | I |              'dataset_path': 'mit-han-lab/pile-val-backup',
25-01-17 16:19:40 | I |              'local_dataset_path': '/dataset/pile',
25-01-17 16:19:40 | I |              'max_seq_length': 0,
25-01-17 16:19:40 | I |              'min_seq_length': 0,
25-01-17 16:19:40 | I |              'num_samples': 128,
25-01-17 16:19:40 | I |              'seq_length': 1024},
25-01-17 16:19:40 | I |   'enable_cache': True,
25-01-17 16:19:40 | I |   'eval': { 'attach_timestamp': True,
25-01-17 16:19:40 | I |             'batch_size': 8,
25-01-17 16:19:40 | I |             'evaluator': 'gptq',
25-01-17 16:19:40 | I |             'max_seq_length': -4096,
25-01-17 16:19:40 | I |             'num_gpus': 1,
25-01-17 16:19:40 | I |             'output_dirname': 'skip.y.[q]-krnl-rot-rodr.Seq.[fc2]-smth.xw.a0p3.b0p7.[AbsMax].[out+fc2].yx.a0p5.b0.[AbsMax].[qk]-pileval.128x1024.[0-0]-250117.161940',
25-01-17 16:19:40 | I |             'output_root': 'runs',
25-01-17 16:19:40 | I |             'tasks': ['wikitext']},
25-01-17 16:19:40 | I |   'fairseq_args': '/data/gyy/lmquant-main/projects/llm/configs/fairseq_args_1.1b_without_preprocess.json',
25-01-17 16:19:40 | I |   'gen_teacher_opts': False,
25-01-17 16:19:40 | I |   'model': { 'local_path': '/dataset/models/tiny/tiny-llama-1.1b',
25-01-17 16:19:40 | I |              'local_root': '/dataset/models',
25-01-17 16:19:40 | I |              'name': 'tiny-llama-1.1b',
25-01-17 16:19:40 | I |              'path': '/data/gyy/TinyLlama',
25-01-17 16:19:40 | I |              'root': '/dataset/models'},
25-01-17 16:19:40 | I |   'quant': { 'bias_correction': False,
25-01-17 16:19:40 | I |              'develop_dtype': 'torch.float32',
25-01-17 16:19:40 | I |              'enable_reorder': True,
25-01-17 16:19:40 | I |              'enable_rotation': True,
25-01-17 16:19:40 | I |              'enable_select_ipts': False,
25-01-17 16:19:40 | I |              'enable_select_opts': False,
25-01-17 16:19:40 | I |              'enable_select_wgts': False,
25-01-17 16:19:40 | I |              'enable_smooth': True,
25-01-17 16:19:40 | I |              'ipts': { 'compute_dtype': None,
25-01-17 16:19:40 | I |                        'compute_group_level': -1,
25-01-17 16:19:40 | I |                        'dtype': 'sint8',
25-01-17 16:19:40 | I |                        'enable_calib_range': False,
25-01-17 16:19:40 | I |                        'group_scale_dtypes': ['torch.float16'],
25-01-17 16:19:40 | I |                        'group_shapes': [[1, -1, -1]],
25-01-17 16:19:40 | I |                        'saturate_compute_dtype': False,
25-01-17 16:19:40 | I |                        'skips': ['embed', 'head', 'router'],
25-01-17 16:19:40 | I |                        'static': False},
25-01-17 16:19:40 | I |              'opts': { 'compute_dtype': None,
25-01-17 16:19:40 | I |                        'compute_group_level': -1,
25-01-17 16:19:40 | I |                        'dtype': 'zint4',
25-01-17 16:19:40 | I |                        'enable_calib_range': False,
25-01-17 16:19:40 | I |                        'group_scale_dtypes': ['torch.float16'],
25-01-17 16:19:40 | I |                        'group_shapes': [[1, 128, -1]],
25-01-17 16:19:40 | I |                        'saturate_compute_dtype': False,
25-01-17 16:19:40 | I |                        'skips': ['attn_q'],
25-01-17 16:19:40 | I |                        'static': False},
25-01-17 16:19:40 | I |              'post_rotary': True,
25-01-17 16:19:40 | I |              'reorder': { 'allow_kernel_calib': False,
25-01-17 16:19:40 | I |                           'channel_index': 'Sequential',
25-01-17 16:19:40 | I |                           'channel_metric': 'InputsAbsMax',
25-01-17 16:19:40 | I |                           'degree': 2,
25-01-17 16:19:40 | I |                           'dynamic': False,
25-01-17 16:19:40 | I |                           'element_batch_size': -1,
25-01-17 16:19:40 | I |                           'element_size': -1,
25-01-17 16:19:40 | I |                           'outputs_device': 'cpu',
25-01-17 16:19:40 | I |                           'pre_reshape': True,
25-01-17 16:19:40 | I |                           'sample_batch_size': -1,
25-01-17 16:19:40 | I |                           'sample_size': -1,
25-01-17 16:19:40 | I |                           'skips': ['proj_out', 'proj_qkv', 'residual'],
25-01-17 16:19:40 | I |                           'strategy': 'Manual'},
25-01-17 16:19:40 | I |              'rotation': {'random': False, 'transforms': []},
25-01-17 16:19:40 | I |              'smooth': { 'enable_xw': True,
25-01-17 16:19:40 | I |                          'enable_yx': True,
25-01-17 16:19:40 | I |                          'xw': { 'allow_kernel_calib': False,
25-01-17 16:19:40 | I |                                  'alpha': 0.3,
25-01-17 16:19:40 | I |                                  'beta': 0.7,
25-01-17 16:19:40 | I |                                  'degree': 2,
25-01-17 16:19:40 | I |                                  'element_batch_size': -1,
25-01-17 16:19:40 | I |                                  'element_size': -1,
25-01-17 16:19:40 | I |                                  'granularity': 'Layer',
25-01-17 16:19:40 | I |                                  'num_grids': 20,
25-01-17 16:19:40 | I |                                  'objective': 'OutputsError',
25-01-17 16:19:40 | I |                                  'outputs_device': 'cpu',
25-01-17 16:19:40 | I |                                  'pre_reshape': True,
25-01-17 16:19:40 | I |                                  'ranges': [['AbsMax', 'AbsMax']],
25-01-17 16:19:40 | I |                                  'sample_batch_size': -1,
25-01-17 16:19:40 | I |                                  'sample_size': -1,
25-01-17 16:19:40 | I |                                  'skips': ['proj_1st', 'proj_qkv'],
25-01-17 16:19:40 | I |                                  'strategy': 'Manual'},
25-01-17 16:19:40 | I |                          'yx': { 'allow_kernel_calib': False,
25-01-17 16:19:40 | I |                                  'alpha': 0.5,
25-01-17 16:19:40 | I |                                  'beta': 0.0,
25-01-17 16:19:40 | I |                                  'degree': 2,
25-01-17 16:19:40 | I |                                  'element_batch_size': -1,
25-01-17 16:19:40 | I |                                  'element_size': -1,
25-01-17 16:19:40 | I |                                  'granularity': 'Layer',
25-01-17 16:19:40 | I |                                  'num_grids': 20,
25-01-17 16:19:40 | I |                                  'objective': 'OutputsError',
25-01-17 16:19:40 | I |                                  'outputs_device': 'cpu',
25-01-17 16:19:40 | I |                                  'pre_reshape': True,
25-01-17 16:19:40 | I |                                  'ranges': [['AbsMax', 'AbsMax']],
25-01-17 16:19:40 | I |                                  'sample_batch_size': -1,
25-01-17 16:19:40 | I |                                  'sample_size': -1,
25-01-17 16:19:40 | I |                                  'skips': [],
25-01-17 16:19:40 | I |                                  'strategy': 'Manual'}},
25-01-17 16:19:40 | I |              'wgts': { 'calib_kernel': { 'enable_gptq': True,
25-01-17 16:19:40 | I |                                          'gptq': { 'block_size': 128,
25-01-17 16:19:40 | I |                                                    'damp_percentage': 0.01,
25-01-17 16:19:40 | I |                                                    'hessian_block_size': 512,
25-01-17 16:19:40 | I |                                                    'includes': ['proj_1st', 'proj_2nd', 'proj_out', 'proj_qkv'],
25-01-17 16:19:40 | I |                                                    'num_inv_tries': 250}},
25-01-17 16:19:40 | I |                        'calib_range': { 'allow_kernel_calib': False,
25-01-17 16:19:40 | I |                                         'degree': 2,
25-01-17 16:19:40 | I |                                         'element_batch_size': 64,
25-01-17 16:19:40 | I |                                         'element_size': 512,
25-01-17 16:19:40 | I |                                         'granularity': 'Group',
25-01-17 16:19:40 | I |                                         'max_expand': 1.0,
25-01-17 16:19:40 | I |                                         'max_shrink': 0.2,
25-01-17 16:19:40 | I |                                         'num_grids': 80,
25-01-17 16:19:40 | I |                                         'objective': 'OutputsError',
25-01-17 16:19:40 | I |                                         'outputs_device': 'cpu',
25-01-17 16:19:40 | I |                                         'pre_reshape': True,
25-01-17 16:19:40 | I |                                         'ratio': 1.0,
25-01-17 16:19:40 | I |                                         'sample_batch_size': -1,
25-01-17 16:19:40 | I |                                         'sample_size': -1,
25-01-17 16:19:40 | I |                                         'skips': [],
25-01-17 16:19:40 | I |                                         'strategy': 'Manual'},
25-01-17 16:19:40 | I |                        'compute_dtype': 'sint8',
25-01-17 16:19:40 | I |                        'compute_group_level': 0,
25-01-17 16:19:40 | I |                        'dtype': 'zint4',
25-01-17 16:19:40 | I |                        'enable_calib_kernel': True,
25-01-17 16:19:40 | I |                        'enable_calib_range': True,
25-01-17 16:19:40 | I |                        'group_scale_dtypes': ['torch.float16', 'sint8'],
25-01-17 16:19:40 | I |                        'group_shapes': [[1, -1, -1], [1, 128, -1]],
25-01-17 16:19:40 | I |                        'saturate_compute_dtype': False,
25-01-17 16:19:40 | I |                        'skips': ['embed', 'head', 'router']}},
25-01-17 16:19:40 | I |   'save_model': True,
25-01-17 16:19:40 | I |   'seed': 12345,
25-01-17 16:19:40 | I |   'with_preprocess': False}
25-01-17 16:19:40 | I | === Output Directory ===
25-01-17 16:19:40 | I | runs/llm/tiny/tiny-llama-1.1b/w.4-x.8-y.4/w.zint4-x.sint8-y.zint4/w.gchn.fp16.g128.sint8.[gchn.sint8]-x.gchn.fp16-y.g128.fp16/rot-reorder-smooth.xw.yx-w.static.kernel/skip.y.[q]-krnl-rot-rodr.Seq.[fc2]-smth.xw.a0p3.b0p7.[AbsMax].[out+fc2].yx.a0p5.b0.[AbsMax].[qk]-pileval.128x1024.[0-0]-250117.161940
25-01-17 16:19:40 | I | === Start Evaluating ===
25-01-17 16:19:40 | I | * Building model tiny-llama-1.1b from /data/gyy/TinyLlama
25-01-17 16:19:40 | I | We will use 90% of the memory on device 0 for storing the model, and 10% for the buffer to avoid OOM. You can set `max_memory` in to a higher value to use more memory (at your own risk).
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.0.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.1.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.2.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.3.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.4.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.5.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.6.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.7.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.8.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.9.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.10.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.11.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.12.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.13.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.14.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.15.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.16.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.17.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.18.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.19.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.20.self_attn
25-01-17 16:19:41 | I | - Patching LlamaSdpaAttention.forward in model.layers.21.self_attn
25-01-17 16:19:41 | I | * Development dtype is torch.float32
25-01-17 16:19:42 | I | * Begin to QAT
25-01-17 16:19:42 | D | Setting JobRuntime:name=UNKNOWN_NAME
25-01-17 16:19:42 | D | Setting JobRuntime:name=utils
25-01-17 16:19:43 | I | distributed init (rank 0): env://
25-01-17 16:19:43 | I | initialized host 3fb0cc53fbf9 as rank 0
25-01-17 16:19:44 | I | nvidia-smi stats: {'gpu_0_mem_used_gb': 3.677734375, 'gpu_1_mem_used_gb': 3.8046875, 'gpu_2_mem_used_gb': 0.0, 'gpu_3_mem_used_gb': 0.0, 'gpu_4_mem_used_gb': 4.658203125, 'gpu_5_mem_used_gb': 0.0, 'gpu_6_mem_used_gb': 0.0, 'gpu_7_mem_used_gb': 0.0}
25-01-17 16:19:44 | I | {'_name': None, 'common': {'_name': None, 'no_progress_bar': False, 'log_interval': 1, 'log_format': 'simple', 'log_file': None, 'tensorboard_logdir': None, 'wandb_project': 'layer_wise_quant', 'azureml_logging': False, 'seed': 1, 'cpu': False, 'tpu': False, 'bf16': False, 'memory_efficient_bf16': False, 'fp16': True, 'memory_efficient_fp16': True, 'fp16_no_flatten_grads': False, 'fp16_init_scale': 128, 'fp16_scale_window': None, 'fp16_scale_tolerance': 0.0, 'min_loss_scale': 0.0001, 'threshold_loss_scale': None, 'user_dir': None, 'empty_cache_freq': 0, 'all_gather_list_size': 16384, 'model_parallel_size': 1, 'quantization_config_path': None, 'profile': False, 'reset_logging': False, 'suppress_crashes': False, 'use_plasma_view': False, 'plasma_path': '/tmp/plasma', 'log_nvidia_smi': False}, 'common_eval': {'_name': None, 'path': None, 'post_process': None, 'quiet': False, 'model_overrides': '{}', 'results_path': None, 'is_moe': False, 'is_model_parallel': False}, 'distributed_training': {'_name': None, 'distributed_world_size': 1, 'distributed_rank': 0, 'distributed_backend': 'nccl', 'distributed_init_method': 'env://', 'distributed_port': -1, 'device_id': 0, 'distributed_no_spawn': True, 'ddp_backend': 'pytorch_ddp', 'bucket_cap_mb': 25, 'fix_batches_to_gpus': False, 'find_unused_parameters': False, 'fast_stat_sync': False, 'heartbeat_timeout': -1, 'broadcast_buffers': False, 'slowmo_momentum': None, 'slowmo_algorithm': 'LocalSGD', 'localsgd_frequency': 3, 'nprocs_per_node': 1, 'pipeline_model_parallel': False, 'pipeline_balance': None, 'pipeline_devices': None, 'pipeline_chunks': 0, 'pipeline_encoder_balance': None, 'pipeline_encoder_devices': None, 'pipeline_decoder_balance': None, 'pipeline_decoder_devices': None, 'pipeline_checkpoint': 'never', 'zero_sharding': 'none', 'zero_group_size': -1, 'save_zero_ckpt_fast': False, 'fp16': True, 'memory_efficient_fp16': True, 'tpu': False, 'no_reshard_after_forward': False, 'fp32_reduce_scatter': False, 'cpu_offload': False, 'use_sharded_state': False}, 'dataset': {'_name': None, 'num_workers': 1, 'num_workers_valid': 0, 'skip_invalid_size_inputs_valid_test': False, 'max_tokens': None, 'batch_size': 32, 'required_batch_size_multiple': 8, 'required_seq_len_multiple': 1, 'dataset_impl': None, 'data_buffer_size': 10, 'train_subset': 'train', 'valid_subset': 'valid', 'combine_valid_subsets': None, 'ignore_unused_valid_subsets': False, 'validate_interval': 1, 'validate_interval_updates': 20, 'validate_after_updates': 0, 'fixed_validation_seed': None, 'disable_validation': False, 'max_tokens_valid': None, 'batch_size_valid': 32, 'max_valid_steps': None, 'curriculum': 0, 'gen_subset': 'test', 'num_shards': 1, 'shard_id': 0}, 'optimization': {'_name': None, 'max_epoch': 0, 'max_update': 100, 'stop_time_hours': 0.0, 'clip_norm': 2.0, 'sentence_avg': False, 'update_freq': [2], 'lr': [0.00015], 'stop_min_lr': -1.0, 'use_bmuf': False}, 'checkpoint': {'_name': None, 'save_dir': 'checkpoints', 'restore_file': 'checkpoint_last.pt', 'finetune_from_model': None, 'reset_dataloader': False, 'reset_lr_scheduler': False, 'reset_meters': False, 'reset_optimizer': False, 'optimizer_overrides': '{}', 'save_interval': 1, 'save_interval_updates': 1000, 'keep_interval_updates': -1, 'keep_last_epochs': -1, 'keep_best_checkpoints': -1, 'no_save': True, 'no_epoch_checkpoints': True, 'no_last_checkpoints': False, 'no_best_checkpoints': False, 'no_save_optimizer_state': False, 'no_save_optimizer_state_on_training_finished': False, 'symlink_best_and_last_checkpoints': False, 'best_checkpoint_metric': 'loss_valid', 'maximize_best_checkpoint_metric': False, 'patience': -1, 'checkpoint_suffix': '', 'checkpoint_shard_count': 1, 'load_checkpoint_on_all_dp_ranks': False, 'write_checkpoints_asynchronously': False, 's3_upload_path': None, 'model_parallel_size': 1}, 'bmuf': {'_name': None, 'block_lr': 1.0, 'block_momentum': 0.875, 'global_sync_iter': 50, 'warmup_iterations': 500, 'use_nbm': False, 'average_sync': False, 'distributed_world_size': 1}, 'generation': {'_name': None, 'beam': 5, 'nbest': 1, 'max_len_a': 0.0, 'max_len_b': 200, 'min_len': 1, 'match_source_len': False, 'unnormalized': False, 'no_early_stop': False, 'no_beamable_mm': False, 'lenpen': 1.0, 'unkpen': 0.0, 'replace_unk': None, 'sacrebleu': False, 'score_reference': False, 'prefix_size': 0, 'no_repeat_ngram_size': 0, 'sampling': False, 'sampling_topk': -1, 'sampling_topp': -1.0, 'constraints': None, 'temperature': 1.0, 'diverse_beam_groups': -1, 'diverse_beam_strength': 0.5, 'diversity_rate': -1.0, 'print_alignment': None, 'print_step': False, 'lm_path': None, 'lm_weight': 0.0, 'iter_decode_eos_penalty': 0.0, 'iter_decode_max_iter': 10, 'iter_decode_force_max_iter': False, 'iter_decode_with_beam': 1, 'iter_decode_with_external_reranker': False, 'retain_iter_history': False, 'retain_dropout': False, 'retain_dropout_modules': None, 'decoding_format': None, 'no_seed_provided': False}, 'eval_lm': {'_name': None, 'input_quant_method': '', 'input_bits': -1, 'weight_quant_method': '', 'weight_bits': -1, 'smoothquant': False, 'smoothquant_alpha': 0.5, 'smoothquant_bitnet': False, 'input_bits_post': 8, 'hadamard_group': -1, 'cal_input_stat': 'none', 'output_word_probs': False, 'output_word_stats': False, 'context_window': 0, 'softmax_batch': 9223372036854775807, 'stats_path': None, 'max_valid_steps': None}, 'interactive': {'_name': None, 'buffer_size': 0, 'input': '-'}, 'model': {'_name': 'llama_for_layer_wise_qat', 'load_ckpt': None, 'batch_size': 32, 'share_input_output_embed': False, 'sliding_window': None, 'rope_theta': 10000.0, 'checkpoint_activations': False, 'tokens_per_sample': 512, 'model_parallel_size': 1}, 'task': {'_name': 'kd', 'path_to_labels': None, 'data': '/data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b', 'tokens_per_sample': 512, 'batch_size_in_quant': 8, 'max_target_positions': None, 'llama_model': None, 'quant_acts_when_training': True, 'tiktoken_model': 'cl100k_base', 'batch_read_ahead': 1, 'pad_to_max_len': True, 'absolute_path': False, 'tokenizer_pad_to_multiple': 1, 'seed': 1, 'batch_size': 32}, 'criterion': {'_name': 'mse', 'sentence_avg': False}, 'optimizer': {'_name': 'adam', 'adam_betas': '(0.9, 0.95)', 'adam_eps': 1e-06, 'weight_decay': 0.05, 'use_old_adam': False, 'fp16_adam_stats': False, 'tpu': False, 'bf16': False, 'lr': [0.00015], 'block_wise': False}, 'lr_scheduler': {'_name': 'polynomial_decay', 'warmup_updates': 50, 'force_anneal': None, 'end_learning_rate': 0.0, 'power': 1.0, 'total_num_update': 300000.0, 'lr': [0.00015]}, 'scoring': {'_name': 'bleu', 'pad': 1, 'eos': 2, 'unk': 3}, 'bpe': None, 'tokenizer': None}
25-01-17 16:19:44 | I | LlamaModelDecoderLayer(
  (decoder): LlamaDecoderLayerInFairseq(
    (model): LlamaDecoderLayer(
      (self_attn): LlamaSdpaAttention(
        (q_proj): Linear(in_features=2048, out_features=2048, bias=False)
        (k_proj): Linear(in_features=2048, out_features=256, bias=False)
        (v_proj): Linear(in_features=2048, out_features=256, bias=False)
        (o_proj): Linear(in_features=2048, out_features=2048, bias=False)
        (rotary_emb): LlamaRotaryEmbedding()
        (q_rotary_emb): RotaryEmbedding()
        (k_rotary_emb): RotaryEmbedding()
      )
      (mlp): LlamaMLP(
        (gate_proj): Linear(in_features=2048, out_features=5632, bias=False)
        (up_proj): Linear(in_features=2048, out_features=5632, bias=False)
        (down_proj): Linear(in_features=5632, out_features=2048, bias=False)
        (act_fn): SiLU()
      )
      (input_layernorm): LlamaRMSNorm((2048,), eps=1e-05)
      (post_attention_layernorm): LlamaRMSNorm((2048,), eps=1e-05)
    )
  )
  (model): LlamaDecoderLayerInFairseq(
    (model): LlamaDecoderLayer(
      (self_attn): LlamaSdpaAttention(
        (q_proj): Linear(in_features=2048, out_features=2048, bias=False)
        (k_proj): Linear(in_features=2048, out_features=256, bias=False)
        (v_proj): Linear(in_features=2048, out_features=256, bias=False)
        (o_proj): Linear(in_features=2048, out_features=2048, bias=False)
        (rotary_emb): LlamaRotaryEmbedding()
        (q_rotary_emb): RotaryEmbedding()
        (k_rotary_emb): RotaryEmbedding()
      )
      (mlp): LlamaMLP(
        (gate_proj): Linear(in_features=2048, out_features=5632, bias=False)
        (up_proj): Linear(in_features=2048, out_features=5632, bias=False)
        (down_proj): Linear(in_features=5632, out_features=2048, bias=False)
        (act_fn): SiLU()
      )
      (input_layernorm): LlamaRMSNorm((2048,), eps=1e-05)
      (post_attention_layernorm): LlamaRMSNorm((2048,), eps=1e-05)
    )
  )
)
25-01-17 16:19:44 | I | task: KDTask
25-01-17 16:19:44 | I | model: LlamaModelDecoderLayer
25-01-17 16:19:44 | I | criterion: MSECriterion
25-01-17 16:19:44 | I | num. non-expert model params: 44,044,288 (num. trained: 44,044,288)
25-01-17 16:19:44 | I | num. expert model params: 0 (num. trained: 0)
25-01-17 16:19:44 | I | nvidia-smi stats: {'gpu_0_mem_used_gb': 3.677734375, 'gpu_1_mem_used_gb': 3.8046875, 'gpu_2_mem_used_gb': 0.0, 'gpu_3_mem_used_gb': 0.0, 'gpu_4_mem_used_gb': 4.658203125, 'gpu_5_mem_used_gb': 0.0, 'gpu_6_mem_used_gb': 0.0, 'gpu_7_mem_used_gb': 0.0}
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.self_attn.q_proj.weight <- model.model.self_attn.q_proj.weight
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- decoder.model.self_attn.k_proj.bias
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- decoder.model.self_attn.v_proj.bias
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- decoder.model.self_attn.o_proj.bias
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- decoder.model.mlp.gate_proj.bias
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- decoder.model.mlp.up_proj.bias
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- decoder.model.mlp.down_proj.bias
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.self_attn.q_proj.bias
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.self_attn.k_proj.bias
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.self_attn.v_proj.bias
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.self_attn.o_proj.bias
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.mlp.gate_proj.bias
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.mlp.up_proj.bias
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.self_attn.q_proj.bias <- model.model.mlp.down_proj.bias
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.self_attn.k_proj.weight <- model.model.self_attn.k_proj.weight
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.self_attn.v_proj.weight <- model.model.self_attn.v_proj.weight
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.self_attn.o_proj.weight <- model.model.self_attn.o_proj.weight
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.mlp.gate_proj.weight <- model.model.mlp.gate_proj.weight
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.mlp.up_proj.weight <- model.model.mlp.up_proj.weight
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.mlp.down_proj.weight <- model.model.mlp.down_proj.weight
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.input_layernorm.weight <- model.model.input_layernorm.weight
25-01-17 16:19:44 | I | detected shared parameter: decoder.model.post_attention_layernorm.weight <- model.model.post_attention_layernorm.weight
25-01-17 16:19:44 | I | nvidia-smi stats: {'gpu_0_mem_used_gb': 3.677734375, 'gpu_1_mem_used_gb': 3.8046875, 'gpu_2_mem_used_gb': 0.0, 'gpu_3_mem_used_gb': 0.0, 'gpu_4_mem_used_gb': 4.69921875, 'gpu_5_mem_used_gb': 0.0, 'gpu_6_mem_used_gb': 0.0, 'gpu_7_mem_used_gb': 0.0}
25-01-17 16:19:44 | I | ***********************CUDA enviroments for all 1 workers***********************
25-01-17 16:19:44 | I | rank   0: capabilities =  8.6  ; total memory = 23.691 GB ; name = NVIDIA GeForce RTX 3090                 
25-01-17 16:19:44 | I | ***********************CUDA enviroments for all 1 workers***********************
25-01-17 16:19:44 | I | training on 1 devices (GPUs/TPUs)
25-01-17 16:19:44 | I | max tokens per GPU = None and batch size per GPU = 32
25-01-17 16:19:44 | I | nvidia-smi stats: {'gpu_0_mem_used_gb': 3.677734375, 'gpu_1_mem_used_gb': 3.8046875, 'gpu_2_mem_used_gb': 0.0, 'gpu_3_mem_used_gb': 0.0, 'gpu_4_mem_used_gb': 4.69921875, 'gpu_5_mem_used_gb': 0.0, 'gpu_6_mem_used_gb': 0.0, 'gpu_7_mem_used_gb': 0.0}
25-01-17 16:19:44 | I | loading train data for epoch 1
25-01-17 16:19:46 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/0.jsonl 
 ***
25-01-17 16:19:46 | I | *** 
 total_rows = 700 
 ***
25-01-17 16:19:46 | I | current row num = 0
25-01-17 16:19:46 | I | in forward_and_gen_teacher_outputs, Start iterating over samples
25-01-17 16:19:46 | I | current row num = 32
25-01-17 16:19:47 | I | current row num = 64
25-01-17 16:19:48 | I | current row num = 96
25-01-17 16:19:48 | I | current row num = 128
25-01-17 16:19:49 | I | current row num = 160
25-01-17 16:19:50 | I | current row num = 192
25-01-17 16:19:50 | I | current row num = 224
25-01-17 16:19:51 | I | current row num = 256
25-01-17 16:19:52 | I | current row num = 288
25-01-17 16:19:53 | I | current row num = 320
25-01-17 16:19:53 | I | current row num = 352
25-01-17 16:19:54 | I | current row num = 384
25-01-17 16:19:55 | I | current row num = 416
25-01-17 16:19:55 | I | current row num = 448
25-01-17 16:19:56 | I | current row num = 480
25-01-17 16:19:57 | I | current row num = 512
25-01-17 16:19:58 | I | current row num = 544
25-01-17 16:19:58 | I | current row num = 576
25-01-17 16:19:59 | I | current row num = 608
25-01-17 16:20:00 | I | current row num = 640
25-01-17 16:20:01 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/1.jsonl 
 ***
25-01-17 16:20:01 | I | *** 
 total_rows = 241 
 ***
25-01-17 16:20:01 | I | current row num = 0
25-01-17 16:20:01 | I | current row num = 32
25-01-17 16:20:02 | I | current row num = 64
25-01-17 16:20:03 | I | current row num = 96
25-01-17 16:20:04 | I | current row num = 128
25-01-17 16:20:04 | I | current row num = 160
25-01-17 16:20:05 | I | current row num = 192
25-01-17 16:20:06 | I | current row num = 224
25-01-17 16:20:07 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/2.jsonl 
 ***
25-01-17 16:20:07 | I | *** 
 total_rows = 509 
 ***
25-01-17 16:20:07 | I | current row num = 0
25-01-17 16:20:08 | I | current row num = 32
25-01-17 16:20:08 | I | current row num = 64
25-01-17 16:20:09 | I | current row num = 96
25-01-17 16:20:10 | I | current row num = 128
25-01-17 16:20:11 | I | current row num = 160
25-01-17 16:20:11 | I | current row num = 192
25-01-17 16:20:12 | I | current row num = 224
25-01-17 16:20:13 | I | current row num = 256
25-01-17 16:20:13 | I | current row num = 288
25-01-17 16:20:14 | I | current row num = 320
25-01-17 16:20:15 | I | current row num = 352
25-01-17 16:20:16 | I | current row num = 384
25-01-17 16:20:16 | I | current row num = 416
25-01-17 16:20:17 | I | current row num = 448
25-01-17 16:20:18 | I | current row num = 480
25-01-17 16:20:19 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/3.jsonl 
 ***
25-01-17 16:20:19 | I | *** 
 total_rows = 274 
 ***
25-01-17 16:20:19 | I | current row num = 0
25-01-17 16:20:19 | I | current row num = 32
25-01-17 16:20:20 | I | current row num = 64
25-01-17 16:20:21 | I | current row num = 96
25-01-17 16:20:23 | I | current row num = 128
25-01-17 16:20:24 | I | current row num = 160
25-01-17 16:20:25 | I | current row num = 192
25-01-17 16:20:25 | I | current row num = 224
25-01-17 16:20:27 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/4.jsonl 
 ***
25-01-17 16:20:27 | I | *** 
 total_rows = 191 
 ***
25-01-17 16:20:27 | I | current row num = 0
25-01-17 16:20:27 | I | current row num = 32
25-01-17 16:20:28 | I | current row num = 64
25-01-17 16:20:28 | I | current row num = 96
25-01-17 16:20:29 | I | current row num = 128
25-01-17 16:20:32 | I | current row num = 160
25-01-17 16:20:33 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/5.jsonl 
 ***
25-01-17 16:20:33 | I | *** 
 total_rows = 211 
 ***
25-01-17 16:20:33 | I | current row num = 0
25-01-17 16:20:33 | I | current row num = 32
25-01-17 16:20:36 | I | current row num = 64
25-01-17 16:20:37 | I | current row num = 96
25-01-17 16:20:37 | I | current row num = 128
25-01-17 16:20:40 | I | current row num = 160
25-01-17 16:20:40 | I | current row num = 192
25-01-17 16:20:42 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/6.jsonl 
 ***
25-01-17 16:20:42 | I | *** 
 total_rows = 241 
 ***
25-01-17 16:20:42 | I | current row num = 0
25-01-17 16:20:42 | I | current row num = 32
25-01-17 16:20:43 | I | current row num = 64
25-01-17 16:20:43 | I | current row num = 96
25-01-17 16:20:44 | I | current row num = 128
25-01-17 16:20:45 | I | current row num = 160
25-01-17 16:20:46 | I | current row num = 192
25-01-17 16:20:47 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/7.jsonl 
 ***
25-01-17 16:20:47 | I | *** 
 total_rows = 279 
 ***
25-01-17 16:20:47 | I | current row num = 0
25-01-17 16:20:49 | I | current row num = 32
25-01-17 16:20:50 | I | current row num = 64
25-01-17 16:20:52 | I | current row num = 96
25-01-17 16:20:54 | I | current row num = 128
25-01-17 16:20:54 | I | current row num = 160
25-01-17 16:20:55 | I | current row num = 192
25-01-17 16:20:56 | I | current row num = 224
25-01-17 16:20:56 | I | current row num = 256
25-01-17 16:20:58 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/8.jsonl 
 ***
25-01-17 16:20:58 | I | *** 
 total_rows = 186 
 ***
25-01-17 16:20:58 | I | current row num = 0
25-01-17 16:20:58 | I | current row num = 32
25-01-17 16:20:59 | I | current row num = 64
25-01-17 16:20:59 | I | current row num = 96
25-01-17 16:21:00 | I | current row num = 128
25-01-17 16:21:01 | I | current row num = 160
25-01-17 16:21:03 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/9.jsonl 
 ***
25-01-17 16:21:03 | I | *** 
 total_rows = 770 
 ***
25-01-17 16:21:03 | I | current row num = 0
25-01-17 16:21:04 | I | current row num = 32
25-01-17 16:21:05 | I | current row num = 64
25-01-17 16:21:06 | I | current row num = 96
25-01-17 16:21:06 | I | current row num = 128
25-01-17 16:21:07 | I | current row num = 160
25-01-17 16:21:08 | I | current row num = 192
25-01-17 16:21:09 | I | current row num = 224
25-01-17 16:21:09 | I | current row num = 256
25-01-17 16:21:10 | I | current row num = 288
25-01-17 16:21:11 | I | current row num = 320
25-01-17 16:21:12 | I | current row num = 352
25-01-17 16:21:12 | I | current row num = 384
25-01-17 16:21:13 | I | current row num = 416
25-01-17 16:21:14 | I | current row num = 448
25-01-17 16:21:15 | I | current row num = 480
25-01-17 16:21:15 | I | current row num = 512
25-01-17 16:21:16 | I | current row num = 544
25-01-17 16:21:19 | I | current row num = 576
25-01-17 16:21:19 | I | current row num = 608
25-01-17 16:21:20 | I | current row num = 640
25-01-17 16:21:21 | I | current row num = 672
25-01-17 16:21:22 | I | current row num = 704
25-01-17 16:21:22 | I | current row num = 736
25-01-17 16:21:24 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/10.jsonl 
 ***
25-01-17 16:21:24 | I | *** 
 total_rows = 271 
 ***
25-01-17 16:21:24 | I | current row num = 0
25-01-17 16:21:24 | I | current row num = 32
25-01-17 16:21:27 | I | current row num = 64
25-01-17 16:21:27 | I | current row num = 96
25-01-17 16:21:28 | I | current row num = 128
25-01-17 16:21:29 | I | current row num = 160
25-01-17 16:21:29 | I | current row num = 192
25-01-17 16:21:30 | I | current row num = 224
25-01-17 16:21:31 | I | current row num = 256
25-01-17 16:21:32 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/11.jsonl 
 ***
25-01-17 16:21:32 | I | *** 
 total_rows = 273 
 ***
25-01-17 16:21:32 | I | current row num = 0
25-01-17 16:21:33 | I | current row num = 32
25-01-17 16:21:35 | I | current row num = 64
25-01-17 16:21:36 | I | current row num = 96
25-01-17 16:21:37 | I | current row num = 128
25-01-17 16:21:38 | I | current row num = 160
25-01-17 16:21:39 | I | current row num = 192
25-01-17 16:21:40 | I | current row num = 224
25-01-17 16:21:41 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/12.jsonl 
 ***
25-01-17 16:21:41 | I | *** 
 total_rows = 301 
 ***
25-01-17 16:21:41 | I | current row num = 0
25-01-17 16:21:41 | I | current row num = 32
25-01-17 16:21:42 | I | current row num = 64
25-01-17 16:21:43 | I | current row num = 96
25-01-17 16:21:44 | I | current row num = 128
25-01-17 16:21:44 | I | current row num = 160
25-01-17 16:21:46 | I | current row num = 192
25-01-17 16:21:47 | I | current row num = 224
25-01-17 16:21:48 | I | current row num = 256
25-01-17 16:21:50 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/13.jsonl 
 ***
25-01-17 16:21:50 | I | *** 
 total_rows = 239 
 ***
25-01-17 16:21:50 | I | current row num = 0
25-01-17 16:21:51 | I | current row num = 32
25-01-17 16:21:51 | I | current row num = 64
25-01-17 16:21:52 | I | current row num = 96
25-01-17 16:21:53 | I | current row num = 128
25-01-17 16:21:54 | I | current row num = 160
25-01-17 16:21:54 | I | current row num = 192
25-01-17 16:21:55 | I | current row num = 224
25-01-17 16:21:56 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/14.jsonl 
 ***
25-01-17 16:21:56 | I | *** 
 total_rows = 262 
 ***
25-01-17 16:21:56 | I | current row num = 0
25-01-17 16:21:58 | I | current row num = 32
25-01-17 16:22:01 | I | current row num = 64
25-01-17 16:22:02 | I | current row num = 96
25-01-17 16:22:02 | I | current row num = 128
25-01-17 16:22:03 | I | current row num = 160
25-01-17 16:22:04 | I | current row num = 192
25-01-17 16:22:05 | I | current row num = 224
25-01-17 16:22:06 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/15.jsonl 
 ***
25-01-17 16:22:06 | I | *** 
 total_rows = 253 
 ***
25-01-17 16:22:06 | I | current row num = 0
25-01-17 16:22:06 | I | current row num = 32
25-01-17 16:22:08 | I | current row num = 64
25-01-17 16:22:08 | I | current row num = 96
25-01-17 16:22:09 | I | current row num = 128
25-01-17 16:22:10 | I | current row num = 160
25-01-17 16:22:11 | I | current row num = 192
25-01-17 16:22:12 | I | current row num = 224
25-01-17 16:22:13 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/16.jsonl 
 ***
25-01-17 16:22:13 | I | *** 
 total_rows = 523 
 ***
25-01-17 16:22:13 | I | current row num = 0
25-01-17 16:22:14 | I | current row num = 32
25-01-17 16:22:15 | I | current row num = 64
25-01-17 16:22:18 | I | current row num = 96
25-01-17 16:22:19 | I | current row num = 128
25-01-17 16:22:19 | I | current row num = 160
25-01-17 16:22:20 | I | current row num = 192
25-01-17 16:22:21 | I | current row num = 224
25-01-17 16:22:22 | I | current row num = 256
25-01-17 16:22:22 | I | current row num = 288
25-01-17 16:22:23 | I | current row num = 320
25-01-17 16:22:24 | I | current row num = 352
25-01-17 16:22:25 | I | current row num = 384
25-01-17 16:22:25 | I | current row num = 416
25-01-17 16:22:28 | I | current row num = 448
25-01-17 16:22:30 | I | current row num = 480
25-01-17 16:22:31 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/17.jsonl 
 ***
25-01-17 16:22:31 | I | *** 
 total_rows = 251 
 ***
25-01-17 16:22:31 | I | current row num = 0
25-01-17 16:22:31 | I | current row num = 32
25-01-17 16:22:32 | I | current row num = 64
25-01-17 16:22:33 | I | current row num = 96
25-01-17 16:22:34 | I | current row num = 128
25-01-17 16:22:35 | I | current row num = 160
25-01-17 16:22:35 | I | current row num = 192
25-01-17 16:22:36 | I | current row num = 224
25-01-17 16:22:39 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/18.jsonl 
 ***
25-01-17 16:22:39 | I | *** 
 total_rows = 274 
 ***
25-01-17 16:22:39 | I | current row num = 0
25-01-17 16:22:39 | I | current row num = 32
25-01-17 16:22:40 | I | current row num = 64
25-01-17 16:22:41 | I | current row num = 96
25-01-17 16:22:42 | I | current row num = 128
25-01-17 16:22:42 | I | current row num = 160
25-01-17 16:22:43 | I | current row num = 192
25-01-17 16:22:44 | I | current row num = 224
25-01-17 16:22:45 | I | current row num = 256
25-01-17 16:22:46 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/19.jsonl 
 ***
25-01-17 16:22:46 | I | *** 
 total_rows = 315 
 ***
25-01-17 16:22:46 | I | current row num = 0
25-01-17 16:22:47 | I | current row num = 32
25-01-17 16:22:48 | I | current row num = 64
25-01-17 16:22:49 | I | current row num = 96
25-01-17 16:22:49 | I | current row num = 128
25-01-17 16:22:50 | I | current row num = 160
25-01-17 16:22:51 | I | current row num = 192
25-01-17 16:22:52 | I | current row num = 224
25-01-17 16:22:52 | I | current row num = 256
25-01-17 16:22:53 | I | current row num = 288
25-01-17 16:22:54 | I | current row num = 320
25-01-17 16:22:55 | I | loading train data for epoch 1
25-01-17 16:22:56 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/0.jsonl 
 ***
25-01-17 16:22:56 | I | *** 
 total_rows = 700 
 ***
25-01-17 16:22:56 | I | current row num = 0
25-01-17 16:22:56 | I | in forward_and_gen_args_and_kwargs, Start iterating over samples
25-01-17 16:22:56 | I | current row num = 32
25-01-17 16:22:57 | I | current row num = 64
25-01-17 16:22:57 | I | current row num = 96
25-01-17 16:22:58 | I | current row num = 128
25-01-17 16:22:59 | I | current row num = 160
25-01-17 16:23:00 | I | current row num = 192
25-01-17 16:23:00 | I | current row num = 224
25-01-17 16:23:01 | I | current row num = 256
25-01-17 16:23:02 | I | current row num = 288
25-01-17 16:23:03 | I | current row num = 320
25-01-17 16:23:04 | I | current row num = 352
25-01-17 16:23:05 | I | current row num = 384
25-01-17 16:23:05 | I | current row num = 416
25-01-17 16:23:06 | I | current row num = 448
25-01-17 16:23:07 | I | current row num = 480
25-01-17 16:23:08 | I | current row num = 512
25-01-17 16:23:09 | I | current row num = 544
25-01-17 16:23:10 | I | current row num = 576
25-01-17 16:23:10 | I | current row num = 608
25-01-17 16:23:11 | I | current row num = 640
25-01-17 16:23:12 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/1.jsonl 
 ***
25-01-17 16:23:12 | I | *** 
 total_rows = 241 
 ***
25-01-17 16:23:12 | I | current row num = 0
25-01-17 16:23:13 | I | current row num = 32
25-01-17 16:23:13 | I | current row num = 64
25-01-17 16:23:14 | I | current row num = 96
25-01-17 16:23:15 | I | current row num = 128
25-01-17 16:23:16 | I | current row num = 160
25-01-17 16:23:17 | I | current row num = 192
25-01-17 16:23:19 | I | current row num = 224
25-01-17 16:23:21 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/2.jsonl 
 ***
25-01-17 16:23:21 | I | *** 
 total_rows = 509 
 ***
25-01-17 16:23:21 | I | current row num = 0
25-01-17 16:23:21 | I | current row num = 32
25-01-17 16:23:24 | I | current row num = 64
25-01-17 16:23:25 | I | current row num = 96
25-01-17 16:23:25 | I | current row num = 128
25-01-17 16:23:26 | I | current row num = 160
25-01-17 16:23:27 | I | current row num = 192
25-01-17 16:23:28 | I | current row num = 224
25-01-17 16:23:28 | I | current row num = 256
25-01-17 16:23:29 | I | current row num = 288
25-01-17 16:23:30 | I | current row num = 320
25-01-17 16:23:30 | I | current row num = 352
25-01-17 16:23:31 | I | current row num = 384
25-01-17 16:23:33 | I | current row num = 416
25-01-17 16:23:34 | I | current row num = 448
25-01-17 16:23:35 | I | current row num = 480
25-01-17 16:23:36 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/3.jsonl 
 ***
25-01-17 16:23:36 | I | *** 
 total_rows = 274 
 ***
25-01-17 16:23:36 | I | current row num = 0
25-01-17 16:23:37 | I | current row num = 32
25-01-17 16:23:37 | I | current row num = 64
25-01-17 16:23:40 | I | current row num = 96
25-01-17 16:23:42 | I | current row num = 128
25-01-17 16:23:42 | I | current row num = 160
25-01-17 16:23:45 | I | current row num = 192
25-01-17 16:23:46 | I | current row num = 224
25-01-17 16:23:47 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/4.jsonl 
 ***
25-01-17 16:23:47 | I | *** 
 total_rows = 191 
 ***
25-01-17 16:23:47 | I | current row num = 0
25-01-17 16:23:47 | I | current row num = 32
25-01-17 16:23:48 | I | current row num = 64
25-01-17 16:23:49 | I | current row num = 96
25-01-17 16:23:49 | I | current row num = 128
25-01-17 16:23:50 | I | current row num = 160
25-01-17 16:23:51 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/5.jsonl 
 ***
25-01-17 16:23:51 | I | *** 
 total_rows = 211 
 ***
25-01-17 16:23:51 | I | current row num = 0
25-01-17 16:23:52 | I | current row num = 32
25-01-17 16:23:53 | I | current row num = 64
25-01-17 16:23:54 | I | current row num = 96
25-01-17 16:23:55 | I | current row num = 128
25-01-17 16:23:55 | I | current row num = 160
25-01-17 16:23:56 | I | current row num = 192
25-01-17 16:23:57 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/6.jsonl 
 ***
25-01-17 16:23:57 | I | *** 
 total_rows = 241 
 ***
25-01-17 16:23:57 | I | current row num = 0
25-01-17 16:23:58 | I | current row num = 32
25-01-17 16:24:00 | I | current row num = 64
25-01-17 16:24:03 | I | current row num = 96
25-01-17 16:24:03 | I | current row num = 128
25-01-17 16:24:04 | I | current row num = 160
25-01-17 16:24:05 | I | current row num = 192
25-01-17 16:24:06 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/7.jsonl 
 ***
25-01-17 16:24:06 | I | *** 
 total_rows = 279 
 ***
25-01-17 16:24:06 | I | current row num = 0
25-01-17 16:24:06 | I | current row num = 32
25-01-17 16:24:07 | I | current row num = 64
25-01-17 16:24:08 | I | current row num = 96
25-01-17 16:24:09 | I | current row num = 128
25-01-17 16:24:10 | I | current row num = 160
25-01-17 16:24:11 | I | current row num = 192
25-01-17 16:24:12 | I | current row num = 224
25-01-17 16:24:12 | I | current row num = 256
25-01-17 16:24:13 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/8.jsonl 
 ***
25-01-17 16:24:13 | I | *** 
 total_rows = 186 
 ***
25-01-17 16:24:13 | I | current row num = 0
25-01-17 16:24:14 | I | current row num = 32
25-01-17 16:24:14 | I | current row num = 64
25-01-17 16:24:15 | I | current row num = 96
25-01-17 16:24:17 | I | current row num = 128
25-01-17 16:24:18 | I | current row num = 160
25-01-17 16:24:20 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/9.jsonl 
 ***
25-01-17 16:24:20 | I | *** 
 total_rows = 770 
 ***
25-01-17 16:24:20 | I | current row num = 0
25-01-17 16:24:20 | I | current row num = 32
25-01-17 16:24:21 | I | current row num = 64
25-01-17 16:24:22 | I | current row num = 96
25-01-17 16:24:22 | I | current row num = 128
25-01-17 16:24:23 | I | current row num = 160
25-01-17 16:24:26 | I | current row num = 192
25-01-17 16:24:28 | I | current row num = 224
25-01-17 16:24:29 | I | current row num = 256
25-01-17 16:24:30 | I | current row num = 288
25-01-17 16:24:31 | I | current row num = 320
25-01-17 16:24:32 | I | current row num = 352
25-01-17 16:24:32 | I | current row num = 384
25-01-17 16:24:33 | I | current row num = 416
25-01-17 16:24:34 | I | current row num = 448
25-01-17 16:24:35 | I | current row num = 480
25-01-17 16:24:35 | I | current row num = 512
25-01-17 16:24:36 | I | current row num = 544
25-01-17 16:24:37 | I | current row num = 576
25-01-17 16:24:38 | I | current row num = 608
25-01-17 16:24:39 | I | current row num = 640
25-01-17 16:24:40 | I | current row num = 672
25-01-17 16:24:41 | I | current row num = 704
25-01-17 16:24:41 | I | current row num = 736
25-01-17 16:24:43 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/10.jsonl 
 ***
25-01-17 16:24:43 | I | *** 
 total_rows = 271 
 ***
25-01-17 16:24:43 | I | current row num = 0
25-01-17 16:24:43 | I | current row num = 32
25-01-17 16:24:45 | I | current row num = 64
25-01-17 16:24:46 | I | current row num = 96
25-01-17 16:24:47 | I | current row num = 128
25-01-17 16:24:47 | I | current row num = 160
25-01-17 16:24:48 | I | current row num = 192
25-01-17 16:24:51 | I | current row num = 224
25-01-17 16:24:51 | I | current row num = 256
25-01-17 16:24:53 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/11.jsonl 
 ***
25-01-17 16:24:53 | I | *** 
 total_rows = 273 
 ***
25-01-17 16:24:53 | I | current row num = 0
25-01-17 16:24:53 | I | current row num = 32
25-01-17 16:24:54 | I | current row num = 64
25-01-17 16:24:54 | I | current row num = 96
25-01-17 16:24:55 | I | current row num = 128
25-01-17 16:24:58 | I | current row num = 160
25-01-17 16:24:58 | I | current row num = 192
25-01-17 16:24:59 | I | current row num = 224
25-01-17 16:25:00 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/12.jsonl 
 ***
25-01-17 16:25:00 | I | *** 
 total_rows = 301 
 ***
25-01-17 16:25:00 | I | current row num = 0
25-01-17 16:25:01 | I | current row num = 32
25-01-17 16:25:01 | I | current row num = 64
25-01-17 16:25:02 | I | current row num = 96
25-01-17 16:25:04 | I | current row num = 128
25-01-17 16:25:05 | I | current row num = 160
25-01-17 16:25:07 | I | current row num = 192
25-01-17 16:25:07 | I | current row num = 224
25-01-17 16:25:08 | I | current row num = 256
25-01-17 16:25:09 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/13.jsonl 
 ***
25-01-17 16:25:09 | I | *** 
 total_rows = 239 
 ***
25-01-17 16:25:09 | I | current row num = 0
25-01-17 16:25:10 | I | current row num = 32
25-01-17 16:25:10 | I | current row num = 64
25-01-17 16:25:11 | I | current row num = 96
25-01-17 16:25:12 | I | current row num = 128
25-01-17 16:25:14 | I | current row num = 160
25-01-17 16:25:16 | I | current row num = 192
25-01-17 16:25:17 | I | current row num = 224
25-01-17 16:25:18 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/14.jsonl 
 ***
25-01-17 16:25:18 | I | *** 
 total_rows = 262 
 ***
25-01-17 16:25:18 | I | current row num = 0
25-01-17 16:25:18 | I | current row num = 32
25-01-17 16:25:19 | I | current row num = 64
25-01-17 16:25:20 | I | current row num = 96
25-01-17 16:25:21 | I | current row num = 128
25-01-17 16:25:22 | I | current row num = 160
25-01-17 16:25:22 | I | current row num = 192
25-01-17 16:25:25 | I | current row num = 224
25-01-17 16:25:26 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/15.jsonl 
 ***
25-01-17 16:25:26 | I | *** 
 total_rows = 253 
 ***
25-01-17 16:25:26 | I | current row num = 0
25-01-17 16:25:26 | I | current row num = 32
25-01-17 16:25:27 | I | current row num = 64
25-01-17 16:25:28 | I | current row num = 96
25-01-17 16:25:29 | I | current row num = 128
25-01-17 16:25:29 | I | current row num = 160
25-01-17 16:25:32 | I | current row num = 192
25-01-17 16:25:33 | I | current row num = 224
25-01-17 16:25:35 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/16.jsonl 
 ***
25-01-17 16:25:35 | I | *** 
 total_rows = 523 
 ***
25-01-17 16:25:35 | I | current row num = 0
25-01-17 16:25:36 | I | current row num = 32
25-01-17 16:25:36 | I | current row num = 64
25-01-17 16:25:37 | I | current row num = 96
25-01-17 16:25:38 | I | current row num = 128
25-01-17 16:25:39 | I | current row num = 160
25-01-17 16:25:39 | I | current row num = 192
25-01-17 16:25:40 | I | current row num = 224
25-01-17 16:25:41 | I | current row num = 256
25-01-17 16:25:42 | I | current row num = 288
25-01-17 16:25:42 | I | current row num = 320
25-01-17 16:25:43 | I | current row num = 352
25-01-17 16:25:44 | I | current row num = 384
25-01-17 16:25:45 | I | current row num = 416
25-01-17 16:25:45 | I | current row num = 448
25-01-17 16:25:46 | I | current row num = 480
25-01-17 16:25:47 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/17.jsonl 
 ***
25-01-17 16:25:47 | I | *** 
 total_rows = 251 
 ***
25-01-17 16:25:47 | I | current row num = 0
25-01-17 16:25:48 | I | current row num = 32
25-01-17 16:25:48 | I | current row num = 64
25-01-17 16:25:49 | I | current row num = 96
25-01-17 16:25:50 | I | current row num = 128
25-01-17 16:25:51 | I | current row num = 160
25-01-17 16:25:52 | I | current row num = 192
25-01-17 16:25:53 | I | current row num = 224
25-01-17 16:25:54 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/18.jsonl 
 ***
25-01-17 16:25:54 | I | *** 
 total_rows = 274 
 ***
25-01-17 16:25:54 | I | current row num = 0
25-01-17 16:25:54 | I | current row num = 32
25-01-17 16:25:55 | I | current row num = 64
25-01-17 16:25:56 | I | current row num = 96
25-01-17 16:25:56 | I | current row num = 128
25-01-17 16:25:57 | I | current row num = 160
25-01-17 16:25:58 | I | current row num = 192
25-01-17 16:25:59 | I | current row num = 224
25-01-17 16:25:59 | I | current row num = 256
25-01-17 16:26:01 | I | *** 
 now in /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val/19.jsonl 
 ***
25-01-17 16:26:01 | I | *** 
 total_rows = 315 
 ***
25-01-17 16:26:01 | I | current row num = 0
25-01-17 16:26:01 | I | current row num = 32
25-01-17 16:26:02 | I | current row num = 64
25-01-17 16:26:03 | I | current row num = 96
25-01-17 16:26:04 | I | current row num = 128
25-01-17 16:26:04 | I | current row num = 160
25-01-17 16:26:05 | I | current row num = 192
25-01-17 16:26:06 | I | current row num = 224
25-01-17 16:26:07 | I | current row num = 256
25-01-17 16:26:07 | I | current row num = 288
25-01-17 16:26:10 | I | current row num = 320
25-01-17 16:26:11 | I | No existing checkpoint found checkpoints/checkpoint_last.pt
25-01-17 16:26:11 | I | loading train data for epoch 1
25-01-17 16:26:11 | I | loading valid data for epoch 1
25-01-17 16:26:18 | I | begin training epoch 1
25-01-17 16:26:18 | I | Start iterating over samples
25-01-17 16:26:18 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:26:18 | I | in layer model.layers.4
25-01-17 16:26:18 | I | quantizing weights for layer model.layers.4
25-01-17 16:26:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:26:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:26:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:26:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:26:20 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:26:20 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:26:20 | I |       - range scale = [    1.0000]
25-01-17 16:26:20 | I |         sum  error  = [    0.5896]
25-01-17 16:26:20 | I |         best error  = [    0.5896]
25-01-17 16:26:20 | I |     + error = [0.5896]
25-01-17 16:26:21 | I |       - range scale = [    1.0000]
25-01-17 16:26:21 | I |         sum  error  = [    5.0300]
25-01-17 16:26:21 | I |         best error  = [    5.0300]
25-01-17 16:26:21 | I |     + error = [5.0300]
25-01-17 16:26:21 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:26:22 | I |       - range scale = [    1.0000]
25-01-17 16:26:22 | I |         sum  error  = [    0.2969]
25-01-17 16:26:22 | I |         best error  = [    0.2969]
25-01-17 16:26:22 | I |     + error = [0.2969]
25-01-17 16:26:22 | I |       - range scale = [    1.0000]
25-01-17 16:26:22 | I |         sum  error  = [    2.3463]
25-01-17 16:26:22 | I |         best error  = [    2.3463]
25-01-17 16:26:22 | I |     + error = [2.3463]
25-01-17 16:26:23 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:26:23 | I |       - range scale = [    1.0000]
25-01-17 16:26:23 | I |         sum  error  = [    0.6320]
25-01-17 16:26:23 | I |         best error  = [    0.6320]
25-01-17 16:26:23 | I |     + error = [0.6320]
25-01-17 16:26:24 | I |       - range scale = [    1.0000]
25-01-17 16:26:24 | I |         sum  error  = [    6.9917]
25-01-17 16:26:24 | I |         best error  = [    6.9917]
25-01-17 16:26:24 | I |     + error = [6.9917]
25-01-17 16:26:24 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:26:25 | I |       - range scale = [    1.0000]
25-01-17 16:26:25 | I |         sum  error  = [    0.1136]
25-01-17 16:26:25 | I |         best error  = [    0.1136]
25-01-17 16:26:25 | I |     + error = [0.1136]
25-01-17 16:26:25 | I |       - range scale = [    1.0000]
25-01-17 16:26:25 | I |         sum  error  = [    1.2518]
25-01-17 16:26:25 | I |         best error  = [    1.2518]
25-01-17 16:26:25 | I |     + error = [1.2518]
25-01-17 16:26:26 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:26:26 | I |       - range scale = [    1.0000]
25-01-17 16:26:26 | I |         sum  error  = [    2.0142]
25-01-17 16:26:26 | I |         best error  = [    2.0142]
25-01-17 16:26:26 | I |     + error = [2.0142]
25-01-17 16:26:27 | I |       - range scale = [    1.0000]
25-01-17 16:26:27 | I |         sum  error  = [   22.6934]
25-01-17 16:26:27 | I |         best error  = [   22.6934]
25-01-17 16:26:27 | I |     + error = [22.6934]
25-01-17 16:26:27 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:26:28 | I |       - range scale = [    1.0000]
25-01-17 16:26:28 | I |         sum  error  = [    2.2120]
25-01-17 16:26:28 | I |         best error  = [    2.2120]
25-01-17 16:26:28 | I |     + error = [2.2120]
25-01-17 16:26:28 | I |       - range scale = [    1.0000]
25-01-17 16:26:28 | I |         sum  error  = [   24.7895]
25-01-17 16:26:28 | I |         best error  = [   24.7895]
25-01-17 16:26:28 | I |     + error = [24.7895]
25-01-17 16:26:29 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:26:29 | I |       - range scale = [    1.0000]
25-01-17 16:26:29 | I |         sum  error  = [    0.1720]
25-01-17 16:26:29 | I |         best error  = [    0.1720]
25-01-17 16:26:29 | I |     + error = [0.1720]
25-01-17 16:26:30 | I |       - range scale = [    1.0000]
25-01-17 16:26:30 | I |         sum  error  = [    1.7614]
25-01-17 16:26:30 | I |         best error  = [    1.7614]
25-01-17 16:26:30 | I |     + error = [1.7614]
25-01-17 16:26:30 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:26:32 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:26:34 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:26:35 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:26:37 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:26:38 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:26:39 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:26:43 | I | quantizing activations for layer model.layers.4
25-01-17 16:26:43 | I | collecting calibration activations in model.layers.4
25-01-17 16:26:43 | I | collecting calibration activations in model.layers.4
25-01-17 16:26:43 | I | collecting calibration activations in model.layers.4
25-01-17 16:26:43 | I | collecting calibration activations in model.layers.4
25-01-17 16:26:45 | I | forward this layer
25-01-17 16:26:45 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/00.pt
25-01-17 16:26:45 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/00.pt
25-01-17 16:26:45 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:26:45 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: True
25-01-17 16:26:45 | I | inf: first position tensor([504, 557], device='cuda:0')
25-01-17 16:26:45 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:26:45 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:26:45 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:26:45 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: True
25-01-17 16:26:45 | I | inf: first position tensor([   5, 1619], device='cuda:0')
25-01-17 16:26:45 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:26:45 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:26:45 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:26:45 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:26:45 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:26:45 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:26:45 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:26:45 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:26:45 | I | in layer model.layers.4
25-01-17 16:26:45 | I | quantizing weights for layer model.layers.4
25-01-17 16:26:46 | I | collecting calibration activations in model.layers.4
25-01-17 16:26:46 | I | collecting calibration activations in model.layers.4
25-01-17 16:26:46 | I | collecting calibration activations in model.layers.4
25-01-17 16:26:46 | I | collecting calibration activations in model.layers.4
25-01-17 16:26:46 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:26:46 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:26:47 | I |       - range scale = [    1.0000]
25-01-17 16:26:47 | I |         sum  error  = [    0.6045]
25-01-17 16:26:47 | I |         best error  = [    0.6045]
25-01-17 16:26:47 | I |     + error = [0.6045]
25-01-17 16:26:48 | I |       - range scale = [    1.0000]
25-01-17 16:26:48 | I |         sum  error  = [    5.0458]
25-01-17 16:26:48 | I |         best error  = [    5.0458]
25-01-17 16:26:48 | I |     + error = [5.0458]
25-01-17 16:26:48 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:26:49 | I |       - range scale = [    1.0000]
25-01-17 16:26:49 | I |         sum  error  = [    0.3161]
25-01-17 16:26:49 | I |         best error  = [    0.3161]
25-01-17 16:26:49 | I |     + error = [0.3161]
25-01-17 16:26:49 | I |       - range scale = [    1.0000]
25-01-17 16:26:49 | I |         sum  error  = [    2.4134]
25-01-17 16:26:49 | I |         best error  = [    2.4134]
25-01-17 16:26:49 | I |     + error = [2.4134]
25-01-17 16:26:49 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:26:50 | I |       - range scale = [    1.0000]
25-01-17 16:26:50 | I |         sum  error  = [    0.6304]
25-01-17 16:26:50 | I |         best error  = [    0.6304]
25-01-17 16:26:50 | I |     + error = [0.6304]
25-01-17 16:26:51 | I |       - range scale = [    1.0000]
25-01-17 16:26:51 | I |         sum  error  = [    6.9314]
25-01-17 16:26:51 | I |         best error  = [    6.9314]
25-01-17 16:26:51 | I |     + error = [6.9314]
25-01-17 16:26:51 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:26:51 | I |       - range scale = [    1.0000]
25-01-17 16:26:51 | I |         sum  error  = [    0.1082]
25-01-17 16:26:51 | I |         best error  = [    0.1082]
25-01-17 16:26:51 | I |     + error = [0.1082]
25-01-17 16:26:52 | I |       - range scale = [    1.0000]
25-01-17 16:26:52 | I |         sum  error  = [    1.1847]
25-01-17 16:26:52 | I |         best error  = [    1.1847]
25-01-17 16:26:52 | I |     + error = [1.1847]
25-01-17 16:26:52 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:26:53 | I |       - range scale = [    1.0000]
25-01-17 16:26:53 | I |         sum  error  = [    1.9908]
25-01-17 16:26:53 | I |         best error  = [    1.9908]
25-01-17 16:26:53 | I |     + error = [1.9908]
25-01-17 16:26:54 | I |       - range scale = [    1.0000]
25-01-17 16:26:54 | I |         sum  error  = [   22.4098]
25-01-17 16:26:54 | I |         best error  = [   22.4098]
25-01-17 16:26:54 | I |     + error = [22.4098]
25-01-17 16:26:54 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:26:54 | I |       - range scale = [    1.0000]
25-01-17 16:26:54 | I |         sum  error  = [    2.1816]
25-01-17 16:26:54 | I |         best error  = [    2.1816]
25-01-17 16:26:54 | I |     + error = [2.1816]
25-01-17 16:26:55 | I |       - range scale = [    1.0000]
25-01-17 16:26:55 | I |         sum  error  = [   24.4810]
25-01-17 16:26:55 | I |         best error  = [   24.4810]
25-01-17 16:26:55 | I |     + error = [24.4810]
25-01-17 16:26:55 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:26:56 | I |       - range scale = [    1.0000]
25-01-17 16:26:56 | I |         sum  error  = [    0.1716]
25-01-17 16:26:56 | I |         best error  = [    0.1716]
25-01-17 16:26:56 | I |     + error = [0.1716]
25-01-17 16:26:57 | I |       - range scale = [    1.0000]
25-01-17 16:26:57 | I |         sum  error  = [    1.7602]
25-01-17 16:26:57 | I |         best error  = [    1.7602]
25-01-17 16:26:57 | I |     + error = [1.7602]
25-01-17 16:26:57 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:26:58 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:27:00 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:27:01 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:27:03 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:27:04 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:27:05 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:27:08 | I | quantizing activations for layer model.layers.4
25-01-17 16:27:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:27:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:27:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:27:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:27:11 | I | forward this layer
25-01-17 16:27:11 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/01.pt
25-01-17 16:27:11 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/01.pt
25-01-17 16:27:11 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:27:11 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: True
25-01-17 16:27:11 | I | inf: first position tensor([504,  94], device='cuda:0')
25-01-17 16:27:11 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:27:11 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:27:11 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:27:11 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: True
25-01-17 16:27:11 | I | inf: first position tensor([   5, 1619], device='cuda:0')
25-01-17 16:27:11 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:27:11 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:27:11 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:27:11 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:27:11 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:27:11 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:27:11 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:27:11 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:27:11 | I | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 64.0
25-01-17 16:27:11 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:27:11 | I | in layer model.layers.4
25-01-17 16:27:11 | I | quantizing weights for layer model.layers.4
25-01-17 16:27:12 | I | collecting calibration activations in model.layers.4
25-01-17 16:27:12 | I | collecting calibration activations in model.layers.4
25-01-17 16:27:12 | I | collecting calibration activations in model.layers.4
25-01-17 16:27:12 | I | collecting calibration activations in model.layers.4
25-01-17 16:27:12 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:27:12 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:27:13 | I |       - range scale = [    1.0000]
25-01-17 16:27:13 | I |         sum  error  = [    0.5934]
25-01-17 16:27:13 | I |         best error  = [    0.5934]
25-01-17 16:27:13 | I |     + error = [0.5934]
25-01-17 16:27:14 | I |       - range scale = [    1.0000]
25-01-17 16:27:14 | I |         sum  error  = [    4.9960]
25-01-17 16:27:14 | I |         best error  = [    4.9960]
25-01-17 16:27:14 | I |     + error = [4.9960]
25-01-17 16:27:14 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:27:15 | I |       - range scale = [    1.0000]
25-01-17 16:27:15 | I |         sum  error  = [    0.3087]
25-01-17 16:27:15 | I |         best error  = [    0.3087]
25-01-17 16:27:15 | I |     + error = [0.3087]
25-01-17 16:27:15 | I |       - range scale = [    1.0000]
25-01-17 16:27:15 | I |         sum  error  = [    2.3456]
25-01-17 16:27:15 | I |         best error  = [    2.3456]
25-01-17 16:27:15 | I |     + error = [2.3456]
25-01-17 16:27:16 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:27:16 | I |       - range scale = [    1.0000]
25-01-17 16:27:16 | I |         sum  error  = [    0.6323]
25-01-17 16:27:16 | I |         best error  = [    0.6323]
25-01-17 16:27:16 | I |     + error = [0.6323]
25-01-17 16:27:17 | I |       - range scale = [    1.0000]
25-01-17 16:27:17 | I |         sum  error  = [    6.9496]
25-01-17 16:27:17 | I |         best error  = [    6.9496]
25-01-17 16:27:17 | I |     + error = [6.9496]
25-01-17 16:27:17 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:27:18 | I |       - range scale = [    1.0000]
25-01-17 16:27:18 | I |         sum  error  = [    0.1103]
25-01-17 16:27:18 | I |         best error  = [    0.1103]
25-01-17 16:27:18 | I |     + error = [0.1103]
25-01-17 16:27:18 | I |       - range scale = [    1.0000]
25-01-17 16:27:18 | I |         sum  error  = [    1.2143]
25-01-17 16:27:18 | I |         best error  = [    1.2143]
25-01-17 16:27:18 | I |     + error = [1.2143]
25-01-17 16:27:18 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:27:19 | I |       - range scale = [    1.0000]
25-01-17 16:27:19 | I |         sum  error  = [    2.0011]
25-01-17 16:27:19 | I |         best error  = [    2.0011]
25-01-17 16:27:19 | I |     + error = [2.0011]
25-01-17 16:27:20 | I |       - range scale = [    1.0000]
25-01-17 16:27:20 | I |         sum  error  = [   22.5087]
25-01-17 16:27:20 | I |         best error  = [   22.5087]
25-01-17 16:27:20 | I |     + error = [22.5087]
25-01-17 16:27:20 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:27:21 | I |       - range scale = [    1.0000]
25-01-17 16:27:21 | I |         sum  error  = [    2.1916]
25-01-17 16:27:21 | I |         best error  = [    2.1916]
25-01-17 16:27:21 | I |     + error = [2.1916]
25-01-17 16:27:21 | I |       - range scale = [    1.0000]
25-01-17 16:27:21 | I |         sum  error  = [   24.5870]
25-01-17 16:27:21 | I |         best error  = [   24.5870]
25-01-17 16:27:21 | I |     + error = [24.5870]
25-01-17 16:27:22 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:27:22 | I |       - range scale = [    1.0000]
25-01-17 16:27:22 | I |         sum  error  = [    0.1772]
25-01-17 16:27:22 | I |         best error  = [    0.1772]
25-01-17 16:27:22 | I |     + error = [0.1772]
25-01-17 16:27:23 | I |       - range scale = [    1.0000]
25-01-17 16:27:23 | I |         sum  error  = [    1.8217]
25-01-17 16:27:23 | I |         best error  = [    1.8217]
25-01-17 16:27:23 | I |     + error = [1.8217]
25-01-17 16:27:23 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:27:24 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:27:26 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:27:27 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:27:28 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:27:30 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:27:31 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:27:35 | I | quantizing activations for layer model.layers.4
25-01-17 16:27:35 | I | collecting calibration activations in model.layers.4
25-01-17 16:27:35 | I | collecting calibration activations in model.layers.4
25-01-17 16:27:35 | I | collecting calibration activations in model.layers.4
25-01-17 16:27:35 | I | collecting calibration activations in model.layers.4
25-01-17 16:27:37 | I | forward this layer
25-01-17 16:27:37 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/02.pt
25-01-17 16:27:37 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/02.pt
25-01-17 16:27:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:27:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:27:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:27:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:27:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:27:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: True
25-01-17 16:27:37 | I | inf: first position tensor([ 15, 174], device='cuda:0')
25-01-17 16:27:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:27:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:27:37 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:27:37 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:27:37 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:27:37 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:27:37 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:27:37 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:27:37 | I | in layer model.layers.4
25-01-17 16:27:37 | I | quantizing weights for layer model.layers.4
25-01-17 16:27:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:27:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:27:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:27:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:27:38 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:27:38 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:27:39 | I |       - range scale = [    1.0000]
25-01-17 16:27:39 | I |         sum  error  = [    0.5928]
25-01-17 16:27:39 | I |         best error  = [    0.5928]
25-01-17 16:27:39 | I |     + error = [0.5928]
25-01-17 16:27:40 | I |       - range scale = [    1.0000]
25-01-17 16:27:40 | I |         sum  error  = [    5.0254]
25-01-17 16:27:40 | I |         best error  = [    5.0254]
25-01-17 16:27:40 | I |     + error = [5.0254]
25-01-17 16:27:40 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:27:41 | I |       - range scale = [    1.0000]
25-01-17 16:27:41 | I |         sum  error  = [    0.2988]
25-01-17 16:27:41 | I |         best error  = [    0.2988]
25-01-17 16:27:41 | I |     + error = [0.2988]
25-01-17 16:27:41 | I |       - range scale = [    1.0000]
25-01-17 16:27:41 | I |         sum  error  = [    2.2938]
25-01-17 16:27:41 | I |         best error  = [    2.2938]
25-01-17 16:27:41 | I |     + error = [2.2938]
25-01-17 16:27:42 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:27:42 | I |       - range scale = [    1.0000]
25-01-17 16:27:42 | I |         sum  error  = [    0.6306]
25-01-17 16:27:42 | I |         best error  = [    0.6306]
25-01-17 16:27:42 | I |     + error = [0.6306]
25-01-17 16:27:43 | I |       - range scale = [    1.0000]
25-01-17 16:27:43 | I |         sum  error  = [    6.9936]
25-01-17 16:27:43 | I |         best error  = [    6.9936]
25-01-17 16:27:43 | I |     + error = [6.9936]
25-01-17 16:27:43 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:27:44 | I |       - range scale = [    1.0000]
25-01-17 16:27:44 | I |         sum  error  = [    0.1075]
25-01-17 16:27:44 | I |         best error  = [    0.1075]
25-01-17 16:27:44 | I |     + error = [0.1075]
25-01-17 16:27:44 | I |       - range scale = [    1.0000]
25-01-17 16:27:44 | I |         sum  error  = [    1.1737]
25-01-17 16:27:44 | I |         best error  = [    1.1737]
25-01-17 16:27:44 | I |     + error = [1.1737]
25-01-17 16:27:45 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:27:45 | I |       - range scale = [    1.0000]
25-01-17 16:27:45 | I |         sum  error  = [    1.9872]
25-01-17 16:27:45 | I |         best error  = [    1.9872]
25-01-17 16:27:45 | I |     + error = [1.9872]
25-01-17 16:27:46 | I |       - range scale = [    1.0000]
25-01-17 16:27:46 | I |         sum  error  = [   22.3492]
25-01-17 16:27:46 | I |         best error  = [   22.3492]
25-01-17 16:27:46 | I |     + error = [22.3492]
25-01-17 16:27:46 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:27:47 | I |       - range scale = [    1.0000]
25-01-17 16:27:47 | I |         sum  error  = [    2.1754]
25-01-17 16:27:47 | I |         best error  = [    2.1754]
25-01-17 16:27:47 | I |     + error = [2.1754]
25-01-17 16:27:48 | I |       - range scale = [    1.0000]
25-01-17 16:27:48 | I |         sum  error  = [   24.4077]
25-01-17 16:27:48 | I |         best error  = [   24.4077]
25-01-17 16:27:48 | I |     + error = [24.4077]
25-01-17 16:27:48 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:27:48 | I |       - range scale = [    1.0000]
25-01-17 16:27:48 | I |         sum  error  = [    0.1728]
25-01-17 16:27:48 | I |         best error  = [    0.1728]
25-01-17 16:27:48 | I |     + error = [0.1728]
25-01-17 16:27:49 | I |       - range scale = [    1.0000]
25-01-17 16:27:49 | I |         sum  error  = [    1.7675]
25-01-17 16:27:49 | I |         best error  = [    1.7675]
25-01-17 16:27:49 | I |     + error = [1.7675]
25-01-17 16:27:49 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:27:51 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:27:52 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:27:53 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:27:55 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:27:56 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:27:58 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:28:01 | I | quantizing activations for layer model.layers.4
25-01-17 16:28:01 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:01 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:02 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:02 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:03 | I | forward this layer
25-01-17 16:28:03 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/03.pt
25-01-17 16:28:03 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/03.pt
25-01-17 16:28:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:28:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:28:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:28:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:28:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:28:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: True
25-01-17 16:28:04 | I | inf: first position tensor([  14, 1619], device='cuda:0')
25-01-17 16:28:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:28:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:28:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:28:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:28:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:28:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:28:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:28:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:28:04 | I | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 32.0
25-01-17 16:28:04 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:28:04 | I | in layer model.layers.4
25-01-17 16:28:04 | I | quantizing weights for layer model.layers.4
25-01-17 16:28:04 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:04 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:05 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:05 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:05 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:28:05 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:28:06 | I |       - range scale = [    1.0000]
25-01-17 16:28:06 | I |         sum  error  = [    0.5911]
25-01-17 16:28:06 | I |         best error  = [    0.5911]
25-01-17 16:28:06 | I |     + error = [0.5911]
25-01-17 16:28:06 | I |       - range scale = [    1.0000]
25-01-17 16:28:06 | I |         sum  error  = [    4.9495]
25-01-17 16:28:06 | I |         best error  = [    4.9495]
25-01-17 16:28:06 | I |     + error = [4.9495]
25-01-17 16:28:06 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:28:07 | I |       - range scale = [    1.0000]
25-01-17 16:28:07 | I |         sum  error  = [    0.2961]
25-01-17 16:28:07 | I |         best error  = [    0.2961]
25-01-17 16:28:07 | I |     + error = [0.2961]
25-01-17 16:28:08 | I |       - range scale = [    1.0000]
25-01-17 16:28:08 | I |         sum  error  = [    2.3186]
25-01-17 16:28:08 | I |         best error  = [    2.3186]
25-01-17 16:28:08 | I |     + error = [2.3186]
25-01-17 16:28:08 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:28:09 | I |       - range scale = [    1.0000]
25-01-17 16:28:09 | I |         sum  error  = [    0.6351]
25-01-17 16:28:09 | I |         best error  = [    0.6351]
25-01-17 16:28:09 | I |     + error = [0.6351]
25-01-17 16:28:09 | I |       - range scale = [    1.0000]
25-01-17 16:28:09 | I |         sum  error  = [    7.0233]
25-01-17 16:28:09 | I |         best error  = [    7.0233]
25-01-17 16:28:09 | I |     + error = [7.0233]
25-01-17 16:28:10 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:28:10 | I |       - range scale = [    1.0000]
25-01-17 16:28:10 | I |         sum  error  = [    0.1072]
25-01-17 16:28:10 | I |         best error  = [    0.1072]
25-01-17 16:28:10 | I |     + error = [0.1072]
25-01-17 16:28:11 | I |       - range scale = [    1.0000]
25-01-17 16:28:11 | I |         sum  error  = [    1.1563]
25-01-17 16:28:11 | I |         best error  = [    1.1563]
25-01-17 16:28:11 | I |     + error = [1.1563]
25-01-17 16:28:11 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:28:12 | I |       - range scale = [    1.0000]
25-01-17 16:28:12 | I |         sum  error  = [    1.9856]
25-01-17 16:28:12 | I |         best error  = [    1.9856]
25-01-17 16:28:12 | I |     + error = [1.9856]
25-01-17 16:28:12 | I |       - range scale = [    1.0000]
25-01-17 16:28:12 | I |         sum  error  = [   22.3493]
25-01-17 16:28:12 | I |         best error  = [   22.3493]
25-01-17 16:28:12 | I |     + error = [22.3493]
25-01-17 16:28:13 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:28:13 | I |       - range scale = [    1.0000]
25-01-17 16:28:13 | I |         sum  error  = [    2.1735]
25-01-17 16:28:13 | I |         best error  = [    2.1735]
25-01-17 16:28:13 | I |     + error = [2.1735]
25-01-17 16:28:14 | I |       - range scale = [    1.0000]
25-01-17 16:28:14 | I |         sum  error  = [   24.4052]
25-01-17 16:28:14 | I |         best error  = [   24.4052]
25-01-17 16:28:14 | I |     + error = [24.4052]
25-01-17 16:28:14 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:28:15 | I |       - range scale = [    1.0000]
25-01-17 16:28:15 | I |         sum  error  = [    0.1689]
25-01-17 16:28:15 | I |         best error  = [    0.1689]
25-01-17 16:28:15 | I |     + error = [0.1689]
25-01-17 16:28:16 | I |       - range scale = [    1.0000]
25-01-17 16:28:16 | I |         sum  error  = [    1.7308]
25-01-17 16:28:16 | I |         best error  = [    1.7308]
25-01-17 16:28:16 | I |     + error = [1.7308]
25-01-17 16:28:16 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:28:17 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:28:19 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:28:20 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:28:21 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:28:23 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:28:24 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:28:27 | I | quantizing activations for layer model.layers.4
25-01-17 16:28:28 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:28 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:28 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:28 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:30 | I | forward this layer
25-01-17 16:28:30 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/04.pt
25-01-17 16:28:30 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/04.pt
25-01-17 16:28:30 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:28:30 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:28:30 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:28:30 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:28:30 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:28:30 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: True
25-01-17 16:28:30 | I | inf: first position tensor([  15, 1327], device='cuda:0')
25-01-17 16:28:30 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:28:30 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:28:30 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:28:30 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:28:30 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:28:30 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:28:30 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:28:30 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:28:30 | I | in layer model.layers.4
25-01-17 16:28:30 | I | quantizing weights for layer model.layers.4
25-01-17 16:28:30 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:30 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:31 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:31 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:31 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:28:31 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:28:32 | I |       - range scale = [    1.0000]
25-01-17 16:28:32 | I |         sum  error  = [    0.5801]
25-01-17 16:28:32 | I |         best error  = [    0.5801]
25-01-17 16:28:32 | I |     + error = [0.5801]
25-01-17 16:28:32 | I |       - range scale = [    1.0000]
25-01-17 16:28:32 | I |         sum  error  = [    4.8930]
25-01-17 16:28:32 | I |         best error  = [    4.8930]
25-01-17 16:28:32 | I |     + error = [4.8930]
25-01-17 16:28:32 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:28:33 | I |       - range scale = [    1.0000]
25-01-17 16:28:33 | I |         sum  error  = [    0.2984]
25-01-17 16:28:33 | I |         best error  = [    0.2984]
25-01-17 16:28:33 | I |     + error = [0.2984]
25-01-17 16:28:34 | I |       - range scale = [    1.0000]
25-01-17 16:28:34 | I |         sum  error  = [    2.3626]
25-01-17 16:28:34 | I |         best error  = [    2.3626]
25-01-17 16:28:34 | I |     + error = [2.3626]
25-01-17 16:28:34 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:28:35 | I |       - range scale = [    1.0000]
25-01-17 16:28:35 | I |         sum  error  = [    0.6330]
25-01-17 16:28:35 | I |         best error  = [    0.6330]
25-01-17 16:28:35 | I |     + error = [0.6330]
25-01-17 16:28:35 | I |       - range scale = [    1.0000]
25-01-17 16:28:35 | I |         sum  error  = [    7.0195]
25-01-17 16:28:35 | I |         best error  = [    7.0195]
25-01-17 16:28:35 | I |     + error = [7.0195]
25-01-17 16:28:35 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:28:36 | I |       - range scale = [    1.0000]
25-01-17 16:28:36 | I |         sum  error  = [    0.1155]
25-01-17 16:28:36 | I |         best error  = [    0.1155]
25-01-17 16:28:36 | I |     + error = [0.1155]
25-01-17 16:28:37 | I |       - range scale = [    1.0000]
25-01-17 16:28:37 | I |         sum  error  = [    1.2646]
25-01-17 16:28:37 | I |         best error  = [    1.2646]
25-01-17 16:28:37 | I |     + error = [1.2646]
25-01-17 16:28:37 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:28:37 | I |       - range scale = [    1.0000]
25-01-17 16:28:37 | I |         sum  error  = [    2.0128]
25-01-17 16:28:38 | I |         best error  = [    2.0128]
25-01-17 16:28:38 | I |     + error = [2.0128]
25-01-17 16:28:38 | I |       - range scale = [    1.0000]
25-01-17 16:28:38 | I |         sum  error  = [   22.6432]
25-01-17 16:28:38 | I |         best error  = [   22.6432]
25-01-17 16:28:38 | I |     + error = [22.6432]
25-01-17 16:28:38 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:28:39 | I |       - range scale = [    1.0000]
25-01-17 16:28:39 | I |         sum  error  = [    2.2041]
25-01-17 16:28:39 | I |         best error  = [    2.2041]
25-01-17 16:28:39 | I |     + error = [2.2041]
25-01-17 16:28:40 | I |       - range scale = [    1.0000]
25-01-17 16:28:40 | I |         sum  error  = [   24.7415]
25-01-17 16:28:40 | I |         best error  = [   24.7415]
25-01-17 16:28:40 | I |     + error = [24.7415]
25-01-17 16:28:40 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:28:41 | I |       - range scale = [    1.0000]
25-01-17 16:28:41 | I |         sum  error  = [    0.1753]
25-01-17 16:28:41 | I |         best error  = [    0.1753]
25-01-17 16:28:41 | I |     + error = [0.1753]
25-01-17 16:28:41 | I |       - range scale = [    1.0000]
25-01-17 16:28:41 | I |         sum  error  = [    1.7978]
25-01-17 16:28:41 | I |         best error  = [    1.7978]
25-01-17 16:28:41 | I |     + error = [1.7978]
25-01-17 16:28:42 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:28:43 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:28:44 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:28:45 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:28:47 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:28:48 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:28:49 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:28:53 | I | quantizing activations for layer model.layers.4
25-01-17 16:28:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:55 | I | forward this layer
25-01-17 16:28:55 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/05.pt
25-01-17 16:28:55 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/05.pt
25-01-17 16:28:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:28:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:28:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:28:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:28:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:28:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: True
25-01-17 16:28:55 | I | inf: first position tensor([ 15, 763], device='cuda:0')
25-01-17 16:28:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:28:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:28:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:28:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:28:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:28:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:28:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:28:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:28:55 | I | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 16.0
25-01-17 16:28:56 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:28:56 | I | in layer model.layers.4
25-01-17 16:28:56 | I | quantizing weights for layer model.layers.4
25-01-17 16:28:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:28:57 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:28:57 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:28:57 | I |       - range scale = [    1.0000]
25-01-17 16:28:57 | I |         sum  error  = [    0.6279]
25-01-17 16:28:57 | I |         best error  = [    0.6279]
25-01-17 16:28:57 | I |     + error = [0.6279]
25-01-17 16:28:58 | I |       - range scale = [    1.0000]
25-01-17 16:28:58 | I |         sum  error  = [    5.0377]
25-01-17 16:28:58 | I |         best error  = [    5.0377]
25-01-17 16:28:58 | I |     + error = [5.0377]
25-01-17 16:28:58 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:28:59 | I |       - range scale = [    1.0000]
25-01-17 16:28:59 | I |         sum  error  = [    0.3450]
25-01-17 16:28:59 | I |         best error  = [    0.3450]
25-01-17 16:28:59 | I |     + error = [0.3450]
25-01-17 16:28:59 | I |       - range scale = [    1.0000]
25-01-17 16:28:59 | I |         sum  error  = [    2.5209]
25-01-17 16:28:59 | I |         best error  = [    2.5209]
25-01-17 16:28:59 | I |     + error = [2.5209]
25-01-17 16:29:00 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:29:00 | I |       - range scale = [    1.0000]
25-01-17 16:29:00 | I |         sum  error  = [    0.6326]
25-01-17 16:29:00 | I |         best error  = [    0.6326]
25-01-17 16:29:00 | I |     + error = [0.6326]
25-01-17 16:29:01 | I |       - range scale = [    1.0000]
25-01-17 16:29:01 | I |         sum  error  = [    6.9702]
25-01-17 16:29:01 | I |         best error  = [    6.9702]
25-01-17 16:29:01 | I |     + error = [6.9702]
25-01-17 16:29:01 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:29:02 | I |       - range scale = [    1.0000]
25-01-17 16:29:02 | I |         sum  error  = [    0.1092]
25-01-17 16:29:02 | I |         best error  = [    0.1092]
25-01-17 16:29:02 | I |     + error = [0.1092]
25-01-17 16:29:03 | I |       - range scale = [    1.0000]
25-01-17 16:29:03 | I |         sum  error  = [    1.1998]
25-01-17 16:29:03 | I |         best error  = [    1.1998]
25-01-17 16:29:03 | I |     + error = [1.1998]
25-01-17 16:29:03 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:29:04 | I |       - range scale = [    1.0000]
25-01-17 16:29:04 | I |         sum  error  = [    2.0142]
25-01-17 16:29:04 | I |         best error  = [    2.0142]
25-01-17 16:29:04 | I |     + error = [2.0142]
25-01-17 16:29:04 | I |       - range scale = [    1.0000]
25-01-17 16:29:04 | I |         sum  error  = [   22.6636]
25-01-17 16:29:04 | I |         best error  = [   22.6636]
25-01-17 16:29:04 | I |     + error = [22.6636]
25-01-17 16:29:05 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:29:05 | I |       - range scale = [    1.0000]
25-01-17 16:29:05 | I |         sum  error  = [    2.2102]
25-01-17 16:29:05 | I |         best error  = [    2.2102]
25-01-17 16:29:05 | I |     + error = [2.2102]
25-01-17 16:29:06 | I |       - range scale = [    1.0000]
25-01-17 16:29:06 | I |         sum  error  = [   24.7624]
25-01-17 16:29:06 | I |         best error  = [   24.7624]
25-01-17 16:29:06 | I |     + error = [24.7624]
25-01-17 16:29:06 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:29:07 | I |       - range scale = [    1.0000]
25-01-17 16:29:07 | I |         sum  error  = [    0.1768]
25-01-17 16:29:07 | I |         best error  = [    0.1768]
25-01-17 16:29:07 | I |     + error = [0.1768]
25-01-17 16:29:08 | I |       - range scale = [    1.0000]
25-01-17 16:29:08 | I |         sum  error  = [    1.8164]
25-01-17 16:29:08 | I |         best error  = [    1.8164]
25-01-17 16:29:08 | I |     + error = [1.8164]
25-01-17 16:29:08 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:29:09 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:29:10 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:29:12 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:29:13 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:29:14 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:29:16 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:29:19 | I | quantizing activations for layer model.layers.4
25-01-17 16:29:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:29:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:29:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:29:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:29:21 | I | forward this layer
25-01-17 16:29:21 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/06.pt
25-01-17 16:29:21 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/06.pt
25-01-17 16:29:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:29:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:29:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:29:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:29:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:29:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: True
25-01-17 16:29:22 | I | inf: first position tensor([  15, 1327], device='cuda:0')
25-01-17 16:29:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:29:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:29:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:29:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:29:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:29:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:29:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:29:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:29:22 | I | in layer model.layers.4
25-01-17 16:29:22 | I | quantizing weights for layer model.layers.4
25-01-17 16:29:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:29:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:29:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:29:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:29:23 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:29:23 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:29:23 | I |       - range scale = [    1.0000]
25-01-17 16:29:23 | I |         sum  error  = [    0.6162]
25-01-17 16:29:23 | I |         best error  = [    0.6162]
25-01-17 16:29:23 | I |     + error = [0.6162]
25-01-17 16:29:24 | I |       - range scale = [    1.0000]
25-01-17 16:29:24 | I |         sum  error  = [    5.1989]
25-01-17 16:29:24 | I |         best error  = [    5.1989]
25-01-17 16:29:24 | I |     + error = [5.1989]
25-01-17 16:29:24 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:29:25 | I |       - range scale = [    1.0000]
25-01-17 16:29:25 | I |         sum  error  = [    0.3517]
25-01-17 16:29:25 | I |         best error  = [    0.3517]
25-01-17 16:29:25 | I |     + error = [0.3517]
25-01-17 16:29:26 | I |       - range scale = [    1.0000]
25-01-17 16:29:26 | I |         sum  error  = [    2.8463]
25-01-17 16:29:26 | I |         best error  = [    2.8463]
25-01-17 16:29:26 | I |     + error = [2.8463]
25-01-17 16:29:26 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:29:26 | I |       - range scale = [    1.0000]
25-01-17 16:29:26 | I |         sum  error  = [    0.6350]
25-01-17 16:29:26 | I |         best error  = [    0.6350]
25-01-17 16:29:26 | I |     + error = [0.6350]
25-01-17 16:29:27 | I |       - range scale = [    1.0000]
25-01-17 16:29:27 | I |         sum  error  = [    6.9749]
25-01-17 16:29:27 | I |         best error  = [    6.9749]
25-01-17 16:29:27 | I |     + error = [6.9749]
25-01-17 16:29:27 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:29:28 | I |       - range scale = [    1.0000]
25-01-17 16:29:28 | I |         sum  error  = [    0.1215]
25-01-17 16:29:28 | I |         best error  = [    0.1215]
25-01-17 16:29:28 | I |     + error = [0.1215]
25-01-17 16:29:28 | I |       - range scale = [    1.0000]
25-01-17 16:29:28 | I |         sum  error  = [    1.3220]
25-01-17 16:29:28 | I |         best error  = [    1.3220]
25-01-17 16:29:28 | I |     + error = [1.3220]
25-01-17 16:29:29 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:29:29 | I |       - range scale = [    1.0000]
25-01-17 16:29:29 | I |         sum  error  = [    2.0560]
25-01-17 16:29:29 | I |         best error  = [    2.0560]
25-01-17 16:29:29 | I |     + error = [2.0560]
25-01-17 16:29:30 | I |       - range scale = [    1.0000]
25-01-17 16:29:30 | I |         sum  error  = [   23.1301]
25-01-17 16:29:30 | I |         best error  = [   23.1301]
25-01-17 16:29:30 | I |     + error = [23.1301]
25-01-17 16:29:30 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:29:31 | I |       - range scale = [    1.0000]
25-01-17 16:29:31 | I |         sum  error  = [    2.2509]
25-01-17 16:29:31 | I |         best error  = [    2.2509]
25-01-17 16:29:31 | I |     + error = [2.2509]
25-01-17 16:29:32 | I |       - range scale = [    1.0000]
25-01-17 16:29:32 | I |         sum  error  = [   25.2607]
25-01-17 16:29:32 | I |         best error  = [   25.2607]
25-01-17 16:29:32 | I |     + error = [25.2607]
25-01-17 16:29:32 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:29:32 | I |       - range scale = [    1.0000]
25-01-17 16:29:32 | I |         sum  error  = [    0.1770]
25-01-17 16:29:32 | I |         best error  = [    0.1770]
25-01-17 16:29:32 | I |     + error = [0.1770]
25-01-17 16:29:33 | I |       - range scale = [    1.0000]
25-01-17 16:29:33 | I |         sum  error  = [    1.8145]
25-01-17 16:29:33 | I |         best error  = [    1.8145]
25-01-17 16:29:33 | I |     + error = [1.8145]
25-01-17 16:29:33 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:29:35 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:29:36 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:29:37 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:29:39 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:29:40 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:29:41 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:29:45 | I | quantizing activations for layer model.layers.4
25-01-17 16:29:45 | I | collecting calibration activations in model.layers.4
25-01-17 16:29:45 | I | collecting calibration activations in model.layers.4
25-01-17 16:29:45 | I | collecting calibration activations in model.layers.4
25-01-17 16:29:45 | I | collecting calibration activations in model.layers.4
25-01-17 16:29:47 | I | forward this layer
25-01-17 16:29:47 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/07.pt
25-01-17 16:29:47 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/07.pt
25-01-17 16:29:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:29:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:29:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:29:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:29:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:29:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: True
25-01-17 16:29:47 | I | inf: first position tensor([  15, 1327], device='cuda:0')
25-01-17 16:29:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:29:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:29:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:29:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:29:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:29:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:29:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:29:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:29:47 | I | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 8.0
25-01-17 16:29:47 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:29:47 | I | in layer model.layers.4
25-01-17 16:29:47 | I | quantizing weights for layer model.layers.4
25-01-17 16:29:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:29:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:29:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:29:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:29:48 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:29:48 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:29:49 | I |       - range scale = [    1.0000]
25-01-17 16:29:49 | I |         sum  error  = [    0.5902]
25-01-17 16:29:49 | I |         best error  = [    0.5902]
25-01-17 16:29:49 | I |     + error = [0.5902]
25-01-17 16:29:50 | I |       - range scale = [    1.0000]
25-01-17 16:29:50 | I |         sum  error  = [    5.0714]
25-01-17 16:29:50 | I |         best error  = [    5.0714]
25-01-17 16:29:50 | I |     + error = [5.0714]
25-01-17 16:29:50 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:29:51 | I |       - range scale = [    1.0000]
25-01-17 16:29:51 | I |         sum  error  = [    0.3146]
25-01-17 16:29:51 | I |         best error  = [    0.3146]
25-01-17 16:29:51 | I |     + error = [0.3146]
25-01-17 16:29:51 | I |       - range scale = [    1.0000]
25-01-17 16:29:51 | I |         sum  error  = [    2.5834]
25-01-17 16:29:51 | I |         best error  = [    2.5834]
25-01-17 16:29:51 | I |     + error = [2.5834]
25-01-17 16:29:51 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:29:52 | I |       - range scale = [    1.0000]
25-01-17 16:29:52 | I |         sum  error  = [    0.6195]
25-01-17 16:29:52 | I |         best error  = [    0.6195]
25-01-17 16:29:52 | I |     + error = [0.6195]
25-01-17 16:29:53 | I |       - range scale = [    1.0000]
25-01-17 16:29:53 | I |         sum  error  = [    6.8094]
25-01-17 16:29:53 | I |         best error  = [    6.8094]
25-01-17 16:29:53 | I |     + error = [6.8094]
25-01-17 16:29:53 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:29:53 | I |       - range scale = [    1.0000]
25-01-17 16:29:53 | I |         sum  error  = [    0.1105]
25-01-17 16:29:54 | I |         best error  = [    0.1105]
25-01-17 16:29:54 | I |     + error = [0.1105]
25-01-17 16:29:54 | I |       - range scale = [    1.0000]
25-01-17 16:29:54 | I |         sum  error  = [    1.1951]
25-01-17 16:29:54 | I |         best error  = [    1.1951]
25-01-17 16:29:54 | I |     + error = [1.1951]
25-01-17 16:29:54 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:29:55 | I |       - range scale = [    1.0000]
25-01-17 16:29:55 | I |         sum  error  = [    1.9899]
25-01-17 16:29:55 | I |         best error  = [    1.9899]
25-01-17 16:29:55 | I |     + error = [1.9899]
25-01-17 16:29:56 | I |       - range scale = [    1.0000]
25-01-17 16:29:56 | I |         sum  error  = [   22.3413]
25-01-17 16:29:56 | I |         best error  = [   22.3413]
25-01-17 16:29:56 | I |     + error = [22.3413]
25-01-17 16:29:56 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:29:57 | I |       - range scale = [    1.0000]
25-01-17 16:29:57 | I |         sum  error  = [    2.1751]
25-01-17 16:29:57 | I |         best error  = [    2.1751]
25-01-17 16:29:57 | I |     + error = [2.1751]
25-01-17 16:29:57 | I |       - range scale = [    1.0000]
25-01-17 16:29:57 | I |         sum  error  = [   24.3990]
25-01-17 16:29:57 | I |         best error  = [   24.3990]
25-01-17 16:29:57 | I |     + error = [24.3990]
25-01-17 16:29:58 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:29:58 | I |       - range scale = [    1.0000]
25-01-17 16:29:58 | I |         sum  error  = [    0.1673]
25-01-17 16:29:58 | I |         best error  = [    0.1673]
25-01-17 16:29:58 | I |     + error = [0.1673]
25-01-17 16:29:59 | I |       - range scale = [    1.0000]
25-01-17 16:29:59 | I |         sum  error  = [    1.7149]
25-01-17 16:29:59 | I |         best error  = [    1.7149]
25-01-17 16:29:59 | I |     + error = [1.7149]
25-01-17 16:29:59 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:30:00 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:30:02 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:30:03 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:30:04 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:30:06 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:30:07 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:30:10 | I | quantizing activations for layer model.layers.4
25-01-17 16:30:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:30:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:30:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:30:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:30:12 | I | forward this layer
25-01-17 16:30:12 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/08.pt
25-01-17 16:30:12 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/08.pt
25-01-17 16:30:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:30:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:30:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:30:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:30:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:30:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: True
25-01-17 16:30:13 | I | inf: first position tensor([  15, 1619], device='cuda:0')
25-01-17 16:30:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:30:13 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:30:13 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:30:13 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:30:13 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:30:13 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:30:13 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:30:13 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:30:13 | I | in layer model.layers.4
25-01-17 16:30:13 | I | quantizing weights for layer model.layers.4
25-01-17 16:30:13 | I | collecting calibration activations in model.layers.4
25-01-17 16:30:13 | I | collecting calibration activations in model.layers.4
25-01-17 16:30:13 | I | collecting calibration activations in model.layers.4
25-01-17 16:30:13 | I | collecting calibration activations in model.layers.4
25-01-17 16:30:14 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:30:14 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:30:14 | I |       - range scale = [    1.0000]
25-01-17 16:30:14 | I |         sum  error  = [    0.6452]
25-01-17 16:30:14 | I |         best error  = [    0.6452]
25-01-17 16:30:14 | I |     + error = [0.6452]
25-01-17 16:30:15 | I |       - range scale = [    1.0000]
25-01-17 16:30:15 | I |         sum  error  = [    5.3546]
25-01-17 16:30:15 | I |         best error  = [    5.3546]
25-01-17 16:30:15 | I |     + error = [5.3546]
25-01-17 16:30:15 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:30:16 | I |       - range scale = [    1.0000]
25-01-17 16:30:16 | I |         sum  error  = [    0.3531]
25-01-17 16:30:16 | I |         best error  = [    0.3531]
25-01-17 16:30:16 | I |     + error = [0.3531]
25-01-17 16:30:16 | I |       - range scale = [    1.0000]
25-01-17 16:30:16 | I |         sum  error  = [    2.5218]
25-01-17 16:30:16 | I |         best error  = [    2.5218]
25-01-17 16:30:16 | I |     + error = [2.5218]
25-01-17 16:30:17 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:30:17 | I |       - range scale = [    1.0000]
25-01-17 16:30:17 | I |         sum  error  = [    0.6281]
25-01-17 16:30:17 | I |         best error  = [    0.6281]
25-01-17 16:30:17 | I |     + error = [0.6281]
25-01-17 16:30:18 | I |       - range scale = [    1.0000]
25-01-17 16:30:18 | I |         sum  error  = [    6.9154]
25-01-17 16:30:18 | I |         best error  = [    6.9154]
25-01-17 16:30:18 | I |     + error = [6.9154]
25-01-17 16:30:18 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:30:19 | I |       - range scale = [    1.0000]
25-01-17 16:30:19 | I |         sum  error  = [    0.1217]
25-01-17 16:30:19 | I |         best error  = [    0.1217]
25-01-17 16:30:19 | I |     + error = [0.1217]
25-01-17 16:30:19 | I |       - range scale = [    1.0000]
25-01-17 16:30:19 | I |         sum  error  = [    1.3193]
25-01-17 16:30:19 | I |         best error  = [    1.3193]
25-01-17 16:30:19 | I |     + error = [1.3193]
25-01-17 16:30:20 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:30:20 | I |       - range scale = [    1.0000]
25-01-17 16:30:20 | I |         sum  error  = [    2.0624]
25-01-17 16:30:20 | I |         best error  = [    2.0624]
25-01-17 16:30:20 | I |     + error = [2.0624]
25-01-17 16:30:21 | I |       - range scale = [    1.0000]
25-01-17 16:30:21 | I |         sum  error  = [   23.1446]
25-01-17 16:30:21 | I |         best error  = [   23.1446]
25-01-17 16:30:21 | I |     + error = [23.1446]
25-01-17 16:30:21 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:30:22 | I |       - range scale = [    1.0000]
25-01-17 16:30:22 | I |         sum  error  = [    2.2600]
25-01-17 16:30:22 | I |         best error  = [    2.2600]
25-01-17 16:30:22 | I |     + error = [2.2600]
25-01-17 16:30:22 | I |       - range scale = [    1.0000]
25-01-17 16:30:22 | I |         sum  error  = [   25.2829]
25-01-17 16:30:22 | I |         best error  = [   25.2829]
25-01-17 16:30:22 | I |     + error = [25.2829]
25-01-17 16:30:23 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:30:23 | I |       - range scale = [    1.0000]
25-01-17 16:30:23 | I |         sum  error  = [    0.1737]
25-01-17 16:30:23 | I |         best error  = [    0.1737]
25-01-17 16:30:23 | I |     + error = [0.1737]
25-01-17 16:30:24 | I |       - range scale = [    1.0000]
25-01-17 16:30:24 | I |         sum  error  = [    1.7786]
25-01-17 16:30:24 | I |         best error  = [    1.7786]
25-01-17 16:30:24 | I |     + error = [1.7786]
25-01-17 16:30:24 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:30:26 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:30:27 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:30:28 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:30:30 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:30:31 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:30:32 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:30:35 | I | quantizing activations for layer model.layers.4
25-01-17 16:30:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:30:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:30:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:30:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:30:38 | I | forward this layer
25-01-17 16:30:38 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/09.pt
25-01-17 16:30:38 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/09.pt
25-01-17 16:30:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:30:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:30:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:30:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:30:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:30:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: True
25-01-17 16:30:38 | I | inf: first position tensor([  15, 1619], device='cuda:0')
25-01-17 16:30:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:30:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:30:38 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:30:38 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:30:38 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:30:38 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:30:38 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:30:38 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:30:38 | I | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 4.0
25-01-17 16:30:38 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:30:38 | I | in layer model.layers.4
25-01-17 16:30:38 | I | quantizing weights for layer model.layers.4
25-01-17 16:30:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:30:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:30:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:30:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:30:39 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:30:40 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:30:40 | I |       - range scale = [    1.0000]
25-01-17 16:30:40 | I |         sum  error  = [    0.5798]
25-01-17 16:30:40 | I |         best error  = [    0.5798]
25-01-17 16:30:40 | I |     + error = [0.5798]
25-01-17 16:30:41 | I |       - range scale = [    1.0000]
25-01-17 16:30:41 | I |         sum  error  = [    5.0753]
25-01-17 16:30:41 | I |         best error  = [    5.0753]
25-01-17 16:30:41 | I |     + error = [5.0753]
25-01-17 16:30:41 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:30:42 | I |       - range scale = [    1.0000]
25-01-17 16:30:42 | I |         sum  error  = [    0.3318]
25-01-17 16:30:42 | I |         best error  = [    0.3318]
25-01-17 16:30:42 | I |     + error = [0.3318]
25-01-17 16:30:42 | I |       - range scale = [    1.0000]
25-01-17 16:30:42 | I |         sum  error  = [    2.4720]
25-01-17 16:30:42 | I |         best error  = [    2.4720]
25-01-17 16:30:42 | I |     + error = [2.4720]
25-01-17 16:30:43 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:30:43 | I |       - range scale = [    1.0000]
25-01-17 16:30:43 | I |         sum  error  = [    0.6260]
25-01-17 16:30:43 | I |         best error  = [    0.6260]
25-01-17 16:30:43 | I |     + error = [0.6260]
25-01-17 16:30:44 | I |       - range scale = [    1.0000]
25-01-17 16:30:44 | I |         sum  error  = [    6.9196]
25-01-17 16:30:44 | I |         best error  = [    6.9196]
25-01-17 16:30:44 | I |     + error = [6.9196]
25-01-17 16:30:44 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:30:45 | I |       - range scale = [    1.0000]
25-01-17 16:30:45 | I |         sum  error  = [    0.1115]
25-01-17 16:30:45 | I |         best error  = [    0.1115]
25-01-17 16:30:45 | I |     + error = [0.1115]
25-01-17 16:30:45 | I |       - range scale = [    1.0000]
25-01-17 16:30:45 | I |         sum  error  = [    1.2155]
25-01-17 16:30:45 | I |         best error  = [    1.2155]
25-01-17 16:30:45 | I |     + error = [1.2155]
25-01-17 16:30:45 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:30:46 | I |       - range scale = [    1.0000]
25-01-17 16:30:46 | I |         sum  error  = [    2.0115]
25-01-17 16:30:46 | I |         best error  = [    2.0115]
25-01-17 16:30:46 | I |     + error = [2.0115]
25-01-17 16:30:47 | I |       - range scale = [    1.0000]
25-01-17 16:30:47 | I |         sum  error  = [   22.6325]
25-01-17 16:30:47 | I |         best error  = [   22.6325]
25-01-17 16:30:47 | I |     + error = [22.6325]
25-01-17 16:30:47 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:30:47 | I |       - range scale = [    1.0000]
25-01-17 16:30:47 | I |         sum  error  = [    2.2030]
25-01-17 16:30:47 | I |         best error  = [    2.2030]
25-01-17 16:30:47 | I |     + error = [2.2030]
25-01-17 16:30:48 | I |       - range scale = [    1.0000]
25-01-17 16:30:48 | I |         sum  error  = [   24.7220]
25-01-17 16:30:48 | I |         best error  = [   24.7220]
25-01-17 16:30:48 | I |     + error = [24.7220]
25-01-17 16:30:48 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:30:49 | I |       - range scale = [    1.0000]
25-01-17 16:30:49 | I |         sum  error  = [    0.1719]
25-01-17 16:30:49 | I |         best error  = [    0.1719]
25-01-17 16:30:49 | I |     + error = [0.1719]
25-01-17 16:30:50 | I |       - range scale = [    1.0000]
25-01-17 16:30:50 | I |         sum  error  = [    1.7587]
25-01-17 16:30:50 | I |         best error  = [    1.7587]
25-01-17 16:30:50 | I |     + error = [1.7587]
25-01-17 16:30:50 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:30:51 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:30:53 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:30:54 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:30:55 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:30:56 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:30:58 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:31:01 | I | quantizing activations for layer model.layers.4
25-01-17 16:31:01 | I | collecting calibration activations in model.layers.4
25-01-17 16:31:01 | I | collecting calibration activations in model.layers.4
25-01-17 16:31:01 | I | collecting calibration activations in model.layers.4
25-01-17 16:31:02 | I | collecting calibration activations in model.layers.4
25-01-17 16:31:03 | I | forward this layer
25-01-17 16:31:03 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/10.pt
25-01-17 16:31:03 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/10.pt
25-01-17 16:31:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:31:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:31:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:31:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:31:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:31:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: True
25-01-17 16:31:04 | I | inf: first position tensor([  15, 1619], device='cuda:0')
25-01-17 16:31:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:31:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:31:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:31:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:31:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:31:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:31:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:31:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:31:04 | I | in layer model.layers.4
25-01-17 16:31:04 | I | quantizing weights for layer model.layers.4
25-01-17 16:31:04 | I | collecting calibration activations in model.layers.4
25-01-17 16:31:04 | I | collecting calibration activations in model.layers.4
25-01-17 16:31:04 | I | collecting calibration activations in model.layers.4
25-01-17 16:31:04 | I | collecting calibration activations in model.layers.4
25-01-17 16:31:05 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:31:05 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:31:05 | I |       - range scale = [    1.0000]
25-01-17 16:31:05 | I |         sum  error  = [    0.5669]
25-01-17 16:31:05 | I |         best error  = [    0.5669]
25-01-17 16:31:05 | I |     + error = [0.5669]
25-01-17 16:31:06 | I |       - range scale = [    1.0000]
25-01-17 16:31:06 | I |         sum  error  = [    4.7449]
25-01-17 16:31:06 | I |         best error  = [    4.7449]
25-01-17 16:31:06 | I |     + error = [4.7449]
25-01-17 16:31:06 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:31:07 | I |       - range scale = [    1.0000]
25-01-17 16:31:07 | I |         sum  error  = [    0.3232]
25-01-17 16:31:07 | I |         best error  = [    0.3232]
25-01-17 16:31:07 | I |     + error = [0.3232]
25-01-17 16:31:08 | I |       - range scale = [    1.0000]
25-01-17 16:31:08 | I |         sum  error  = [    2.5017]
25-01-17 16:31:08 | I |         best error  = [    2.5017]
25-01-17 16:31:08 | I |     + error = [2.5017]
25-01-17 16:31:08 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:31:09 | I |       - range scale = [    1.0000]
25-01-17 16:31:09 | I |         sum  error  = [    0.6223]
25-01-17 16:31:09 | I |         best error  = [    0.6223]
25-01-17 16:31:09 | I |     + error = [0.6223]
25-01-17 16:31:09 | I |       - range scale = [    1.0000]
25-01-17 16:31:09 | I |         sum  error  = [    6.8530]
25-01-17 16:31:09 | I |         best error  = [    6.8530]
25-01-17 16:31:09 | I |     + error = [6.8530]
25-01-17 16:31:10 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:31:10 | I |       - range scale = [    1.0000]
25-01-17 16:31:10 | I |         sum  error  = [    0.1117]
25-01-17 16:31:10 | I |         best error  = [    0.1117]
25-01-17 16:31:10 | I |     + error = [0.1117]
25-01-17 16:31:11 | I |       - range scale = [    1.0000]
25-01-17 16:31:11 | I |         sum  error  = [    1.2036]
25-01-17 16:31:11 | I |         best error  = [    1.2036]
25-01-17 16:31:11 | I |     + error = [1.2036]
25-01-17 16:31:11 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:31:12 | I |       - range scale = [    1.0000]
25-01-17 16:31:12 | I |         sum  error  = [    1.9905]
25-01-17 16:31:12 | I |         best error  = [    1.9905]
25-01-17 16:31:12 | I |     + error = [1.9905]
25-01-17 16:31:13 | I |       - range scale = [    1.0000]
25-01-17 16:31:13 | I |         sum  error  = [   22.3550]
25-01-17 16:31:13 | I |         best error  = [   22.3550]
25-01-17 16:31:13 | I |     + error = [22.3550]
25-01-17 16:31:13 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:31:13 | I |       - range scale = [    1.0000]
25-01-17 16:31:13 | I |         sum  error  = [    2.1732]
25-01-17 16:31:13 | I |         best error  = [    2.1732]
25-01-17 16:31:13 | I |     + error = [2.1732]
25-01-17 16:31:14 | I |       - range scale = [    1.0000]
25-01-17 16:31:14 | I |         sum  error  = [   24.4360]
25-01-17 16:31:14 | I |         best error  = [   24.4360]
25-01-17 16:31:14 | I |     + error = [24.4360]
25-01-17 16:31:14 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:31:15 | I |       - range scale = [    1.0000]
25-01-17 16:31:15 | I |         sum  error  = [    0.1874]
25-01-17 16:31:15 | I |         best error  = [    0.1874]
25-01-17 16:31:15 | I |     + error = [0.1874]
25-01-17 16:31:16 | I |       - range scale = [    1.0000]
25-01-17 16:31:16 | I |         sum  error  = [    1.9251]
25-01-17 16:31:16 | I |         best error  = [    1.9251]
25-01-17 16:31:16 | I |     + error = [1.9251]
25-01-17 16:31:16 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:31:18 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:31:19 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:31:21 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:31:23 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:31:24 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:31:26 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:31:30 | I | quantizing activations for layer model.layers.4
25-01-17 16:31:30 | I | collecting calibration activations in model.layers.4
25-01-17 16:31:30 | I | collecting calibration activations in model.layers.4
25-01-17 16:31:31 | I | collecting calibration activations in model.layers.4
25-01-17 16:31:31 | I | collecting calibration activations in model.layers.4
25-01-17 16:31:32 | I | forward this layer
25-01-17 16:31:32 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/11.pt
25-01-17 16:31:32 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/11.pt
25-01-17 16:31:33 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:31:33 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:31:33 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:31:33 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:31:33 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:31:33 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: True
25-01-17 16:31:33 | I | inf: first position tensor([  15, 1619], device='cuda:0')
25-01-17 16:31:33 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:31:33 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:31:33 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:31:33 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:31:33 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:31:33 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:31:33 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:31:33 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:31:33 | I | NOTE: gradient overflow detected, ignoring gradient, setting loss scale to: 2.0
25-01-17 16:31:33 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:31:33 | I | in layer model.layers.4
25-01-17 16:31:33 | I | quantizing weights for layer model.layers.4
25-01-17 16:31:33 | I | collecting calibration activations in model.layers.4
25-01-17 16:31:33 | I | collecting calibration activations in model.layers.4
25-01-17 16:31:34 | I | collecting calibration activations in model.layers.4
25-01-17 16:31:34 | I | collecting calibration activations in model.layers.4
25-01-17 16:31:34 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:31:34 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:31:35 | I |       - range scale = [    1.0000]
25-01-17 16:31:35 | I |         sum  error  = [    0.5919]
25-01-17 16:31:35 | I |         best error  = [    0.5919]
25-01-17 16:31:35 | I |     + error = [0.5919]
25-01-17 16:31:35 | I |       - range scale = [    1.0000]
25-01-17 16:31:35 | I |         sum  error  = [    4.8779]
25-01-17 16:31:35 | I |         best error  = [    4.8779]
25-01-17 16:31:35 | I |     + error = [4.8779]
25-01-17 16:31:35 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:31:36 | I |       - range scale = [    1.0000]
25-01-17 16:31:36 | I |         sum  error  = [    0.3381]
25-01-17 16:31:36 | I |         best error  = [    0.3381]
25-01-17 16:31:36 | I |     + error = [0.3381]
25-01-17 16:31:37 | I |       - range scale = [    1.0000]
25-01-17 16:31:37 | I |         sum  error  = [    2.6482]
25-01-17 16:31:37 | I |         best error  = [    2.6482]
25-01-17 16:31:37 | I |     + error = [2.6482]
25-01-17 16:31:37 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:31:38 | I |       - range scale = [    1.0000]
25-01-17 16:31:38 | I |         sum  error  = [    0.6238]
25-01-17 16:31:38 | I |         best error  = [    0.6238]
25-01-17 16:31:38 | I |     + error = [0.6238]
25-01-17 16:31:38 | I |       - range scale = [    1.0000]
25-01-17 16:31:38 | I |         sum  error  = [    6.8391]
25-01-17 16:31:38 | I |         best error  = [    6.8391]
25-01-17 16:31:38 | I |     + error = [6.8391]
25-01-17 16:31:38 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:31:39 | I |       - range scale = [    1.0000]
25-01-17 16:31:39 | I |         sum  error  = [    0.1139]
25-01-17 16:31:39 | I |         best error  = [    0.1139]
25-01-17 16:31:39 | I |     + error = [0.1139]
25-01-17 16:31:40 | I |       - range scale = [    1.0000]
25-01-17 16:31:40 | I |         sum  error  = [    1.2369]
25-01-17 16:31:40 | I |         best error  = [    1.2369]
25-01-17 16:31:40 | I |     + error = [1.2369]
25-01-17 16:31:40 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:31:40 | I |       - range scale = [    1.0000]
25-01-17 16:31:40 | I |         sum  error  = [    2.0015]
25-01-17 16:31:40 | I |         best error  = [    2.0015]
25-01-17 16:31:40 | I |     + error = [2.0015]
25-01-17 16:31:41 | I |       - range scale = [    1.0000]
25-01-17 16:31:41 | I |         sum  error  = [   22.4811]
25-01-17 16:31:41 | I |         best error  = [   22.4811]
25-01-17 16:31:41 | I |     + error = [22.4811]
25-01-17 16:31:41 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:31:42 | I |       - range scale = [    1.0000]
25-01-17 16:31:42 | I |         sum  error  = [    2.1928]
25-01-17 16:31:42 | I |         best error  = [    2.1928]
25-01-17 16:31:42 | I |     + error = [2.1928]
25-01-17 16:31:43 | I |       - range scale = [    1.0000]
25-01-17 16:31:43 | I |         sum  error  = [   24.6009]
25-01-17 16:31:43 | I |         best error  = [   24.6009]
25-01-17 16:31:43 | I |     + error = [24.6009]
25-01-17 16:31:43 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:31:44 | I |       - range scale = [    1.0000]
25-01-17 16:31:44 | I |         sum  error  = [    0.1981]
25-01-17 16:31:44 | I |         best error  = [    0.1981]
25-01-17 16:31:44 | I |     + error = [0.1981]
25-01-17 16:31:44 | I |       - range scale = [    1.0000]
25-01-17 16:31:44 | I |         sum  error  = [    2.0315]
25-01-17 16:31:44 | I |         best error  = [    2.0315]
25-01-17 16:31:44 | I |     + error = [2.0315]
25-01-17 16:31:45 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:31:46 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:31:48 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:31:49 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:31:51 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:31:53 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:31:54 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:31:58 | I | quantizing activations for layer model.layers.4
25-01-17 16:31:58 | I | collecting calibration activations in model.layers.4
25-01-17 16:31:58 | I | collecting calibration activations in model.layers.4
25-01-17 16:31:58 | I | collecting calibration activations in model.layers.4
25-01-17 16:31:58 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:00 | I | forward this layer
25-01-17 16:32:00 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/12.pt
25-01-17 16:32:00 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/12.pt
25-01-17 16:32:00 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:32:00 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:32:00 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:32:00 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:32:00 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:32:00 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:32:00 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:32:00 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:32:00 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:32:00 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:32:00 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:32:00 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:32:00 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:32:00 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:32:00 | I | in layer model.layers.4
25-01-17 16:32:00 | I | quantizing weights for layer model.layers.4
25-01-17 16:32:01 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:01 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:01 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:01 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:01 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:32:01 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:32:02 | I |       - range scale = [    1.0000]
25-01-17 16:32:02 | I |         sum  error  = [    0.5893]
25-01-17 16:32:02 | I |         best error  = [    0.5893]
25-01-17 16:32:02 | I |     + error = [0.5893]
25-01-17 16:32:03 | I |       - range scale = [    1.0000]
25-01-17 16:32:03 | I |         sum  error  = [    4.9427]
25-01-17 16:32:03 | I |         best error  = [    4.9427]
25-01-17 16:32:03 | I |     + error = [4.9427]
25-01-17 16:32:03 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:32:03 | I |       - range scale = [    1.0000]
25-01-17 16:32:03 | I |         sum  error  = [    0.3431]
25-01-17 16:32:03 | I |         best error  = [    0.3431]
25-01-17 16:32:03 | I |     + error = [0.3431]
25-01-17 16:32:04 | I |       - range scale = [    1.0000]
25-01-17 16:32:04 | I |         sum  error  = [    2.6589]
25-01-17 16:32:04 | I |         best error  = [    2.6589]
25-01-17 16:32:04 | I |     + error = [2.6589]
25-01-17 16:32:04 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:32:05 | I |       - range scale = [    1.0000]
25-01-17 16:32:05 | I |         sum  error  = [    0.6216]
25-01-17 16:32:05 | I |         best error  = [    0.6216]
25-01-17 16:32:05 | I |     + error = [0.6216]
25-01-17 16:32:06 | I |       - range scale = [    1.0000]
25-01-17 16:32:06 | I |         sum  error  = [    6.8390]
25-01-17 16:32:06 | I |         best error  = [    6.8390]
25-01-17 16:32:06 | I |     + error = [6.8390]
25-01-17 16:32:06 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:32:06 | I |       - range scale = [    1.0000]
25-01-17 16:32:06 | I |         sum  error  = [    0.1158]
25-01-17 16:32:06 | I |         best error  = [    0.1158]
25-01-17 16:32:06 | I |     + error = [0.1158]
25-01-17 16:32:07 | I |       - range scale = [    1.0000]
25-01-17 16:32:07 | I |         sum  error  = [    1.2563]
25-01-17 16:32:07 | I |         best error  = [    1.2563]
25-01-17 16:32:07 | I |     + error = [1.2563]
25-01-17 16:32:07 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:32:08 | I |       - range scale = [    1.0000]
25-01-17 16:32:08 | I |         sum  error  = [    1.9910]
25-01-17 16:32:08 | I |         best error  = [    1.9910]
25-01-17 16:32:08 | I |     + error = [1.9910]
25-01-17 16:32:09 | I |       - range scale = [    1.0000]
25-01-17 16:32:09 | I |         sum  error  = [   22.3535]
25-01-17 16:32:09 | I |         best error  = [   22.3535]
25-01-17 16:32:09 | I |     + error = [22.3535]
25-01-17 16:32:09 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:32:09 | I |       - range scale = [    1.0000]
25-01-17 16:32:09 | I |         sum  error  = [    2.1757]
25-01-17 16:32:09 | I |         best error  = [    2.1757]
25-01-17 16:32:09 | I |     + error = [2.1757]
25-01-17 16:32:10 | I |       - range scale = [    1.0000]
25-01-17 16:32:10 | I |         sum  error  = [   24.4491]
25-01-17 16:32:10 | I |         best error  = [   24.4491]
25-01-17 16:32:10 | I |     + error = [24.4491]
25-01-17 16:32:10 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:32:11 | I |       - range scale = [    1.0000]
25-01-17 16:32:11 | I |         sum  error  = [    0.1969]
25-01-17 16:32:11 | I |         best error  = [    0.1969]
25-01-17 16:32:11 | I |     + error = [0.1969]
25-01-17 16:32:12 | I |       - range scale = [    1.0000]
25-01-17 16:32:12 | I |         sum  error  = [    2.0239]
25-01-17 16:32:12 | I |         best error  = [    2.0239]
25-01-17 16:32:12 | I |     + error = [2.0239]
25-01-17 16:32:12 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:32:13 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:32:15 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:32:16 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:32:17 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:32:19 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:32:20 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:32:23 | I | quantizing activations for layer model.layers.4
25-01-17 16:32:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:26 | I | forward this layer
25-01-17 16:32:26 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/13.pt
25-01-17 16:32:26 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/13.pt
25-01-17 16:32:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:32:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:32:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:32:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:32:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:32:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:32:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:32:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:32:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:32:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:32:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:32:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:32:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:32:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:32:26 | I | [0] done with optimizer step
25-01-17 16:32:26 | I | epoch 001:      7 / 409600000 loss=1.47393e-05, loss_per_token=0.0301862, loss_sum=989.141, wps=0, ups=0, wpb=32768, bsz=64, num_updates=1, lr=3e-06, gnorm=0.885, clip=0, loss_scale=2, train_wall=366, cuda_gb_allocated=11.9, cuda_gb_reserved=13.3, cuda_gb_free=11.8, wall=762
25-01-17 16:32:26 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:32:26 | I | in layer model.layers.4
25-01-17 16:32:26 | I | quantizing weights for layer model.layers.4
25-01-17 16:32:26 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:27 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:32:27 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:32:28 | I |       - range scale = [    1.0000]
25-01-17 16:32:28 | I |         sum  error  = [    0.5766]
25-01-17 16:32:28 | I |         best error  = [    0.5766]
25-01-17 16:32:28 | I |     + error = [0.5766]
25-01-17 16:32:28 | I |       - range scale = [    1.0000]
25-01-17 16:32:28 | I |         sum  error  = [    4.8741]
25-01-17 16:32:28 | I |         best error  = [    4.8741]
25-01-17 16:32:28 | I |     + error = [4.8741]
25-01-17 16:32:29 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:32:29 | I |       - range scale = [    1.0000]
25-01-17 16:32:29 | I |         sum  error  = [    0.3294]
25-01-17 16:32:29 | I |         best error  = [    0.3294]
25-01-17 16:32:29 | I |     + error = [0.3294]
25-01-17 16:32:30 | I |       - range scale = [    1.0000]
25-01-17 16:32:30 | I |         sum  error  = [    2.5856]
25-01-17 16:32:30 | I |         best error  = [    2.5856]
25-01-17 16:32:30 | I |     + error = [2.5856]
25-01-17 16:32:30 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:32:31 | I |       - range scale = [    1.0000]
25-01-17 16:32:31 | I |         sum  error  = [    0.6257]
25-01-17 16:32:31 | I |         best error  = [    0.6257]
25-01-17 16:32:31 | I |     + error = [0.6257]
25-01-17 16:32:32 | I |       - range scale = [    1.0000]
25-01-17 16:32:32 | I |         sum  error  = [    6.8718]
25-01-17 16:32:32 | I |         best error  = [    6.8718]
25-01-17 16:32:32 | I |     + error = [6.8718]
25-01-17 16:32:32 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:32:32 | I |       - range scale = [    1.0000]
25-01-17 16:32:32 | I |         sum  error  = [    0.1116]
25-01-17 16:32:32 | I |         best error  = [    0.1116]
25-01-17 16:32:32 | I |     + error = [0.1116]
25-01-17 16:32:33 | I |       - range scale = [    1.0000]
25-01-17 16:32:33 | I |         sum  error  = [    1.2044]
25-01-17 16:32:33 | I |         best error  = [    1.2044]
25-01-17 16:32:33 | I |     + error = [1.2044]
25-01-17 16:32:33 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:32:34 | I |       - range scale = [    1.0000]
25-01-17 16:32:34 | I |         sum  error  = [    1.9800]
25-01-17 16:32:34 | I |         best error  = [    1.9800]
25-01-17 16:32:34 | I |     + error = [1.9800]
25-01-17 16:32:35 | I |       - range scale = [    1.0000]
25-01-17 16:32:35 | I |         sum  error  = [   22.2571]
25-01-17 16:32:35 | I |         best error  = [   22.2571]
25-01-17 16:32:35 | I |     + error = [22.2571]
25-01-17 16:32:35 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:32:36 | I |       - range scale = [    1.0000]
25-01-17 16:32:36 | I |         sum  error  = [    2.1647]
25-01-17 16:32:36 | I |         best error  = [    2.1647]
25-01-17 16:32:36 | I |     + error = [2.1647]
25-01-17 16:32:36 | I |       - range scale = [    1.0000]
25-01-17 16:32:36 | I |         sum  error  = [   24.3430]
25-01-17 16:32:36 | I |         best error  = [   24.3430]
25-01-17 16:32:36 | I |     + error = [24.3430]
25-01-17 16:32:36 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:32:37 | I |       - range scale = [    1.0000]
25-01-17 16:32:37 | I |         sum  error  = [    0.1926]
25-01-17 16:32:37 | I |         best error  = [    0.1926]
25-01-17 16:32:37 | I |     + error = [0.1926]
25-01-17 16:32:38 | I |       - range scale = [    1.0000]
25-01-17 16:32:38 | I |         sum  error  = [    1.9774]
25-01-17 16:32:38 | I |         best error  = [    1.9774]
25-01-17 16:32:38 | I |     + error = [1.9774]
25-01-17 16:32:38 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:32:40 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:32:42 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:32:43 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:32:45 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:32:47 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:32:48 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:32:51 | I | quantizing activations for layer model.layers.4
25-01-17 16:32:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:54 | I | forward this layer
25-01-17 16:32:54 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/14.pt
25-01-17 16:32:54 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/14.pt
25-01-17 16:32:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:32:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:32:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:32:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:32:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:32:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:32:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:32:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:32:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:32:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:32:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:32:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:32:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:32:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:32:54 | I | in layer model.layers.4
25-01-17 16:32:54 | I | quantizing weights for layer model.layers.4
25-01-17 16:32:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:32:55 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:32:55 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:32:56 | I |       - range scale = [    1.0000]
25-01-17 16:32:56 | I |         sum  error  = [    0.5901]
25-01-17 16:32:56 | I |         best error  = [    0.5901]
25-01-17 16:32:56 | I |     + error = [0.5901]
25-01-17 16:32:57 | I |       - range scale = [    1.0000]
25-01-17 16:32:57 | I |         sum  error  = [    4.8952]
25-01-17 16:32:57 | I |         best error  = [    4.8952]
25-01-17 16:32:57 | I |     + error = [4.8952]
25-01-17 16:32:57 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:32:58 | I |       - range scale = [    1.0000]
25-01-17 16:32:58 | I |         sum  error  = [    0.3585]
25-01-17 16:32:58 | I |         best error  = [    0.3585]
25-01-17 16:32:58 | I |     + error = [0.3585]
25-01-17 16:32:58 | I |       - range scale = [    1.0000]
25-01-17 16:32:58 | I |         sum  error  = [    2.6666]
25-01-17 16:32:58 | I |         best error  = [    2.6666]
25-01-17 16:32:58 | I |     + error = [2.6666]
25-01-17 16:32:59 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:32:59 | I |       - range scale = [    1.0000]
25-01-17 16:32:59 | I |         sum  error  = [    0.6263]
25-01-17 16:32:59 | I |         best error  = [    0.6263]
25-01-17 16:32:59 | I |     + error = [0.6263]
25-01-17 16:33:00 | I |       - range scale = [    1.0000]
25-01-17 16:33:00 | I |         sum  error  = [    6.8851]
25-01-17 16:33:00 | I |         best error  = [    6.8851]
25-01-17 16:33:00 | I |     + error = [6.8851]
25-01-17 16:33:00 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:33:01 | I |       - range scale = [    1.0000]
25-01-17 16:33:01 | I |         sum  error  = [    0.1067]
25-01-17 16:33:01 | I |         best error  = [    0.1067]
25-01-17 16:33:01 | I |     + error = [0.1067]
25-01-17 16:33:01 | I |       - range scale = [    1.0000]
25-01-17 16:33:01 | I |         sum  error  = [    1.1560]
25-01-17 16:33:01 | I |         best error  = [    1.1560]
25-01-17 16:33:01 | I |     + error = [1.1560]
25-01-17 16:33:02 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:33:02 | I |       - range scale = [    1.0000]
25-01-17 16:33:02 | I |         sum  error  = [    2.0043]
25-01-17 16:33:02 | I |         best error  = [    2.0043]
25-01-17 16:33:02 | I |     + error = [2.0043]
25-01-17 16:33:03 | I |       - range scale = [    1.0000]
25-01-17 16:33:03 | I |         sum  error  = [   22.5494]
25-01-17 16:33:03 | I |         best error  = [   22.5494]
25-01-17 16:33:03 | I |     + error = [22.5494]
25-01-17 16:33:03 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:33:04 | I |       - range scale = [    1.0000]
25-01-17 16:33:04 | I |         sum  error  = [    2.1939]
25-01-17 16:33:04 | I |         best error  = [    2.1939]
25-01-17 16:33:04 | I |     + error = [2.1939]
25-01-17 16:33:05 | I |       - range scale = [    1.0000]
25-01-17 16:33:05 | I |         sum  error  = [   24.6510]
25-01-17 16:33:05 | I |         best error  = [   24.6510]
25-01-17 16:33:05 | I |     + error = [24.6510]
25-01-17 16:33:05 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:33:06 | I |       - range scale = [    1.0000]
25-01-17 16:33:06 | I |         sum  error  = [    0.1865]
25-01-17 16:33:06 | I |         best error  = [    0.1865]
25-01-17 16:33:06 | I |     + error = [0.1865]
25-01-17 16:33:07 | I |       - range scale = [    1.0000]
25-01-17 16:33:07 | I |         sum  error  = [    1.9133]
25-01-17 16:33:07 | I |         best error  = [    1.9133]
25-01-17 16:33:07 | I |     + error = [1.9133]
25-01-17 16:33:07 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:33:08 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:33:10 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:33:11 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:33:12 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:33:14 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:33:16 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:33:20 | I | quantizing activations for layer model.layers.4
25-01-17 16:33:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:33:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:33:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:33:21 | I | collecting calibration activations in model.layers.4
25-01-17 16:33:23 | I | forward this layer
25-01-17 16:33:23 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/15.pt
25-01-17 16:33:23 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/15.pt
25-01-17 16:33:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:33:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:33:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:33:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:33:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:33:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:33:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:33:23 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:33:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:33:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:33:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:33:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:33:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:33:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:33:23 | I | [1] done with optimizer step
25-01-17 16:33:23 | I | epoch 001:      8 / 409600000 loss=1.53398e-05, loss_per_token=0.0314159, loss_sum=1029.44, wps=574.9, ups=0.02, wpb=32768, bsz=64, num_updates=2, lr=6e-06, gnorm=1.39, clip=0, loss_scale=2, train_wall=57, cuda_gb_allocated=12.3, cuda_gb_reserved=13.6, cuda_gb_free=11.4, wall=819
25-01-17 16:33:23 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:33:23 | I | in layer model.layers.4
25-01-17 16:33:23 | I | quantizing weights for layer model.layers.4
25-01-17 16:33:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:33:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:33:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:33:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:33:24 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:33:24 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:33:25 | I |       - range scale = [    1.0000]
25-01-17 16:33:25 | I |         sum  error  = [    0.5613]
25-01-17 16:33:25 | I |         best error  = [    0.5613]
25-01-17 16:33:25 | I |     + error = [0.5613]
25-01-17 16:33:26 | I |       - range scale = [    1.0000]
25-01-17 16:33:26 | I |         sum  error  = [    4.8131]
25-01-17 16:33:26 | I |         best error  = [    4.8131]
25-01-17 16:33:26 | I |     + error = [4.8131]
25-01-17 16:33:26 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:33:27 | I |       - range scale = [    1.0000]
25-01-17 16:33:27 | I |         sum  error  = [    0.3325]
25-01-17 16:33:27 | I |         best error  = [    0.3325]
25-01-17 16:33:27 | I |     + error = [0.3325]
25-01-17 16:33:27 | I |       - range scale = [    1.0000]
25-01-17 16:33:27 | I |         sum  error  = [    2.4927]
25-01-17 16:33:27 | I |         best error  = [    2.4927]
25-01-17 16:33:27 | I |     + error = [2.4927]
25-01-17 16:33:28 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:33:28 | I |       - range scale = [    1.0000]
25-01-17 16:33:28 | I |         sum  error  = [    0.6257]
25-01-17 16:33:28 | I |         best error  = [    0.6257]
25-01-17 16:33:28 | I |     + error = [0.6257]
25-01-17 16:33:29 | I |       - range scale = [    1.0000]
25-01-17 16:33:29 | I |         sum  error  = [    6.8144]
25-01-17 16:33:29 | I |         best error  = [    6.8144]
25-01-17 16:33:29 | I |     + error = [6.8144]
25-01-17 16:33:29 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:33:30 | I |       - range scale = [    1.0000]
25-01-17 16:33:30 | I |         sum  error  = [    0.1112]
25-01-17 16:33:30 | I |         best error  = [    0.1112]
25-01-17 16:33:30 | I |     + error = [0.1112]
25-01-17 16:33:30 | I |       - range scale = [    1.0000]
25-01-17 16:33:30 | I |         sum  error  = [    1.2117]
25-01-17 16:33:30 | I |         best error  = [    1.2117]
25-01-17 16:33:30 | I |     + error = [1.2117]
25-01-17 16:33:31 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:33:32 | I |       - range scale = [    1.0000]
25-01-17 16:33:32 | I |         sum  error  = [    1.9850]
25-01-17 16:33:32 | I |         best error  = [    1.9850]
25-01-17 16:33:32 | I |     + error = [1.9850]
25-01-17 16:33:32 | I |       - range scale = [    1.0000]
25-01-17 16:33:32 | I |         sum  error  = [   22.2836]
25-01-17 16:33:32 | I |         best error  = [   22.2836]
25-01-17 16:33:32 | I |     + error = [22.2836]
25-01-17 16:33:33 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:33:33 | I |       - range scale = [    1.0000]
25-01-17 16:33:33 | I |         sum  error  = [    2.1723]
25-01-17 16:33:33 | I |         best error  = [    2.1723]
25-01-17 16:33:33 | I |     + error = [2.1723]
25-01-17 16:33:34 | I |       - range scale = [    1.0000]
25-01-17 16:33:34 | I |         sum  error  = [   24.3753]
25-01-17 16:33:34 | I |         best error  = [   24.3753]
25-01-17 16:33:34 | I |     + error = [24.3753]
25-01-17 16:33:34 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:33:35 | I |       - range scale = [    1.0000]
25-01-17 16:33:35 | I |         sum  error  = [    0.1949]
25-01-17 16:33:35 | I |         best error  = [    0.1949]
25-01-17 16:33:35 | I |     + error = [0.1949]
25-01-17 16:33:36 | I |       - range scale = [    1.0000]
25-01-17 16:33:36 | I |         sum  error  = [    1.9975]
25-01-17 16:33:36 | I |         best error  = [    1.9975]
25-01-17 16:33:36 | I |     + error = [1.9975]
25-01-17 16:33:36 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:33:37 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:33:39 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:33:40 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:33:42 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:33:43 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:33:45 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:33:48 | I | quantizing activations for layer model.layers.4
25-01-17 16:33:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:33:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:33:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:33:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:33:51 | I | forward this layer
25-01-17 16:33:51 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/16.pt
25-01-17 16:33:51 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/16.pt
25-01-17 16:33:51 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:33:51 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:33:51 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:33:51 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:33:51 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:33:51 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:33:51 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:33:51 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:33:51 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:33:51 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:33:51 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:33:51 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:33:51 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:33:51 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:33:51 | I | in layer model.layers.4
25-01-17 16:33:51 | I | quantizing weights for layer model.layers.4
25-01-17 16:33:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:33:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:33:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:33:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:33:52 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:33:52 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:33:53 | I |       - range scale = [    1.0000]
25-01-17 16:33:53 | I |         sum  error  = [    0.6059]
25-01-17 16:33:53 | I |         best error  = [    0.6059]
25-01-17 16:33:53 | I |     + error = [0.6059]
25-01-17 16:33:54 | I |       - range scale = [    1.0000]
25-01-17 16:33:54 | I |         sum  error  = [    5.0526]
25-01-17 16:33:54 | I |         best error  = [    5.0526]
25-01-17 16:33:54 | I |     + error = [5.0526]
25-01-17 16:33:54 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:33:55 | I |       - range scale = [    1.0000]
25-01-17 16:33:55 | I |         sum  error  = [    0.3283]
25-01-17 16:33:55 | I |         best error  = [    0.3283]
25-01-17 16:33:55 | I |     + error = [0.3283]
25-01-17 16:33:56 | I |       - range scale = [    1.0000]
25-01-17 16:33:56 | I |         sum  error  = [    2.4691]
25-01-17 16:33:56 | I |         best error  = [    2.4691]
25-01-17 16:33:56 | I |     + error = [2.4691]
25-01-17 16:33:56 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:33:57 | I |       - range scale = [    1.0000]
25-01-17 16:33:57 | I |         sum  error  = [    0.6291]
25-01-17 16:33:57 | I |         best error  = [    0.6291]
25-01-17 16:33:57 | I |     + error = [0.6291]
25-01-17 16:33:57 | I |       - range scale = [    1.0000]
25-01-17 16:33:57 | I |         sum  error  = [    6.9147]
25-01-17 16:33:57 | I |         best error  = [    6.9147]
25-01-17 16:33:57 | I |     + error = [6.9147]
25-01-17 16:33:57 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:33:58 | I |       - range scale = [    1.0000]
25-01-17 16:33:58 | I |         sum  error  = [    0.1106]
25-01-17 16:33:58 | I |         best error  = [    0.1106]
25-01-17 16:33:58 | I |     + error = [0.1106]
25-01-17 16:33:59 | I |       - range scale = [    1.0000]
25-01-17 16:33:59 | I |         sum  error  = [    1.1944]
25-01-17 16:33:59 | I |         best error  = [    1.1944]
25-01-17 16:33:59 | I |     + error = [1.1944]
25-01-17 16:33:59 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:34:00 | I |       - range scale = [    1.0000]
25-01-17 16:34:00 | I |         sum  error  = [    2.0175]
25-01-17 16:34:00 | I |         best error  = [    2.0175]
25-01-17 16:34:00 | I |     + error = [2.0175]
25-01-17 16:34:01 | I |       - range scale = [    1.0000]
25-01-17 16:34:01 | I |         sum  error  = [   22.6661]
25-01-17 16:34:01 | I |         best error  = [   22.6661]
25-01-17 16:34:01 | I |     + error = [22.6661]
25-01-17 16:34:01 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:34:02 | I |       - range scale = [    1.0000]
25-01-17 16:34:02 | I |         sum  error  = [    2.2056]
25-01-17 16:34:02 | I |         best error  = [    2.2056]
25-01-17 16:34:02 | I |     + error = [2.2056]
25-01-17 16:34:02 | I |       - range scale = [    1.0000]
25-01-17 16:34:02 | I |         sum  error  = [   24.7850]
25-01-17 16:34:02 | I |         best error  = [   24.7850]
25-01-17 16:34:02 | I |     + error = [24.7850]
25-01-17 16:34:03 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:34:03 | I |       - range scale = [    1.0000]
25-01-17 16:34:03 | I |         sum  error  = [    0.1848]
25-01-17 16:34:03 | I |         best error  = [    0.1848]
25-01-17 16:34:03 | I |     + error = [0.1848]
25-01-17 16:34:04 | I |       - range scale = [    1.0000]
25-01-17 16:34:04 | I |         sum  error  = [    1.8984]
25-01-17 16:34:04 | I |         best error  = [    1.8984]
25-01-17 16:34:04 | I |     + error = [1.8984]
25-01-17 16:34:04 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:34:06 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:34:07 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:34:08 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:34:10 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:34:11 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:34:13 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:34:16 | I | quantizing activations for layer model.layers.4
25-01-17 16:34:17 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:17 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:17 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:17 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:19 | I | forward this layer
25-01-17 16:34:19 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/17.pt
25-01-17 16:34:19 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/17.pt
25-01-17 16:34:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:34:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:34:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:34:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:34:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:34:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:34:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:34:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:34:19 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:34:19 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:34:19 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:34:19 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:34:19 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:34:19 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:34:19 | I | [2] done with optimizer step
25-01-17 16:34:19 | I | epoch 001:      9 / 409600000 loss=1.64352e-05, loss_per_token=0.0336592, loss_sum=1102.95, wps=582.5, ups=0.02, wpb=32768, bsz=64, num_updates=3, lr=9e-06, gnorm=1.108, clip=0, loss_scale=2, train_wall=56, cuda_gb_allocated=12.3, cuda_gb_reserved=13.6, cuda_gb_free=11.4, wall=875
25-01-17 16:34:19 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:34:19 | I | in layer model.layers.4
25-01-17 16:34:19 | I | quantizing weights for layer model.layers.4
25-01-17 16:34:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:21 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:34:21 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:34:21 | I |       - range scale = [    1.0000]
25-01-17 16:34:21 | I |         sum  error  = [    0.7238]
25-01-17 16:34:21 | I |         best error  = [    0.7238]
25-01-17 16:34:21 | I |     + error = [0.7238]
25-01-17 16:34:22 | I |       - range scale = [    1.0000]
25-01-17 16:34:22 | I |         sum  error  = [    6.6536]
25-01-17 16:34:22 | I |         best error  = [    6.6536]
25-01-17 16:34:22 | I |     + error = [6.6536]
25-01-17 16:34:22 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:34:23 | I |       - range scale = [    1.0000]
25-01-17 16:34:23 | I |         sum  error  = [    0.5463]
25-01-17 16:34:23 | I |         best error  = [    0.5463]
25-01-17 16:34:23 | I |     + error = [0.5463]
25-01-17 16:34:24 | I |       - range scale = [    1.0000]
25-01-17 16:34:24 | I |         sum  error  = [    3.8570]
25-01-17 16:34:24 | I |         best error  = [    3.8570]
25-01-17 16:34:24 | I |     + error = [3.8570]
25-01-17 16:34:24 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:34:25 | I |       - range scale = [    1.0000]
25-01-17 16:34:25 | I |         sum  error  = [    0.6325]
25-01-17 16:34:25 | I |         best error  = [    0.6325]
25-01-17 16:34:25 | I |     + error = [0.6325]
25-01-17 16:34:26 | I |       - range scale = [    1.0000]
25-01-17 16:34:26 | I |         sum  error  = [    7.0715]
25-01-17 16:34:26 | I |         best error  = [    7.0715]
25-01-17 16:34:26 | I |     + error = [7.0715]
25-01-17 16:34:26 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:34:27 | I |       - range scale = [    1.0000]
25-01-17 16:34:27 | I |         sum  error  = [    0.1382]
25-01-17 16:34:27 | I |         best error  = [    0.1382]
25-01-17 16:34:27 | I |     + error = [0.1382]
25-01-17 16:34:27 | I |       - range scale = [    1.0000]
25-01-17 16:34:27 | I |         sum  error  = [    1.4934]
25-01-17 16:34:27 | I |         best error  = [    1.4934]
25-01-17 16:34:27 | I |     + error = [1.4934]
25-01-17 16:34:28 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:34:28 | I |       - range scale = [    1.0000]
25-01-17 16:34:28 | I |         sum  error  = [    2.0311]
25-01-17 16:34:28 | I |         best error  = [    2.0311]
25-01-17 16:34:28 | I |     + error = [2.0311]
25-01-17 16:34:29 | I |       - range scale = [    1.0000]
25-01-17 16:34:29 | I |         sum  error  = [   22.8371]
25-01-17 16:34:29 | I |         best error  = [   22.8371]
25-01-17 16:34:29 | I |     + error = [22.8371]
25-01-17 16:34:30 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:34:30 | I |       - range scale = [    1.0000]
25-01-17 16:34:30 | I |         sum  error  = [    2.2296]
25-01-17 16:34:30 | I |         best error  = [    2.2296]
25-01-17 16:34:30 | I |     + error = [2.2296]
25-01-17 16:34:31 | I |       - range scale = [    1.0000]
25-01-17 16:34:31 | I |         sum  error  = [   24.9442]
25-01-17 16:34:31 | I |         best error  = [   24.9442]
25-01-17 16:34:31 | I |     + error = [24.9442]
25-01-17 16:34:31 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:34:32 | I |       - range scale = [    1.0000]
25-01-17 16:34:32 | I |         sum  error  = [    0.1716]
25-01-17 16:34:32 | I |         best error  = [    0.1716]
25-01-17 16:34:32 | I |     + error = [0.1716]
25-01-17 16:34:33 | I |       - range scale = [    1.0000]
25-01-17 16:34:33 | I |         sum  error  = [    1.7594]
25-01-17 16:34:33 | I |         best error  = [    1.7594]
25-01-17 16:34:33 | I |     + error = [1.7594]
25-01-17 16:34:33 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:34:34 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:34:36 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:34:37 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:34:39 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:34:40 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:34:41 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:34:45 | I | quantizing activations for layer model.layers.4
25-01-17 16:34:45 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:45 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:45 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:45 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:47 | I | forward this layer
25-01-17 16:34:47 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/18.pt
25-01-17 16:34:47 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/18.pt
25-01-17 16:34:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:34:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:34:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:34:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:34:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:34:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:34:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:34:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:34:48 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:34:48 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:34:48 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:34:48 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:34:48 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:34:48 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:34:48 | I | in layer model.layers.4
25-01-17 16:34:48 | I | quantizing weights for layer model.layers.4
25-01-17 16:34:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:34:49 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:34:49 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:34:49 | I |       - range scale = [    1.0000]
25-01-17 16:34:49 | I |         sum  error  = [    0.6502]
25-01-17 16:34:50 | I |         best error  = [    0.6502]
25-01-17 16:34:50 | I |     + error = [0.6502]
25-01-17 16:34:51 | I |       - range scale = [    1.0000]
25-01-17 16:34:51 | I |         sum  error  = [    5.7149]
25-01-17 16:34:51 | I |         best error  = [    5.7149]
25-01-17 16:34:51 | I |     + error = [5.7149]
25-01-17 16:34:51 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:34:51 | I |       - range scale = [    1.0000]
25-01-17 16:34:51 | I |         sum  error  = [    0.3767]
25-01-17 16:34:51 | I |         best error  = [    0.3767]
25-01-17 16:34:51 | I |     + error = [0.3767]
25-01-17 16:34:52 | I |       - range scale = [    1.0000]
25-01-17 16:34:52 | I |         sum  error  = [    2.7619]
25-01-17 16:34:52 | I |         best error  = [    2.7619]
25-01-17 16:34:52 | I |     + error = [2.7619]
25-01-17 16:34:52 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:34:53 | I |       - range scale = [    1.0000]
25-01-17 16:34:53 | I |         sum  error  = [    0.6285]
25-01-17 16:34:53 | I |         best error  = [    0.6285]
25-01-17 16:34:53 | I |     + error = [0.6285]
25-01-17 16:34:54 | I |       - range scale = [    1.0000]
25-01-17 16:34:54 | I |         sum  error  = [    6.9281]
25-01-17 16:34:54 | I |         best error  = [    6.9281]
25-01-17 16:34:54 | I |     + error = [6.9281]
25-01-17 16:34:54 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:34:55 | I |       - range scale = [    1.0000]
25-01-17 16:34:55 | I |         sum  error  = [    0.1138]
25-01-17 16:34:55 | I |         best error  = [    0.1138]
25-01-17 16:34:55 | I |     + error = [0.1138]
25-01-17 16:34:56 | I |       - range scale = [    1.0000]
25-01-17 16:34:56 | I |         sum  error  = [    1.2406]
25-01-17 16:34:56 | I |         best error  = [    1.2406]
25-01-17 16:34:56 | I |     + error = [1.2406]
25-01-17 16:34:56 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:34:56 | I |       - range scale = [    1.0000]
25-01-17 16:34:56 | I |         sum  error  = [    1.9994]
25-01-17 16:34:56 | I |         best error  = [    1.9994]
25-01-17 16:34:56 | I |     + error = [1.9994]
25-01-17 16:34:57 | I |       - range scale = [    1.0000]
25-01-17 16:34:57 | I |         sum  error  = [   22.4835]
25-01-17 16:34:57 | I |         best error  = [   22.4835]
25-01-17 16:34:57 | I |     + error = [22.4835]
25-01-17 16:34:57 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:34:58 | I |       - range scale = [    1.0000]
25-01-17 16:34:58 | I |         sum  error  = [    2.1920]
25-01-17 16:34:58 | I |         best error  = [    2.1920]
25-01-17 16:34:58 | I |     + error = [2.1920]
25-01-17 16:34:59 | I |       - range scale = [    1.0000]
25-01-17 16:34:59 | I |         sum  error  = [   24.5569]
25-01-17 16:34:59 | I |         best error  = [   24.5569]
25-01-17 16:34:59 | I |     + error = [24.5569]
25-01-17 16:34:59 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:35:00 | I |       - range scale = [    1.0000]
25-01-17 16:35:00 | I |         sum  error  = [    0.1707]
25-01-17 16:35:00 | I |         best error  = [    0.1707]
25-01-17 16:35:00 | I |     + error = [0.1707]
25-01-17 16:35:01 | I |       - range scale = [    1.0000]
25-01-17 16:35:01 | I |         sum  error  = [    1.7446]
25-01-17 16:35:01 | I |         best error  = [    1.7446]
25-01-17 16:35:01 | I |     + error = [1.7446]
25-01-17 16:35:01 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:35:02 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:35:04 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:35:05 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:35:06 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:35:08 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:35:09 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:35:13 | I | quantizing activations for layer model.layers.4
25-01-17 16:35:13 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:13 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:13 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:13 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:15 | I | forward this layer
25-01-17 16:35:15 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/19.pt
25-01-17 16:35:15 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/19.pt
25-01-17 16:35:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:35:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:35:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:35:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:35:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:35:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:35:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:35:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:35:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:35:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:35:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:35:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:35:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:35:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:35:15 | I | [3] done with optimizer step
25-01-17 16:35:15 | I | epoch 001:     10 / 409600000 loss=1.97685e-05, loss_per_token=0.0404859, loss_sum=1326.64, wps=582.5, ups=0.02, wpb=32768, bsz=64, num_updates=4, lr=1.2e-05, gnorm=1.031, clip=0, loss_scale=2, train_wall=56, cuda_gb_allocated=12.3, cuda_gb_reserved=13.6, cuda_gb_free=11.4, wall=931
25-01-17 16:35:16 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:35:16 | I | in layer model.layers.4
25-01-17 16:35:16 | I | quantizing weights for layer model.layers.4
25-01-17 16:35:16 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:16 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:16 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:16 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:17 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:35:17 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:35:17 | I |       - range scale = [    1.0000]
25-01-17 16:35:17 | I |         sum  error  = [    0.5978]
25-01-17 16:35:17 | I |         best error  = [    0.5978]
25-01-17 16:35:17 | I |     + error = [0.5978]
25-01-17 16:35:18 | I |       - range scale = [    1.0000]
25-01-17 16:35:18 | I |         sum  error  = [    4.9485]
25-01-17 16:35:18 | I |         best error  = [    4.9485]
25-01-17 16:35:18 | I |     + error = [4.9485]
25-01-17 16:35:18 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:35:19 | I |       - range scale = [    1.0000]
25-01-17 16:35:19 | I |         sum  error  = [    0.3196]
25-01-17 16:35:19 | I |         best error  = [    0.3196]
25-01-17 16:35:19 | I |     + error = [0.3196]
25-01-17 16:35:20 | I |       - range scale = [    1.0000]
25-01-17 16:35:20 | I |         sum  error  = [    2.5287]
25-01-17 16:35:20 | I |         best error  = [    2.5287]
25-01-17 16:35:20 | I |     + error = [2.5287]
25-01-17 16:35:20 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:35:20 | I |       - range scale = [    1.0000]
25-01-17 16:35:20 | I |         sum  error  = [    0.6239]
25-01-17 16:35:20 | I |         best error  = [    0.6239]
25-01-17 16:35:20 | I |     + error = [0.6239]
25-01-17 16:35:21 | I |       - range scale = [    1.0000]
25-01-17 16:35:21 | I |         sum  error  = [    6.8704]
25-01-17 16:35:21 | I |         best error  = [    6.8704]
25-01-17 16:35:21 | I |     + error = [6.8704]
25-01-17 16:35:21 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:35:22 | I |       - range scale = [    1.0000]
25-01-17 16:35:22 | I |         sum  error  = [    0.1080]
25-01-17 16:35:22 | I |         best error  = [    0.1080]
25-01-17 16:35:22 | I |     + error = [0.1080]
25-01-17 16:35:23 | I |       - range scale = [    1.0000]
25-01-17 16:35:23 | I |         sum  error  = [    1.1782]
25-01-17 16:35:23 | I |         best error  = [    1.1782]
25-01-17 16:35:23 | I |     + error = [1.1782]
25-01-17 16:35:23 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:35:24 | I |       - range scale = [    1.0000]
25-01-17 16:35:24 | I |         sum  error  = [    1.9959]
25-01-17 16:35:24 | I |         best error  = [    1.9959]
25-01-17 16:35:24 | I |     + error = [1.9959]
25-01-17 16:35:24 | I |       - range scale = [    1.0000]
25-01-17 16:35:24 | I |         sum  error  = [   22.4066]
25-01-17 16:35:24 | I |         best error  = [   22.4066]
25-01-17 16:35:24 | I |     + error = [22.4066]
25-01-17 16:35:25 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:35:25 | I |       - range scale = [    1.0000]
25-01-17 16:35:25 | I |         sum  error  = [    2.1844]
25-01-17 16:35:25 | I |         best error  = [    2.1844]
25-01-17 16:35:25 | I |     + error = [2.1844]
25-01-17 16:35:26 | I |       - range scale = [    1.0000]
25-01-17 16:35:26 | I |         sum  error  = [   24.4879]
25-01-17 16:35:26 | I |         best error  = [   24.4879]
25-01-17 16:35:26 | I |     + error = [24.4879]
25-01-17 16:35:26 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:35:27 | I |       - range scale = [    1.0000]
25-01-17 16:35:27 | I |         sum  error  = [    0.1751]
25-01-17 16:35:27 | I |         best error  = [    0.1751]
25-01-17 16:35:27 | I |     + error = [0.1751]
25-01-17 16:35:28 | I |       - range scale = [    1.0000]
25-01-17 16:35:28 | I |         sum  error  = [    1.7959]
25-01-17 16:35:28 | I |         best error  = [    1.7959]
25-01-17 16:35:28 | I |     + error = [1.7959]
25-01-17 16:35:28 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:35:29 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:35:31 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:35:32 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:35:33 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:35:35 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:35:36 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:35:39 | I | quantizing activations for layer model.layers.4
25-01-17 16:35:40 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:40 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:40 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:40 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:42 | I | forward this layer
25-01-17 16:35:42 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/20.pt
25-01-17 16:35:42 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/20.pt
25-01-17 16:35:42 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:35:42 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:35:42 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:35:42 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:35:42 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:35:42 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:35:42 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:35:42 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:35:42 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:35:42 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:35:42 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:35:42 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:35:42 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:35:42 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:35:42 | I | in layer model.layers.4
25-01-17 16:35:42 | I | quantizing weights for layer model.layers.4
25-01-17 16:35:43 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:43 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:43 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:43 | I | collecting calibration activations in model.layers.4
25-01-17 16:35:43 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:35:43 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:35:44 | I |       - range scale = [    1.0000]
25-01-17 16:35:44 | I |         sum  error  = [    0.6128]
25-01-17 16:35:44 | I |         best error  = [    0.6128]
25-01-17 16:35:44 | I |     + error = [0.6128]
25-01-17 16:35:45 | I |       - range scale = [    1.0000]
25-01-17 16:35:45 | I |         sum  error  = [    5.3476]
25-01-17 16:35:45 | I |         best error  = [    5.3476]
25-01-17 16:35:45 | I |     + error = [5.3476]
25-01-17 16:35:45 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:35:46 | I |       - range scale = [    1.0000]
25-01-17 16:35:46 | I |         sum  error  = [    0.3407]
25-01-17 16:35:46 | I |         best error  = [    0.3407]
25-01-17 16:35:46 | I |     + error = [0.3407]
25-01-17 16:35:46 | I |       - range scale = [    1.0000]
25-01-17 16:35:46 | I |         sum  error  = [    2.5443]
25-01-17 16:35:46 | I |         best error  = [    2.5443]
25-01-17 16:35:46 | I |     + error = [2.5443]
25-01-17 16:35:47 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:35:47 | I |       - range scale = [    1.0000]
25-01-17 16:35:47 | I |         sum  error  = [    0.6174]
25-01-17 16:35:47 | I |         best error  = [    0.6174]
25-01-17 16:35:47 | I |     + error = [0.6174]
25-01-17 16:35:48 | I |       - range scale = [    1.0000]
25-01-17 16:35:48 | I |         sum  error  = [    6.8990]
25-01-17 16:35:48 | I |         best error  = [    6.8990]
25-01-17 16:35:48 | I |     + error = [6.8990]
25-01-17 16:35:48 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:35:49 | I |       - range scale = [    1.0000]
25-01-17 16:35:49 | I |         sum  error  = [    0.1094]
25-01-17 16:35:49 | I |         best error  = [    0.1094]
25-01-17 16:35:49 | I |     + error = [0.1094]
25-01-17 16:35:50 | I |       - range scale = [    1.0000]
25-01-17 16:35:50 | I |         sum  error  = [    1.1877]
25-01-17 16:35:50 | I |         best error  = [    1.1877]
25-01-17 16:35:50 | I |     + error = [1.1877]
25-01-17 16:35:50 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:35:50 | I |       - range scale = [    1.0000]
25-01-17 16:35:50 | I |         sum  error  = [    2.0258]
25-01-17 16:35:50 | I |         best error  = [    2.0258]
25-01-17 16:35:50 | I |     + error = [2.0258]
25-01-17 16:35:51 | I |       - range scale = [    1.0000]
25-01-17 16:35:51 | I |         sum  error  = [   22.7553]
25-01-17 16:35:51 | I |         best error  = [   22.7553]
25-01-17 16:35:51 | I |     + error = [22.7553]
25-01-17 16:35:51 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:35:52 | I |       - range scale = [    1.0000]
25-01-17 16:35:52 | I |         sum  error  = [    2.2153]
25-01-17 16:35:52 | I |         best error  = [    2.2153]
25-01-17 16:35:52 | I |     + error = [2.2153]
25-01-17 16:35:53 | I |       - range scale = [    1.0000]
25-01-17 16:35:53 | I |         sum  error  = [   24.8574]
25-01-17 16:35:53 | I |         best error  = [   24.8574]
25-01-17 16:35:53 | I |     + error = [24.8574]
25-01-17 16:35:53 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:35:54 | I |       - range scale = [    1.0000]
25-01-17 16:35:54 | I |         sum  error  = [    0.1801]
25-01-17 16:35:54 | I |         best error  = [    0.1801]
25-01-17 16:35:54 | I |     + error = [0.1801]
25-01-17 16:35:55 | I |       - range scale = [    1.0000]
25-01-17 16:35:55 | I |         sum  error  = [    1.8384]
25-01-17 16:35:55 | I |         best error  = [    1.8384]
25-01-17 16:35:55 | I |     + error = [1.8384]
25-01-17 16:35:55 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:35:56 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:35:58 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:35:59 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:36:00 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:36:02 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:36:03 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:36:06 | I | quantizing activations for layer model.layers.4
25-01-17 16:36:07 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:07 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:07 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:07 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:09 | I | forward this layer
25-01-17 16:36:09 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/21.pt
25-01-17 16:36:09 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/21.pt
25-01-17 16:36:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:36:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:36:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:36:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:36:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:36:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:36:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:36:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:36:09 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:36:09 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:36:09 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:36:09 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:36:09 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:36:09 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:36:09 | I | [4] done with optimizer step
25-01-17 16:36:09 | I | epoch 001:     11 / 409600000 loss=1.91109e-05, loss_per_token=0.039139, loss_sum=1282.51, wps=608.9, ups=0.02, wpb=32768, bsz=64, num_updates=5, lr=1.5e-05, gnorm=0.878, clip=0, loss_scale=2, train_wall=54, cuda_gb_allocated=12.3, cuda_gb_reserved=13.6, cuda_gb_free=11.4, wall=985
25-01-17 16:36:09 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:36:09 | I | in layer model.layers.4
25-01-17 16:36:09 | I | quantizing weights for layer model.layers.4
25-01-17 16:36:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:10 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:36:10 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:36:11 | I |       - range scale = [    1.0000]
25-01-17 16:36:11 | I |         sum  error  = [    0.6267]
25-01-17 16:36:11 | I |         best error  = [    0.6267]
25-01-17 16:36:11 | I |     + error = [0.6267]
25-01-17 16:36:12 | I |       - range scale = [    1.0000]
25-01-17 16:36:12 | I |         sum  error  = [    5.2799]
25-01-17 16:36:12 | I |         best error  = [    5.2799]
25-01-17 16:36:12 | I |     + error = [5.2799]
25-01-17 16:36:12 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:36:13 | I |       - range scale = [    1.0000]
25-01-17 16:36:13 | I |         sum  error  = [    0.3144]
25-01-17 16:36:13 | I |         best error  = [    0.3144]
25-01-17 16:36:13 | I |     + error = [0.3144]
25-01-17 16:36:14 | I |       - range scale = [    1.0000]
25-01-17 16:36:14 | I |         sum  error  = [    2.5360]
25-01-17 16:36:14 | I |         best error  = [    2.5360]
25-01-17 16:36:14 | I |     + error = [2.5360]
25-01-17 16:36:14 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:36:14 | I |       - range scale = [    1.0000]
25-01-17 16:36:14 | I |         sum  error  = [    0.6284]
25-01-17 16:36:14 | I |         best error  = [    0.6284]
25-01-17 16:36:14 | I |     + error = [0.6284]
25-01-17 16:36:15 | I |       - range scale = [    1.0000]
25-01-17 16:36:15 | I |         sum  error  = [    6.9370]
25-01-17 16:36:15 | I |         best error  = [    6.9370]
25-01-17 16:36:15 | I |     + error = [6.9370]
25-01-17 16:36:15 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:36:16 | I |       - range scale = [    1.0000]
25-01-17 16:36:16 | I |         sum  error  = [    0.1181]
25-01-17 16:36:16 | I |         best error  = [    0.1181]
25-01-17 16:36:16 | I |     + error = [0.1181]
25-01-17 16:36:17 | I |       - range scale = [    1.0000]
25-01-17 16:36:17 | I |         sum  error  = [    1.3072]
25-01-17 16:36:17 | I |         best error  = [    1.3072]
25-01-17 16:36:17 | I |     + error = [1.3072]
25-01-17 16:36:17 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:36:18 | I |       - range scale = [    1.0000]
25-01-17 16:36:18 | I |         sum  error  = [    2.0320]
25-01-17 16:36:18 | I |         best error  = [    2.0320]
25-01-17 16:36:18 | I |     + error = [2.0320]
25-01-17 16:36:18 | I |       - range scale = [    1.0000]
25-01-17 16:36:18 | I |         sum  error  = [   22.8299]
25-01-17 16:36:18 | I |         best error  = [   22.8299]
25-01-17 16:36:18 | I |     + error = [22.8299]
25-01-17 16:36:19 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:36:19 | I |       - range scale = [    1.0000]
25-01-17 16:36:19 | I |         sum  error  = [    2.2240]
25-01-17 16:36:19 | I |         best error  = [    2.2240]
25-01-17 16:36:19 | I |     + error = [2.2240]
25-01-17 16:36:20 | I |       - range scale = [    1.0000]
25-01-17 16:36:20 | I |         sum  error  = [   24.9314]
25-01-17 16:36:20 | I |         best error  = [   24.9314]
25-01-17 16:36:20 | I |     + error = [24.9314]
25-01-17 16:36:20 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:36:21 | I |       - range scale = [    1.0000]
25-01-17 16:36:21 | I |         sum  error  = [    0.1831]
25-01-17 16:36:21 | I |         best error  = [    0.1831]
25-01-17 16:36:21 | I |     + error = [0.1831]
25-01-17 16:36:22 | I |       - range scale = [    1.0000]
25-01-17 16:36:22 | I |         sum  error  = [    1.8682]
25-01-17 16:36:22 | I |         best error  = [    1.8682]
25-01-17 16:36:22 | I |     + error = [1.8682]
25-01-17 16:36:22 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:36:23 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:36:25 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:36:26 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:36:27 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:36:29 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:36:30 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:36:33 | I | quantizing activations for layer model.layers.4
25-01-17 16:36:34 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:34 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:34 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:34 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:36 | I | forward this layer
25-01-17 16:36:36 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/22.pt
25-01-17 16:36:36 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/22.pt
25-01-17 16:36:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:36:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:36:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:36:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:36:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:36:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:36:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:36:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:36:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:36:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:36:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:36:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:36:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:36:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:36:36 | I | in layer model.layers.4
25-01-17 16:36:36 | I | quantizing weights for layer model.layers.4
25-01-17 16:36:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:36:37 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:36:37 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:36:38 | I |       - range scale = [    1.0000]
25-01-17 16:36:38 | I |         sum  error  = [    0.6208]
25-01-17 16:36:38 | I |         best error  = [    0.6208]
25-01-17 16:36:38 | I |     + error = [0.6208]
25-01-17 16:36:39 | I |       - range scale = [    1.0000]
25-01-17 16:36:39 | I |         sum  error  = [    5.2373]
25-01-17 16:36:39 | I |         best error  = [    5.2373]
25-01-17 16:36:39 | I |     + error = [5.2373]
25-01-17 16:36:39 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:36:40 | I |       - range scale = [    1.0000]
25-01-17 16:36:40 | I |         sum  error  = [    0.3394]
25-01-17 16:36:40 | I |         best error  = [    0.3394]
25-01-17 16:36:40 | I |     + error = [0.3394]
25-01-17 16:36:40 | I |       - range scale = [    1.0000]
25-01-17 16:36:40 | I |         sum  error  = [    2.7025]
25-01-17 16:36:40 | I |         best error  = [    2.7025]
25-01-17 16:36:40 | I |     + error = [2.7025]
25-01-17 16:36:41 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:36:41 | I |       - range scale = [    1.0000]
25-01-17 16:36:41 | I |         sum  error  = [    0.6281]
25-01-17 16:36:41 | I |         best error  = [    0.6281]
25-01-17 16:36:41 | I |     + error = [0.6281]
25-01-17 16:36:42 | I |       - range scale = [    1.0000]
25-01-17 16:36:42 | I |         sum  error  = [    6.9069]
25-01-17 16:36:42 | I |         best error  = [    6.9069]
25-01-17 16:36:42 | I |     + error = [6.9069]
25-01-17 16:36:42 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:36:43 | I |       - range scale = [    1.0000]
25-01-17 16:36:43 | I |         sum  error  = [    0.1129]
25-01-17 16:36:43 | I |         best error  = [    0.1129]
25-01-17 16:36:43 | I |     + error = [0.1129]
25-01-17 16:36:43 | I |       - range scale = [    1.0000]
25-01-17 16:36:43 | I |         sum  error  = [    1.2347]
25-01-17 16:36:43 | I |         best error  = [    1.2347]
25-01-17 16:36:43 | I |     + error = [1.2347]
25-01-17 16:36:44 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:36:44 | I |       - range scale = [    1.0000]
25-01-17 16:36:44 | I |         sum  error  = [    2.0263]
25-01-17 16:36:44 | I |         best error  = [    2.0263]
25-01-17 16:36:44 | I |     + error = [2.0263]
25-01-17 16:36:45 | I |       - range scale = [    1.0000]
25-01-17 16:36:45 | I |         sum  error  = [   22.7470]
25-01-17 16:36:45 | I |         best error  = [   22.7470]
25-01-17 16:36:45 | I |     + error = [22.7470]
25-01-17 16:36:45 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:36:46 | I |       - range scale = [    1.0000]
25-01-17 16:36:46 | I |         sum  error  = [    2.2167]
25-01-17 16:36:46 | I |         best error  = [    2.2167]
25-01-17 16:36:46 | I |     + error = [2.2167]
25-01-17 16:36:47 | I |       - range scale = [    1.0000]
25-01-17 16:36:47 | I |         sum  error  = [   24.8499]
25-01-17 16:36:47 | I |         best error  = [   24.8499]
25-01-17 16:36:47 | I |     + error = [24.8499]
25-01-17 16:36:47 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:36:48 | I |       - range scale = [    1.0000]
25-01-17 16:36:48 | I |         sum  error  = [    0.1709]
25-01-17 16:36:48 | I |         best error  = [    0.1709]
25-01-17 16:36:48 | I |     + error = [0.1709]
25-01-17 16:36:48 | I |       - range scale = [    1.0000]
25-01-17 16:36:48 | I |         sum  error  = [    1.7512]
25-01-17 16:36:48 | I |         best error  = [    1.7512]
25-01-17 16:36:48 | I |     + error = [1.7512]
25-01-17 16:36:49 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:36:50 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:36:51 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:36:53 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:36:54 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:36:55 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:36:57 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:37:00 | I | quantizing activations for layer model.layers.4
25-01-17 16:37:01 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:01 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:01 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:01 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:03 | I | forward this layer
25-01-17 16:37:03 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/23.pt
25-01-17 16:37:03 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/23.pt
25-01-17 16:37:03 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:37:03 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:37:03 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:37:03 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:37:03 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:37:03 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:37:03 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:37:03 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:37:03 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:37:03 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:37:03 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:37:03 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:37:03 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:37:03 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:37:03 | I | [5] done with optimizer step
25-01-17 16:37:03 | I | epoch 001:     12 / 409600000 loss=1.8395e-05, loss_per_token=0.0376729, loss_sum=1234.46, wps=610.4, ups=0.02, wpb=32768, bsz=64, num_updates=6, lr=1.8e-05, gnorm=0.559, clip=0, loss_scale=2, train_wall=53, cuda_gb_allocated=12.3, cuda_gb_reserved=13.6, cuda_gb_free=11.4, wall=1039
25-01-17 16:37:03 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:37:03 | I | in layer model.layers.4
25-01-17 16:37:03 | I | quantizing weights for layer model.layers.4
25-01-17 16:37:04 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:04 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:04 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:04 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:04 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:37:04 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:37:05 | I |       - range scale = [    1.0000]
25-01-17 16:37:05 | I |         sum  error  = [    0.6095]
25-01-17 16:37:05 | I |         best error  = [    0.6095]
25-01-17 16:37:05 | I |     + error = [0.6095]
25-01-17 16:37:06 | I |       - range scale = [    1.0000]
25-01-17 16:37:06 | I |         sum  error  = [    5.2057]
25-01-17 16:37:06 | I |         best error  = [    5.2057]
25-01-17 16:37:06 | I |     + error = [5.2057]
25-01-17 16:37:06 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:37:06 | I |       - range scale = [    1.0000]
25-01-17 16:37:06 | I |         sum  error  = [    0.3117]
25-01-17 16:37:06 | I |         best error  = [    0.3117]
25-01-17 16:37:06 | I |     + error = [0.3117]
25-01-17 16:37:07 | I |       - range scale = [    1.0000]
25-01-17 16:37:07 | I |         sum  error  = [    2.5546]
25-01-17 16:37:07 | I |         best error  = [    2.5546]
25-01-17 16:37:07 | I |     + error = [2.5546]
25-01-17 16:37:07 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:37:08 | I |       - range scale = [    1.0000]
25-01-17 16:37:08 | I |         sum  error  = [    0.6213]
25-01-17 16:37:08 | I |         best error  = [    0.6213]
25-01-17 16:37:08 | I |     + error = [0.6213]
25-01-17 16:37:09 | I |       - range scale = [    1.0000]
25-01-17 16:37:09 | I |         sum  error  = [    6.8844]
25-01-17 16:37:09 | I |         best error  = [    6.8844]
25-01-17 16:37:09 | I |     + error = [6.8844]
25-01-17 16:37:09 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:37:10 | I |       - range scale = [    1.0000]
25-01-17 16:37:10 | I |         sum  error  = [    0.1119]
25-01-17 16:37:10 | I |         best error  = [    0.1119]
25-01-17 16:37:10 | I |     + error = [0.1119]
25-01-17 16:37:11 | I |       - range scale = [    1.0000]
25-01-17 16:37:11 | I |         sum  error  = [    1.2274]
25-01-17 16:37:11 | I |         best error  = [    1.2274]
25-01-17 16:37:11 | I |     + error = [1.2274]
25-01-17 16:37:11 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:37:11 | I |       - range scale = [    1.0000]
25-01-17 16:37:11 | I |         sum  error  = [    2.0020]
25-01-17 16:37:11 | I |         best error  = [    2.0020]
25-01-17 16:37:11 | I |     + error = [2.0020]
25-01-17 16:37:12 | I |       - range scale = [    1.0000]
25-01-17 16:37:12 | I |         sum  error  = [   22.4692]
25-01-17 16:37:12 | I |         best error  = [   22.4692]
25-01-17 16:37:12 | I |     + error = [22.4692]
25-01-17 16:37:12 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:37:13 | I |       - range scale = [    1.0000]
25-01-17 16:37:13 | I |         sum  error  = [    2.1920]
25-01-17 16:37:13 | I |         best error  = [    2.1920]
25-01-17 16:37:13 | I |     + error = [2.1920]
25-01-17 16:37:14 | I |       - range scale = [    1.0000]
25-01-17 16:37:14 | I |         sum  error  = [   24.5384]
25-01-17 16:37:14 | I |         best error  = [   24.5384]
25-01-17 16:37:14 | I |     + error = [24.5384]
25-01-17 16:37:14 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:37:15 | I |       - range scale = [    1.0000]
25-01-17 16:37:15 | I |         sum  error  = [    0.1711]
25-01-17 16:37:15 | I |         best error  = [    0.1711]
25-01-17 16:37:15 | I |     + error = [0.1711]
25-01-17 16:37:16 | I |       - range scale = [    1.0000]
25-01-17 16:37:16 | I |         sum  error  = [    1.7460]
25-01-17 16:37:16 | I |         best error  = [    1.7460]
25-01-17 16:37:16 | I |     + error = [1.7460]
25-01-17 16:37:16 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:37:17 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:37:19 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:37:20 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:37:21 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:37:23 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:37:24 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:37:27 | I | quantizing activations for layer model.layers.4
25-01-17 16:37:28 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:28 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:28 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:28 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:30 | I | forward this layer
25-01-17 16:37:30 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/24.pt
25-01-17 16:37:30 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/24.pt
25-01-17 16:37:30 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:37:30 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:37:30 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:37:30 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:37:30 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:37:30 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:37:30 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:37:30 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:37:30 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:37:30 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:37:30 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:37:30 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:37:30 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:37:30 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:37:30 | I | in layer model.layers.4
25-01-17 16:37:30 | I | quantizing weights for layer model.layers.4
25-01-17 16:37:31 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:31 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:31 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:31 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:31 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:37:31 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:37:32 | I |       - range scale = [    1.0000]
25-01-17 16:37:32 | I |         sum  error  = [    0.5699]
25-01-17 16:37:32 | I |         best error  = [    0.5699]
25-01-17 16:37:32 | I |     + error = [0.5699]
25-01-17 16:37:33 | I |       - range scale = [    1.0000]
25-01-17 16:37:33 | I |         sum  error  = [    5.1699]
25-01-17 16:37:33 | I |         best error  = [    5.1699]
25-01-17 16:37:33 | I |     + error = [5.1699]
25-01-17 16:37:33 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:37:34 | I |       - range scale = [    1.0000]
25-01-17 16:37:34 | I |         sum  error  = [    0.3121]
25-01-17 16:37:34 | I |         best error  = [    0.3121]
25-01-17 16:37:34 | I |     + error = [0.3121]
25-01-17 16:37:34 | I |       - range scale = [    1.0000]
25-01-17 16:37:34 | I |         sum  error  = [    2.4157]
25-01-17 16:37:34 | I |         best error  = [    2.4157]
25-01-17 16:37:34 | I |     + error = [2.4157]
25-01-17 16:37:35 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:37:35 | I |       - range scale = [    1.0000]
25-01-17 16:37:35 | I |         sum  error  = [    0.6197]
25-01-17 16:37:35 | I |         best error  = [    0.6197]
25-01-17 16:37:35 | I |     + error = [0.6197]
25-01-17 16:37:36 | I |       - range scale = [    1.0000]
25-01-17 16:37:36 | I |         sum  error  = [    6.9134]
25-01-17 16:37:36 | I |         best error  = [    6.9134]
25-01-17 16:37:36 | I |     + error = [6.9134]
25-01-17 16:37:36 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:37:37 | I |       - range scale = [    1.0000]
25-01-17 16:37:37 | I |         sum  error  = [    0.1022]
25-01-17 16:37:37 | I |         best error  = [    0.1022]
25-01-17 16:37:37 | I |     + error = [0.1022]
25-01-17 16:37:38 | I |       - range scale = [    1.0000]
25-01-17 16:37:38 | I |         sum  error  = [    1.1221]
25-01-17 16:37:38 | I |         best error  = [    1.1221]
25-01-17 16:37:38 | I |     + error = [1.1221]
25-01-17 16:37:38 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:37:39 | I |       - range scale = [    1.0000]
25-01-17 16:37:39 | I |         sum  error  = [    2.0184]
25-01-17 16:37:39 | I |         best error  = [    2.0184]
25-01-17 16:37:39 | I |     + error = [2.0184]
25-01-17 16:37:39 | I |       - range scale = [    1.0000]
25-01-17 16:37:39 | I |         sum  error  = [   22.6915]
25-01-17 16:37:39 | I |         best error  = [   22.6915]
25-01-17 16:37:39 | I |     + error = [22.6915]
25-01-17 16:37:39 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:37:40 | I |       - range scale = [    1.0000]
25-01-17 16:37:40 | I |         sum  error  = [    2.2110]
25-01-17 16:37:40 | I |         best error  = [    2.2110]
25-01-17 16:37:40 | I |     + error = [2.2110]
25-01-17 16:37:41 | I |       - range scale = [    1.0000]
25-01-17 16:37:41 | I |         sum  error  = [   24.7852]
25-01-17 16:37:41 | I |         best error  = [   24.7852]
25-01-17 16:37:41 | I |     + error = [24.7852]
25-01-17 16:37:41 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:37:42 | I |       - range scale = [    1.0000]
25-01-17 16:37:42 | I |         sum  error  = [    0.1761]
25-01-17 16:37:42 | I |         best error  = [    0.1761]
25-01-17 16:37:42 | I |     + error = [0.1761]
25-01-17 16:37:43 | I |       - range scale = [    1.0000]
25-01-17 16:37:43 | I |         sum  error  = [    1.7997]
25-01-17 16:37:43 | I |         best error  = [    1.7997]
25-01-17 16:37:43 | I |     + error = [1.7997]
25-01-17 16:37:43 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:37:44 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:37:46 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:37:47 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:37:49 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:37:50 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:37:52 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:37:55 | I | quantizing activations for layer model.layers.4
25-01-17 16:37:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:58 | I | forward this layer
25-01-17 16:37:58 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/25.pt
25-01-17 16:37:58 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/25.pt
25-01-17 16:37:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:37:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:37:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:37:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:37:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:37:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:37:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:37:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:37:58 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:37:58 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:37:58 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:37:58 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:37:58 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:37:58 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:37:58 | I | [6] done with optimizer step
25-01-17 16:37:58 | I | epoch 001:     13 / 409600000 loss=1.59705e-05, loss_per_token=0.0327076, loss_sum=1071.76, wps=591, ups=0.02, wpb=32768, bsz=64, num_updates=7, lr=2.1e-05, gnorm=0.718, clip=0, loss_scale=2, train_wall=55, cuda_gb_allocated=12.3, cuda_gb_reserved=13.6, cuda_gb_free=11.4, wall=1094
25-01-17 16:37:59 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:37:59 | I | in layer model.layers.4
25-01-17 16:37:59 | I | quantizing weights for layer model.layers.4
25-01-17 16:37:59 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:59 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:59 | I | collecting calibration activations in model.layers.4
25-01-17 16:37:59 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:00 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:38:00 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:38:00 | I |       - range scale = [    1.0000]
25-01-17 16:38:00 | I |         sum  error  = [    0.6033]
25-01-17 16:38:00 | I |         best error  = [    0.6033]
25-01-17 16:38:00 | I |     + error = [0.6033]
25-01-17 16:38:01 | I |       - range scale = [    1.0000]
25-01-17 16:38:01 | I |         sum  error  = [    5.1848]
25-01-17 16:38:01 | I |         best error  = [    5.1848]
25-01-17 16:38:01 | I |     + error = [5.1848]
25-01-17 16:38:01 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:38:02 | I |       - range scale = [    1.0000]
25-01-17 16:38:02 | I |         sum  error  = [    0.3051]
25-01-17 16:38:02 | I |         best error  = [    0.3051]
25-01-17 16:38:02 | I |     + error = [0.3051]
25-01-17 16:38:03 | I |       - range scale = [    1.0000]
25-01-17 16:38:03 | I |         sum  error  = [    2.4945]
25-01-17 16:38:03 | I |         best error  = [    2.4945]
25-01-17 16:38:03 | I |     + error = [2.4945]
25-01-17 16:38:03 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:38:04 | I |       - range scale = [    1.0000]
25-01-17 16:38:04 | I |         sum  error  = [    0.6262]
25-01-17 16:38:04 | I |         best error  = [    0.6262]
25-01-17 16:38:04 | I |     + error = [0.6262]
25-01-17 16:38:04 | I |       - range scale = [    1.0000]
25-01-17 16:38:04 | I |         sum  error  = [    6.9067]
25-01-17 16:38:04 | I |         best error  = [    6.9067]
25-01-17 16:38:04 | I |     + error = [6.9067]
25-01-17 16:38:05 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:38:05 | I |       - range scale = [    1.0000]
25-01-17 16:38:05 | I |         sum  error  = [    0.1115]
25-01-17 16:38:05 | I |         best error  = [    0.1115]
25-01-17 16:38:05 | I |     + error = [0.1115]
25-01-17 16:38:06 | I |       - range scale = [    1.0000]
25-01-17 16:38:06 | I |         sum  error  = [    1.2190]
25-01-17 16:38:06 | I |         best error  = [    1.2190]
25-01-17 16:38:06 | I |     + error = [1.2190]
25-01-17 16:38:06 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:38:07 | I |       - range scale = [    1.0000]
25-01-17 16:38:07 | I |         sum  error  = [    2.0392]
25-01-17 16:38:07 | I |         best error  = [    2.0392]
25-01-17 16:38:07 | I |     + error = [2.0392]
25-01-17 16:38:08 | I |       - range scale = [    1.0000]
25-01-17 16:38:08 | I |         sum  error  = [   22.8782]
25-01-17 16:38:08 | I |         best error  = [   22.8782]
25-01-17 16:38:08 | I |     + error = [22.8782]
25-01-17 16:38:08 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:38:09 | I |       - range scale = [    1.0000]
25-01-17 16:38:09 | I |         sum  error  = [    2.2275]
25-01-17 16:38:09 | I |         best error  = [    2.2275]
25-01-17 16:38:09 | I |     + error = [2.2275]
25-01-17 16:38:10 | I |       - range scale = [    1.0000]
25-01-17 16:38:10 | I |         sum  error  = [   24.9804]
25-01-17 16:38:10 | I |         best error  = [   24.9804]
25-01-17 16:38:10 | I |     + error = [24.9804]
25-01-17 16:38:10 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:38:10 | I |       - range scale = [    1.0000]
25-01-17 16:38:10 | I |         sum  error  = [    0.1765]
25-01-17 16:38:10 | I |         best error  = [    0.1765]
25-01-17 16:38:10 | I |     + error = [0.1765]
25-01-17 16:38:11 | I |       - range scale = [    1.0000]
25-01-17 16:38:11 | I |         sum  error  = [    1.8012]
25-01-17 16:38:11 | I |         best error  = [    1.8012]
25-01-17 16:38:11 | I |     + error = [1.8012]
25-01-17 16:38:11 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:38:13 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:38:15 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:38:17 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:38:18 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:38:20 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:38:22 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:38:26 | I | quantizing activations for layer model.layers.4
25-01-17 16:38:26 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:26 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:28 | I | forward this layer
25-01-17 16:38:28 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/26.pt
25-01-17 16:38:28 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/26.pt
25-01-17 16:38:29 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:38:29 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:38:29 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:38:29 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:38:29 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:38:29 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:38:29 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:38:29 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:38:29 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:38:29 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:38:29 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:38:29 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:38:29 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:38:29 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:38:29 | I | in layer model.layers.4
25-01-17 16:38:29 | I | quantizing weights for layer model.layers.4
25-01-17 16:38:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:30 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:38:30 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:38:30 | I |       - range scale = [    1.0000]
25-01-17 16:38:30 | I |         sum  error  = [    0.6254]
25-01-17 16:38:30 | I |         best error  = [    0.6254]
25-01-17 16:38:30 | I |     + error = [0.6254]
25-01-17 16:38:31 | I |       - range scale = [    1.0000]
25-01-17 16:38:31 | I |         sum  error  = [    5.1723]
25-01-17 16:38:31 | I |         best error  = [    5.1723]
25-01-17 16:38:31 | I |     + error = [5.1723]
25-01-17 16:38:32 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:38:32 | I |       - range scale = [    1.0000]
25-01-17 16:38:32 | I |         sum  error  = [    0.3127]
25-01-17 16:38:32 | I |         best error  = [    0.3127]
25-01-17 16:38:32 | I |     + error = [0.3127]
25-01-17 16:38:33 | I |       - range scale = [    1.0000]
25-01-17 16:38:33 | I |         sum  error  = [    2.4667]
25-01-17 16:38:33 | I |         best error  = [    2.4667]
25-01-17 16:38:33 | I |     + error = [2.4667]
25-01-17 16:38:33 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:38:34 | I |       - range scale = [    1.0000]
25-01-17 16:38:34 | I |         sum  error  = [    0.6183]
25-01-17 16:38:34 | I |         best error  = [    0.6183]
25-01-17 16:38:34 | I |     + error = [0.6183]
25-01-17 16:38:34 | I |       - range scale = [    1.0000]
25-01-17 16:38:34 | I |         sum  error  = [    6.8285]
25-01-17 16:38:34 | I |         best error  = [    6.8285]
25-01-17 16:38:34 | I |     + error = [6.8285]
25-01-17 16:38:35 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:38:35 | I |       - range scale = [    1.0000]
25-01-17 16:38:35 | I |         sum  error  = [    0.1064]
25-01-17 16:38:35 | I |         best error  = [    0.1064]
25-01-17 16:38:35 | I |     + error = [0.1064]
25-01-17 16:38:36 | I |       - range scale = [    1.0000]
25-01-17 16:38:36 | I |         sum  error  = [    1.1470]
25-01-17 16:38:36 | I |         best error  = [    1.1470]
25-01-17 16:38:36 | I |     + error = [1.1470]
25-01-17 16:38:36 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:38:37 | I |       - range scale = [    1.0000]
25-01-17 16:38:37 | I |         sum  error  = [    1.9983]
25-01-17 16:38:37 | I |         best error  = [    1.9983]
25-01-17 16:38:37 | I |     + error = [1.9983]
25-01-17 16:38:38 | I |       - range scale = [    1.0000]
25-01-17 16:38:38 | I |         sum  error  = [   22.3975]
25-01-17 16:38:38 | I |         best error  = [   22.3975]
25-01-17 16:38:38 | I |     + error = [22.3975]
25-01-17 16:38:38 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:38:38 | I |       - range scale = [    1.0000]
25-01-17 16:38:38 | I |         sum  error  = [    2.1790]
25-01-17 16:38:38 | I |         best error  = [    2.1790]
25-01-17 16:38:38 | I |     + error = [2.1790]
25-01-17 16:38:39 | I |       - range scale = [    1.0000]
25-01-17 16:38:39 | I |         sum  error  = [   24.4604]
25-01-17 16:38:39 | I |         best error  = [   24.4604]
25-01-17 16:38:39 | I |     + error = [24.4604]
25-01-17 16:38:39 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:38:40 | I |       - range scale = [    1.0000]
25-01-17 16:38:40 | I |         sum  error  = [    0.1692]
25-01-17 16:38:40 | I |         best error  = [    0.1692]
25-01-17 16:38:40 | I |     + error = [0.1692]
25-01-17 16:38:41 | I |       - range scale = [    1.0000]
25-01-17 16:38:41 | I |         sum  error  = [    1.7293]
25-01-17 16:38:41 | I |         best error  = [    1.7293]
25-01-17 16:38:41 | I |     + error = [1.7293]
25-01-17 16:38:41 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:38:42 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:38:44 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:38:45 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:38:46 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:38:48 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:38:49 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:38:53 | I | quantizing activations for layer model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:55 | I | forward this layer
25-01-17 16:38:55 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/27.pt
25-01-17 16:38:55 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/27.pt
25-01-17 16:38:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:38:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:38:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:38:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:38:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:38:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:38:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:38:55 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:38:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:38:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:38:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:38:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:38:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:38:55 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:38:55 | I | [7] done with optimizer step
25-01-17 16:38:55 | I | epoch 001:     14 / 409600000 loss=1.67829e-05, loss_per_token=0.0343714, loss_sum=1126.28, wps=574.5, ups=0.02, wpb=32768, bsz=64, num_updates=8, lr=2.4e-05, gnorm=0.358, clip=0, loss_scale=2, train_wall=57, cuda_gb_allocated=12.3, cuda_gb_reserved=13.6, cuda_gb_free=11.4, wall=1151
25-01-17 16:38:56 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:38:56 | I | in layer model.layers.4
25-01-17 16:38:56 | I | quantizing weights for layer model.layers.4
25-01-17 16:38:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:38:57 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:38:57 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:38:57 | I |       - range scale = [    1.0000]
25-01-17 16:38:57 | I |         sum  error  = [    0.6360]
25-01-17 16:38:57 | I |         best error  = [    0.6360]
25-01-17 16:38:57 | I |     + error = [0.6360]
25-01-17 16:38:58 | I |       - range scale = [    1.0000]
25-01-17 16:38:58 | I |         sum  error  = [    5.6288]
25-01-17 16:38:58 | I |         best error  = [    5.6288]
25-01-17 16:38:58 | I |     + error = [5.6288]
25-01-17 16:38:58 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:38:59 | I |       - range scale = [    1.0000]
25-01-17 16:38:59 | I |         sum  error  = [    0.3649]
25-01-17 16:38:59 | I |         best error  = [    0.3649]
25-01-17 16:38:59 | I |     + error = [0.3649]
25-01-17 16:39:00 | I |       - range scale = [    1.0000]
25-01-17 16:39:00 | I |         sum  error  = [    2.6543]
25-01-17 16:39:00 | I |         best error  = [    2.6543]
25-01-17 16:39:00 | I |     + error = [2.6543]
25-01-17 16:39:00 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:39:01 | I |       - range scale = [    1.0000]
25-01-17 16:39:01 | I |         sum  error  = [    0.6257]
25-01-17 16:39:01 | I |         best error  = [    0.6257]
25-01-17 16:39:01 | I |     + error = [0.6257]
25-01-17 16:39:01 | I |       - range scale = [    1.0000]
25-01-17 16:39:01 | I |         sum  error  = [    6.9823]
25-01-17 16:39:01 | I |         best error  = [    6.9823]
25-01-17 16:39:01 | I |     + error = [6.9823]
25-01-17 16:39:01 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:39:02 | I |       - range scale = [    1.0000]
25-01-17 16:39:02 | I |         sum  error  = [    0.1144]
25-01-17 16:39:02 | I |         best error  = [    0.1144]
25-01-17 16:39:02 | I |     + error = [0.1144]
25-01-17 16:39:03 | I |       - range scale = [    1.0000]
25-01-17 16:39:03 | I |         sum  error  = [    1.2464]
25-01-17 16:39:03 | I |         best error  = [    1.2464]
25-01-17 16:39:03 | I |     + error = [1.2464]
25-01-17 16:39:03 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:39:04 | I |       - range scale = [    1.0000]
25-01-17 16:39:04 | I |         sum  error  = [    2.0413]
25-01-17 16:39:04 | I |         best error  = [    2.0413]
25-01-17 16:39:04 | I |     + error = [2.0413]
25-01-17 16:39:04 | I |       - range scale = [    1.0000]
25-01-17 16:39:04 | I |         sum  error  = [   22.8967]
25-01-17 16:39:04 | I |         best error  = [   22.8967]
25-01-17 16:39:04 | I |     + error = [22.8967]
25-01-17 16:39:05 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:39:05 | I |       - range scale = [    1.0000]
25-01-17 16:39:05 | I |         sum  error  = [    2.2311]
25-01-17 16:39:05 | I |         best error  = [    2.2311]
25-01-17 16:39:05 | I |     + error = [2.2311]
25-01-17 16:39:06 | I |       - range scale = [    1.0000]
25-01-17 16:39:06 | I |         sum  error  = [   25.0282]
25-01-17 16:39:06 | I |         best error  = [   25.0282]
25-01-17 16:39:06 | I |     + error = [25.0282]
25-01-17 16:39:06 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:39:07 | I |       - range scale = [    1.0000]
25-01-17 16:39:07 | I |         sum  error  = [    0.1758]
25-01-17 16:39:07 | I |         best error  = [    0.1758]
25-01-17 16:39:07 | I |     + error = [0.1758]
25-01-17 16:39:08 | I |       - range scale = [    1.0000]
25-01-17 16:39:08 | I |         sum  error  = [    1.7984]
25-01-17 16:39:08 | I |         best error  = [    1.7984]
25-01-17 16:39:08 | I |     + error = [1.7984]
25-01-17 16:39:08 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:39:09 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:39:11 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:39:12 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:39:14 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:39:15 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:39:16 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:39:20 | I | quantizing activations for layer model.layers.4
25-01-17 16:39:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:22 | I | forward this layer
25-01-17 16:39:22 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/28.pt
25-01-17 16:39:22 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/28.pt
25-01-17 16:39:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:39:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:39:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:39:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:39:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:39:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:39:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:39:22 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:39:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:39:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:39:22 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:39:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:39:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:39:23 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:39:23 | I | in layer model.layers.4
25-01-17 16:39:23 | I | quantizing weights for layer model.layers.4
25-01-17 16:39:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:23 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:24 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:39:24 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:39:24 | I |       - range scale = [    1.0000]
25-01-17 16:39:24 | I |         sum  error  = [    0.5283]
25-01-17 16:39:24 | I |         best error  = [    0.5283]
25-01-17 16:39:24 | I |     + error = [0.5283]
25-01-17 16:39:25 | I |       - range scale = [    1.0000]
25-01-17 16:39:25 | I |         sum  error  = [    5.3113]
25-01-17 16:39:25 | I |         best error  = [    5.3113]
25-01-17 16:39:25 | I |     + error = [5.3113]
25-01-17 16:39:25 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:39:26 | I |       - range scale = [    1.0000]
25-01-17 16:39:26 | I |         sum  error  = [    0.3352]
25-01-17 16:39:26 | I |         best error  = [    0.3352]
25-01-17 16:39:26 | I |     + error = [0.3352]
25-01-17 16:39:27 | I |       - range scale = [    1.0000]
25-01-17 16:39:27 | I |         sum  error  = [    2.5891]
25-01-17 16:39:27 | I |         best error  = [    2.5891]
25-01-17 16:39:27 | I |     + error = [2.5891]
25-01-17 16:39:27 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:39:27 | I |       - range scale = [    1.0000]
25-01-17 16:39:27 | I |         sum  error  = [    0.6216]
25-01-17 16:39:27 | I |         best error  = [    0.6216]
25-01-17 16:39:27 | I |     + error = [0.6216]
25-01-17 16:39:28 | I |       - range scale = [    1.0000]
25-01-17 16:39:28 | I |         sum  error  = [    6.9587]
25-01-17 16:39:28 | I |         best error  = [    6.9587]
25-01-17 16:39:28 | I |     + error = [6.9587]
25-01-17 16:39:28 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:39:29 | I |       - range scale = [    1.0000]
25-01-17 16:39:29 | I |         sum  error  = [    0.1076]
25-01-17 16:39:29 | I |         best error  = [    0.1076]
25-01-17 16:39:29 | I |     + error = [0.1076]
25-01-17 16:39:30 | I |       - range scale = [    1.0000]
25-01-17 16:39:30 | I |         sum  error  = [    1.1762]
25-01-17 16:39:30 | I |         best error  = [    1.1762]
25-01-17 16:39:30 | I |     + error = [1.1762]
25-01-17 16:39:30 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:39:31 | I |       - range scale = [    1.0000]
25-01-17 16:39:31 | I |         sum  error  = [    2.0438]
25-01-17 16:39:31 | I |         best error  = [    2.0438]
25-01-17 16:39:31 | I |     + error = [2.0438]
25-01-17 16:39:31 | I |       - range scale = [    1.0000]
25-01-17 16:39:32 | I |         sum  error  = [   22.9394]
25-01-17 16:39:32 | I |         best error  = [   22.9394]
25-01-17 16:39:32 | I |     + error = [22.9394]
25-01-17 16:39:32 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:39:33 | I |       - range scale = [    1.0000]
25-01-17 16:39:33 | I |         sum  error  = [    2.2361]
25-01-17 16:39:33 | I |         best error  = [    2.2361]
25-01-17 16:39:33 | I |     + error = [2.2361]
25-01-17 16:39:34 | I |       - range scale = [    1.0000]
25-01-17 16:39:34 | I |         sum  error  = [   25.0608]
25-01-17 16:39:34 | I |         best error  = [   25.0608]
25-01-17 16:39:34 | I |     + error = [25.0608]
25-01-17 16:39:34 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:39:35 | I |       - range scale = [    1.0000]
25-01-17 16:39:35 | I |         sum  error  = [    0.1730]
25-01-17 16:39:35 | I |         best error  = [    0.1730]
25-01-17 16:39:35 | I |     + error = [0.1730]
25-01-17 16:39:36 | I |       - range scale = [    1.0000]
25-01-17 16:39:36 | I |         sum  error  = [    1.7665]
25-01-17 16:39:36 | I |         best error  = [    1.7665]
25-01-17 16:39:36 | I |     + error = [1.7665]
25-01-17 16:39:36 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:39:37 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:39:39 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:39:40 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:39:41 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:39:43 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:39:44 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:39:48 | I | quantizing activations for layer model.layers.4
25-01-17 16:39:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:50 | I | forward this layer
25-01-17 16:39:50 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/29.pt
25-01-17 16:39:50 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/29.pt
25-01-17 16:39:50 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:39:50 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:39:50 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:39:50 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:39:50 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:39:50 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:39:50 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:39:50 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:39:50 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:39:50 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:39:50 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:39:50 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:39:50 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:39:50 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:39:50 | I | [8] done with optimizer step
25-01-17 16:39:50 | I | epoch 001:     15 / 409600000 loss=1.4203e-05, loss_per_token=0.0290878, loss_sum=953.148, wps=595.2, ups=0.02, wpb=32768, bsz=64, num_updates=9, lr=2.7e-05, gnorm=0.335, clip=0, loss_scale=2, train_wall=55, cuda_gb_allocated=12.3, cuda_gb_reserved=13.6, cuda_gb_free=11.4, wall=1206
25-01-17 16:39:51 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:39:51 | I | in layer model.layers.4
25-01-17 16:39:51 | I | quantizing weights for layer model.layers.4
25-01-17 16:39:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:39:52 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:39:52 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:39:53 | I |       - range scale = [    1.0000]
25-01-17 16:39:53 | I |         sum  error  = [    0.6223]
25-01-17 16:39:53 | I |         best error  = [    0.6223]
25-01-17 16:39:53 | I |     + error = [0.6223]
25-01-17 16:39:53 | I |       - range scale = [    1.0000]
25-01-17 16:39:53 | I |         sum  error  = [    5.5699]
25-01-17 16:39:53 | I |         best error  = [    5.5699]
25-01-17 16:39:53 | I |     + error = [5.5699]
25-01-17 16:39:53 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:39:54 | I |       - range scale = [    1.0000]
25-01-17 16:39:54 | I |         sum  error  = [    0.3372]
25-01-17 16:39:54 | I |         best error  = [    0.3372]
25-01-17 16:39:54 | I |     + error = [0.3372]
25-01-17 16:39:55 | I |       - range scale = [    1.0000]
25-01-17 16:39:55 | I |         sum  error  = [    3.1270]
25-01-17 16:39:55 | I |         best error  = [    3.1270]
25-01-17 16:39:55 | I |     + error = [3.1270]
25-01-17 16:39:55 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:39:56 | I |       - range scale = [    1.0000]
25-01-17 16:39:56 | I |         sum  error  = [    0.6312]
25-01-17 16:39:56 | I |         best error  = [    0.6312]
25-01-17 16:39:56 | I |     + error = [0.6312]
25-01-17 16:39:56 | I |       - range scale = [    1.0000]
25-01-17 16:39:56 | I |         sum  error  = [    6.9866]
25-01-17 16:39:56 | I |         best error  = [    6.9866]
25-01-17 16:39:56 | I |     + error = [6.9866]
25-01-17 16:39:57 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:39:57 | I |       - range scale = [    1.0000]
25-01-17 16:39:57 | I |         sum  error  = [    0.1071]
25-01-17 16:39:57 | I |         best error  = [    0.1071]
25-01-17 16:39:57 | I |     + error = [0.1071]
25-01-17 16:39:58 | I |       - range scale = [    1.0000]
25-01-17 16:39:58 | I |         sum  error  = [    1.1762]
25-01-17 16:39:58 | I |         best error  = [    1.1762]
25-01-17 16:39:58 | I |     + error = [1.1762]
25-01-17 16:39:58 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:39:59 | I |       - range scale = [    1.0000]
25-01-17 16:39:59 | I |         sum  error  = [    2.0365]
25-01-17 16:39:59 | I |         best error  = [    2.0365]
25-01-17 16:39:59 | I |     + error = [2.0365]
25-01-17 16:40:00 | I |       - range scale = [    1.0000]
25-01-17 16:40:00 | I |         sum  error  = [   22.8826]
25-01-17 16:40:00 | I |         best error  = [   22.8826]
25-01-17 16:40:00 | I |     + error = [22.8826]
25-01-17 16:40:00 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:40:00 | I |       - range scale = [    1.0000]
25-01-17 16:40:00 | I |         sum  error  = [    2.2292]
25-01-17 16:40:00 | I |         best error  = [    2.2292]
25-01-17 16:40:00 | I |     + error = [2.2292]
25-01-17 16:40:01 | I |       - range scale = [    1.0000]
25-01-17 16:40:01 | I |         sum  error  = [   25.0075]
25-01-17 16:40:01 | I |         best error  = [   25.0075]
25-01-17 16:40:01 | I |     + error = [25.0075]
25-01-17 16:40:01 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:40:02 | I |       - range scale = [    1.0000]
25-01-17 16:40:02 | I |         sum  error  = [    0.1773]
25-01-17 16:40:02 | I |         best error  = [    0.1773]
25-01-17 16:40:02 | I |     + error = [0.1773]
25-01-17 16:40:03 | I |       - range scale = [    1.0000]
25-01-17 16:40:03 | I |         sum  error  = [    1.8111]
25-01-17 16:40:03 | I |         best error  = [    1.8111]
25-01-17 16:40:03 | I |     + error = [1.8111]
25-01-17 16:40:03 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:40:04 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:40:06 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:40:07 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:40:08 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:40:10 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:40:11 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:40:15 | I | quantizing activations for layer model.layers.4
25-01-17 16:40:15 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:15 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:15 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:15 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:17 | I | forward this layer
25-01-17 16:40:17 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/30.pt
25-01-17 16:40:17 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/30.pt
25-01-17 16:40:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:40:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:40:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:40:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:40:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:40:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:40:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:40:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:40:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:40:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:40:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:40:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:40:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:40:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:40:17 | I | in layer model.layers.4
25-01-17 16:40:17 | I | quantizing weights for layer model.layers.4
25-01-17 16:40:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:18 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:40:18 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:40:19 | I |       - range scale = [    1.0000]
25-01-17 16:40:19 | I |         sum  error  = [    0.5770]
25-01-17 16:40:19 | I |         best error  = [    0.5770]
25-01-17 16:40:19 | I |     + error = [0.5770]
25-01-17 16:40:20 | I |       - range scale = [    1.0000]
25-01-17 16:40:20 | I |         sum  error  = [    4.9506]
25-01-17 16:40:20 | I |         best error  = [    4.9506]
25-01-17 16:40:20 | I |     + error = [4.9506]
25-01-17 16:40:20 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:40:21 | I |       - range scale = [    1.0000]
25-01-17 16:40:21 | I |         sum  error  = [    0.3200]
25-01-17 16:40:21 | I |         best error  = [    0.3200]
25-01-17 16:40:21 | I |     + error = [0.3200]
25-01-17 16:40:21 | I |       - range scale = [    1.0000]
25-01-17 16:40:21 | I |         sum  error  = [    2.3778]
25-01-17 16:40:21 | I |         best error  = [    2.3778]
25-01-17 16:40:21 | I |     + error = [2.3778]
25-01-17 16:40:22 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:40:22 | I |       - range scale = [    1.0000]
25-01-17 16:40:22 | I |         sum  error  = [    0.6266]
25-01-17 16:40:22 | I |         best error  = [    0.6266]
25-01-17 16:40:22 | I |     + error = [0.6266]
25-01-17 16:40:23 | I |       - range scale = [    1.0000]
25-01-17 16:40:23 | I |         sum  error  = [    6.9157]
25-01-17 16:40:23 | I |         best error  = [    6.9157]
25-01-17 16:40:23 | I |     + error = [6.9157]
25-01-17 16:40:23 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:40:24 | I |       - range scale = [    1.0000]
25-01-17 16:40:24 | I |         sum  error  = [    0.1048]
25-01-17 16:40:24 | I |         best error  = [    0.1048]
25-01-17 16:40:24 | I |     + error = [0.1048]
25-01-17 16:40:24 | I |       - range scale = [    1.0000]
25-01-17 16:40:24 | I |         sum  error  = [    1.1508]
25-01-17 16:40:24 | I |         best error  = [    1.1508]
25-01-17 16:40:24 | I |     + error = [1.1508]
25-01-17 16:40:25 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:40:25 | I |       - range scale = [    1.0000]
25-01-17 16:40:25 | I |         sum  error  = [    2.0150]
25-01-17 16:40:25 | I |         best error  = [    2.0150]
25-01-17 16:40:25 | I |     + error = [2.0150]
25-01-17 16:40:26 | I |       - range scale = [    1.0000]
25-01-17 16:40:26 | I |         sum  error  = [   22.6607]
25-01-17 16:40:26 | I |         best error  = [   22.6607]
25-01-17 16:40:26 | I |     + error = [22.6607]
25-01-17 16:40:26 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:40:27 | I |       - range scale = [    1.0000]
25-01-17 16:40:27 | I |         sum  error  = [    2.2026]
25-01-17 16:40:27 | I |         best error  = [    2.2026]
25-01-17 16:40:27 | I |     + error = [2.2026]
25-01-17 16:40:28 | I |       - range scale = [    1.0000]
25-01-17 16:40:28 | I |         sum  error  = [   24.7487]
25-01-17 16:40:28 | I |         best error  = [   24.7487]
25-01-17 16:40:28 | I |     + error = [24.7487]
25-01-17 16:40:28 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:40:29 | I |       - range scale = [    1.0000]
25-01-17 16:40:29 | I |         sum  error  = [    0.1768]
25-01-17 16:40:29 | I |         best error  = [    0.1768]
25-01-17 16:40:29 | I |     + error = [0.1768]
25-01-17 16:40:29 | I |       - range scale = [    1.0000]
25-01-17 16:40:29 | I |         sum  error  = [    1.8019]
25-01-17 16:40:29 | I |         best error  = [    1.8019]
25-01-17 16:40:29 | I |     + error = [1.8019]
25-01-17 16:40:29 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:40:31 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:40:32 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:40:34 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:40:35 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:40:36 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:40:38 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:40:41 | I | quantizing activations for layer model.layers.4
25-01-17 16:40:41 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:42 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:42 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:42 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:44 | I | forward this layer
25-01-17 16:40:44 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/31.pt
25-01-17 16:40:44 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/31.pt
25-01-17 16:40:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:40:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:40:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:40:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:40:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:40:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:40:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:40:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:40:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:40:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:40:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:40:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:40:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:40:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:40:44 | I | [9] done with optimizer step
25-01-17 16:40:44 | I | epoch 001:     16 / 409600000 loss=1.6327e-05, loss_per_token=0.0334378, loss_sum=1095.69, wps=614.8, ups=0.02, wpb=32768, bsz=64, num_updates=10, lr=3e-05, gnorm=0.439, clip=0, loss_scale=2, train_wall=53, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=1260
25-01-17 16:40:44 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:40:44 | I | in layer model.layers.4
25-01-17 16:40:44 | I | quantizing weights for layer model.layers.4
25-01-17 16:40:44 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:45 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:45 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:45 | I | collecting calibration activations in model.layers.4
25-01-17 16:40:45 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:40:45 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:40:46 | I |       - range scale = [    1.0000]
25-01-17 16:40:46 | I |         sum  error  = [    0.5710]
25-01-17 16:40:46 | I |         best error  = [    0.5710]
25-01-17 16:40:46 | I |     + error = [0.5710]
25-01-17 16:40:46 | I |       - range scale = [    1.0000]
25-01-17 16:40:46 | I |         sum  error  = [    4.9764]
25-01-17 16:40:46 | I |         best error  = [    4.9764]
25-01-17 16:40:46 | I |     + error = [4.9764]
25-01-17 16:40:47 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:40:47 | I |       - range scale = [    1.0000]
25-01-17 16:40:47 | I |         sum  error  = [    0.2893]
25-01-17 16:40:47 | I |         best error  = [    0.2893]
25-01-17 16:40:47 | I |     + error = [0.2893]
25-01-17 16:40:48 | I |       - range scale = [    1.0000]
25-01-17 16:40:48 | I |         sum  error  = [    2.4435]
25-01-17 16:40:48 | I |         best error  = [    2.4435]
25-01-17 16:40:48 | I |     + error = [2.4435]
25-01-17 16:40:48 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:40:49 | I |       - range scale = [    1.0000]
25-01-17 16:40:49 | I |         sum  error  = [    0.6291]
25-01-17 16:40:49 | I |         best error  = [    0.6291]
25-01-17 16:40:49 | I |     + error = [0.6291]
25-01-17 16:40:49 | I |       - range scale = [    1.0000]
25-01-17 16:40:49 | I |         sum  error  = [    6.9225]
25-01-17 16:40:49 | I |         best error  = [    6.9225]
25-01-17 16:40:49 | I |     + error = [6.9225]
25-01-17 16:40:50 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:40:50 | I |       - range scale = [    1.0000]
25-01-17 16:40:50 | I |         sum  error  = [    0.1034]
25-01-17 16:40:50 | I |         best error  = [    0.1034]
25-01-17 16:40:50 | I |     + error = [0.1034]
25-01-17 16:40:51 | I |       - range scale = [    1.0000]
25-01-17 16:40:51 | I |         sum  error  = [    1.1143]
25-01-17 16:40:51 | I |         best error  = [    1.1143]
25-01-17 16:40:51 | I |     + error = [1.1143]
25-01-17 16:40:51 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:40:52 | I |       - range scale = [    1.0000]
25-01-17 16:40:52 | I |         sum  error  = [    1.9976]
25-01-17 16:40:52 | I |         best error  = [    1.9976]
25-01-17 16:40:52 | I |     + error = [1.9976]
25-01-17 16:40:53 | I |       - range scale = [    1.0000]
25-01-17 16:40:53 | I |         sum  error  = [   22.4502]
25-01-17 16:40:53 | I |         best error  = [   22.4502]
25-01-17 16:40:53 | I |     + error = [22.4502]
25-01-17 16:40:53 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:40:53 | I |       - range scale = [    1.0000]
25-01-17 16:40:53 | I |         sum  error  = [    2.1840]
25-01-17 16:40:53 | I |         best error  = [    2.1840]
25-01-17 16:40:53 | I |     + error = [2.1840]
25-01-17 16:40:54 | I |       - range scale = [    1.0000]
25-01-17 16:40:54 | I |         sum  error  = [   24.5056]
25-01-17 16:40:54 | I |         best error  = [   24.5056]
25-01-17 16:40:54 | I |     + error = [24.5056]
25-01-17 16:40:54 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:40:55 | I |       - range scale = [    1.0000]
25-01-17 16:40:55 | I |         sum  error  = [    0.1655]
25-01-17 16:40:55 | I |         best error  = [    0.1655]
25-01-17 16:40:55 | I |     + error = [0.1655]
25-01-17 16:40:56 | I |       - range scale = [    1.0000]
25-01-17 16:40:56 | I |         sum  error  = [    1.6900]
25-01-17 16:40:56 | I |         best error  = [    1.6900]
25-01-17 16:40:56 | I |     + error = [1.6900]
25-01-17 16:40:56 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:40:57 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:40:59 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:41:00 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:41:01 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:41:03 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:41:04 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:41:07 | I | quantizing activations for layer model.layers.4
25-01-17 16:41:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:10 | I | forward this layer
25-01-17 16:41:10 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/32.pt
25-01-17 16:41:10 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/32.pt
25-01-17 16:41:10 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:41:10 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:41:10 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:41:10 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:41:10 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:41:10 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:41:10 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:41:10 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:41:10 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:41:10 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:41:10 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:41:10 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:41:10 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:41:10 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:41:10 | I | in layer model.layers.4
25-01-17 16:41:10 | I | quantizing weights for layer model.layers.4
25-01-17 16:41:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:11 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:41:11 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:41:12 | I |       - range scale = [    1.0000]
25-01-17 16:41:12 | I |         sum  error  = [    0.5629]
25-01-17 16:41:12 | I |         best error  = [    0.5629]
25-01-17 16:41:12 | I |     + error = [0.5629]
25-01-17 16:41:12 | I |       - range scale = [    1.0000]
25-01-17 16:41:12 | I |         sum  error  = [    5.1013]
25-01-17 16:41:12 | I |         best error  = [    5.1013]
25-01-17 16:41:12 | I |     + error = [5.1013]
25-01-17 16:41:13 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:41:13 | I |       - range scale = [    1.0000]
25-01-17 16:41:13 | I |         sum  error  = [    0.2937]
25-01-17 16:41:13 | I |         best error  = [    0.2937]
25-01-17 16:41:13 | I |     + error = [0.2937]
25-01-17 16:41:14 | I |       - range scale = [    1.0000]
25-01-17 16:41:14 | I |         sum  error  = [    2.4113]
25-01-17 16:41:14 | I |         best error  = [    2.4113]
25-01-17 16:41:14 | I |     + error = [2.4113]
25-01-17 16:41:14 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:41:15 | I |       - range scale = [    1.0000]
25-01-17 16:41:15 | I |         sum  error  = [    0.6289]
25-01-17 16:41:15 | I |         best error  = [    0.6289]
25-01-17 16:41:15 | I |     + error = [0.6289]
25-01-17 16:41:15 | I |       - range scale = [    1.0000]
25-01-17 16:41:15 | I |         sum  error  = [    6.9217]
25-01-17 16:41:15 | I |         best error  = [    6.9217]
25-01-17 16:41:15 | I |     + error = [6.9217]
25-01-17 16:41:16 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:41:16 | I |       - range scale = [    1.0000]
25-01-17 16:41:16 | I |         sum  error  = [    0.1056]
25-01-17 16:41:16 | I |         best error  = [    0.1056]
25-01-17 16:41:16 | I |     + error = [0.1056]
25-01-17 16:41:17 | I |       - range scale = [    1.0000]
25-01-17 16:41:17 | I |         sum  error  = [    1.1258]
25-01-17 16:41:17 | I |         best error  = [    1.1258]
25-01-17 16:41:17 | I |     + error = [1.1258]
25-01-17 16:41:17 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:41:18 | I |       - range scale = [    1.0000]
25-01-17 16:41:18 | I |         sum  error  = [    1.9901]
25-01-17 16:41:18 | I |         best error  = [    1.9901]
25-01-17 16:41:18 | I |     + error = [1.9901]
25-01-17 16:41:19 | I |       - range scale = [    1.0000]
25-01-17 16:41:19 | I |         sum  error  = [   22.3521]
25-01-17 16:41:19 | I |         best error  = [   22.3521]
25-01-17 16:41:19 | I |     + error = [22.3521]
25-01-17 16:41:19 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:41:19 | I |       - range scale = [    1.0000]
25-01-17 16:41:19 | I |         sum  error  = [    2.1737]
25-01-17 16:41:19 | I |         best error  = [    2.1737]
25-01-17 16:41:19 | I |     + error = [2.1737]
25-01-17 16:41:20 | I |       - range scale = [    1.0000]
25-01-17 16:41:20 | I |         sum  error  = [   24.3968]
25-01-17 16:41:20 | I |         best error  = [   24.3968]
25-01-17 16:41:20 | I |     + error = [24.3968]
25-01-17 16:41:20 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:41:21 | I |       - range scale = [    1.0000]
25-01-17 16:41:21 | I |         sum  error  = [    0.1659]
25-01-17 16:41:21 | I |         best error  = [    0.1659]
25-01-17 16:41:21 | I |     + error = [0.1659]
25-01-17 16:41:22 | I |       - range scale = [    1.0000]
25-01-17 16:41:22 | I |         sum  error  = [    1.6978]
25-01-17 16:41:22 | I |         best error  = [    1.6978]
25-01-17 16:41:22 | I |     + error = [1.6978]
25-01-17 16:41:22 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:41:23 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:41:25 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:41:26 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:41:27 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:41:29 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:41:30 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:41:33 | I | quantizing activations for layer model.layers.4
25-01-17 16:41:34 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:34 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:34 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:34 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:36 | I | forward this layer
25-01-17 16:41:36 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/33.pt
25-01-17 16:41:36 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/33.pt
25-01-17 16:41:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:41:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:41:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:41:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:41:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:41:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:41:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:41:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:41:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:41:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:41:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:41:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:41:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:41:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:41:36 | I | [10] done with optimizer step
25-01-17 16:41:36 | I | epoch 001:     17 / 409600000 loss=1.43229e-05, loss_per_token=0.0293332, loss_sum=961.19, wps=627.6, ups=0.02, wpb=32768, bsz=64, num_updates=11, lr=3.3e-05, gnorm=0.264, clip=0, loss_scale=2, train_wall=52, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=1312
25-01-17 16:41:36 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:41:36 | I | in layer model.layers.4
25-01-17 16:41:36 | I | quantizing weights for layer model.layers.4
25-01-17 16:41:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:41:37 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:41:37 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:41:38 | I |       - range scale = [    1.0000]
25-01-17 16:41:38 | I |         sum  error  = [    0.5534]
25-01-17 16:41:38 | I |         best error  = [    0.5534]
25-01-17 16:41:38 | I |     + error = [0.5534]
25-01-17 16:41:39 | I |       - range scale = [    1.0000]
25-01-17 16:41:39 | I |         sum  error  = [    4.9609]
25-01-17 16:41:39 | I |         best error  = [    4.9609]
25-01-17 16:41:39 | I |     + error = [4.9609]
25-01-17 16:41:39 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:41:39 | I |       - range scale = [    1.0000]
25-01-17 16:41:39 | I |         sum  error  = [    0.2823]
25-01-17 16:41:39 | I |         best error  = [    0.2823]
25-01-17 16:41:39 | I |     + error = [0.2823]
25-01-17 16:41:40 | I |       - range scale = [    1.0000]
25-01-17 16:41:40 | I |         sum  error  = [    2.3654]
25-01-17 16:41:40 | I |         best error  = [    2.3654]
25-01-17 16:41:40 | I |     + error = [2.3654]
25-01-17 16:41:40 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:41:41 | I |       - range scale = [    1.0000]
25-01-17 16:41:41 | I |         sum  error  = [    0.6269]
25-01-17 16:41:41 | I |         best error  = [    0.6269]
25-01-17 16:41:41 | I |     + error = [0.6269]
25-01-17 16:41:42 | I |       - range scale = [    1.0000]
25-01-17 16:41:42 | I |         sum  error  = [    6.9001]
25-01-17 16:41:42 | I |         best error  = [    6.9001]
25-01-17 16:41:42 | I |     + error = [6.9001]
25-01-17 16:41:42 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:41:42 | I |       - range scale = [    1.0000]
25-01-17 16:41:42 | I |         sum  error  = [    0.1027]
25-01-17 16:41:42 | I |         best error  = [    0.1027]
25-01-17 16:41:42 | I |     + error = [0.1027]
25-01-17 16:41:43 | I |       - range scale = [    1.0000]
25-01-17 16:41:43 | I |         sum  error  = [    1.0999]
25-01-17 16:41:43 | I |         best error  = [    1.0999]
25-01-17 16:41:43 | I |     + error = [1.0999]
25-01-17 16:41:43 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:41:44 | I |       - range scale = [    1.0000]
25-01-17 16:41:44 | I |         sum  error  = [    1.9808]
25-01-17 16:41:44 | I |         best error  = [    1.9808]
25-01-17 16:41:44 | I |     + error = [1.9808]
25-01-17 16:41:45 | I |       - range scale = [    1.0000]
25-01-17 16:41:45 | I |         sum  error  = [   22.2500]
25-01-17 16:41:45 | I |         best error  = [   22.2500]
25-01-17 16:41:45 | I |     + error = [22.2500]
25-01-17 16:41:45 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:41:46 | I |       - range scale = [    1.0000]
25-01-17 16:41:46 | I |         sum  error  = [    2.1671]
25-01-17 16:41:46 | I |         best error  = [    2.1671]
25-01-17 16:41:46 | I |     + error = [2.1671]
25-01-17 16:41:46 | I |       - range scale = [    1.0000]
25-01-17 16:41:46 | I |         sum  error  = [   24.2899]
25-01-17 16:41:46 | I |         best error  = [   24.2899]
25-01-17 16:41:46 | I |     + error = [24.2899]
25-01-17 16:41:47 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:41:47 | I |       - range scale = [    1.0000]
25-01-17 16:41:47 | I |         sum  error  = [    0.1648]
25-01-17 16:41:47 | I |         best error  = [    0.1648]
25-01-17 16:41:47 | I |     + error = [0.1648]
25-01-17 16:41:48 | I |       - range scale = [    1.0000]
25-01-17 16:41:48 | I |         sum  error  = [    1.6895]
25-01-17 16:41:48 | I |         best error  = [    1.6895]
25-01-17 16:41:48 | I |     + error = [1.6895]
25-01-17 16:41:48 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:41:49 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:41:51 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:41:52 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:41:53 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:41:55 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:41:56 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:41:59 | I | quantizing activations for layer model.layers.4
25-01-17 16:42:00 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:00 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:00 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:00 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:02 | I | forward this layer
25-01-17 16:42:02 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/34.pt
25-01-17 16:42:02 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/34.pt
25-01-17 16:42:02 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:42:02 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:42:02 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:42:02 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:42:02 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:42:02 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:42:02 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:42:02 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:42:02 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:42:02 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:42:02 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:42:02 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:42:02 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:42:02 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:42:02 | I | in layer model.layers.4
25-01-17 16:42:02 | I | quantizing weights for layer model.layers.4
25-01-17 16:42:03 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:03 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:03 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:03 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:03 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:42:03 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:42:04 | I |       - range scale = [    1.0000]
25-01-17 16:42:04 | I |         sum  error  = [    0.5526]
25-01-17 16:42:04 | I |         best error  = [    0.5526]
25-01-17 16:42:04 | I |     + error = [0.5526]
25-01-17 16:42:04 | I |       - range scale = [    1.0000]
25-01-17 16:42:04 | I |         sum  error  = [    5.0299]
25-01-17 16:42:04 | I |         best error  = [    5.0299]
25-01-17 16:42:04 | I |     + error = [5.0299]
25-01-17 16:42:05 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:42:05 | I |       - range scale = [    1.0000]
25-01-17 16:42:05 | I |         sum  error  = [    0.2848]
25-01-17 16:42:05 | I |         best error  = [    0.2848]
25-01-17 16:42:05 | I |     + error = [0.2848]
25-01-17 16:42:06 | I |       - range scale = [    1.0000]
25-01-17 16:42:06 | I |         sum  error  = [    2.3948]
25-01-17 16:42:06 | I |         best error  = [    2.3948]
25-01-17 16:42:06 | I |     + error = [2.3948]
25-01-17 16:42:06 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:42:07 | I |       - range scale = [    1.0000]
25-01-17 16:42:07 | I |         sum  error  = [    0.6226]
25-01-17 16:42:07 | I |         best error  = [    0.6226]
25-01-17 16:42:07 | I |     + error = [0.6226]
25-01-17 16:42:08 | I |       - range scale = [    1.0000]
25-01-17 16:42:08 | I |         sum  error  = [    6.9074]
25-01-17 16:42:08 | I |         best error  = [    6.9074]
25-01-17 16:42:08 | I |     + error = [6.9074]
25-01-17 16:42:08 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:42:08 | I |       - range scale = [    1.0000]
25-01-17 16:42:08 | I |         sum  error  = [    0.1006]
25-01-17 16:42:08 | I |         best error  = [    0.1006]
25-01-17 16:42:08 | I |     + error = [0.1006]
25-01-17 16:42:09 | I |       - range scale = [    1.0000]
25-01-17 16:42:09 | I |         sum  error  = [    1.0767]
25-01-17 16:42:09 | I |         best error  = [    1.0767]
25-01-17 16:42:09 | I |     + error = [1.0767]
25-01-17 16:42:09 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:42:10 | I |       - range scale = [    1.0000]
25-01-17 16:42:10 | I |         sum  error  = [    1.9842]
25-01-17 16:42:10 | I |         best error  = [    1.9842]
25-01-17 16:42:10 | I |     + error = [1.9842]
25-01-17 16:42:11 | I |       - range scale = [    1.0000]
25-01-17 16:42:11 | I |         sum  error  = [   22.2762]
25-01-17 16:42:11 | I |         best error  = [   22.2762]
25-01-17 16:42:11 | I |     + error = [22.2762]
25-01-17 16:42:11 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:42:11 | I |       - range scale = [    1.0000]
25-01-17 16:42:11 | I |         sum  error  = [    2.1677]
25-01-17 16:42:11 | I |         best error  = [    2.1677]
25-01-17 16:42:11 | I |     + error = [2.1677]
25-01-17 16:42:12 | I |       - range scale = [    1.0000]
25-01-17 16:42:12 | I |         sum  error  = [   24.3187]
25-01-17 16:42:12 | I |         best error  = [   24.3187]
25-01-17 16:42:12 | I |     + error = [24.3187]
25-01-17 16:42:12 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:42:13 | I |       - range scale = [    1.0000]
25-01-17 16:42:13 | I |         sum  error  = [    0.1649]
25-01-17 16:42:13 | I |         best error  = [    0.1649]
25-01-17 16:42:13 | I |     + error = [0.1649]
25-01-17 16:42:14 | I |       - range scale = [    1.0000]
25-01-17 16:42:14 | I |         sum  error  = [    1.6889]
25-01-17 16:42:14 | I |         best error  = [    1.6889]
25-01-17 16:42:14 | I |     + error = [1.6889]
25-01-17 16:42:14 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:42:15 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:42:17 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:42:18 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:42:19 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:42:21 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:42:22 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:42:25 | I | quantizing activations for layer model.layers.4
25-01-17 16:42:26 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:26 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:26 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:26 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:28 | I | forward this layer
25-01-17 16:42:28 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/35.pt
25-01-17 16:42:28 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/35.pt
25-01-17 16:42:28 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:42:28 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:42:28 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:42:28 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:42:28 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:42:28 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:42:28 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:42:28 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:42:28 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:42:28 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:42:28 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:42:28 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:42:28 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:42:28 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:42:28 | I | [11] done with optimizer step
25-01-17 16:42:28 | I | epoch 001:     18 / 409600000 loss=1.36068e-05, loss_per_token=0.0278668, loss_sum=913.14, wps=629.2, ups=0.02, wpb=32768, bsz=64, num_updates=12, lr=3.6e-05, gnorm=0.393, clip=0, loss_scale=2, train_wall=52, cuda_gb_allocated=12.3, cuda_gb_reserved=13.6, cuda_gb_free=11.4, wall=1364
25-01-17 16:42:28 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:42:28 | I | in layer model.layers.4
25-01-17 16:42:28 | I | quantizing weights for layer model.layers.4
25-01-17 16:42:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:29 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:42:29 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:42:30 | I |       - range scale = [    1.0000]
25-01-17 16:42:30 | I |         sum  error  = [    0.5479]
25-01-17 16:42:30 | I |         best error  = [    0.5479]
25-01-17 16:42:30 | I |     + error = [0.5479]
25-01-17 16:42:31 | I |       - range scale = [    1.0000]
25-01-17 16:42:31 | I |         sum  error  = [    4.9378]
25-01-17 16:42:31 | I |         best error  = [    4.9378]
25-01-17 16:42:31 | I |     + error = [4.9378]
25-01-17 16:42:31 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:42:32 | I |       - range scale = [    1.0000]
25-01-17 16:42:32 | I |         sum  error  = [    0.2793]
25-01-17 16:42:32 | I |         best error  = [    0.2793]
25-01-17 16:42:32 | I |     + error = [0.2793]
25-01-17 16:42:32 | I |       - range scale = [    1.0000]
25-01-17 16:42:32 | I |         sum  error  = [    2.3920]
25-01-17 16:42:32 | I |         best error  = [    2.3920]
25-01-17 16:42:32 | I |     + error = [2.3920]
25-01-17 16:42:32 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:42:33 | I |       - range scale = [    1.0000]
25-01-17 16:42:33 | I |         sum  error  = [    0.6213]
25-01-17 16:42:33 | I |         best error  = [    0.6213]
25-01-17 16:42:33 | I |     + error = [0.6213]
25-01-17 16:42:34 | I |       - range scale = [    1.0000]
25-01-17 16:42:34 | I |         sum  error  = [    6.8838]
25-01-17 16:42:34 | I |         best error  = [    6.8838]
25-01-17 16:42:34 | I |     + error = [6.8838]
25-01-17 16:42:34 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:42:35 | I |       - range scale = [    1.0000]
25-01-17 16:42:35 | I |         sum  error  = [    0.0997]
25-01-17 16:42:35 | I |         best error  = [    0.0997]
25-01-17 16:42:35 | I |     + error = [0.0997]
25-01-17 16:42:35 | I |       - range scale = [    1.0000]
25-01-17 16:42:35 | I |         sum  error  = [    1.0722]
25-01-17 16:42:35 | I |         best error  = [    1.0722]
25-01-17 16:42:35 | I |     + error = [1.0722]
25-01-17 16:42:35 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:42:36 | I |       - range scale = [    1.0000]
25-01-17 16:42:36 | I |         sum  error  = [    1.9893]
25-01-17 16:42:36 | I |         best error  = [    1.9893]
25-01-17 16:42:36 | I |     + error = [1.9893]
25-01-17 16:42:37 | I |       - range scale = [    1.0000]
25-01-17 16:42:37 | I |         sum  error  = [   22.3193]
25-01-17 16:42:37 | I |         best error  = [   22.3193]
25-01-17 16:42:37 | I |     + error = [22.3193]
25-01-17 16:42:37 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:42:38 | I |       - range scale = [    1.0000]
25-01-17 16:42:38 | I |         sum  error  = [    2.1710]
25-01-17 16:42:38 | I |         best error  = [    2.1710]
25-01-17 16:42:38 | I |     + error = [2.1710]
25-01-17 16:42:38 | I |       - range scale = [    1.0000]
25-01-17 16:42:38 | I |         sum  error  = [   24.3679]
25-01-17 16:42:38 | I |         best error  = [   24.3679]
25-01-17 16:42:38 | I |     + error = [24.3679]
25-01-17 16:42:39 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:42:39 | I |       - range scale = [    1.0000]
25-01-17 16:42:39 | I |         sum  error  = [    0.1662]
25-01-17 16:42:39 | I |         best error  = [    0.1662]
25-01-17 16:42:39 | I |     + error = [0.1662]
25-01-17 16:42:40 | I |       - range scale = [    1.0000]
25-01-17 16:42:40 | I |         sum  error  = [    1.7024]
25-01-17 16:42:40 | I |         best error  = [    1.7024]
25-01-17 16:42:40 | I |     + error = [1.7024]
25-01-17 16:42:40 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:42:42 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:42:43 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:42:44 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:42:46 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:42:47 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:42:48 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:42:52 | I | quantizing activations for layer model.layers.4
25-01-17 16:42:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:54 | I | forward this layer
25-01-17 16:42:54 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/36.pt
25-01-17 16:42:54 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/36.pt
25-01-17 16:42:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:42:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:42:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:42:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:42:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:42:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:42:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:42:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:42:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:42:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:42:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:42:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:42:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:42:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:42:54 | I | in layer model.layers.4
25-01-17 16:42:54 | I | quantizing weights for layer model.layers.4
25-01-17 16:42:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:55 | I | collecting calibration activations in model.layers.4
25-01-17 16:42:55 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:42:55 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:42:56 | I |       - range scale = [    1.0000]
25-01-17 16:42:56 | I |         sum  error  = [    0.5425]
25-01-17 16:42:56 | I |         best error  = [    0.5425]
25-01-17 16:42:56 | I |     + error = [0.5425]
25-01-17 16:42:57 | I |       - range scale = [    1.0000]
25-01-17 16:42:57 | I |         sum  error  = [    4.9475]
25-01-17 16:42:57 | I |         best error  = [    4.9475]
25-01-17 16:42:57 | I |     + error = [4.9475]
25-01-17 16:42:57 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:42:58 | I |       - range scale = [    1.0000]
25-01-17 16:42:58 | I |         sum  error  = [    0.2886]
25-01-17 16:42:58 | I |         best error  = [    0.2886]
25-01-17 16:42:58 | I |     + error = [0.2886]
25-01-17 16:42:58 | I |       - range scale = [    1.0000]
25-01-17 16:42:58 | I |         sum  error  = [    2.3788]
25-01-17 16:42:58 | I |         best error  = [    2.3788]
25-01-17 16:42:58 | I |     + error = [2.3788]
25-01-17 16:42:58 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:42:59 | I |       - range scale = [    1.0000]
25-01-17 16:42:59 | I |         sum  error  = [    0.6250]
25-01-17 16:42:59 | I |         best error  = [    0.6250]
25-01-17 16:42:59 | I |     + error = [0.6250]
25-01-17 16:43:00 | I |       - range scale = [    1.0000]
25-01-17 16:43:00 | I |         sum  error  = [    6.9291]
25-01-17 16:43:00 | I |         best error  = [    6.9291]
25-01-17 16:43:00 | I |     + error = [6.9291]
25-01-17 16:43:00 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:43:01 | I |       - range scale = [    1.0000]
25-01-17 16:43:01 | I |         sum  error  = [    0.1064]
25-01-17 16:43:01 | I |         best error  = [    0.1064]
25-01-17 16:43:01 | I |     + error = [0.1064]
25-01-17 16:43:01 | I |       - range scale = [    1.0000]
25-01-17 16:43:01 | I |         sum  error  = [    1.1408]
25-01-17 16:43:01 | I |         best error  = [    1.1408]
25-01-17 16:43:01 | I |     + error = [1.1408]
25-01-17 16:43:01 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:43:02 | I |       - range scale = [    1.0000]
25-01-17 16:43:02 | I |         sum  error  = [    1.9817]
25-01-17 16:43:02 | I |         best error  = [    1.9817]
25-01-17 16:43:02 | I |     + error = [1.9817]
25-01-17 16:43:03 | I |       - range scale = [    1.0000]
25-01-17 16:43:03 | I |         sum  error  = [   22.2516]
25-01-17 16:43:03 | I |         best error  = [   22.2516]
25-01-17 16:43:03 | I |     + error = [22.2516]
25-01-17 16:43:03 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:43:04 | I |       - range scale = [    1.0000]
25-01-17 16:43:04 | I |         sum  error  = [    2.1655]
25-01-17 16:43:04 | I |         best error  = [    2.1655]
25-01-17 16:43:04 | I |     + error = [2.1655]
25-01-17 16:43:05 | I |       - range scale = [    1.0000]
25-01-17 16:43:05 | I |         sum  error  = [   24.2844]
25-01-17 16:43:05 | I |         best error  = [   24.2844]
25-01-17 16:43:05 | I |     + error = [24.2844]
25-01-17 16:43:05 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:43:05 | I |       - range scale = [    1.0000]
25-01-17 16:43:05 | I |         sum  error  = [    0.1637]
25-01-17 16:43:05 | I |         best error  = [    0.1637]
25-01-17 16:43:05 | I |     + error = [0.1637]
25-01-17 16:43:06 | I |       - range scale = [    1.0000]
25-01-17 16:43:06 | I |         sum  error  = [    1.6765]
25-01-17 16:43:06 | I |         best error  = [    1.6765]
25-01-17 16:43:06 | I |     + error = [1.6765]
25-01-17 16:43:06 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:43:08 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:43:09 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:43:11 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:43:12 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:43:13 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:43:15 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:43:18 | I | quantizing activations for layer model.layers.4
25-01-17 16:43:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:21 | I | forward this layer
25-01-17 16:43:21 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/37.pt
25-01-17 16:43:21 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/37.pt
25-01-17 16:43:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:43:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:43:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:43:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:43:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:43:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:43:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:43:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:43:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:43:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:43:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:43:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:43:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:43:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:43:21 | I | [12] done with optimizer step
25-01-17 16:43:21 | I | epoch 001:     19 / 409600000 loss=1.30751e-05, loss_per_token=0.0267777, loss_sum=877.452, wps=619.7, ups=0.02, wpb=32768, bsz=64, num_updates=13, lr=3.9e-05, gnorm=0.195, clip=0, loss_scale=2, train_wall=53, cuda_gb_allocated=12.3, cuda_gb_reserved=13.6, cuda_gb_free=11.4, wall=1417
25-01-17 16:43:21 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:43:21 | I | in layer model.layers.4
25-01-17 16:43:21 | I | quantizing weights for layer model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:22 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:43:22 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:43:23 | I |       - range scale = [    1.0000]
25-01-17 16:43:23 | I |         sum  error  = [    0.5575]
25-01-17 16:43:23 | I |         best error  = [    0.5575]
25-01-17 16:43:23 | I |     + error = [0.5575]
25-01-17 16:43:24 | I |       - range scale = [    1.0000]
25-01-17 16:43:24 | I |         sum  error  = [    4.6885]
25-01-17 16:43:24 | I |         best error  = [    4.6885]
25-01-17 16:43:24 | I |     + error = [4.6885]
25-01-17 16:43:24 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:43:25 | I |       - range scale = [    1.0000]
25-01-17 16:43:25 | I |         sum  error  = [    0.2798]
25-01-17 16:43:25 | I |         best error  = [    0.2798]
25-01-17 16:43:25 | I |     + error = [0.2798]
25-01-17 16:43:25 | I |       - range scale = [    1.0000]
25-01-17 16:43:25 | I |         sum  error  = [    2.3025]
25-01-17 16:43:25 | I |         best error  = [    2.3025]
25-01-17 16:43:25 | I |     + error = [2.3025]
25-01-17 16:43:25 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:43:26 | I |       - range scale = [    1.0000]
25-01-17 16:43:26 | I |         sum  error  = [    0.6234]
25-01-17 16:43:26 | I |         best error  = [    0.6234]
25-01-17 16:43:26 | I |     + error = [0.6234]
25-01-17 16:43:27 | I |       - range scale = [    1.0000]
25-01-17 16:43:27 | I |         sum  error  = [    6.9801]
25-01-17 16:43:27 | I |         best error  = [    6.9801]
25-01-17 16:43:27 | I |     + error = [6.9801]
25-01-17 16:43:27 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:43:28 | I |       - range scale = [    1.0000]
25-01-17 16:43:28 | I |         sum  error  = [    0.1032]
25-01-17 16:43:28 | I |         best error  = [    0.1032]
25-01-17 16:43:28 | I |     + error = [0.1032]
25-01-17 16:43:28 | I |       - range scale = [    1.0000]
25-01-17 16:43:28 | I |         sum  error  = [    1.1242]
25-01-17 16:43:28 | I |         best error  = [    1.1242]
25-01-17 16:43:28 | I |     + error = [1.1242]
25-01-17 16:43:29 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:43:29 | I |       - range scale = [    1.0000]
25-01-17 16:43:29 | I |         sum  error  = [    1.9912]
25-01-17 16:43:29 | I |         best error  = [    1.9912]
25-01-17 16:43:29 | I |     + error = [1.9912]
25-01-17 16:43:30 | I |       - range scale = [    1.0000]
25-01-17 16:43:30 | I |         sum  error  = [   22.4071]
25-01-17 16:43:30 | I |         best error  = [   22.4071]
25-01-17 16:43:30 | I |     + error = [22.4071]
25-01-17 16:43:30 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:43:31 | I |       - range scale = [    1.0000]
25-01-17 16:43:31 | I |         sum  error  = [    2.1803]
25-01-17 16:43:31 | I |         best error  = [    2.1803]
25-01-17 16:43:31 | I |     + error = [2.1803]
25-01-17 16:43:32 | I |       - range scale = [    1.0000]
25-01-17 16:43:32 | I |         sum  error  = [   24.4662]
25-01-17 16:43:32 | I |         best error  = [   24.4662]
25-01-17 16:43:32 | I |     + error = [24.4662]
25-01-17 16:43:32 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:43:33 | I |       - range scale = [    1.0000]
25-01-17 16:43:33 | I |         sum  error  = [    0.1651]
25-01-17 16:43:33 | I |         best error  = [    0.1651]
25-01-17 16:43:33 | I |     + error = [0.1651]
25-01-17 16:43:34 | I |       - range scale = [    1.0000]
25-01-17 16:43:34 | I |         sum  error  = [    1.6821]
25-01-17 16:43:34 | I |         best error  = [    1.6821]
25-01-17 16:43:34 | I |     + error = [1.6821]
25-01-17 16:43:34 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:43:35 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:43:37 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:43:38 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:43:40 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:43:41 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:43:42 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:43:46 | I | quantizing activations for layer model.layers.4
25-01-17 16:43:46 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:46 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:46 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:48 | I | forward this layer
25-01-17 16:43:48 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/38.pt
25-01-17 16:43:48 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/38.pt
25-01-17 16:43:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:43:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:43:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:43:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:43:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:43:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:43:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:43:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:43:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:43:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:43:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:43:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:43:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:43:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:43:49 | I | in layer model.layers.4
25-01-17 16:43:49 | I | quantizing weights for layer model.layers.4
25-01-17 16:43:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:43:50 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:43:50 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:43:50 | I |       - range scale = [    1.0000]
25-01-17 16:43:50 | I |         sum  error  = [    0.5803]
25-01-17 16:43:50 | I |         best error  = [    0.5803]
25-01-17 16:43:50 | I |     + error = [0.5803]
25-01-17 16:43:51 | I |       - range scale = [    1.0000]
25-01-17 16:43:51 | I |         sum  error  = [    4.5256]
25-01-17 16:43:51 | I |         best error  = [    4.5256]
25-01-17 16:43:51 | I |     + error = [4.5256]
25-01-17 16:43:51 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:43:52 | I |       - range scale = [    1.0000]
25-01-17 16:43:52 | I |         sum  error  = [    0.2746]
25-01-17 16:43:52 | I |         best error  = [    0.2746]
25-01-17 16:43:52 | I |     + error = [0.2746]
25-01-17 16:43:53 | I |       - range scale = [    1.0000]
25-01-17 16:43:53 | I |         sum  error  = [    2.2808]
25-01-17 16:43:53 | I |         best error  = [    2.2808]
25-01-17 16:43:53 | I |     + error = [2.2808]
25-01-17 16:43:53 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:43:54 | I |       - range scale = [    1.0000]
25-01-17 16:43:54 | I |         sum  error  = [    0.6177]
25-01-17 16:43:54 | I |         best error  = [    0.6177]
25-01-17 16:43:54 | I |     + error = [0.6177]
25-01-17 16:43:54 | I |       - range scale = [    1.0000]
25-01-17 16:43:54 | I |         sum  error  = [    6.8920]
25-01-17 16:43:54 | I |         best error  = [    6.8920]
25-01-17 16:43:54 | I |     + error = [6.8920]
25-01-17 16:43:55 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:43:55 | I |       - range scale = [    1.0000]
25-01-17 16:43:55 | I |         sum  error  = [    0.1046]
25-01-17 16:43:55 | I |         best error  = [    0.1046]
25-01-17 16:43:55 | I |     + error = [0.1046]
25-01-17 16:43:56 | I |       - range scale = [    1.0000]
25-01-17 16:43:56 | I |         sum  error  = [    1.1331]
25-01-17 16:43:56 | I |         best error  = [    1.1331]
25-01-17 16:43:56 | I |     + error = [1.1331]
25-01-17 16:43:56 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:43:57 | I |       - range scale = [    1.0000]
25-01-17 16:43:57 | I |         sum  error  = [    2.0095]
25-01-17 16:43:57 | I |         best error  = [    2.0095]
25-01-17 16:43:57 | I |     + error = [2.0095]
25-01-17 16:43:58 | I |       - range scale = [    1.0000]
25-01-17 16:43:58 | I |         sum  error  = [   22.5789]
25-01-17 16:43:58 | I |         best error  = [   22.5789]
25-01-17 16:43:58 | I |     + error = [22.5789]
25-01-17 16:43:58 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:43:58 | I |       - range scale = [    1.0000]
25-01-17 16:43:58 | I |         sum  error  = [    2.1991]
25-01-17 16:43:58 | I |         best error  = [    2.1991]
25-01-17 16:43:58 | I |     + error = [2.1991]
25-01-17 16:43:59 | I |       - range scale = [    1.0000]
25-01-17 16:43:59 | I |         sum  error  = [   24.6590]
25-01-17 16:43:59 | I |         best error  = [   24.6590]
25-01-17 16:43:59 | I |     + error = [24.6590]
25-01-17 16:43:59 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:44:00 | I |       - range scale = [    1.0000]
25-01-17 16:44:00 | I |         sum  error  = [    0.1748]
25-01-17 16:44:00 | I |         best error  = [    0.1748]
25-01-17 16:44:00 | I |     + error = [0.1748]
25-01-17 16:44:01 | I |       - range scale = [    1.0000]
25-01-17 16:44:01 | I |         sum  error  = [    1.7885]
25-01-17 16:44:01 | I |         best error  = [    1.7885]
25-01-17 16:44:01 | I |     + error = [1.7885]
25-01-17 16:44:01 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:44:02 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:44:04 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:44:05 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:44:07 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:44:08 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:44:09 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:44:13 | I | quantizing activations for layer model.layers.4
25-01-17 16:44:13 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:13 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:13 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:13 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:15 | I | forward this layer
25-01-17 16:44:15 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/39.pt
25-01-17 16:44:15 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/39.pt
25-01-17 16:44:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:44:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:44:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:44:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:44:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:44:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:44:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:44:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:44:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:44:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:44:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:44:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:44:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:44:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:44:15 | I | [13] done with optimizer step
25-01-17 16:44:15 | I | epoch 001:     20 / 409600000 loss=1.65292e-05, loss_per_token=0.0338518, loss_sum=1109.26, wps=603, ups=0.02, wpb=32768, bsz=64, num_updates=14, lr=4.2e-05, gnorm=0.788, clip=0, loss_scale=2, train_wall=54, cuda_gb_allocated=12.3, cuda_gb_reserved=13.6, cuda_gb_free=11.4, wall=1471
25-01-17 16:44:16 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:44:16 | I | in layer model.layers.4
25-01-17 16:44:16 | I | quantizing weights for layer model.layers.4
25-01-17 16:44:16 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:16 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:16 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:16 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:17 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:44:17 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:44:17 | I |       - range scale = [    1.0000]
25-01-17 16:44:17 | I |         sum  error  = [    0.5581]
25-01-17 16:44:17 | I |         best error  = [    0.5581]
25-01-17 16:44:17 | I |     + error = [0.5581]
25-01-17 16:44:18 | I |       - range scale = [    1.0000]
25-01-17 16:44:18 | I |         sum  error  = [    4.4056]
25-01-17 16:44:18 | I |         best error  = [    4.4056]
25-01-17 16:44:18 | I |     + error = [4.4056]
25-01-17 16:44:18 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:44:19 | I |       - range scale = [    1.0000]
25-01-17 16:44:19 | I |         sum  error  = [    0.2634]
25-01-17 16:44:19 | I |         best error  = [    0.2634]
25-01-17 16:44:19 | I |     + error = [0.2634]
25-01-17 16:44:20 | I |       - range scale = [    1.0000]
25-01-17 16:44:20 | I |         sum  error  = [    2.1389]
25-01-17 16:44:20 | I |         best error  = [    2.1389]
25-01-17 16:44:20 | I |     + error = [2.1389]
25-01-17 16:44:20 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:44:20 | I |       - range scale = [    1.0000]
25-01-17 16:44:20 | I |         sum  error  = [    0.6223]
25-01-17 16:44:20 | I |         best error  = [    0.6223]
25-01-17 16:44:20 | I |     + error = [0.6223]
25-01-17 16:44:21 | I |       - range scale = [    1.0000]
25-01-17 16:44:21 | I |         sum  error  = [    6.8693]
25-01-17 16:44:21 | I |         best error  = [    6.8693]
25-01-17 16:44:21 | I |     + error = [6.8693]
25-01-17 16:44:21 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:44:22 | I |       - range scale = [    1.0000]
25-01-17 16:44:22 | I |         sum  error  = [    0.0908]
25-01-17 16:44:22 | I |         best error  = [    0.0908]
25-01-17 16:44:22 | I |     + error = [0.0908]
25-01-17 16:44:23 | I |       - range scale = [    1.0000]
25-01-17 16:44:23 | I |         sum  error  = [    0.9941]
25-01-17 16:44:23 | I |         best error  = [    0.9941]
25-01-17 16:44:23 | I |     + error = [0.9941]
25-01-17 16:44:23 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:44:24 | I |       - range scale = [    1.0000]
25-01-17 16:44:24 | I |         sum  error  = [    2.0267]
25-01-17 16:44:24 | I |         best error  = [    2.0267]
25-01-17 16:44:24 | I |     + error = [2.0267]
25-01-17 16:44:24 | I |       - range scale = [    1.0000]
25-01-17 16:44:24 | I |         sum  error  = [   22.7691]
25-01-17 16:44:24 | I |         best error  = [   22.7691]
25-01-17 16:44:24 | I |     + error = [22.7691]
25-01-17 16:44:25 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:44:25 | I |       - range scale = [    1.0000]
25-01-17 16:44:25 | I |         sum  error  = [    2.2137]
25-01-17 16:44:25 | I |         best error  = [    2.2137]
25-01-17 16:44:25 | I |     + error = [2.2137]
25-01-17 16:44:26 | I |       - range scale = [    1.0000]
25-01-17 16:44:26 | I |         sum  error  = [   24.8662]
25-01-17 16:44:26 | I |         best error  = [   24.8662]
25-01-17 16:44:26 | I |     + error = [24.8662]
25-01-17 16:44:26 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:44:27 | I |       - range scale = [    1.0000]
25-01-17 16:44:27 | I |         sum  error  = [    0.1756]
25-01-17 16:44:27 | I |         best error  = [    0.1756]
25-01-17 16:44:27 | I |     + error = [0.1756]
25-01-17 16:44:28 | I |       - range scale = [    1.0000]
25-01-17 16:44:28 | I |         sum  error  = [    1.8021]
25-01-17 16:44:28 | I |         best error  = [    1.8021]
25-01-17 16:44:28 | I |     + error = [1.8021]
25-01-17 16:44:28 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:44:30 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:44:31 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:44:33 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:44:35 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:44:37 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:44:38 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:44:43 | I | quantizing activations for layer model.layers.4
25-01-17 16:44:43 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:43 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:44 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:44 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:46 | I | forward this layer
25-01-17 16:44:46 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/40.pt
25-01-17 16:44:46 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/40.pt
25-01-17 16:44:46 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:44:46 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:44:46 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:44:46 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:44:46 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:44:46 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:44:46 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:44:46 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:44:46 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:44:46 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:44:46 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:44:46 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:44:46 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:44:46 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:44:46 | I | in layer model.layers.4
25-01-17 16:44:46 | I | quantizing weights for layer model.layers.4
25-01-17 16:44:46 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:46 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:44:47 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:44:47 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:44:48 | I |       - range scale = [    1.0000]
25-01-17 16:44:48 | I |         sum  error  = [    0.5407]
25-01-17 16:44:48 | I |         best error  = [    0.5407]
25-01-17 16:44:48 | I |     + error = [0.5407]
25-01-17 16:44:48 | I |       - range scale = [    1.0000]
25-01-17 16:44:48 | I |         sum  error  = [    4.3081]
25-01-17 16:44:48 | I |         best error  = [    4.3081]
25-01-17 16:44:48 | I |     + error = [4.3081]
25-01-17 16:44:49 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:44:49 | I |       - range scale = [    1.0000]
25-01-17 16:44:49 | I |         sum  error  = [    0.2607]
25-01-17 16:44:49 | I |         best error  = [    0.2607]
25-01-17 16:44:49 | I |     + error = [0.2607]
25-01-17 16:44:50 | I |       - range scale = [    1.0000]
25-01-17 16:44:50 | I |         sum  error  = [    2.1812]
25-01-17 16:44:50 | I |         best error  = [    2.1812]
25-01-17 16:44:50 | I |     + error = [2.1812]
25-01-17 16:44:50 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:44:51 | I |       - range scale = [    1.0000]
25-01-17 16:44:51 | I |         sum  error  = [    0.6174]
25-01-17 16:44:51 | I |         best error  = [    0.6174]
25-01-17 16:44:51 | I |     + error = [0.6174]
25-01-17 16:44:52 | I |       - range scale = [    1.0000]
25-01-17 16:44:52 | I |         sum  error  = [    6.8232]
25-01-17 16:44:52 | I |         best error  = [    6.8232]
25-01-17 16:44:52 | I |     + error = [6.8232]
25-01-17 16:44:52 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:44:53 | I |       - range scale = [    1.0000]
25-01-17 16:44:53 | I |         sum  error  = [    0.1035]
25-01-17 16:44:53 | I |         best error  = [    0.1035]
25-01-17 16:44:53 | I |     + error = [0.1035]
25-01-17 16:44:54 | I |       - range scale = [    1.0000]
25-01-17 16:44:54 | I |         sum  error  = [    1.1254]
25-01-17 16:44:54 | I |         best error  = [    1.1254]
25-01-17 16:44:54 | I |     + error = [1.1254]
25-01-17 16:44:54 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:44:55 | I |       - range scale = [    1.0000]
25-01-17 16:44:55 | I |         sum  error  = [    1.9977]
25-01-17 16:44:55 | I |         best error  = [    1.9977]
25-01-17 16:44:55 | I |     + error = [1.9977]
25-01-17 16:44:55 | I |       - range scale = [    1.0000]
25-01-17 16:44:55 | I |         sum  error  = [   22.4598]
25-01-17 16:44:55 | I |         best error  = [   22.4598]
25-01-17 16:44:55 | I |     + error = [22.4598]
25-01-17 16:44:56 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:44:56 | I |       - range scale = [    1.0000]
25-01-17 16:44:56 | I |         sum  error  = [    2.1843]
25-01-17 16:44:56 | I |         best error  = [    2.1843]
25-01-17 16:44:56 | I |     + error = [2.1843]
25-01-17 16:44:57 | I |       - range scale = [    1.0000]
25-01-17 16:44:57 | I |         sum  error  = [   24.5201]
25-01-17 16:44:57 | I |         best error  = [   24.5201]
25-01-17 16:44:57 | I |     + error = [24.5201]
25-01-17 16:44:57 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:44:58 | I |       - range scale = [    1.0000]
25-01-17 16:44:58 | I |         sum  error  = [    0.1705]
25-01-17 16:44:58 | I |         best error  = [    0.1705]
25-01-17 16:44:58 | I |     + error = [0.1705]
25-01-17 16:44:59 | I |       - range scale = [    1.0000]
25-01-17 16:44:59 | I |         sum  error  = [    1.7385]
25-01-17 16:44:59 | I |         best error  = [    1.7385]
25-01-17 16:44:59 | I |     + error = [1.7385]
25-01-17 16:44:59 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:45:01 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:45:02 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:45:03 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:45:05 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:45:06 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:45:08 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:45:11 | I | quantizing activations for layer model.layers.4
25-01-17 16:45:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:12 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:13 | I | forward this layer
25-01-17 16:45:13 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/41.pt
25-01-17 16:45:13 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/41.pt
25-01-17 16:45:14 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:45:14 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:45:14 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:45:14 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:45:14 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:45:14 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:45:14 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:45:14 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:45:14 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:45:14 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:45:14 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:45:14 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:45:14 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:45:14 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:45:14 | I | [14] done with optimizer step
25-01-17 16:45:14 | I | epoch 001:     21 / 409600000 loss=1.63045e-05, loss_per_token=0.0333915, loss_sum=1094.17, wps=561.3, ups=0.02, wpb=32768, bsz=64, num_updates=15, lr=4.5e-05, gnorm=0.961, clip=0, loss_scale=2, train_wall=58, cuda_gb_allocated=12.3, cuda_gb_reserved=13.6, cuda_gb_free=11.4, wall=1530
25-01-17 16:45:14 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:45:14 | I | in layer model.layers.4
25-01-17 16:45:14 | I | quantizing weights for layer model.layers.4
25-01-17 16:45:14 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:15 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:15 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:15 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:15 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:45:15 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:45:16 | I |       - range scale = [    1.0000]
25-01-17 16:45:16 | I |         sum  error  = [    0.5736]
25-01-17 16:45:16 | I |         best error  = [    0.5736]
25-01-17 16:45:16 | I |     + error = [0.5736]
25-01-17 16:45:16 | I |       - range scale = [    1.0000]
25-01-17 16:45:16 | I |         sum  error  = [    4.7811]
25-01-17 16:45:16 | I |         best error  = [    4.7811]
25-01-17 16:45:16 | I |     + error = [4.7811]
25-01-17 16:45:17 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:45:17 | I |       - range scale = [    1.0000]
25-01-17 16:45:17 | I |         sum  error  = [    0.2720]
25-01-17 16:45:17 | I |         best error  = [    0.2720]
25-01-17 16:45:17 | I |     + error = [0.2720]
25-01-17 16:45:18 | I |       - range scale = [    1.0000]
25-01-17 16:45:18 | I |         sum  error  = [    2.3164]
25-01-17 16:45:18 | I |         best error  = [    2.3164]
25-01-17 16:45:18 | I |     + error = [2.3164]
25-01-17 16:45:18 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:45:19 | I |       - range scale = [    1.0000]
25-01-17 16:45:19 | I |         sum  error  = [    0.6220]
25-01-17 16:45:19 | I |         best error  = [    0.6220]
25-01-17 16:45:19 | I |     + error = [0.6220]
25-01-17 16:45:20 | I |       - range scale = [    1.0000]
25-01-17 16:45:20 | I |         sum  error  = [    6.9405]
25-01-17 16:45:20 | I |         best error  = [    6.9405]
25-01-17 16:45:20 | I |     + error = [6.9405]
25-01-17 16:45:20 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:45:21 | I |       - range scale = [    1.0000]
25-01-17 16:45:21 | I |         sum  error  = [    0.1126]
25-01-17 16:45:21 | I |         best error  = [    0.1126]
25-01-17 16:45:21 | I |     + error = [0.1126]
25-01-17 16:45:21 | I |       - range scale = [    1.0000]
25-01-17 16:45:21 | I |         sum  error  = [    1.2103]
25-01-17 16:45:21 | I |         best error  = [    1.2103]
25-01-17 16:45:21 | I |     + error = [1.2103]
25-01-17 16:45:21 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:45:22 | I |       - range scale = [    1.0000]
25-01-17 16:45:22 | I |         sum  error  = [    2.0007]
25-01-17 16:45:22 | I |         best error  = [    2.0007]
25-01-17 16:45:22 | I |     + error = [2.0007]
25-01-17 16:45:23 | I |       - range scale = [    1.0000]
25-01-17 16:45:23 | I |         sum  error  = [   22.5199]
25-01-17 16:45:23 | I |         best error  = [   22.5199]
25-01-17 16:45:23 | I |     + error = [22.5199]
25-01-17 16:45:23 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:45:24 | I |       - range scale = [    1.0000]
25-01-17 16:45:24 | I |         sum  error  = [    2.1868]
25-01-17 16:45:24 | I |         best error  = [    2.1868]
25-01-17 16:45:24 | I |     + error = [2.1868]
25-01-17 16:45:25 | I |       - range scale = [    1.0000]
25-01-17 16:45:25 | I |         sum  error  = [   24.5942]
25-01-17 16:45:25 | I |         best error  = [   24.5942]
25-01-17 16:45:25 | I |     + error = [24.5942]
25-01-17 16:45:25 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:45:25 | I |       - range scale = [    1.0000]
25-01-17 16:45:25 | I |         sum  error  = [    0.1643]
25-01-17 16:45:25 | I |         best error  = [    0.1643]
25-01-17 16:45:25 | I |     + error = [0.1643]
25-01-17 16:45:26 | I |       - range scale = [    1.0000]
25-01-17 16:45:26 | I |         sum  error  = [    1.6872]
25-01-17 16:45:26 | I |         best error  = [    1.6872]
25-01-17 16:45:26 | I |     + error = [1.6872]
25-01-17 16:45:26 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:45:28 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:45:29 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:45:31 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:45:32 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:45:33 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:45:35 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:45:38 | I | quantizing activations for layer model.layers.4
25-01-17 16:45:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:41 | I | forward this layer
25-01-17 16:45:41 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/42.pt
25-01-17 16:45:41 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/42.pt
25-01-17 16:45:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:45:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:45:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:45:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:45:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:45:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:45:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:45:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:45:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:45:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:45:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:45:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:45:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:45:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:45:41 | I | in layer model.layers.4
25-01-17 16:45:41 | I | quantizing weights for layer model.layers.4
25-01-17 16:45:42 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:42 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:42 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:42 | I | collecting calibration activations in model.layers.4
25-01-17 16:45:42 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:45:42 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:45:43 | I |       - range scale = [    1.0000]
25-01-17 16:45:43 | I |         sum  error  = [    0.5326]
25-01-17 16:45:43 | I |         best error  = [    0.5326]
25-01-17 16:45:43 | I |     + error = [0.5326]
25-01-17 16:45:44 | I |       - range scale = [    1.0000]
25-01-17 16:45:44 | I |         sum  error  = [    4.5265]
25-01-17 16:45:44 | I |         best error  = [    4.5265]
25-01-17 16:45:44 | I |     + error = [4.5265]
25-01-17 16:45:44 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:45:45 | I |       - range scale = [    1.0000]
25-01-17 16:45:45 | I |         sum  error  = [    0.2523]
25-01-17 16:45:45 | I |         best error  = [    0.2523]
25-01-17 16:45:45 | I |     + error = [0.2523]
25-01-17 16:45:45 | I |       - range scale = [    1.0000]
25-01-17 16:45:45 | I |         sum  error  = [    2.1557]
25-01-17 16:45:45 | I |         best error  = [    2.1557]
25-01-17 16:45:45 | I |     + error = [2.1557]
25-01-17 16:45:46 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:45:46 | I |       - range scale = [    1.0000]
25-01-17 16:45:46 | I |         sum  error  = [    0.6262]
25-01-17 16:45:46 | I |         best error  = [    0.6262]
25-01-17 16:45:46 | I |     + error = [0.6262]
25-01-17 16:45:47 | I |       - range scale = [    1.0000]
25-01-17 16:45:47 | I |         sum  error  = [    6.9889]
25-01-17 16:45:47 | I |         best error  = [    6.9889]
25-01-17 16:45:47 | I |     + error = [6.9889]
25-01-17 16:45:47 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:45:48 | I |       - range scale = [    1.0000]
25-01-17 16:45:48 | I |         sum  error  = [    0.0977]
25-01-17 16:45:48 | I |         best error  = [    0.0977]
25-01-17 16:45:48 | I |     + error = [0.0977]
25-01-17 16:45:49 | I |       - range scale = [    1.0000]
25-01-17 16:45:49 | I |         sum  error  = [    1.0629]
25-01-17 16:45:49 | I |         best error  = [    1.0629]
25-01-17 16:45:49 | I |     + error = [1.0629]
25-01-17 16:45:49 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:45:49 | I |       - range scale = [    1.0000]
25-01-17 16:45:49 | I |         sum  error  = [    2.0252]
25-01-17 16:45:49 | I |         best error  = [    2.0252]
25-01-17 16:45:49 | I |     + error = [2.0252]
25-01-17 16:45:50 | I |       - range scale = [    1.0000]
25-01-17 16:45:50 | I |         sum  error  = [   22.7660]
25-01-17 16:45:50 | I |         best error  = [   22.7660]
25-01-17 16:45:50 | I |     + error = [22.7660]
25-01-17 16:45:50 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:45:51 | I |       - range scale = [    1.0000]
25-01-17 16:45:51 | I |         sum  error  = [    2.2145]
25-01-17 16:45:51 | I |         best error  = [    2.2145]
25-01-17 16:45:51 | I |     + error = [2.2145]
25-01-17 16:45:52 | I |       - range scale = [    1.0000]
25-01-17 16:45:52 | I |         sum  error  = [   24.8475]
25-01-17 16:45:52 | I |         best error  = [   24.8475]
25-01-17 16:45:52 | I |     + error = [24.8475]
25-01-17 16:45:52 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:45:53 | I |       - range scale = [    1.0000]
25-01-17 16:45:53 | I |         sum  error  = [    0.1622]
25-01-17 16:45:53 | I |         best error  = [    0.1622]
25-01-17 16:45:53 | I |     + error = [0.1622]
25-01-17 16:45:53 | I |       - range scale = [    1.0000]
25-01-17 16:45:53 | I |         sum  error  = [    1.6600]
25-01-17 16:45:53 | I |         best error  = [    1.6600]
25-01-17 16:45:53 | I |     + error = [1.6600]
25-01-17 16:45:54 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:45:55 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:45:56 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:45:58 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:45:59 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:46:01 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:46:02 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:46:05 | I | quantizing activations for layer model.layers.4
25-01-17 16:46:06 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:06 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:06 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:06 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:08 | I | forward this layer
25-01-17 16:46:08 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/43.pt
25-01-17 16:46:08 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/43.pt
25-01-17 16:46:08 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:46:08 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:46:08 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:46:08 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:46:08 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:46:08 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:46:08 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:46:08 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:46:08 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:46:08 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:46:08 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:46:08 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:46:08 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:46:08 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:46:08 | I | [15] done with optimizer step
25-01-17 16:46:08 | I | epoch 001:     22 / 409600000 loss=1.52573e-05, loss_per_token=0.031247, loss_sum=1023.9, wps=602, ups=0.02, wpb=32768, bsz=64, num_updates=16, lr=4.8e-05, gnorm=0.858, clip=0, loss_scale=2, train_wall=54, cuda_gb_allocated=12.3, cuda_gb_reserved=13.6, cuda_gb_free=11.4, wall=1584
25-01-17 16:46:08 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:46:08 | I | in layer model.layers.4
25-01-17 16:46:08 | I | quantizing weights for layer model.layers.4
25-01-17 16:46:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:09 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:46:09 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:46:10 | I |       - range scale = [    1.0000]
25-01-17 16:46:10 | I |         sum  error  = [    0.5360]
25-01-17 16:46:10 | I |         best error  = [    0.5360]
25-01-17 16:46:10 | I |     + error = [0.5360]
25-01-17 16:46:11 | I |       - range scale = [    1.0000]
25-01-17 16:46:11 | I |         sum  error  = [    4.4644]
25-01-17 16:46:11 | I |         best error  = [    4.4644]
25-01-17 16:46:11 | I |     + error = [4.4644]
25-01-17 16:46:11 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:46:12 | I |       - range scale = [    1.0000]
25-01-17 16:46:12 | I |         sum  error  = [    0.2507]
25-01-17 16:46:12 | I |         best error  = [    0.2507]
25-01-17 16:46:12 | I |     + error = [0.2507]
25-01-17 16:46:12 | I |       - range scale = [    1.0000]
25-01-17 16:46:12 | I |         sum  error  = [    2.2063]
25-01-17 16:46:12 | I |         best error  = [    2.2063]
25-01-17 16:46:12 | I |     + error = [2.2063]
25-01-17 16:46:13 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:46:13 | I |       - range scale = [    1.0000]
25-01-17 16:46:13 | I |         sum  error  = [    0.6170]
25-01-17 16:46:13 | I |         best error  = [    0.6170]
25-01-17 16:46:13 | I |     + error = [0.6170]
25-01-17 16:46:14 | I |       - range scale = [    1.0000]
25-01-17 16:46:14 | I |         sum  error  = [    6.9032]
25-01-17 16:46:14 | I |         best error  = [    6.9032]
25-01-17 16:46:14 | I |     + error = [6.9032]
25-01-17 16:46:14 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:46:15 | I |       - range scale = [    1.0000]
25-01-17 16:46:15 | I |         sum  error  = [    0.0973]
25-01-17 16:46:15 | I |         best error  = [    0.0973]
25-01-17 16:46:15 | I |     + error = [0.0973]
25-01-17 16:46:16 | I |       - range scale = [    1.0000]
25-01-17 16:46:16 | I |         sum  error  = [    1.0558]
25-01-17 16:46:16 | I |         best error  = [    1.0558]
25-01-17 16:46:16 | I |     + error = [1.0558]
25-01-17 16:46:16 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:46:17 | I |       - range scale = [    1.0000]
25-01-17 16:46:17 | I |         sum  error  = [    2.0186]
25-01-17 16:46:17 | I |         best error  = [    2.0186]
25-01-17 16:46:17 | I |     + error = [2.0186]
25-01-17 16:46:17 | I |       - range scale = [    1.0000]
25-01-17 16:46:17 | I |         sum  error  = [   22.6890]
25-01-17 16:46:17 | I |         best error  = [   22.6890]
25-01-17 16:46:17 | I |     + error = [22.6890]
25-01-17 16:46:18 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:46:18 | I |       - range scale = [    1.0000]
25-01-17 16:46:18 | I |         sum  error  = [    2.2063]
25-01-17 16:46:18 | I |         best error  = [    2.2063]
25-01-17 16:46:18 | I |     + error = [2.2063]
25-01-17 16:46:19 | I |       - range scale = [    1.0000]
25-01-17 16:46:19 | I |         sum  error  = [   24.7751]
25-01-17 16:46:19 | I |         best error  = [   24.7751]
25-01-17 16:46:19 | I |     + error = [24.7751]
25-01-17 16:46:19 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:46:20 | I |       - range scale = [    1.0000]
25-01-17 16:46:20 | I |         sum  error  = [    0.1693]
25-01-17 16:46:20 | I |         best error  = [    0.1693]
25-01-17 16:46:20 | I |     + error = [0.1693]
25-01-17 16:46:21 | I |       - range scale = [    1.0000]
25-01-17 16:46:21 | I |         sum  error  = [    1.7349]
25-01-17 16:46:21 | I |         best error  = [    1.7349]
25-01-17 16:46:21 | I |     + error = [1.7349]
25-01-17 16:46:21 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:46:22 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:46:24 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:46:25 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:46:26 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:46:28 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:46:29 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:46:32 | I | quantizing activations for layer model.layers.4
25-01-17 16:46:33 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:33 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:33 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:33 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:35 | I | forward this layer
25-01-17 16:46:35 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/44.pt
25-01-17 16:46:35 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/44.pt
25-01-17 16:46:35 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:46:35 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:46:35 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:46:35 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:46:35 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:46:35 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:46:35 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:46:35 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:46:35 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:46:35 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:46:35 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:46:35 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:46:35 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:46:35 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:46:35 | I | in layer model.layers.4
25-01-17 16:46:35 | I | quantizing weights for layer model.layers.4
25-01-17 16:46:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:46:36 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:46:36 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:46:37 | I |       - range scale = [    1.0000]
25-01-17 16:46:37 | I |         sum  error  = [    0.5585]
25-01-17 16:46:37 | I |         best error  = [    0.5585]
25-01-17 16:46:37 | I |     + error = [0.5585]
25-01-17 16:46:37 | I |       - range scale = [    1.0000]
25-01-17 16:46:37 | I |         sum  error  = [    4.5559]
25-01-17 16:46:37 | I |         best error  = [    4.5559]
25-01-17 16:46:37 | I |     + error = [4.5559]
25-01-17 16:46:38 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:46:38 | I |       - range scale = [    1.0000]
25-01-17 16:46:38 | I |         sum  error  = [    0.2609]
25-01-17 16:46:38 | I |         best error  = [    0.2609]
25-01-17 16:46:38 | I |     + error = [0.2609]
25-01-17 16:46:39 | I |       - range scale = [    1.0000]
25-01-17 16:46:39 | I |         sum  error  = [    2.1617]
25-01-17 16:46:39 | I |         best error  = [    2.1617]
25-01-17 16:46:39 | I |     + error = [2.1617]
25-01-17 16:46:39 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:46:40 | I |       - range scale = [    1.0000]
25-01-17 16:46:40 | I |         sum  error  = [    0.6179]
25-01-17 16:46:40 | I |         best error  = [    0.6179]
25-01-17 16:46:40 | I |     + error = [0.6179]
25-01-17 16:46:41 | I |       - range scale = [    1.0000]
25-01-17 16:46:41 | I |         sum  error  = [    6.9183]
25-01-17 16:46:41 | I |         best error  = [    6.9183]
25-01-17 16:46:41 | I |     + error = [6.9183]
25-01-17 16:46:41 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:46:41 | I |       - range scale = [    1.0000]
25-01-17 16:46:41 | I |         sum  error  = [    0.0937]
25-01-17 16:46:41 | I |         best error  = [    0.0937]
25-01-17 16:46:41 | I |     + error = [0.0937]
25-01-17 16:46:42 | I |       - range scale = [    1.0000]
25-01-17 16:46:42 | I |         sum  error  = [    1.0231]
25-01-17 16:46:42 | I |         best error  = [    1.0231]
25-01-17 16:46:42 | I |     + error = [1.0231]
25-01-17 16:46:42 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:46:43 | I |       - range scale = [    1.0000]
25-01-17 16:46:43 | I |         sum  error  = [    2.0302]
25-01-17 16:46:43 | I |         best error  = [    2.0302]
25-01-17 16:46:43 | I |     + error = [2.0302]
25-01-17 16:46:44 | I |       - range scale = [    1.0000]
25-01-17 16:46:44 | I |         sum  error  = [   22.8586]
25-01-17 16:46:44 | I |         best error  = [   22.8586]
25-01-17 16:46:44 | I |     + error = [22.8586]
25-01-17 16:46:44 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:46:44 | I |       - range scale = [    1.0000]
25-01-17 16:46:44 | I |         sum  error  = [    2.2267]
25-01-17 16:46:44 | I |         best error  = [    2.2267]
25-01-17 16:46:44 | I |     + error = [2.2267]
25-01-17 16:46:45 | I |       - range scale = [    1.0000]
25-01-17 16:46:45 | I |         sum  error  = [   24.9560]
25-01-17 16:46:45 | I |         best error  = [   24.9560]
25-01-17 16:46:45 | I |     + error = [24.9560]
25-01-17 16:46:45 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:46:46 | I |       - range scale = [    1.0000]
25-01-17 16:46:46 | I |         sum  error  = [    0.1739]
25-01-17 16:46:46 | I |         best error  = [    0.1739]
25-01-17 16:46:46 | I |     + error = [0.1739]
25-01-17 16:46:47 | I |       - range scale = [    1.0000]
25-01-17 16:46:47 | I |         sum  error  = [    1.7787]
25-01-17 16:46:47 | I |         best error  = [    1.7787]
25-01-17 16:46:47 | I |     + error = [1.7787]
25-01-17 16:46:47 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:46:49 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:46:51 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:46:52 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:46:54 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:46:56 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:46:57 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:47:02 | I | quantizing activations for layer model.layers.4
25-01-17 16:47:02 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:02 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:03 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:03 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:05 | I | forward this layer
25-01-17 16:47:05 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/45.pt
25-01-17 16:47:05 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/45.pt
25-01-17 16:47:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:47:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:47:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:47:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:47:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:47:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:47:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:47:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:47:05 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:47:05 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:47:05 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:47:05 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:47:05 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:47:05 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:47:05 | I | [16] done with optimizer step
25-01-17 16:47:05 | I | epoch 001:     23 / 409600000 loss=1.77903e-05, loss_per_token=0.0364346, loss_sum=1193.89, wps=577.8, ups=0.02, wpb=32768, bsz=64, num_updates=17, lr=5.1e-05, gnorm=0.424, clip=0, loss_scale=2, train_wall=57, cuda_gb_allocated=12.3, cuda_gb_reserved=13.6, cuda_gb_free=11.4, wall=1641
25-01-17 16:47:05 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:47:05 | I | in layer model.layers.4
25-01-17 16:47:05 | I | quantizing weights for layer model.layers.4
25-01-17 16:47:06 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:06 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:06 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:06 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:06 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:47:06 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:47:07 | I |       - range scale = [    1.0000]
25-01-17 16:47:07 | I |         sum  error  = [    0.5854]
25-01-17 16:47:07 | I |         best error  = [    0.5854]
25-01-17 16:47:07 | I |     + error = [0.5854]
25-01-17 16:47:08 | I |       - range scale = [    1.0000]
25-01-17 16:47:08 | I |         sum  error  = [    4.7832]
25-01-17 16:47:08 | I |         best error  = [    4.7832]
25-01-17 16:47:08 | I |     + error = [4.7832]
25-01-17 16:47:08 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:47:09 | I |       - range scale = [    1.0000]
25-01-17 16:47:09 | I |         sum  error  = [    0.2733]
25-01-17 16:47:09 | I |         best error  = [    0.2733]
25-01-17 16:47:09 | I |     + error = [0.2733]
25-01-17 16:47:09 | I |       - range scale = [    1.0000]
25-01-17 16:47:09 | I |         sum  error  = [    2.2317]
25-01-17 16:47:09 | I |         best error  = [    2.2317]
25-01-17 16:47:09 | I |     + error = [2.2317]
25-01-17 16:47:10 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:47:10 | I |       - range scale = [    1.0000]
25-01-17 16:47:10 | I |         sum  error  = [    0.6217]
25-01-17 16:47:10 | I |         best error  = [    0.6217]
25-01-17 16:47:10 | I |     + error = [0.6217]
25-01-17 16:47:11 | I |       - range scale = [    1.0000]
25-01-17 16:47:11 | I |         sum  error  = [    6.9024]
25-01-17 16:47:11 | I |         best error  = [    6.9024]
25-01-17 16:47:11 | I |     + error = [6.9024]
25-01-17 16:47:11 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:47:12 | I |       - range scale = [    1.0000]
25-01-17 16:47:12 | I |         sum  error  = [    0.1031]
25-01-17 16:47:12 | I |         best error  = [    0.1031]
25-01-17 16:47:12 | I |     + error = [0.1031]
25-01-17 16:47:13 | I |       - range scale = [    1.0000]
25-01-17 16:47:13 | I |         sum  error  = [    1.1286]
25-01-17 16:47:13 | I |         best error  = [    1.1286]
25-01-17 16:47:13 | I |     + error = [1.1286]
25-01-17 16:47:13 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:47:14 | I |       - range scale = [    1.0000]
25-01-17 16:47:14 | I |         sum  error  = [    1.9951]
25-01-17 16:47:14 | I |         best error  = [    1.9951]
25-01-17 16:47:14 | I |     + error = [1.9951]
25-01-17 16:47:14 | I |       - range scale = [    1.0000]
25-01-17 16:47:14 | I |         sum  error  = [   22.4420]
25-01-17 16:47:14 | I |         best error  = [   22.4420]
25-01-17 16:47:14 | I |     + error = [22.4420]
25-01-17 16:47:15 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:47:15 | I |       - range scale = [    1.0000]
25-01-17 16:47:15 | I |         sum  error  = [    2.1821]
25-01-17 16:47:15 | I |         best error  = [    2.1821]
25-01-17 16:47:15 | I |     + error = [2.1821]
25-01-17 16:47:16 | I |       - range scale = [    1.0000]
25-01-17 16:47:16 | I |         sum  error  = [   24.5099]
25-01-17 16:47:16 | I |         best error  = [   24.5099]
25-01-17 16:47:16 | I |     + error = [24.5099]
25-01-17 16:47:16 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:47:17 | I |       - range scale = [    1.0000]
25-01-17 16:47:17 | I |         sum  error  = [    0.1687]
25-01-17 16:47:17 | I |         best error  = [    0.1687]
25-01-17 16:47:17 | I |     + error = [0.1687]
25-01-17 16:47:18 | I |       - range scale = [    1.0000]
25-01-17 16:47:18 | I |         sum  error  = [    1.7296]
25-01-17 16:47:18 | I |         best error  = [    1.7296]
25-01-17 16:47:18 | I |     + error = [1.7296]
25-01-17 16:47:18 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:47:20 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:47:21 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:47:23 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:47:24 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:47:26 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:47:28 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:47:32 | I | quantizing activations for layer model.layers.4
25-01-17 16:47:32 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:33 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:33 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:33 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:35 | I | forward this layer
25-01-17 16:47:35 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/46.pt
25-01-17 16:47:35 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/46.pt
25-01-17 16:47:35 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:47:35 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:47:35 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:47:35 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:47:35 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:47:35 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:47:35 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:47:35 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:47:35 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:47:35 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:47:35 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:47:35 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:47:35 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:47:35 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:47:35 | I | in layer model.layers.4
25-01-17 16:47:35 | I | quantizing weights for layer model.layers.4
25-01-17 16:47:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:47:36 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:47:36 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:47:37 | I |       - range scale = [    1.0000]
25-01-17 16:47:37 | I |         sum  error  = [    0.5997]
25-01-17 16:47:37 | I |         best error  = [    0.5997]
25-01-17 16:47:37 | I |     + error = [0.5997]
25-01-17 16:47:38 | I |       - range scale = [    1.0000]
25-01-17 16:47:38 | I |         sum  error  = [    5.1174]
25-01-17 16:47:38 | I |         best error  = [    5.1174]
25-01-17 16:47:38 | I |     + error = [5.1174]
25-01-17 16:47:38 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:47:38 | I |       - range scale = [    1.0000]
25-01-17 16:47:38 | I |         sum  error  = [    0.3094]
25-01-17 16:47:38 | I |         best error  = [    0.3094]
25-01-17 16:47:38 | I |     + error = [0.3094]
25-01-17 16:47:39 | I |       - range scale = [    1.0000]
25-01-17 16:47:39 | I |         sum  error  = [    2.3250]
25-01-17 16:47:39 | I |         best error  = [    2.3250]
25-01-17 16:47:39 | I |     + error = [2.3250]
25-01-17 16:47:39 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:47:40 | I |       - range scale = [    1.0000]
25-01-17 16:47:40 | I |         sum  error  = [    0.6228]
25-01-17 16:47:40 | I |         best error  = [    0.6228]
25-01-17 16:47:40 | I |     + error = [0.6228]
25-01-17 16:47:41 | I |       - range scale = [    1.0000]
25-01-17 16:47:41 | I |         sum  error  = [    6.9600]
25-01-17 16:47:41 | I |         best error  = [    6.9600]
25-01-17 16:47:41 | I |     + error = [6.9600]
25-01-17 16:47:41 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:47:42 | I |       - range scale = [    1.0000]
25-01-17 16:47:42 | I |         sum  error  = [    0.0990]
25-01-17 16:47:42 | I |         best error  = [    0.0990]
25-01-17 16:47:42 | I |     + error = [0.0990]
25-01-17 16:47:42 | I |       - range scale = [    1.0000]
25-01-17 16:47:42 | I |         sum  error  = [    1.0766]
25-01-17 16:47:42 | I |         best error  = [    1.0766]
25-01-17 16:47:42 | I |     + error = [1.0766]
25-01-17 16:47:43 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:47:43 | I |       - range scale = [    1.0000]
25-01-17 16:47:43 | I |         sum  error  = [    2.0185]
25-01-17 16:47:43 | I |         best error  = [    2.0185]
25-01-17 16:47:43 | I |     + error = [2.0185]
25-01-17 16:47:44 | I |       - range scale = [    1.0000]
25-01-17 16:47:44 | I |         sum  error  = [   22.7201]
25-01-17 16:47:44 | I |         best error  = [   22.7201]
25-01-17 16:47:44 | I |     + error = [22.7201]
25-01-17 16:47:44 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:47:45 | I |       - range scale = [    1.0000]
25-01-17 16:47:45 | I |         sum  error  = [    2.2087]
25-01-17 16:47:45 | I |         best error  = [    2.2087]
25-01-17 16:47:45 | I |     + error = [2.2087]
25-01-17 16:47:46 | I |       - range scale = [    1.0000]
25-01-17 16:47:46 | I |         sum  error  = [   24.8134]
25-01-17 16:47:46 | I |         best error  = [   24.8134]
25-01-17 16:47:46 | I |     + error = [24.8134]
25-01-17 16:47:46 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:47:47 | I |       - range scale = [    1.0000]
25-01-17 16:47:47 | I |         sum  error  = [    0.1614]
25-01-17 16:47:47 | I |         best error  = [    0.1614]
25-01-17 16:47:47 | I |     + error = [0.1614]
25-01-17 16:47:47 | I |       - range scale = [    1.0000]
25-01-17 16:47:47 | I |         sum  error  = [    1.6559]
25-01-17 16:47:47 | I |         best error  = [    1.6559]
25-01-17 16:47:47 | I |     + error = [1.6559]
25-01-17 16:47:48 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:47:49 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:47:51 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:47:53 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:47:55 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:47:56 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:47:58 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:48:02 | I | quantizing activations for layer model.layers.4
25-01-17 16:48:03 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:03 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:03 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:03 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:05 | I | forward this layer
25-01-17 16:48:05 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/47.pt
25-01-17 16:48:05 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/47.pt
25-01-17 16:48:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:48:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:48:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:48:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:48:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:48:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:48:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:48:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:48:05 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:48:05 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:48:05 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:48:05 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:48:05 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:48:05 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:48:05 | I | [17] done with optimizer step
25-01-17 16:48:05 | I | epoch 001:     24 / 409600000 loss=1.77217e-05, loss_per_token=0.036294, loss_sum=1189.28, wps=542.7, ups=0.02, wpb=32768, bsz=64, num_updates=18, lr=5.4e-05, gnorm=0.305, clip=0, loss_scale=2, train_wall=60, cuda_gb_allocated=12.3, cuda_gb_reserved=13.6, cuda_gb_free=11.4, wall=1701
25-01-17 16:48:05 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:48:05 | I | in layer model.layers.4
25-01-17 16:48:05 | I | quantizing weights for layer model.layers.4
25-01-17 16:48:06 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:06 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:06 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:06 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:07 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:48:07 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:48:07 | I |       - range scale = [    1.0000]
25-01-17 16:48:07 | I |         sum  error  = [    0.5427]
25-01-17 16:48:07 | I |         best error  = [    0.5427]
25-01-17 16:48:07 | I |     + error = [0.5427]
25-01-17 16:48:08 | I |       - range scale = [    1.0000]
25-01-17 16:48:08 | I |         sum  error  = [    4.2019]
25-01-17 16:48:08 | I |         best error  = [    4.2019]
25-01-17 16:48:08 | I |     + error = [4.2019]
25-01-17 16:48:08 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:48:09 | I |       - range scale = [    1.0000]
25-01-17 16:48:09 | I |         sum  error  = [    0.2592]
25-01-17 16:48:09 | I |         best error  = [    0.2592]
25-01-17 16:48:09 | I |     + error = [0.2592]
25-01-17 16:48:10 | I |       - range scale = [    1.0000]
25-01-17 16:48:10 | I |         sum  error  = [    2.1655]
25-01-17 16:48:10 | I |         best error  = [    2.1655]
25-01-17 16:48:10 | I |     + error = [2.1655]
25-01-17 16:48:10 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:48:11 | I |       - range scale = [    1.0000]
25-01-17 16:48:11 | I |         sum  error  = [    0.6169]
25-01-17 16:48:11 | I |         best error  = [    0.6169]
25-01-17 16:48:11 | I |     + error = [0.6169]
25-01-17 16:48:12 | I |       - range scale = [    1.0000]
25-01-17 16:48:12 | I |         sum  error  = [    6.8394]
25-01-17 16:48:12 | I |         best error  = [    6.8394]
25-01-17 16:48:12 | I |     + error = [6.8394]
25-01-17 16:48:12 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:48:12 | I |       - range scale = [    1.0000]
25-01-17 16:48:12 | I |         sum  error  = [    0.0923]
25-01-17 16:48:12 | I |         best error  = [    0.0923]
25-01-17 16:48:12 | I |     + error = [0.0923]
25-01-17 16:48:13 | I |       - range scale = [    1.0000]
25-01-17 16:48:13 | I |         sum  error  = [    0.9994]
25-01-17 16:48:13 | I |         best error  = [    0.9994]
25-01-17 16:48:13 | I |     + error = [0.9994]
25-01-17 16:48:13 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:48:14 | I |       - range scale = [    1.0000]
25-01-17 16:48:14 | I |         sum  error  = [    2.0179]
25-01-17 16:48:14 | I |         best error  = [    2.0179]
25-01-17 16:48:14 | I |     + error = [2.0179]
25-01-17 16:48:15 | I |       - range scale = [    1.0000]
25-01-17 16:48:15 | I |         sum  error  = [   22.7003]
25-01-17 16:48:15 | I |         best error  = [   22.7003]
25-01-17 16:48:15 | I |     + error = [22.7003]
25-01-17 16:48:15 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:48:16 | I |       - range scale = [    1.0000]
25-01-17 16:48:16 | I |         sum  error  = [    2.2060]
25-01-17 16:48:16 | I |         best error  = [    2.2060]
25-01-17 16:48:16 | I |     + error = [2.2060]
25-01-17 16:48:17 | I |       - range scale = [    1.0000]
25-01-17 16:48:17 | I |         sum  error  = [   24.7831]
25-01-17 16:48:17 | I |         best error  = [   24.7831]
25-01-17 16:48:17 | I |     + error = [24.7831]
25-01-17 16:48:17 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:48:18 | I |       - range scale = [    1.0000]
25-01-17 16:48:18 | I |         sum  error  = [    0.1667]
25-01-17 16:48:18 | I |         best error  = [    0.1667]
25-01-17 16:48:18 | I |     + error = [0.1667]
25-01-17 16:48:18 | I |       - range scale = [    1.0000]
25-01-17 16:48:18 | I |         sum  error  = [    1.7075]
25-01-17 16:48:18 | I |         best error  = [    1.7075]
25-01-17 16:48:18 | I |     + error = [1.7075]
25-01-17 16:48:19 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:48:20 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:48:22 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:48:24 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:48:26 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:48:28 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:48:29 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:48:34 | I | quantizing activations for layer model.layers.4
25-01-17 16:48:34 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:34 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:34 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:34 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:36 | I | forward this layer
25-01-17 16:48:36 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/48.pt
25-01-17 16:48:36 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/48.pt
25-01-17 16:48:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:48:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:48:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:48:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:48:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:48:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:48:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:48:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:48:37 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:48:37 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:48:37 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:48:37 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:48:37 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:48:37 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:48:37 | I | in layer model.layers.4
25-01-17 16:48:37 | I | quantizing weights for layer model.layers.4
25-01-17 16:48:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:48:38 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:48:38 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:48:39 | I |       - range scale = [    1.0000]
25-01-17 16:48:39 | I |         sum  error  = [    0.6136]
25-01-17 16:48:39 | I |         best error  = [    0.6136]
25-01-17 16:48:39 | I |     + error = [0.6136]
25-01-17 16:48:39 | I |       - range scale = [    1.0000]
25-01-17 16:48:39 | I |         sum  error  = [    4.6417]
25-01-17 16:48:39 | I |         best error  = [    4.6417]
25-01-17 16:48:39 | I |     + error = [4.6417]
25-01-17 16:48:40 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:48:40 | I |       - range scale = [    1.0000]
25-01-17 16:48:40 | I |         sum  error  = [    0.2551]
25-01-17 16:48:40 | I |         best error  = [    0.2551]
25-01-17 16:48:40 | I |     + error = [0.2551]
25-01-17 16:48:41 | I |       - range scale = [    1.0000]
25-01-17 16:48:41 | I |         sum  error  = [    2.2769]
25-01-17 16:48:41 | I |         best error  = [    2.2769]
25-01-17 16:48:41 | I |     + error = [2.2769]
25-01-17 16:48:41 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:48:42 | I |       - range scale = [    1.0000]
25-01-17 16:48:42 | I |         sum  error  = [    0.6223]
25-01-17 16:48:42 | I |         best error  = [    0.6223]
25-01-17 16:48:42 | I |     + error = [0.6223]
25-01-17 16:48:43 | I |       - range scale = [    1.0000]
25-01-17 16:48:43 | I |         sum  error  = [    6.8330]
25-01-17 16:48:43 | I |         best error  = [    6.8330]
25-01-17 16:48:43 | I |     + error = [6.8330]
25-01-17 16:48:43 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:48:44 | I |       - range scale = [    1.0000]
25-01-17 16:48:44 | I |         sum  error  = [    0.1004]
25-01-17 16:48:44 | I |         best error  = [    0.1004]
25-01-17 16:48:44 | I |     + error = [0.1004]
25-01-17 16:48:44 | I |       - range scale = [    1.0000]
25-01-17 16:48:44 | I |         sum  error  = [    1.0932]
25-01-17 16:48:44 | I |         best error  = [    1.0932]
25-01-17 16:48:44 | I |     + error = [1.0932]
25-01-17 16:48:44 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:48:45 | I |       - range scale = [    1.0000]
25-01-17 16:48:45 | I |         sum  error  = [    1.9963]
25-01-17 16:48:45 | I |         best error  = [    1.9963]
25-01-17 16:48:45 | I |     + error = [1.9963]
25-01-17 16:48:46 | I |       - range scale = [    1.0000]
25-01-17 16:48:46 | I |         sum  error  = [   22.4505]
25-01-17 16:48:46 | I |         best error  = [   22.4505]
25-01-17 16:48:46 | I |     + error = [22.4505]
25-01-17 16:48:46 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:48:47 | I |       - range scale = [    1.0000]
25-01-17 16:48:47 | I |         sum  error  = [    2.1865]
25-01-17 16:48:47 | I |         best error  = [    2.1865]
25-01-17 16:48:47 | I |     + error = [2.1865]
25-01-17 16:48:48 | I |       - range scale = [    1.0000]
25-01-17 16:48:48 | I |         sum  error  = [   24.5040]
25-01-17 16:48:48 | I |         best error  = [   24.5040]
25-01-17 16:48:48 | I |     + error = [24.5040]
25-01-17 16:48:48 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:48:49 | I |       - range scale = [    1.0000]
25-01-17 16:48:49 | I |         sum  error  = [    0.1627]
25-01-17 16:48:49 | I |         best error  = [    0.1627]
25-01-17 16:48:49 | I |     + error = [0.1627]
25-01-17 16:48:49 | I |       - range scale = [    1.0000]
25-01-17 16:48:49 | I |         sum  error  = [    1.6689]
25-01-17 16:48:49 | I |         best error  = [    1.6689]
25-01-17 16:48:49 | I |     + error = [1.6689]
25-01-17 16:48:50 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:48:51 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:48:53 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:48:55 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:48:57 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:48:58 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:49:00 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:49:04 | I | quantizing activations for layer model.layers.4
25-01-17 16:49:05 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:05 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:05 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:05 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:07 | I | forward this layer
25-01-17 16:49:07 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/49.pt
25-01-17 16:49:07 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/49.pt
25-01-17 16:49:07 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:49:07 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:49:07 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:49:07 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:49:07 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:49:07 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:49:07 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:49:07 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:49:07 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:49:07 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:49:07 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:49:07 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:49:07 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:49:07 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:49:07 | I | [18] done with optimizer step
25-01-17 16:49:07 | I | epoch 001:     25 / 409600000 loss=1.59508e-05, loss_per_token=0.0326673, loss_sum=1070.44, wps=528.6, ups=0.02, wpb=32768, bsz=64, num_updates=19, lr=5.7e-05, gnorm=0.567, clip=0, loss_scale=2, train_wall=62, cuda_gb_allocated=12.3, cuda_gb_reserved=13.6, cuda_gb_free=11.4, wall=1763
25-01-17 16:49:07 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:49:07 | I | in layer model.layers.4
25-01-17 16:49:07 | I | quantizing weights for layer model.layers.4
25-01-17 16:49:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:09 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:49:09 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:49:09 | I |       - range scale = [    1.0000]
25-01-17 16:49:09 | I |         sum  error  = [    0.5902]
25-01-17 16:49:09 | I |         best error  = [    0.5902]
25-01-17 16:49:09 | I |     + error = [0.5902]
25-01-17 16:49:10 | I |       - range scale = [    1.0000]
25-01-17 16:49:10 | I |         sum  error  = [    4.5413]
25-01-17 16:49:10 | I |         best error  = [    4.5413]
25-01-17 16:49:10 | I |     + error = [4.5413]
25-01-17 16:49:10 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:49:11 | I |       - range scale = [    1.0000]
25-01-17 16:49:11 | I |         sum  error  = [    0.2880]
25-01-17 16:49:11 | I |         best error  = [    0.2880]
25-01-17 16:49:11 | I |     + error = [0.2880]
25-01-17 16:49:12 | I |       - range scale = [    1.0000]
25-01-17 16:49:12 | I |         sum  error  = [    2.5662]
25-01-17 16:49:12 | I |         best error  = [    2.5662]
25-01-17 16:49:12 | I |     + error = [2.5662]
25-01-17 16:49:12 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:49:12 | I |       - range scale = [    1.0000]
25-01-17 16:49:12 | I |         sum  error  = [    0.6134]
25-01-17 16:49:12 | I |         best error  = [    0.6134]
25-01-17 16:49:12 | I |     + error = [0.6134]
25-01-17 16:49:13 | I |       - range scale = [    1.0000]
25-01-17 16:49:13 | I |         sum  error  = [    6.8996]
25-01-17 16:49:13 | I |         best error  = [    6.8996]
25-01-17 16:49:13 | I |     + error = [6.8996]
25-01-17 16:49:13 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:49:14 | I |       - range scale = [    1.0000]
25-01-17 16:49:14 | I |         sum  error  = [    0.1080]
25-01-17 16:49:14 | I |         best error  = [    0.1080]
25-01-17 16:49:14 | I |     + error = [0.1080]
25-01-17 16:49:15 | I |       - range scale = [    1.0000]
25-01-17 16:49:15 | I |         sum  error  = [    1.1725]
25-01-17 16:49:15 | I |         best error  = [    1.1725]
25-01-17 16:49:15 | I |     + error = [1.1725]
25-01-17 16:49:15 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:49:15 | I |       - range scale = [    1.0000]
25-01-17 16:49:15 | I |         sum  error  = [    2.0862]
25-01-17 16:49:15 | I |         best error  = [    2.0862]
25-01-17 16:49:15 | I |     + error = [2.0862]
25-01-17 16:49:16 | I |       - range scale = [    1.0000]
25-01-17 16:49:16 | I |         sum  error  = [   23.4965]
25-01-17 16:49:16 | I |         best error  = [   23.4965]
25-01-17 16:49:16 | I |     + error = [23.4965]
25-01-17 16:49:16 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:49:17 | I |       - range scale = [    1.0000]
25-01-17 16:49:17 | I |         sum  error  = [    2.2826]
25-01-17 16:49:17 | I |         best error  = [    2.2826]
25-01-17 16:49:17 | I |     + error = [2.2826]
25-01-17 16:49:18 | I |       - range scale = [    1.0000]
25-01-17 16:49:18 | I |         sum  error  = [   25.6567]
25-01-17 16:49:18 | I |         best error  = [   25.6567]
25-01-17 16:49:18 | I |     + error = [25.6567]
25-01-17 16:49:18 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:49:19 | I |       - range scale = [    1.0000]
25-01-17 16:49:19 | I |         sum  error  = [    0.1652]
25-01-17 16:49:19 | I |         best error  = [    0.1652]
25-01-17 16:49:19 | I |     + error = [0.1652]
25-01-17 16:49:19 | I |       - range scale = [    1.0000]
25-01-17 16:49:19 | I |         sum  error  = [    1.6867]
25-01-17 16:49:19 | I |         best error  = [    1.6867]
25-01-17 16:49:19 | I |     + error = [1.6867]
25-01-17 16:49:20 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:49:21 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:49:23 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:49:25 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:49:27 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:49:28 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:49:30 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:49:35 | I | quantizing activations for layer model.layers.4
25-01-17 16:49:35 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:35 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:35 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:35 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:37 | I | forward this layer
25-01-17 16:49:37 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/50.pt
25-01-17 16:49:37 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/50.pt
25-01-17 16:49:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:49:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:49:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:49:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:49:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:49:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:49:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:49:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:49:38 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:49:38 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:49:38 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:49:38 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:49:38 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:49:38 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:49:38 | I | in layer model.layers.4
25-01-17 16:49:38 | I | quantizing weights for layer model.layers.4
25-01-17 16:49:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:49:39 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:49:39 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:49:39 | I |       - range scale = [    1.0000]
25-01-17 16:49:39 | I |         sum  error  = [    0.5975]
25-01-17 16:49:39 | I |         best error  = [    0.5975]
25-01-17 16:49:39 | I |     + error = [0.5975]
25-01-17 16:49:40 | I |       - range scale = [    1.0000]
25-01-17 16:49:40 | I |         sum  error  = [    4.5941]
25-01-17 16:49:40 | I |         best error  = [    4.5941]
25-01-17 16:49:40 | I |     + error = [4.5941]
25-01-17 16:49:40 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:49:41 | I |       - range scale = [    1.0000]
25-01-17 16:49:41 | I |         sum  error  = [    0.2836]
25-01-17 16:49:41 | I |         best error  = [    0.2836]
25-01-17 16:49:41 | I |     + error = [0.2836]
25-01-17 16:49:42 | I |       - range scale = [    1.0000]
25-01-17 16:49:42 | I |         sum  error  = [    2.4453]
25-01-17 16:49:42 | I |         best error  = [    2.4453]
25-01-17 16:49:42 | I |     + error = [2.4453]
25-01-17 16:49:42 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:49:43 | I |       - range scale = [    1.0000]
25-01-17 16:49:43 | I |         sum  error  = [    0.6207]
25-01-17 16:49:43 | I |         best error  = [    0.6207]
25-01-17 16:49:43 | I |     + error = [0.6207]
25-01-17 16:49:43 | I |       - range scale = [    1.0000]
25-01-17 16:49:43 | I |         sum  error  = [    6.9358]
25-01-17 16:49:43 | I |         best error  = [    6.9358]
25-01-17 16:49:43 | I |     + error = [6.9358]
25-01-17 16:49:44 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:49:44 | I |       - range scale = [    1.0000]
25-01-17 16:49:44 | I |         sum  error  = [    0.1139]
25-01-17 16:49:44 | I |         best error  = [    0.1139]
25-01-17 16:49:44 | I |     + error = [0.1139]
25-01-17 16:49:45 | I |       - range scale = [    1.0000]
25-01-17 16:49:45 | I |         sum  error  = [    1.2330]
25-01-17 16:49:45 | I |         best error  = [    1.2330]
25-01-17 16:49:45 | I |     + error = [1.2330]
25-01-17 16:49:45 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:49:46 | I |       - range scale = [    1.0000]
25-01-17 16:49:46 | I |         sum  error  = [    2.0970]
25-01-17 16:49:46 | I |         best error  = [    2.0970]
25-01-17 16:49:46 | I |     + error = [2.0970]
25-01-17 16:49:47 | I |       - range scale = [    1.0000]
25-01-17 16:49:47 | I |         sum  error  = [   23.6461]
25-01-17 16:49:47 | I |         best error  = [   23.6461]
25-01-17 16:49:47 | I |     + error = [23.6461]
25-01-17 16:49:47 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:49:48 | I |       - range scale = [    1.0000]
25-01-17 16:49:48 | I |         sum  error  = [    2.2959]
25-01-17 16:49:48 | I |         best error  = [    2.2959]
25-01-17 16:49:48 | I |     + error = [2.2959]
25-01-17 16:49:49 | I |       - range scale = [    1.0000]
25-01-17 16:49:49 | I |         sum  error  = [   25.8114]
25-01-17 16:49:49 | I |         best error  = [   25.8114]
25-01-17 16:49:49 | I |     + error = [25.8114]
25-01-17 16:49:49 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:49:49 | I |       - range scale = [    1.0000]
25-01-17 16:49:49 | I |         sum  error  = [    0.1715]
25-01-17 16:49:49 | I |         best error  = [    0.1715]
25-01-17 16:49:50 | I |     + error = [0.1715]
25-01-17 16:49:50 | I |       - range scale = [    1.0000]
25-01-17 16:49:50 | I |         sum  error  = [    1.7537]
25-01-17 16:49:50 | I |         best error  = [    1.7537]
25-01-17 16:49:50 | I |     + error = [1.7537]
25-01-17 16:49:51 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:49:52 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:49:53 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:49:55 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:49:56 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:49:58 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:49:59 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:50:03 | I | quantizing activations for layer model.layers.4
25-01-17 16:50:03 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:03 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:03 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:03 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:05 | I | forward this layer
25-01-17 16:50:05 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/51.pt
25-01-17 16:50:05 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/51.pt
25-01-17 16:50:06 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:50:06 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:50:06 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:50:06 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:50:06 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:50:06 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:50:06 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:50:06 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:50:06 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:50:06 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:50:06 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:50:06 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:50:06 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:50:06 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:50:06 | I | [19] done with optimizer step
25-01-17 16:50:06 | I | epoch 001:     26 / 409600000 loss=1.6374e-05, loss_per_token=0.0335339, loss_sum=1098.84, wps=562.2, ups=0.02, wpb=32768, bsz=64, num_updates=20, lr=6e-05, gnorm=0.493, clip=0, loss_scale=2, train_wall=58, cuda_gb_allocated=12.3, cuda_gb_reserved=13.6, cuda_gb_free=11.4, wall=1822
25-01-17 16:50:06 | I | begin validation on "valid" subset on rank 0
25-01-17 16:50:06 | I | got valid iterator on "valid" subset on rank 0
25-01-17 16:50:06 | I | Valid: Start iterating over samples
25-01-17 16:50:06 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:50:06 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:50:06 | I | - Evaluator: gptq
25-01-17 16:50:06 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:50:06 | I | - Batch_size: 8
25-01-17 16:50:06 | I |   + Max_seq_length: 2048
25-01-17 16:50:24 | I |     - Results:
25-01-17 16:50:24 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:50:24 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:50:24 | I |       |wikitext |      1|word_perplexity|7.7122|±  |7.7122|
25-01-17 16:50:24 | I |       |val_valid|      1|word_perplexity|7.4275|±  |7.4275|
25-01-17 16:50:24 | I |       
25-01-17 16:50:24 | I | in valid, quantize current layer weights
25-01-17 16:50:25 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 16:50:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:40 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:40 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:40 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:40 | I | collecting calibration activations in model.layers.4
25-01-17 16:50:41 | I |       - range scale = [    1.0000]
25-01-17 16:50:41 | I |         sum  error  = [    1.5566]
25-01-17 16:50:41 | I |         best error  = [    1.5566]
25-01-17 16:50:41 | I |     + error = [1.5566]
25-01-17 16:50:42 | I |       - range scale = [    1.0000]
25-01-17 16:50:42 | I |         sum  error  = [   11.8413]
25-01-17 16:50:42 | I |         best error  = [   11.8413]
25-01-17 16:50:42 | I |     + error = [11.8413]
25-01-17 16:50:43 | I |       - range scale = [    1.0000]
25-01-17 16:50:43 | I |         sum  error  = [    0.6586]
25-01-17 16:50:43 | I |         best error  = [    0.6586]
25-01-17 16:50:43 | I |     + error = [0.6586]
25-01-17 16:50:44 | I |       - range scale = [    1.0000]
25-01-17 16:50:44 | I |         sum  error  = [    5.6605]
25-01-17 16:50:44 | I |         best error  = [    5.6605]
25-01-17 16:50:44 | I |     + error = [5.6605]
25-01-17 16:50:45 | I |       - range scale = [    1.0000]
25-01-17 16:50:45 | I |         sum  error  = [    0.6109]
25-01-17 16:50:45 | I |         best error  = [    0.6109]
25-01-17 16:50:45 | I |     + error = [0.6109]
25-01-17 16:50:46 | I |       - range scale = [    1.0000]
25-01-17 16:50:46 | I |         sum  error  = [    6.8347]
25-01-17 16:50:46 | I |         best error  = [    6.8347]
25-01-17 16:50:46 | I |     + error = [6.8347]
25-01-17 16:50:47 | I |       - range scale = [    1.0000]
25-01-17 16:50:47 | I |         sum  error  = [    0.0826]
25-01-17 16:50:47 | I |         best error  = [    0.0826]
25-01-17 16:50:47 | I |     + error = [0.0826]
25-01-17 16:50:47 | I |       - range scale = [    1.0000]
25-01-17 16:50:47 | I |         sum  error  = [    0.9023]
25-01-17 16:50:47 | I |         best error  = [    0.9023]
25-01-17 16:50:47 | I |     + error = [0.9023]
25-01-17 16:50:48 | I |       - range scale = [    1.0000]
25-01-17 16:50:48 | I |         sum  error  = [    1.9693]
25-01-17 16:50:48 | I |         best error  = [    1.9693]
25-01-17 16:50:48 | I |     + error = [1.9693]
25-01-17 16:50:49 | I |       - range scale = [    1.0000]
25-01-17 16:50:49 | I |         sum  error  = [   22.1901]
25-01-17 16:50:49 | I |         best error  = [   22.1901]
25-01-17 16:50:49 | I |     + error = [22.1901]
25-01-17 16:50:50 | I |       - range scale = [    1.0000]
25-01-17 16:50:50 | I |         sum  error  = [    2.1522]
25-01-17 16:50:50 | I |         best error  = [    2.1522]
25-01-17 16:50:50 | I |     + error = [2.1522]
25-01-17 16:50:51 | I |       - range scale = [    1.0000]
25-01-17 16:50:51 | I |         sum  error  = [   24.2067]
25-01-17 16:50:51 | I |         best error  = [   24.2067]
25-01-17 16:50:51 | I |     + error = [24.2067]
25-01-17 16:50:52 | I |       - range scale = [    1.0000]
25-01-17 16:50:52 | I |         sum  error  = [    0.1675]
25-01-17 16:50:52 | I |         best error  = [    0.1675]
25-01-17 16:50:52 | I |     + error = [0.1675]
25-01-17 16:50:53 | I |       - range scale = [    1.0000]
25-01-17 16:50:53 | I |         sum  error  = [    1.7172]
25-01-17 16:50:53 | I |         best error  = [    1.7172]
25-01-17 16:50:53 | I |     + error = [1.7172]
25-01-17 16:51:07 | I | in valid, quantize current layer acts
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:08 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:11 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:13 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 16:51:13 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 16:51:13 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 16:51:13 | I | - Evaluator: gptq
25-01-17 16:51:13 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 16:51:13 | I | - Batch_size: 8
25-01-17 16:51:13 | I |   + Max_seq_length: 2048
25-01-17 16:51:33 | I |     - Results:
25-01-17 16:51:33 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 16:51:33 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 16:51:33 | I |       |wikitext |      1|word_perplexity|7.7337|±  |7.7337|
25-01-17 16:51:33 | I |       |val_valid|      1|word_perplexity|7.4498|±  |7.4498|
25-01-17 16:51:33 | I |       
25-01-17 16:51:35 | W | Criterion.reduce_metrics did not log a 'loss_valid' value, which may break some functionality
25-01-17 16:51:47 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.62, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.15, wps=36694.5, wpb=4058.2, bsz=2, num_updates=20, lmquant_ppl_wikitext_all_quanted=7.71225, lmquant_ppl_val_all_quanted=7.42746, lmquant_ppl_wikitext_partly_quanted=7.73372, lmquant_ppl_val_partly_quanted=7.44978
25-01-17 16:51:47 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.62 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.15 | wps 36694.5 | wpb 4058.2 | bsz 2 | num_updates 20 | lmquant_ppl_wikitext_all_quanted 7.71225 | lmquant_ppl_val_all_quanted 7.42746 | lmquant_ppl_wikitext_partly_quanted 7.73372 | lmquant_ppl_val_partly_quanted 7.44978
25-01-17 16:51:47 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:51:47 | I | in layer model.layers.4
25-01-17 16:51:47 | I | quantizing weights for layer model.layers.4
25-01-17 16:51:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:47 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:51:48 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:51:48 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:51:49 | I |       - range scale = [    1.0000]
25-01-17 16:51:49 | I |         sum  error  = [    0.5711]
25-01-17 16:51:49 | I |         best error  = [    0.5711]
25-01-17 16:51:49 | I |     + error = [0.5711]
25-01-17 16:51:49 | I |       - range scale = [    1.0000]
25-01-17 16:51:49 | I |         sum  error  = [    4.3509]
25-01-17 16:51:49 | I |         best error  = [    4.3509]
25-01-17 16:51:49 | I |     + error = [4.3509]
25-01-17 16:51:50 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:51:50 | I |       - range scale = [    1.0000]
25-01-17 16:51:50 | I |         sum  error  = [    0.2570]
25-01-17 16:51:50 | I |         best error  = [    0.2570]
25-01-17 16:51:50 | I |     + error = [0.2570]
25-01-17 16:51:51 | I |       - range scale = [    1.0000]
25-01-17 16:51:51 | I |         sum  error  = [    2.2613]
25-01-17 16:51:51 | I |         best error  = [    2.2613]
25-01-17 16:51:51 | I |     + error = [2.2613]
25-01-17 16:51:51 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:51:52 | I |       - range scale = [    1.0000]
25-01-17 16:51:52 | I |         sum  error  = [    0.6172]
25-01-17 16:51:52 | I |         best error  = [    0.6172]
25-01-17 16:51:52 | I |     + error = [0.6172]
25-01-17 16:51:53 | I |       - range scale = [    1.0000]
25-01-17 16:51:53 | I |         sum  error  = [    6.9231]
25-01-17 16:51:53 | I |         best error  = [    6.9231]
25-01-17 16:51:53 | I |     + error = [6.9231]
25-01-17 16:51:53 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:51:54 | I |       - range scale = [    1.0000]
25-01-17 16:51:54 | I |         sum  error  = [    0.1026]
25-01-17 16:51:54 | I |         best error  = [    0.1026]
25-01-17 16:51:54 | I |     + error = [0.1026]
25-01-17 16:51:54 | I |       - range scale = [    1.0000]
25-01-17 16:51:54 | I |         sum  error  = [    1.1142]
25-01-17 16:51:54 | I |         best error  = [    1.1142]
25-01-17 16:51:54 | I |     + error = [1.1142]
25-01-17 16:51:55 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:51:55 | I |       - range scale = [    1.0000]
25-01-17 16:51:55 | I |         sum  error  = [    2.0675]
25-01-17 16:51:55 | I |         best error  = [    2.0675]
25-01-17 16:51:55 | I |     + error = [2.0675]
25-01-17 16:51:56 | I |       - range scale = [    1.0000]
25-01-17 16:51:56 | I |         sum  error  = [   23.2973]
25-01-17 16:51:56 | I |         best error  = [   23.2973]
25-01-17 16:51:56 | I |     + error = [23.2973]
25-01-17 16:51:56 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:51:57 | I |       - range scale = [    1.0000]
25-01-17 16:51:57 | I |         sum  error  = [    2.2647]
25-01-17 16:51:57 | I |         best error  = [    2.2647]
25-01-17 16:51:57 | I |     + error = [2.2647]
25-01-17 16:51:58 | I |       - range scale = [    1.0000]
25-01-17 16:51:58 | I |         sum  error  = [   25.4377]
25-01-17 16:51:58 | I |         best error  = [   25.4377]
25-01-17 16:51:58 | I |     + error = [25.4377]
25-01-17 16:51:58 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:51:59 | I |       - range scale = [    1.0000]
25-01-17 16:51:59 | I |         sum  error  = [    0.1717]
25-01-17 16:51:59 | I |         best error  = [    0.1717]
25-01-17 16:51:59 | I |     + error = [0.1717]
25-01-17 16:52:00 | I |       - range scale = [    1.0000]
25-01-17 16:52:00 | I |         sum  error  = [    1.7671]
25-01-17 16:52:00 | I |         best error  = [    1.7671]
25-01-17 16:52:00 | I |     + error = [1.7671]
25-01-17 16:52:00 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:52:02 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:52:04 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:52:05 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:52:07 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:52:09 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:52:11 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:52:14 | I | quantizing activations for layer model.layers.4
25-01-17 16:52:15 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:15 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:15 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:15 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:17 | I | forward this layer
25-01-17 16:52:17 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/52.pt
25-01-17 16:52:17 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/52.pt
25-01-17 16:52:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:52:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:52:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:52:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:52:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:52:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:52:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:52:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:52:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:52:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:52:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:52:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:52:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:52:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:52:17 | I | in layer model.layers.4
25-01-17 16:52:17 | I | quantizing weights for layer model.layers.4
25-01-17 16:52:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:18 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:52:18 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:52:19 | I |       - range scale = [    1.0000]
25-01-17 16:52:19 | I |         sum  error  = [    0.5792]
25-01-17 16:52:19 | I |         best error  = [    0.5792]
25-01-17 16:52:19 | I |     + error = [0.5792]
25-01-17 16:52:20 | I |       - range scale = [    1.0000]
25-01-17 16:52:20 | I |         sum  error  = [    4.2638]
25-01-17 16:52:20 | I |         best error  = [    4.2638]
25-01-17 16:52:20 | I |     + error = [4.2638]
25-01-17 16:52:20 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:52:21 | I |       - range scale = [    1.0000]
25-01-17 16:52:21 | I |         sum  error  = [    0.2521]
25-01-17 16:52:21 | I |         best error  = [    0.2521]
25-01-17 16:52:21 | I |     + error = [0.2521]
25-01-17 16:52:22 | I |       - range scale = [    1.0000]
25-01-17 16:52:22 | I |         sum  error  = [    2.2328]
25-01-17 16:52:22 | I |         best error  = [    2.2328]
25-01-17 16:52:22 | I |     + error = [2.2328]
25-01-17 16:52:22 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:52:23 | I |       - range scale = [    1.0000]
25-01-17 16:52:23 | I |         sum  error  = [    0.6157]
25-01-17 16:52:23 | I |         best error  = [    0.6157]
25-01-17 16:52:23 | I |     + error = [0.6157]
25-01-17 16:52:23 | I |       - range scale = [    1.0000]
25-01-17 16:52:23 | I |         sum  error  = [    6.9032]
25-01-17 16:52:23 | I |         best error  = [    6.9032]
25-01-17 16:52:23 | I |     + error = [6.9032]
25-01-17 16:52:24 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:52:24 | I |       - range scale = [    1.0000]
25-01-17 16:52:24 | I |         sum  error  = [    0.1061]
25-01-17 16:52:24 | I |         best error  = [    0.1061]
25-01-17 16:52:24 | I |     + error = [0.1061]
25-01-17 16:52:25 | I |       - range scale = [    1.0000]
25-01-17 16:52:25 | I |         sum  error  = [    1.1509]
25-01-17 16:52:25 | I |         best error  = [    1.1509]
25-01-17 16:52:25 | I |     + error = [1.1509]
25-01-17 16:52:25 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:52:26 | I |       - range scale = [    1.0000]
25-01-17 16:52:26 | I |         sum  error  = [    2.0208]
25-01-17 16:52:26 | I |         best error  = [    2.0208]
25-01-17 16:52:26 | I |     + error = [2.0208]
25-01-17 16:52:27 | I |       - range scale = [    1.0000]
25-01-17 16:52:27 | I |         sum  error  = [   22.7655]
25-01-17 16:52:27 | I |         best error  = [   22.7655]
25-01-17 16:52:27 | I |     + error = [22.7655]
25-01-17 16:52:27 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:52:28 | I |       - range scale = [    1.0000]
25-01-17 16:52:28 | I |         sum  error  = [    2.2074]
25-01-17 16:52:28 | I |         best error  = [    2.2074]
25-01-17 16:52:28 | I |     + error = [2.2074]
25-01-17 16:52:28 | I |       - range scale = [    1.0000]
25-01-17 16:52:28 | I |         sum  error  = [   24.8490]
25-01-17 16:52:28 | I |         best error  = [   24.8490]
25-01-17 16:52:28 | I |     + error = [24.8490]
25-01-17 16:52:29 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:52:30 | I |       - range scale = [    1.0000]
25-01-17 16:52:30 | I |         sum  error  = [    0.1730]
25-01-17 16:52:30 | I |         best error  = [    0.1730]
25-01-17 16:52:30 | I |     + error = [0.1730]
25-01-17 16:52:30 | I |       - range scale = [    1.0000]
25-01-17 16:52:30 | I |         sum  error  = [    1.7827]
25-01-17 16:52:30 | I |         best error  = [    1.7827]
25-01-17 16:52:30 | I |     + error = [1.7827]
25-01-17 16:52:31 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:52:32 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:52:33 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:52:35 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:52:36 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:52:38 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:52:39 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:52:42 | I | quantizing activations for layer model.layers.4
25-01-17 16:52:43 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:43 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:43 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:43 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:45 | I | forward this layer
25-01-17 16:52:45 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/53.pt
25-01-17 16:52:45 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/53.pt
25-01-17 16:52:45 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:52:45 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:52:45 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:52:45 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:52:45 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:52:45 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:52:45 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:52:45 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:52:45 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:52:45 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:52:45 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:52:45 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:52:45 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:52:45 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:52:45 | I | [20] done with optimizer step
25-01-17 16:52:45 | I | epoch 001:     27 / 409600000 loss=1.72075e-05, loss_per_token=0.0352409, loss_sum=1154.77, wps=205.3, ups=0.01, wpb=32768, bsz=64, num_updates=21, lr=6.3e-05, gnorm=0.062, clip=0, loss_scale=2, train_wall=58, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=1981
25-01-17 16:52:45 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:52:45 | I | in layer model.layers.4
25-01-17 16:52:45 | I | quantizing weights for layer model.layers.4
25-01-17 16:52:46 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:46 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:46 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:46 | I | collecting calibration activations in model.layers.4
25-01-17 16:52:46 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:52:46 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:52:47 | I |       - range scale = [    1.0000]
25-01-17 16:52:47 | I |         sum  error  = [    0.5193]
25-01-17 16:52:47 | I |         best error  = [    0.5193]
25-01-17 16:52:47 | I |     + error = [0.5193]
25-01-17 16:52:48 | I |       - range scale = [    1.0000]
25-01-17 16:52:48 | I |         sum  error  = [    3.9748]
25-01-17 16:52:48 | I |         best error  = [    3.9748]
25-01-17 16:52:48 | I |     + error = [3.9748]
25-01-17 16:52:48 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:52:49 | I |       - range scale = [    1.0000]
25-01-17 16:52:49 | I |         sum  error  = [    0.2334]
25-01-17 16:52:49 | I |         best error  = [    0.2334]
25-01-17 16:52:49 | I |     + error = [0.2334]
25-01-17 16:52:49 | I |       - range scale = [    1.0000]
25-01-17 16:52:49 | I |         sum  error  = [    2.0289]
25-01-17 16:52:49 | I |         best error  = [    2.0289]
25-01-17 16:52:49 | I |     + error = [2.0289]
25-01-17 16:52:50 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:52:50 | I |       - range scale = [    1.0000]
25-01-17 16:52:50 | I |         sum  error  = [    0.6071]
25-01-17 16:52:50 | I |         best error  = [    0.6071]
25-01-17 16:52:50 | I |     + error = [0.6071]
25-01-17 16:52:51 | I |       - range scale = [    1.0000]
25-01-17 16:52:51 | I |         sum  error  = [    6.8120]
25-01-17 16:52:51 | I |         best error  = [    6.8120]
25-01-17 16:52:51 | I |     + error = [6.8120]
25-01-17 16:52:51 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:52:52 | I |       - range scale = [    1.0000]
25-01-17 16:52:52 | I |         sum  error  = [    0.0928]
25-01-17 16:52:52 | I |         best error  = [    0.0928]
25-01-17 16:52:52 | I |     + error = [0.0928]
25-01-17 16:52:53 | I |       - range scale = [    1.0000]
25-01-17 16:52:53 | I |         sum  error  = [    1.0122]
25-01-17 16:52:53 | I |         best error  = [    1.0122]
25-01-17 16:52:53 | I |     + error = [1.0122]
25-01-17 16:52:53 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:52:53 | I |       - range scale = [    1.0000]
25-01-17 16:52:53 | I |         sum  error  = [    2.0039]
25-01-17 16:52:53 | I |         best error  = [    2.0039]
25-01-17 16:52:53 | I |     + error = [2.0039]
25-01-17 16:52:54 | I |       - range scale = [    1.0000]
25-01-17 16:52:54 | I |         sum  error  = [   22.5592]
25-01-17 16:52:54 | I |         best error  = [   22.5592]
25-01-17 16:52:54 | I |     + error = [22.5592]
25-01-17 16:52:54 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:52:55 | I |       - range scale = [    1.0000]
25-01-17 16:52:55 | I |         sum  error  = [    2.1915]
25-01-17 16:52:55 | I |         best error  = [    2.1915]
25-01-17 16:52:55 | I |     + error = [2.1915]
25-01-17 16:52:56 | I |       - range scale = [    1.0000]
25-01-17 16:52:56 | I |         sum  error  = [   24.6130]
25-01-17 16:52:56 | I |         best error  = [   24.6130]
25-01-17 16:52:56 | I |     + error = [24.6130]
25-01-17 16:52:56 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:52:57 | I |       - range scale = [    1.0000]
25-01-17 16:52:57 | I |         sum  error  = [    0.1668]
25-01-17 16:52:57 | I |         best error  = [    0.1668]
25-01-17 16:52:57 | I |     + error = [0.1668]
25-01-17 16:52:58 | I |       - range scale = [    1.0000]
25-01-17 16:52:58 | I |         sum  error  = [    1.7085]
25-01-17 16:52:58 | I |         best error  = [    1.7085]
25-01-17 16:52:58 | I |     + error = [1.7085]
25-01-17 16:52:58 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:52:59 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:53:01 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:53:02 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:53:03 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:53:05 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:53:06 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:53:10 | I | quantizing activations for layer model.layers.4
25-01-17 16:53:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:10 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:12 | I | forward this layer
25-01-17 16:53:12 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/54.pt
25-01-17 16:53:12 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/54.pt
25-01-17 16:53:12 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:53:12 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:53:12 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:53:12 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:53:12 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:53:12 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:53:12 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:53:12 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:53:12 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:53:12 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:53:12 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:53:12 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:53:12 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:53:12 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:53:12 | I | in layer model.layers.4
25-01-17 16:53:12 | I | quantizing weights for layer model.layers.4
25-01-17 16:53:13 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:13 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:13 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:13 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:14 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:53:14 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:53:14 | I |       - range scale = [    1.0000]
25-01-17 16:53:14 | I |         sum  error  = [    0.5987]
25-01-17 16:53:14 | I |         best error  = [    0.5987]
25-01-17 16:53:14 | I |     + error = [0.5987]
25-01-17 16:53:15 | I |       - range scale = [    1.0000]
25-01-17 16:53:15 | I |         sum  error  = [    4.3247]
25-01-17 16:53:15 | I |         best error  = [    4.3247]
25-01-17 16:53:15 | I |     + error = [4.3247]
25-01-17 16:53:15 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:53:16 | I |       - range scale = [    1.0000]
25-01-17 16:53:16 | I |         sum  error  = [    0.2630]
25-01-17 16:53:16 | I |         best error  = [    0.2630]
25-01-17 16:53:16 | I |     + error = [0.2630]
25-01-17 16:53:17 | I |       - range scale = [    1.0000]
25-01-17 16:53:17 | I |         sum  error  = [    2.1729]
25-01-17 16:53:17 | I |         best error  = [    2.1729]
25-01-17 16:53:17 | I |     + error = [2.1729]
25-01-17 16:53:17 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:53:18 | I |       - range scale = [    1.0000]
25-01-17 16:53:18 | I |         sum  error  = [    0.6232]
25-01-17 16:53:18 | I |         best error  = [    0.6232]
25-01-17 16:53:18 | I |     + error = [0.6232]
25-01-17 16:53:18 | I |       - range scale = [    1.0000]
25-01-17 16:53:18 | I |         sum  error  = [    6.9589]
25-01-17 16:53:18 | I |         best error  = [    6.9589]
25-01-17 16:53:18 | I |     + error = [6.9589]
25-01-17 16:53:19 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:53:19 | I |       - range scale = [    1.0000]
25-01-17 16:53:19 | I |         sum  error  = [    0.1068]
25-01-17 16:53:19 | I |         best error  = [    0.1068]
25-01-17 16:53:19 | I |     + error = [0.1068]
25-01-17 16:53:20 | I |       - range scale = [    1.0000]
25-01-17 16:53:20 | I |         sum  error  = [    1.1575]
25-01-17 16:53:20 | I |         best error  = [    1.1575]
25-01-17 16:53:20 | I |     + error = [1.1575]
25-01-17 16:53:20 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:53:21 | I |       - range scale = [    1.0000]
25-01-17 16:53:21 | I |         sum  error  = [    2.0299]
25-01-17 16:53:21 | I |         best error  = [    2.0299]
25-01-17 16:53:21 | I |     + error = [2.0299]
25-01-17 16:53:22 | I |       - range scale = [    1.0000]
25-01-17 16:53:22 | I |         sum  error  = [   22.8526]
25-01-17 16:53:22 | I |         best error  = [   22.8526]
25-01-17 16:53:22 | I |     + error = [22.8526]
25-01-17 16:53:22 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:53:23 | I |       - range scale = [    1.0000]
25-01-17 16:53:23 | I |         sum  error  = [    2.2205]
25-01-17 16:53:23 | I |         best error  = [    2.2205]
25-01-17 16:53:23 | I |     + error = [2.2205]
25-01-17 16:53:24 | I |       - range scale = [    1.0000]
25-01-17 16:53:24 | I |         sum  error  = [   24.9409]
25-01-17 16:53:24 | I |         best error  = [   24.9409]
25-01-17 16:53:24 | I |     + error = [24.9409]
25-01-17 16:53:24 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:53:25 | I |       - range scale = [    1.0000]
25-01-17 16:53:25 | I |         sum  error  = [    0.1716]
25-01-17 16:53:25 | I |         best error  = [    0.1716]
25-01-17 16:53:25 | I |     + error = [0.1716]
25-01-17 16:53:25 | I |       - range scale = [    1.0000]
25-01-17 16:53:25 | I |         sum  error  = [    1.7608]
25-01-17 16:53:25 | I |         best error  = [    1.7608]
25-01-17 16:53:25 | I |     + error = [1.7608]
25-01-17 16:53:26 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:53:27 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:53:29 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:53:30 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:53:32 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:53:33 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:53:35 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:53:38 | I | quantizing activations for layer model.layers.4
25-01-17 16:53:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:38 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:41 | I | forward this layer
25-01-17 16:53:41 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/55.pt
25-01-17 16:53:41 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/55.pt
25-01-17 16:53:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:53:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:53:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:53:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:53:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:53:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:53:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:53:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:53:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:53:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:53:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:53:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:53:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:53:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:53:41 | I | [21] done with optimizer step
25-01-17 16:53:41 | I | epoch 001:     28 / 409600000 loss=1.75254e-05, loss_per_token=0.0358919, loss_sum=1176.11, wps=588.6, ups=0.02, wpb=32768, bsz=64, num_updates=22, lr=6.6e-05, gnorm=0.071, clip=0, loss_scale=2, train_wall=56, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=2037
25-01-17 16:53:41 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:53:41 | I | in layer model.layers.4
25-01-17 16:53:41 | I | quantizing weights for layer model.layers.4
25-01-17 16:53:41 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:42 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:42 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:42 | I | collecting calibration activations in model.layers.4
25-01-17 16:53:42 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:53:42 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:53:43 | I |       - range scale = [    1.0000]
25-01-17 16:53:43 | I |         sum  error  = [    0.5231]
25-01-17 16:53:43 | I |         best error  = [    0.5231]
25-01-17 16:53:43 | I |     + error = [0.5231]
25-01-17 16:53:43 | I |       - range scale = [    1.0000]
25-01-17 16:53:43 | I |         sum  error  = [    4.1015]
25-01-17 16:53:43 | I |         best error  = [    4.1015]
25-01-17 16:53:43 | I |     + error = [4.1015]
25-01-17 16:53:44 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:53:44 | I |       - range scale = [    1.0000]
25-01-17 16:53:44 | I |         sum  error  = [    0.2656]
25-01-17 16:53:44 | I |         best error  = [    0.2656]
25-01-17 16:53:44 | I |     + error = [0.2656]
25-01-17 16:53:45 | I |       - range scale = [    1.0000]
25-01-17 16:53:45 | I |         sum  error  = [    2.1459]
25-01-17 16:53:45 | I |         best error  = [    2.1459]
25-01-17 16:53:45 | I |     + error = [2.1459]
25-01-17 16:53:45 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:53:46 | I |       - range scale = [    1.0000]
25-01-17 16:53:46 | I |         sum  error  = [    0.6071]
25-01-17 16:53:46 | I |         best error  = [    0.6071]
25-01-17 16:53:46 | I |     + error = [0.6071]
25-01-17 16:53:47 | I |       - range scale = [    1.0000]
25-01-17 16:53:47 | I |         sum  error  = [    6.8443]
25-01-17 16:53:47 | I |         best error  = [    6.8443]
25-01-17 16:53:47 | I |     + error = [6.8443]
25-01-17 16:53:47 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:53:48 | I |       - range scale = [    1.0000]
25-01-17 16:53:48 | I |         sum  error  = [    0.0955]
25-01-17 16:53:48 | I |         best error  = [    0.0955]
25-01-17 16:53:48 | I |     + error = [0.0955]
25-01-17 16:53:48 | I |       - range scale = [    1.0000]
25-01-17 16:53:48 | I |         sum  error  = [    1.0373]
25-01-17 16:53:48 | I |         best error  = [    1.0373]
25-01-17 16:53:48 | I |     + error = [1.0373]
25-01-17 16:53:49 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:53:49 | I |       - range scale = [    1.0000]
25-01-17 16:53:49 | I |         sum  error  = [    2.0349]
25-01-17 16:53:49 | I |         best error  = [    2.0349]
25-01-17 16:53:49 | I |     + error = [2.0349]
25-01-17 16:53:50 | I |       - range scale = [    1.0000]
25-01-17 16:53:50 | I |         sum  error  = [   22.9125]
25-01-17 16:53:50 | I |         best error  = [   22.9125]
25-01-17 16:53:50 | I |     + error = [22.9125]
25-01-17 16:53:50 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:53:51 | I |       - range scale = [    1.0000]
25-01-17 16:53:51 | I |         sum  error  = [    2.2263]
25-01-17 16:53:51 | I |         best error  = [    2.2263]
25-01-17 16:53:51 | I |     + error = [2.2263]
25-01-17 16:53:52 | I |       - range scale = [    1.0000]
25-01-17 16:53:52 | I |         sum  error  = [   25.0015]
25-01-17 16:53:52 | I |         best error  = [   25.0015]
25-01-17 16:53:52 | I |     + error = [25.0015]
25-01-17 16:53:52 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:53:53 | I |       - range scale = [    1.0000]
25-01-17 16:53:53 | I |         sum  error  = [    0.1682]
25-01-17 16:53:53 | I |         best error  = [    0.1682]
25-01-17 16:53:53 | I |     + error = [0.1682]
25-01-17 16:53:54 | I |       - range scale = [    1.0000]
25-01-17 16:53:54 | I |         sum  error  = [    1.7236]
25-01-17 16:53:54 | I |         best error  = [    1.7236]
25-01-17 16:53:54 | I |     + error = [1.7236]
25-01-17 16:53:54 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:53:55 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:53:57 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:53:58 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:53:59 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:54:01 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:54:02 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:54:06 | I | quantizing activations for layer model.layers.4
25-01-17 16:54:06 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:06 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:06 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:06 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:08 | I | forward this layer
25-01-17 16:54:08 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/56.pt
25-01-17 16:54:08 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/56.pt
25-01-17 16:54:08 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:54:08 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:54:08 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:54:08 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:54:08 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:54:08 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:54:08 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:54:08 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:54:08 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:54:08 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:54:08 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:54:08 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:54:08 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:54:08 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:54:08 | I | in layer model.layers.4
25-01-17 16:54:08 | I | quantizing weights for layer model.layers.4
25-01-17 16:54:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:09 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:10 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:54:10 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:54:10 | I |       - range scale = [    1.0000]
25-01-17 16:54:10 | I |         sum  error  = [    0.5508]
25-01-17 16:54:10 | I |         best error  = [    0.5508]
25-01-17 16:54:10 | I |     + error = [0.5508]
25-01-17 16:54:11 | I |       - range scale = [    1.0000]
25-01-17 16:54:11 | I |         sum  error  = [    4.3682]
25-01-17 16:54:11 | I |         best error  = [    4.3682]
25-01-17 16:54:11 | I |     + error = [4.3682]
25-01-17 16:54:11 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:54:12 | I |       - range scale = [    1.0000]
25-01-17 16:54:12 | I |         sum  error  = [    0.2604]
25-01-17 16:54:12 | I |         best error  = [    0.2604]
25-01-17 16:54:12 | I |     + error = [0.2604]
25-01-17 16:54:13 | I |       - range scale = [    1.0000]
25-01-17 16:54:13 | I |         sum  error  = [    2.0960]
25-01-17 16:54:13 | I |         best error  = [    2.0960]
25-01-17 16:54:13 | I |     + error = [2.0960]
25-01-17 16:54:13 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:54:13 | I |       - range scale = [    1.0000]
25-01-17 16:54:13 | I |         sum  error  = [    0.6113]
25-01-17 16:54:13 | I |         best error  = [    0.6113]
25-01-17 16:54:13 | I |     + error = [0.6113]
25-01-17 16:54:14 | I |       - range scale = [    1.0000]
25-01-17 16:54:14 | I |         sum  error  = [    6.8289]
25-01-17 16:54:14 | I |         best error  = [    6.8289]
25-01-17 16:54:14 | I |     + error = [6.8289]
25-01-17 16:54:14 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:54:15 | I |       - range scale = [    1.0000]
25-01-17 16:54:15 | I |         sum  error  = [    0.1075]
25-01-17 16:54:15 | I |         best error  = [    0.1075]
25-01-17 16:54:15 | I |     + error = [0.1075]
25-01-17 16:54:16 | I |       - range scale = [    1.0000]
25-01-17 16:54:16 | I |         sum  error  = [    1.1591]
25-01-17 16:54:16 | I |         best error  = [    1.1591]
25-01-17 16:54:16 | I |     + error = [1.1591]
25-01-17 16:54:16 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:54:17 | I |       - range scale = [    1.0000]
25-01-17 16:54:17 | I |         sum  error  = [    2.0278]
25-01-17 16:54:17 | I |         best error  = [    2.0278]
25-01-17 16:54:17 | I |     + error = [2.0278]
25-01-17 16:54:17 | I |       - range scale = [    1.0000]
25-01-17 16:54:17 | I |         sum  error  = [   22.8139]
25-01-17 16:54:17 | I |         best error  = [   22.8139]
25-01-17 16:54:17 | I |     + error = [22.8139]
25-01-17 16:54:18 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:54:18 | I |       - range scale = [    1.0000]
25-01-17 16:54:18 | I |         sum  error  = [    2.2090]
25-01-17 16:54:18 | I |         best error  = [    2.2090]
25-01-17 16:54:18 | I |     + error = [2.2090]
25-01-17 16:54:19 | I |       - range scale = [    1.0000]
25-01-17 16:54:19 | I |         sum  error  = [   24.9031]
25-01-17 16:54:19 | I |         best error  = [   24.9031]
25-01-17 16:54:19 | I |     + error = [24.9031]
25-01-17 16:54:19 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:54:20 | I |       - range scale = [    1.0000]
25-01-17 16:54:20 | I |         sum  error  = [    0.1729]
25-01-17 16:54:20 | I |         best error  = [    0.1729]
25-01-17 16:54:20 | I |     + error = [0.1729]
25-01-17 16:54:21 | I |       - range scale = [    1.0000]
25-01-17 16:54:21 | I |         sum  error  = [    1.7692]
25-01-17 16:54:21 | I |         best error  = [    1.7692]
25-01-17 16:54:21 | I |     + error = [1.7692]
25-01-17 16:54:21 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:54:22 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:54:24 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:54:25 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:54:26 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:54:28 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:54:29 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:54:33 | I | quantizing activations for layer model.layers.4
25-01-17 16:54:33 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:33 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:33 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:33 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:35 | I | forward this layer
25-01-17 16:54:35 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/57.pt
25-01-17 16:54:35 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/57.pt
25-01-17 16:54:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:54:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:54:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:54:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:54:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:54:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:54:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:54:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:54:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:54:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:54:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:54:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:54:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:54:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:54:36 | I | [22] done with optimizer step
25-01-17 16:54:36 | I | epoch 001:     29 / 409600000 loss=1.58145e-05, loss_per_token=0.0323881, loss_sum=1061.29, wps=599, ups=0.02, wpb=32768, bsz=64, num_updates=23, lr=6.9e-05, gnorm=0.08, clip=0, loss_scale=2, train_wall=55, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=2092
25-01-17 16:54:36 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:54:36 | I | in layer model.layers.4
25-01-17 16:54:36 | I | quantizing weights for layer model.layers.4
25-01-17 16:54:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:36 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:37 | I | collecting calibration activations in model.layers.4
25-01-17 16:54:37 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:54:37 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:54:38 | I |       - range scale = [    1.0000]
25-01-17 16:54:38 | I |         sum  error  = [    0.6018]
25-01-17 16:54:38 | I |         best error  = [    0.6018]
25-01-17 16:54:38 | I |     + error = [0.6018]
25-01-17 16:54:38 | I |       - range scale = [    1.0000]
25-01-17 16:54:38 | I |         sum  error  = [    4.6702]
25-01-17 16:54:38 | I |         best error  = [    4.6702]
25-01-17 16:54:38 | I |     + error = [4.6702]
25-01-17 16:54:39 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:54:39 | I |       - range scale = [    1.0000]
25-01-17 16:54:39 | I |         sum  error  = [    0.2639]
25-01-17 16:54:39 | I |         best error  = [    0.2639]
25-01-17 16:54:39 | I |     + error = [0.2639]
25-01-17 16:54:40 | I |       - range scale = [    1.0000]
25-01-17 16:54:40 | I |         sum  error  = [    2.2049]
25-01-17 16:54:40 | I |         best error  = [    2.2049]
25-01-17 16:54:40 | I |     + error = [2.2049]
25-01-17 16:54:40 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:54:41 | I |       - range scale = [    1.0000]
25-01-17 16:54:41 | I |         sum  error  = [    0.6170]
25-01-17 16:54:41 | I |         best error  = [    0.6170]
25-01-17 16:54:41 | I |     + error = [0.6170]
25-01-17 16:54:42 | I |       - range scale = [    1.0000]
25-01-17 16:54:42 | I |         sum  error  = [    6.8856]
25-01-17 16:54:42 | I |         best error  = [    6.8856]
25-01-17 16:54:42 | I |     + error = [6.8856]
25-01-17 16:54:42 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:54:43 | I |       - range scale = [    1.0000]
25-01-17 16:54:43 | I |         sum  error  = [    0.1020]
25-01-17 16:54:43 | I |         best error  = [    0.1020]
25-01-17 16:54:43 | I |     + error = [0.1020]
25-01-17 16:54:43 | I |       - range scale = [    1.0000]
25-01-17 16:54:43 | I |         sum  error  = [    1.1156]
25-01-17 16:54:43 | I |         best error  = [    1.1156]
25-01-17 16:54:43 | I |     + error = [1.1156]
25-01-17 16:54:44 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:54:44 | I |       - range scale = [    1.0000]
25-01-17 16:54:44 | I |         sum  error  = [    2.0297]
25-01-17 16:54:44 | I |         best error  = [    2.0297]
25-01-17 16:54:44 | I |     + error = [2.0297]
25-01-17 16:54:45 | I |       - range scale = [    1.0000]
25-01-17 16:54:45 | I |         sum  error  = [   22.8756]
25-01-17 16:54:45 | I |         best error  = [   22.8756]
25-01-17 16:54:45 | I |     + error = [22.8756]
25-01-17 16:54:45 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:54:46 | I |       - range scale = [    1.0000]
25-01-17 16:54:46 | I |         sum  error  = [    2.2215]
25-01-17 16:54:46 | I |         best error  = [    2.2215]
25-01-17 16:54:46 | I |     + error = [2.2215]
25-01-17 16:54:47 | I |       - range scale = [    1.0000]
25-01-17 16:54:47 | I |         sum  error  = [   24.9625]
25-01-17 16:54:47 | I |         best error  = [   24.9625]
25-01-17 16:54:47 | I |     + error = [24.9625]
25-01-17 16:54:47 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:54:48 | I |       - range scale = [    1.0000]
25-01-17 16:54:48 | I |         sum  error  = [    0.1761]
25-01-17 16:54:48 | I |         best error  = [    0.1761]
25-01-17 16:54:48 | I |     + error = [0.1761]
25-01-17 16:54:48 | I |       - range scale = [    1.0000]
25-01-17 16:54:48 | I |         sum  error  = [    1.7984]
25-01-17 16:54:48 | I |         best error  = [    1.7984]
25-01-17 16:54:48 | I |     + error = [1.7984]
25-01-17 16:54:49 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:54:50 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:54:52 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:54:53 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:54:55 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:54:56 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:54:58 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:55:01 | I | quantizing activations for layer model.layers.4
25-01-17 16:55:01 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:02 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:02 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:02 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:04 | I | forward this layer
25-01-17 16:55:04 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/58.pt
25-01-17 16:55:04 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/58.pt
25-01-17 16:55:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:55:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:55:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:55:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:55:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:55:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:55:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:55:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:55:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:55:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:55:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:55:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:55:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:55:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:55:04 | I | in layer model.layers.4
25-01-17 16:55:04 | I | quantizing weights for layer model.layers.4
25-01-17 16:55:04 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:04 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:05 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:05 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:05 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:55:05 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:55:06 | I |       - range scale = [    1.0000]
25-01-17 16:55:06 | I |         sum  error  = [    0.5908]
25-01-17 16:55:06 | I |         best error  = [    0.5908]
25-01-17 16:55:06 | I |     + error = [0.5908]
25-01-17 16:55:06 | I |       - range scale = [    1.0000]
25-01-17 16:55:06 | I |         sum  error  = [    4.5570]
25-01-17 16:55:06 | I |         best error  = [    4.5570]
25-01-17 16:55:06 | I |     + error = [4.5570]
25-01-17 16:55:07 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:55:07 | I |       - range scale = [    1.0000]
25-01-17 16:55:07 | I |         sum  error  = [    0.2478]
25-01-17 16:55:07 | I |         best error  = [    0.2478]
25-01-17 16:55:07 | I |     + error = [0.2478]
25-01-17 16:55:08 | I |       - range scale = [    1.0000]
25-01-17 16:55:08 | I |         sum  error  = [    2.1275]
25-01-17 16:55:08 | I |         best error  = [    2.1275]
25-01-17 16:55:08 | I |     + error = [2.1275]
25-01-17 16:55:08 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:55:09 | I |       - range scale = [    1.0000]
25-01-17 16:55:09 | I |         sum  error  = [    0.6150]
25-01-17 16:55:09 | I |         best error  = [    0.6150]
25-01-17 16:55:09 | I |     + error = [0.6150]
25-01-17 16:55:10 | I |       - range scale = [    1.0000]
25-01-17 16:55:10 | I |         sum  error  = [    6.8571]
25-01-17 16:55:10 | I |         best error  = [    6.8571]
25-01-17 16:55:10 | I |     + error = [6.8571]
25-01-17 16:55:10 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:55:11 | I |       - range scale = [    1.0000]
25-01-17 16:55:11 | I |         sum  error  = [    0.1007]
25-01-17 16:55:11 | I |         best error  = [    0.1007]
25-01-17 16:55:11 | I |     + error = [0.1007]
25-01-17 16:55:11 | I |       - range scale = [    1.0000]
25-01-17 16:55:11 | I |         sum  error  = [    1.1070]
25-01-17 16:55:11 | I |         best error  = [    1.1070]
25-01-17 16:55:11 | I |     + error = [1.1070]
25-01-17 16:55:12 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:55:12 | I |       - range scale = [    1.0000]
25-01-17 16:55:12 | I |         sum  error  = [    2.0218]
25-01-17 16:55:12 | I |         best error  = [    2.0218]
25-01-17 16:55:12 | I |     + error = [2.0218]
25-01-17 16:55:13 | I |       - range scale = [    1.0000]
25-01-17 16:55:13 | I |         sum  error  = [   22.7679]
25-01-17 16:55:13 | I |         best error  = [   22.7679]
25-01-17 16:55:13 | I |     + error = [22.7679]
25-01-17 16:55:13 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:55:14 | I |       - range scale = [    1.0000]
25-01-17 16:55:14 | I |         sum  error  = [    2.2132]
25-01-17 16:55:14 | I |         best error  = [    2.2132]
25-01-17 16:55:14 | I |     + error = [2.2132]
25-01-17 16:55:15 | I |       - range scale = [    1.0000]
25-01-17 16:55:15 | I |         sum  error  = [   24.8455]
25-01-17 16:55:15 | I |         best error  = [   24.8455]
25-01-17 16:55:15 | I |     + error = [24.8455]
25-01-17 16:55:15 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:55:16 | I |       - range scale = [    1.0000]
25-01-17 16:55:16 | I |         sum  error  = [    0.1731]
25-01-17 16:55:16 | I |         best error  = [    0.1731]
25-01-17 16:55:16 | I |     + error = [0.1731]
25-01-17 16:55:16 | I |       - range scale = [    1.0000]
25-01-17 16:55:16 | I |         sum  error  = [    1.7741]
25-01-17 16:55:16 | I |         best error  = [    1.7741]
25-01-17 16:55:16 | I |     + error = [1.7741]
25-01-17 16:55:17 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:55:18 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:55:19 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:55:21 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:55:22 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:55:23 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:55:25 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:55:28 | I | quantizing activations for layer model.layers.4
25-01-17 16:55:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:29 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:31 | I | forward this layer
25-01-17 16:55:31 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/59.pt
25-01-17 16:55:31 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/59.pt
25-01-17 16:55:31 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:55:31 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:55:31 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:55:31 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:55:31 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:55:31 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:55:31 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:55:31 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:55:31 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:55:31 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:55:31 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:55:31 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:55:31 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:55:31 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:55:31 | I | [23] done with optimizer step
25-01-17 16:55:31 | I | epoch 001:     30 / 409600000 loss=1.68888e-05, loss_per_token=0.0345882, loss_sum=1133.39, wps=591.1, ups=0.02, wpb=32768, bsz=64, num_updates=24, lr=7.2e-05, gnorm=0.078, clip=0, loss_scale=2, train_wall=55, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=2147
25-01-17 16:55:31 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:55:31 | I | in layer model.layers.4
25-01-17 16:55:31 | I | quantizing weights for layer model.layers.4
25-01-17 16:55:32 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:32 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:32 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:32 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:32 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:55:32 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:55:33 | I |       - range scale = [    1.0000]
25-01-17 16:55:33 | I |         sum  error  = [    0.5981]
25-01-17 16:55:33 | I |         best error  = [    0.5981]
25-01-17 16:55:33 | I |     + error = [0.5981]
25-01-17 16:55:34 | I |       - range scale = [    1.0000]
25-01-17 16:55:34 | I |         sum  error  = [    4.8086]
25-01-17 16:55:34 | I |         best error  = [    4.8086]
25-01-17 16:55:34 | I |     + error = [4.8086]
25-01-17 16:55:34 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:55:35 | I |       - range scale = [    1.0000]
25-01-17 16:55:35 | I |         sum  error  = [    0.2760]
25-01-17 16:55:35 | I |         best error  = [    0.2760]
25-01-17 16:55:35 | I |     + error = [0.2760]
25-01-17 16:55:35 | I |       - range scale = [    1.0000]
25-01-17 16:55:35 | I |         sum  error  = [    2.2381]
25-01-17 16:55:35 | I |         best error  = [    2.2381]
25-01-17 16:55:35 | I |     + error = [2.2381]
25-01-17 16:55:36 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:55:36 | I |       - range scale = [    1.0000]
25-01-17 16:55:36 | I |         sum  error  = [    0.6084]
25-01-17 16:55:36 | I |         best error  = [    0.6084]
25-01-17 16:55:36 | I |     + error = [0.6084]
25-01-17 16:55:37 | I |       - range scale = [    1.0000]
25-01-17 16:55:37 | I |         sum  error  = [    6.8230]
25-01-17 16:55:37 | I |         best error  = [    6.8230]
25-01-17 16:55:37 | I |     + error = [6.8230]
25-01-17 16:55:37 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:55:38 | I |       - range scale = [    1.0000]
25-01-17 16:55:38 | I |         sum  error  = [    0.1012]
25-01-17 16:55:38 | I |         best error  = [    0.1012]
25-01-17 16:55:38 | I |     + error = [0.1012]
25-01-17 16:55:38 | I |       - range scale = [    1.0000]
25-01-17 16:55:38 | I |         sum  error  = [    1.1036]
25-01-17 16:55:38 | I |         best error  = [    1.1036]
25-01-17 16:55:38 | I |     + error = [1.1036]
25-01-17 16:55:39 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:55:39 | I |       - range scale = [    1.0000]
25-01-17 16:55:39 | I |         sum  error  = [    1.9861]
25-01-17 16:55:39 | I |         best error  = [    1.9861]
25-01-17 16:55:39 | I |     + error = [1.9861]
25-01-17 16:55:40 | I |       - range scale = [    1.0000]
25-01-17 16:55:40 | I |         sum  error  = [   22.3583]
25-01-17 16:55:40 | I |         best error  = [   22.3583]
25-01-17 16:55:40 | I |     + error = [22.3583]
25-01-17 16:55:40 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:55:41 | I |       - range scale = [    1.0000]
25-01-17 16:55:41 | I |         sum  error  = [    2.1695]
25-01-17 16:55:41 | I |         best error  = [    2.1695]
25-01-17 16:55:41 | I |     + error = [2.1695]
25-01-17 16:55:42 | I |       - range scale = [    1.0000]
25-01-17 16:55:42 | I |         sum  error  = [   24.3842]
25-01-17 16:55:42 | I |         best error  = [   24.3842]
25-01-17 16:55:42 | I |     + error = [24.3842]
25-01-17 16:55:42 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:55:43 | I |       - range scale = [    1.0000]
25-01-17 16:55:43 | I |         sum  error  = [    0.1680]
25-01-17 16:55:43 | I |         best error  = [    0.1680]
25-01-17 16:55:43 | I |     + error = [0.1680]
25-01-17 16:55:43 | I |       - range scale = [    1.0000]
25-01-17 16:55:43 | I |         sum  error  = [    1.7202]
25-01-17 16:55:43 | I |         best error  = [    1.7202]
25-01-17 16:55:43 | I |     + error = [1.7202]
25-01-17 16:55:44 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:55:45 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:55:47 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:55:48 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:55:49 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:55:51 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:55:52 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:55:56 | I | quantizing activations for layer model.layers.4
25-01-17 16:55:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:56 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:58 | I | forward this layer
25-01-17 16:55:58 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/60.pt
25-01-17 16:55:58 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/60.pt
25-01-17 16:55:59 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:55:59 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:55:59 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:55:59 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:55:59 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:55:59 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:55:59 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:55:59 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:55:59 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:55:59 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:55:59 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:55:59 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:55:59 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:55:59 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:55:59 | I | in layer model.layers.4
25-01-17 16:55:59 | I | quantizing weights for layer model.layers.4
25-01-17 16:55:59 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:59 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:59 | I | collecting calibration activations in model.layers.4
25-01-17 16:55:59 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:00 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:56:00 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:56:00 | I |       - range scale = [    1.0000]
25-01-17 16:56:00 | I |         sum  error  = [    0.5991]
25-01-17 16:56:00 | I |         best error  = [    0.5991]
25-01-17 16:56:00 | I |     + error = [0.5991]
25-01-17 16:56:01 | I |       - range scale = [    1.0000]
25-01-17 16:56:01 | I |         sum  error  = [    4.4828]
25-01-17 16:56:01 | I |         best error  = [    4.4828]
25-01-17 16:56:01 | I |     + error = [4.4828]
25-01-17 16:56:01 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:56:02 | I |       - range scale = [    1.0000]
25-01-17 16:56:02 | I |         sum  error  = [    0.2667]
25-01-17 16:56:02 | I |         best error  = [    0.2667]
25-01-17 16:56:02 | I |     + error = [0.2667]
25-01-17 16:56:03 | I |       - range scale = [    1.0000]
25-01-17 16:56:03 | I |         sum  error  = [    2.1610]
25-01-17 16:56:03 | I |         best error  = [    2.1610]
25-01-17 16:56:03 | I |     + error = [2.1610]
25-01-17 16:56:03 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:56:04 | I |       - range scale = [    1.0000]
25-01-17 16:56:04 | I |         sum  error  = [    0.6109]
25-01-17 16:56:04 | I |         best error  = [    0.6109]
25-01-17 16:56:04 | I |     + error = [0.6109]
25-01-17 16:56:04 | I |       - range scale = [    1.0000]
25-01-17 16:56:04 | I |         sum  error  = [    6.9043]
25-01-17 16:56:04 | I |         best error  = [    6.9043]
25-01-17 16:56:04 | I |     + error = [6.9043]
25-01-17 16:56:05 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:56:05 | I |       - range scale = [    1.0000]
25-01-17 16:56:05 | I |         sum  error  = [    0.0994]
25-01-17 16:56:05 | I |         best error  = [    0.0994]
25-01-17 16:56:05 | I |     + error = [0.0994]
25-01-17 16:56:06 | I |       - range scale = [    1.0000]
25-01-17 16:56:06 | I |         sum  error  = [    1.0803]
25-01-17 16:56:06 | I |         best error  = [    1.0803]
25-01-17 16:56:06 | I |     + error = [1.0803]
25-01-17 16:56:06 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:56:07 | I |       - range scale = [    1.0000]
25-01-17 16:56:07 | I |         sum  error  = [    2.0310]
25-01-17 16:56:07 | I |         best error  = [    2.0310]
25-01-17 16:56:07 | I |     + error = [2.0310]
25-01-17 16:56:08 | I |       - range scale = [    1.0000]
25-01-17 16:56:08 | I |         sum  error  = [   22.8323]
25-01-17 16:56:08 | I |         best error  = [   22.8323]
25-01-17 16:56:08 | I |     + error = [22.8323]
25-01-17 16:56:08 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:56:09 | I |       - range scale = [    1.0000]
25-01-17 16:56:09 | I |         sum  error  = [    2.2184]
25-01-17 16:56:09 | I |         best error  = [    2.2184]
25-01-17 16:56:09 | I |     + error = [2.2184]
25-01-17 16:56:09 | I |       - range scale = [    1.0000]
25-01-17 16:56:09 | I |         sum  error  = [   24.9261]
25-01-17 16:56:09 | I |         best error  = [   24.9261]
25-01-17 16:56:09 | I |     + error = [24.9261]
25-01-17 16:56:10 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:56:10 | I |       - range scale = [    1.0000]
25-01-17 16:56:10 | I |         sum  error  = [    0.1731]
25-01-17 16:56:10 | I |         best error  = [    0.1731]
25-01-17 16:56:10 | I |     + error = [0.1731]
25-01-17 16:56:11 | I |       - range scale = [    1.0000]
25-01-17 16:56:11 | I |         sum  error  = [    1.7741]
25-01-17 16:56:11 | I |         best error  = [    1.7741]
25-01-17 16:56:11 | I |     + error = [1.7741]
25-01-17 16:56:11 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:56:13 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:56:14 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:56:16 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:56:17 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:56:18 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:56:20 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:56:23 | I | quantizing activations for layer model.layers.4
25-01-17 16:56:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:24 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:26 | I | forward this layer
25-01-17 16:56:26 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/61.pt
25-01-17 16:56:26 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/61.pt
25-01-17 16:56:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:56:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:56:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:56:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:56:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:56:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:56:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:56:26 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:56:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:56:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:56:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:56:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:56:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:56:26 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:56:26 | I | [24] done with optimizer step
25-01-17 16:56:26 | I | epoch 001:     31 / 409600000 loss=1.71873e-05, loss_per_token=0.0351996, loss_sum=1153.42, wps=593.8, ups=0.02, wpb=32768, bsz=64, num_updates=25, lr=7.5e-05, gnorm=0.063, clip=0, loss_scale=2, train_wall=55, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=2202
25-01-17 16:56:26 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:56:26 | I | in layer model.layers.4
25-01-17 16:56:26 | I | quantizing weights for layer model.layers.4
25-01-17 16:56:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:27 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:27 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:56:27 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:56:28 | I |       - range scale = [    1.0000]
25-01-17 16:56:28 | I |         sum  error  = [    0.5357]
25-01-17 16:56:28 | I |         best error  = [    0.5357]
25-01-17 16:56:28 | I |     + error = [0.5357]
25-01-17 16:56:29 | I |       - range scale = [    1.0000]
25-01-17 16:56:29 | I |         sum  error  = [    4.2784]
25-01-17 16:56:29 | I |         best error  = [    4.2784]
25-01-17 16:56:29 | I |     + error = [4.2784]
25-01-17 16:56:29 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:56:30 | I |       - range scale = [    1.0000]
25-01-17 16:56:30 | I |         sum  error  = [    0.2326]
25-01-17 16:56:30 | I |         best error  = [    0.2326]
25-01-17 16:56:30 | I |     + error = [0.2326]
25-01-17 16:56:31 | I |       - range scale = [    1.0000]
25-01-17 16:56:31 | I |         sum  error  = [    2.0075]
25-01-17 16:56:31 | I |         best error  = [    2.0075]
25-01-17 16:56:31 | I |     + error = [2.0075]
25-01-17 16:56:31 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:56:31 | I |       - range scale = [    1.0000]
25-01-17 16:56:31 | I |         sum  error  = [    0.6227]
25-01-17 16:56:31 | I |         best error  = [    0.6227]
25-01-17 16:56:31 | I |     + error = [0.6227]
25-01-17 16:56:32 | I |       - range scale = [    1.0000]
25-01-17 16:56:32 | I |         sum  error  = [    7.0074]
25-01-17 16:56:32 | I |         best error  = [    7.0074]
25-01-17 16:56:32 | I |     + error = [7.0074]
25-01-17 16:56:32 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:56:33 | I |       - range scale = [    1.0000]
25-01-17 16:56:33 | I |         sum  error  = [    0.0904]
25-01-17 16:56:33 | I |         best error  = [    0.0904]
25-01-17 16:56:33 | I |     + error = [0.0904]
25-01-17 16:56:34 | I |       - range scale = [    1.0000]
25-01-17 16:56:34 | I |         sum  error  = [    0.9862]
25-01-17 16:56:34 | I |         best error  = [    0.9862]
25-01-17 16:56:34 | I |     + error = [0.9862]
25-01-17 16:56:34 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:56:35 | I |       - range scale = [    1.0000]
25-01-17 16:56:35 | I |         sum  error  = [    2.0498]
25-01-17 16:56:35 | I |         best error  = [    2.0498]
25-01-17 16:56:35 | I |     + error = [2.0498]
25-01-17 16:56:35 | I |       - range scale = [    1.0000]
25-01-17 16:56:35 | I |         sum  error  = [   23.0888]
25-01-17 16:56:35 | I |         best error  = [   23.0888]
25-01-17 16:56:35 | I |     + error = [23.0888]
25-01-17 16:56:36 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:56:36 | I |       - range scale = [    1.0000]
25-01-17 16:56:36 | I |         sum  error  = [    2.2434]
25-01-17 16:56:36 | I |         best error  = [    2.2434]
25-01-17 16:56:36 | I |     + error = [2.2434]
25-01-17 16:56:37 | I |       - range scale = [    1.0000]
25-01-17 16:56:37 | I |         sum  error  = [   25.2132]
25-01-17 16:56:37 | I |         best error  = [   25.2132]
25-01-17 16:56:37 | I |     + error = [25.2132]
25-01-17 16:56:37 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:56:38 | I |       - range scale = [    1.0000]
25-01-17 16:56:38 | I |         sum  error  = [    0.1807]
25-01-17 16:56:38 | I |         best error  = [    0.1807]
25-01-17 16:56:38 | I |     + error = [0.1807]
25-01-17 16:56:39 | I |       - range scale = [    1.0000]
25-01-17 16:56:39 | I |         sum  error  = [    1.8519]
25-01-17 16:56:39 | I |         best error  = [    1.8519]
25-01-17 16:56:39 | I |     + error = [1.8519]
25-01-17 16:56:39 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:56:41 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:56:42 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:56:43 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:56:45 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:56:46 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:56:48 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:56:51 | I | quantizing activations for layer model.layers.4
25-01-17 16:56:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:51 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:53 | I | forward this layer
25-01-17 16:56:53 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/62.pt
25-01-17 16:56:53 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/62.pt
25-01-17 16:56:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:56:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:56:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:56:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:56:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:56:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:56:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:56:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:56:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:56:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:56:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:56:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:56:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:56:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:56:54 | I | in layer model.layers.4
25-01-17 16:56:54 | I | quantizing weights for layer model.layers.4
25-01-17 16:56:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:54 | I | collecting calibration activations in model.layers.4
25-01-17 16:56:55 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:56:55 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:56:55 | I |       - range scale = [    1.0000]
25-01-17 16:56:55 | I |         sum  error  = [    0.5610]
25-01-17 16:56:55 | I |         best error  = [    0.5610]
25-01-17 16:56:55 | I |     + error = [0.5610]
25-01-17 16:56:56 | I |       - range scale = [    1.0000]
25-01-17 16:56:56 | I |         sum  error  = [    4.3883]
25-01-17 16:56:56 | I |         best error  = [    4.3883]
25-01-17 16:56:56 | I |     + error = [4.3883]
25-01-17 16:56:56 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:56:57 | I |       - range scale = [    1.0000]
25-01-17 16:56:57 | I |         sum  error  = [    0.2456]
25-01-17 16:56:57 | I |         best error  = [    0.2456]
25-01-17 16:56:57 | I |     + error = [0.2456]
25-01-17 16:56:58 | I |       - range scale = [    1.0000]
25-01-17 16:56:58 | I |         sum  error  = [    2.0522]
25-01-17 16:56:58 | I |         best error  = [    2.0522]
25-01-17 16:56:58 | I |     + error = [2.0522]
25-01-17 16:56:58 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:56:59 | I |       - range scale = [    1.0000]
25-01-17 16:56:59 | I |         sum  error  = [    0.6197]
25-01-17 16:56:59 | I |         best error  = [    0.6197]
25-01-17 16:56:59 | I |     + error = [0.6197]
25-01-17 16:56:59 | I |       - range scale = [    1.0000]
25-01-17 16:56:59 | I |         sum  error  = [    6.9723]
25-01-17 16:56:59 | I |         best error  = [    6.9723]
25-01-17 16:56:59 | I |     + error = [6.9723]
25-01-17 16:56:59 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:57:00 | I |       - range scale = [    1.0000]
25-01-17 16:57:00 | I |         sum  error  = [    0.0970]
25-01-17 16:57:00 | I |         best error  = [    0.0970]
25-01-17 16:57:00 | I |     + error = [0.0970]
25-01-17 16:57:01 | I |       - range scale = [    1.0000]
25-01-17 16:57:01 | I |         sum  error  = [    1.0590]
25-01-17 16:57:01 | I |         best error  = [    1.0590]
25-01-17 16:57:01 | I |     + error = [1.0590]
25-01-17 16:57:01 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:57:02 | I |       - range scale = [    1.0000]
25-01-17 16:57:02 | I |         sum  error  = [    2.0153]
25-01-17 16:57:02 | I |         best error  = [    2.0153]
25-01-17 16:57:02 | I |     + error = [2.0153]
25-01-17 16:57:02 | I |       - range scale = [    1.0000]
25-01-17 16:57:02 | I |         sum  error  = [   22.6439]
25-01-17 16:57:02 | I |         best error  = [   22.6439]
25-01-17 16:57:02 | I |     + error = [22.6439]
25-01-17 16:57:03 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:57:03 | I |       - range scale = [    1.0000]
25-01-17 16:57:03 | I |         sum  error  = [    2.2024]
25-01-17 16:57:03 | I |         best error  = [    2.2024]
25-01-17 16:57:03 | I |     + error = [2.2024]
25-01-17 16:57:04 | I |       - range scale = [    1.0000]
25-01-17 16:57:04 | I |         sum  error  = [   24.7236]
25-01-17 16:57:04 | I |         best error  = [   24.7236]
25-01-17 16:57:04 | I |     + error = [24.7236]
25-01-17 16:57:04 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:57:05 | I |       - range scale = [    1.0000]
25-01-17 16:57:05 | I |         sum  error  = [    0.1675]
25-01-17 16:57:05 | I |         best error  = [    0.1675]
25-01-17 16:57:05 | I |     + error = [0.1675]
25-01-17 16:57:06 | I |       - range scale = [    1.0000]
25-01-17 16:57:06 | I |         sum  error  = [    1.7120]
25-01-17 16:57:06 | I |         best error  = [    1.7120]
25-01-17 16:57:06 | I |     + error = [1.7120]
25-01-17 16:57:06 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:57:07 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:57:09 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:57:10 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:57:12 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:57:13 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:57:15 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:57:18 | I | quantizing activations for layer model.layers.4
25-01-17 16:57:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:18 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:19 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:21 | I | forward this layer
25-01-17 16:57:21 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/63.pt
25-01-17 16:57:21 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/63.pt
25-01-17 16:57:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:57:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:57:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:57:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:57:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:57:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:57:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:57:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:57:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:57:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:57:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:57:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:57:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:57:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:57:21 | I | [25] done with optimizer step
25-01-17 16:57:21 | I | epoch 001:     32 / 409600000 loss=1.48247e-05, loss_per_token=0.0303611, loss_sum=994.872, wps=600, ups=0.02, wpb=32768, bsz=64, num_updates=26, lr=7.8e-05, gnorm=0.08, clip=0, loss_scale=2, train_wall=54, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=2257
25-01-17 16:57:21 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:57:21 | I | in layer model.layers.4
25-01-17 16:57:21 | I | quantizing weights for layer model.layers.4
25-01-17 16:57:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:22 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:22 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:57:22 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:57:23 | I |       - range scale = [    1.0000]
25-01-17 16:57:23 | I |         sum  error  = [    0.5592]
25-01-17 16:57:23 | I |         best error  = [    0.5592]
25-01-17 16:57:23 | I |     + error = [0.5592]
25-01-17 16:57:24 | I |       - range scale = [    1.0000]
25-01-17 16:57:24 | I |         sum  error  = [    4.2859]
25-01-17 16:57:24 | I |         best error  = [    4.2859]
25-01-17 16:57:24 | I |     + error = [4.2859]
25-01-17 16:57:24 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:57:25 | I |       - range scale = [    1.0000]
25-01-17 16:57:25 | I |         sum  error  = [    0.2532]
25-01-17 16:57:25 | I |         best error  = [    0.2532]
25-01-17 16:57:25 | I |     + error = [0.2532]
25-01-17 16:57:25 | I |       - range scale = [    1.0000]
25-01-17 16:57:25 | I |         sum  error  = [    2.1212]
25-01-17 16:57:25 | I |         best error  = [    2.1212]
25-01-17 16:57:25 | I |     + error = [2.1212]
25-01-17 16:57:25 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:57:26 | I |       - range scale = [    1.0000]
25-01-17 16:57:26 | I |         sum  error  = [    0.6160]
25-01-17 16:57:26 | I |         best error  = [    0.6160]
25-01-17 16:57:26 | I |     + error = [0.6160]
25-01-17 16:57:27 | I |       - range scale = [    1.0000]
25-01-17 16:57:27 | I |         sum  error  = [    6.9311]
25-01-17 16:57:27 | I |         best error  = [    6.9311]
25-01-17 16:57:27 | I |     + error = [6.9311]
25-01-17 16:57:27 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:57:28 | I |       - range scale = [    1.0000]
25-01-17 16:57:28 | I |         sum  error  = [    0.0935]
25-01-17 16:57:28 | I |         best error  = [    0.0935]
25-01-17 16:57:28 | I |     + error = [0.0935]
25-01-17 16:57:29 | I |       - range scale = [    1.0000]
25-01-17 16:57:29 | I |         sum  error  = [    1.0100]
25-01-17 16:57:29 | I |         best error  = [    1.0100]
25-01-17 16:57:29 | I |     + error = [1.0100]
25-01-17 16:57:29 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:57:30 | I |       - range scale = [    1.0000]
25-01-17 16:57:30 | I |         sum  error  = [    1.9989]
25-01-17 16:57:30 | I |         best error  = [    1.9989]
25-01-17 16:57:30 | I |     + error = [1.9989]
25-01-17 16:57:30 | I |       - range scale = [    1.0000]
25-01-17 16:57:30 | I |         sum  error  = [   22.4850]
25-01-17 16:57:30 | I |         best error  = [   22.4850]
25-01-17 16:57:30 | I |     + error = [22.4850]
25-01-17 16:57:31 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:57:31 | I |       - range scale = [    1.0000]
25-01-17 16:57:31 | I |         sum  error  = [    2.1859]
25-01-17 16:57:31 | I |         best error  = [    2.1859]
25-01-17 16:57:31 | I |     + error = [2.1859]
25-01-17 16:57:32 | I |       - range scale = [    1.0000]
25-01-17 16:57:32 | I |         sum  error  = [   24.5426]
25-01-17 16:57:32 | I |         best error  = [   24.5426]
25-01-17 16:57:32 | I |     + error = [24.5426]
25-01-17 16:57:32 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:57:33 | I |       - range scale = [    1.0000]
25-01-17 16:57:33 | I |         sum  error  = [    0.1685]
25-01-17 16:57:33 | I |         best error  = [    0.1685]
25-01-17 16:57:33 | I |     + error = [0.1685]
25-01-17 16:57:34 | I |       - range scale = [    1.0000]
25-01-17 16:57:34 | I |         sum  error  = [    1.7257]
25-01-17 16:57:34 | I |         best error  = [    1.7257]
25-01-17 16:57:34 | I |     + error = [1.7257]
25-01-17 16:57:34 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:57:36 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:57:38 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:57:39 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:57:41 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:57:43 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:57:45 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:57:49 | I | quantizing activations for layer model.layers.4
25-01-17 16:57:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:49 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:50 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:52 | I | forward this layer
25-01-17 16:57:52 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/64.pt
25-01-17 16:57:52 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/64.pt
25-01-17 16:57:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:57:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:57:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:57:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:57:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:57:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:57:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:57:52 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:57:52 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:57:52 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:57:52 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:57:52 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:57:52 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:57:52 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:57:52 | I | in layer model.layers.4
25-01-17 16:57:52 | I | quantizing weights for layer model.layers.4
25-01-17 16:57:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:52 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:53 | I | collecting calibration activations in model.layers.4
25-01-17 16:57:53 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:57:53 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:57:54 | I |       - range scale = [    1.0000]
25-01-17 16:57:54 | I |         sum  error  = [    0.5607]
25-01-17 16:57:54 | I |         best error  = [    0.5607]
25-01-17 16:57:54 | I |     + error = [0.5607]
25-01-17 16:57:54 | I |       - range scale = [    1.0000]
25-01-17 16:57:54 | I |         sum  error  = [    4.1709]
25-01-17 16:57:54 | I |         best error  = [    4.1709]
25-01-17 16:57:54 | I |     + error = [4.1709]
25-01-17 16:57:54 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:57:55 | I |       - range scale = [    1.0000]
25-01-17 16:57:55 | I |         sum  error  = [    0.2481]
25-01-17 16:57:55 | I |         best error  = [    0.2481]
25-01-17 16:57:55 | I |     + error = [0.2481]
25-01-17 16:57:56 | I |       - range scale = [    1.0000]
25-01-17 16:57:56 | I |         sum  error  = [    2.0791]
25-01-17 16:57:56 | I |         best error  = [    2.0791]
25-01-17 16:57:56 | I |     + error = [2.0791]
25-01-17 16:57:56 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:57:57 | I |       - range scale = [    1.0000]
25-01-17 16:57:57 | I |         sum  error  = [    0.6130]
25-01-17 16:57:57 | I |         best error  = [    0.6130]
25-01-17 16:57:57 | I |     + error = [0.6130]
25-01-17 16:57:57 | I |       - range scale = [    1.0000]
25-01-17 16:57:57 | I |         sum  error  = [    6.8803]
25-01-17 16:57:57 | I |         best error  = [    6.8803]
25-01-17 16:57:57 | I |     + error = [6.8803]
25-01-17 16:57:58 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:57:58 | I |       - range scale = [    1.0000]
25-01-17 16:57:58 | I |         sum  error  = [    0.1010]
25-01-17 16:57:58 | I |         best error  = [    0.1010]
25-01-17 16:57:58 | I |     + error = [0.1010]
25-01-17 16:57:59 | I |       - range scale = [    1.0000]
25-01-17 16:57:59 | I |         sum  error  = [    1.0978]
25-01-17 16:57:59 | I |         best error  = [    1.0978]
25-01-17 16:57:59 | I |     + error = [1.0978]
25-01-17 16:57:59 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:58:00 | I |       - range scale = [    1.0000]
25-01-17 16:58:00 | I |         sum  error  = [    1.9948]
25-01-17 16:58:00 | I |         best error  = [    1.9948]
25-01-17 16:58:00 | I |     + error = [1.9948]
25-01-17 16:58:01 | I |       - range scale = [    1.0000]
25-01-17 16:58:01 | I |         sum  error  = [   22.4372]
25-01-17 16:58:01 | I |         best error  = [   22.4372]
25-01-17 16:58:01 | I |     + error = [22.4372]
25-01-17 16:58:01 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:58:02 | I |       - range scale = [    1.0000]
25-01-17 16:58:02 | I |         sum  error  = [    2.1802]
25-01-17 16:58:02 | I |         best error  = [    2.1802]
25-01-17 16:58:02 | I |     + error = [2.1802]
25-01-17 16:58:02 | I |       - range scale = [    1.0000]
25-01-17 16:58:02 | I |         sum  error  = [   24.4772]
25-01-17 16:58:02 | I |         best error  = [   24.4772]
25-01-17 16:58:02 | I |     + error = [24.4772]
25-01-17 16:58:03 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:58:03 | I |       - range scale = [    1.0000]
25-01-17 16:58:03 | I |         sum  error  = [    0.1634]
25-01-17 16:58:03 | I |         best error  = [    0.1634]
25-01-17 16:58:03 | I |     + error = [0.1634]
25-01-17 16:58:04 | I |       - range scale = [    1.0000]
25-01-17 16:58:04 | I |         sum  error  = [    1.6712]
25-01-17 16:58:04 | I |         best error  = [    1.6712]
25-01-17 16:58:04 | I |     + error = [1.6712]
25-01-17 16:58:04 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:58:06 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:58:07 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:58:09 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:58:10 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:58:11 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:58:13 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:58:16 | I | quantizing activations for layer model.layers.4
25-01-17 16:58:17 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:17 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:17 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:17 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:19 | I | forward this layer
25-01-17 16:58:19 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/65.pt
25-01-17 16:58:19 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/65.pt
25-01-17 16:58:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:58:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:58:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:58:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:58:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:58:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:58:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:58:19 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:58:19 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:58:19 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:58:19 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:58:19 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:58:19 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:58:19 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:58:19 | I | [26] done with optimizer step
25-01-17 16:58:19 | I | epoch 001:     33 / 409600000 loss=1.72247e-05, loss_per_token=0.0352762, loss_sum=1155.93, wps=562.2, ups=0.02, wpb=32768, bsz=64, num_updates=27, lr=8.1e-05, gnorm=0.07, clip=0, loss_scale=2, train_wall=58, cuda_gb_allocated=12.3, cuda_gb_reserved=14, cuda_gb_free=11.4, wall=2315
25-01-17 16:58:19 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:58:19 | I | in layer model.layers.4
25-01-17 16:58:19 | I | quantizing weights for layer model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:20 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:21 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:58:21 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:58:21 | I |       - range scale = [    1.0000]
25-01-17 16:58:21 | I |         sum  error  = [    0.5660]
25-01-17 16:58:21 | I |         best error  = [    0.5660]
25-01-17 16:58:21 | I |     + error = [0.5660]
25-01-17 16:58:22 | I |       - range scale = [    1.0000]
25-01-17 16:58:22 | I |         sum  error  = [    4.2728]
25-01-17 16:58:22 | I |         best error  = [    4.2728]
25-01-17 16:58:22 | I |     + error = [4.2728]
25-01-17 16:58:22 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:58:23 | I |       - range scale = [    1.0000]
25-01-17 16:58:23 | I |         sum  error  = [    0.2482]
25-01-17 16:58:23 | I |         best error  = [    0.2482]
25-01-17 16:58:23 | I |     + error = [0.2482]
25-01-17 16:58:24 | I |       - range scale = [    1.0000]
25-01-17 16:58:24 | I |         sum  error  = [    2.0516]
25-01-17 16:58:24 | I |         best error  = [    2.0516]
25-01-17 16:58:24 | I |     + error = [2.0516]
25-01-17 16:58:24 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:58:25 | I |       - range scale = [    1.0000]
25-01-17 16:58:25 | I |         sum  error  = [    0.6178]
25-01-17 16:58:25 | I |         best error  = [    0.6178]
25-01-17 16:58:25 | I |     + error = [0.6178]
25-01-17 16:58:25 | I |       - range scale = [    1.0000]
25-01-17 16:58:25 | I |         sum  error  = [    6.8902]
25-01-17 16:58:25 | I |         best error  = [    6.8902]
25-01-17 16:58:25 | I |     + error = [6.8902]
25-01-17 16:58:25 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:58:26 | I |       - range scale = [    1.0000]
25-01-17 16:58:26 | I |         sum  error  = [    0.0893]
25-01-17 16:58:26 | I |         best error  = [    0.0893]
25-01-17 16:58:26 | I |     + error = [0.0893]
25-01-17 16:58:27 | I |       - range scale = [    1.0000]
25-01-17 16:58:27 | I |         sum  error  = [    0.9796]
25-01-17 16:58:27 | I |         best error  = [    0.9796]
25-01-17 16:58:27 | I |     + error = [0.9796]
25-01-17 16:58:27 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:58:28 | I |       - range scale = [    1.0000]
25-01-17 16:58:28 | I |         sum  error  = [    2.0255]
25-01-17 16:58:28 | I |         best error  = [    2.0255]
25-01-17 16:58:28 | I |     + error = [2.0255]
25-01-17 16:58:29 | I |       - range scale = [    1.0000]
25-01-17 16:58:29 | I |         sum  error  = [   22.8062]
25-01-17 16:58:29 | I |         best error  = [   22.8062]
25-01-17 16:58:29 | I |     + error = [22.8062]
25-01-17 16:58:29 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:58:30 | I |       - range scale = [    1.0000]
25-01-17 16:58:30 | I |         sum  error  = [    2.2152]
25-01-17 16:58:30 | I |         best error  = [    2.2152]
25-01-17 16:58:30 | I |     + error = [2.2152]
25-01-17 16:58:30 | I |       - range scale = [    1.0000]
25-01-17 16:58:30 | I |         sum  error  = [   24.8982]
25-01-17 16:58:30 | I |         best error  = [   24.8982]
25-01-17 16:58:30 | I |     + error = [24.8982]
25-01-17 16:58:31 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:58:31 | I |       - range scale = [    1.0000]
25-01-17 16:58:31 | I |         sum  error  = [    0.1752]
25-01-17 16:58:31 | I |         best error  = [    0.1752]
25-01-17 16:58:31 | I |     + error = [0.1752]
25-01-17 16:58:32 | I |       - range scale = [    1.0000]
25-01-17 16:58:32 | I |         sum  error  = [    1.7939]
25-01-17 16:58:32 | I |         best error  = [    1.7939]
25-01-17 16:58:32 | I |     + error = [1.7939]
25-01-17 16:58:32 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:58:34 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:58:35 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:58:37 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:58:38 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:58:39 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:58:41 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:58:44 | I | quantizing activations for layer model.layers.4
25-01-17 16:58:45 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:45 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:45 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:45 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:47 | I | forward this layer
25-01-17 16:58:47 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/66.pt
25-01-17 16:58:47 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/66.pt
25-01-17 16:58:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:58:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:58:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:58:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:58:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:58:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:58:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:58:47 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:58:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:58:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:58:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:58:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:58:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:58:47 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:58:47 | I | in layer model.layers.4
25-01-17 16:58:47 | I | quantizing weights for layer model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | collecting calibration activations in model.layers.4
25-01-17 16:58:48 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:58:48 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:58:49 | I |       - range scale = [    1.0000]
25-01-17 16:58:49 | I |         sum  error  = [    0.5511]
25-01-17 16:58:49 | I |         best error  = [    0.5511]
25-01-17 16:58:49 | I |     + error = [0.5511]
25-01-17 16:58:50 | I |       - range scale = [    1.0000]
25-01-17 16:58:50 | I |         sum  error  = [    4.2732]
25-01-17 16:58:50 | I |         best error  = [    4.2732]
25-01-17 16:58:50 | I |     + error = [4.2732]
25-01-17 16:58:50 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:58:51 | I |       - range scale = [    1.0000]
25-01-17 16:58:51 | I |         sum  error  = [    0.2370]
25-01-17 16:58:51 | I |         best error  = [    0.2370]
25-01-17 16:58:51 | I |     + error = [0.2370]
25-01-17 16:58:51 | I |       - range scale = [    1.0000]
25-01-17 16:58:51 | I |         sum  error  = [    2.0208]
25-01-17 16:58:51 | I |         best error  = [    2.0208]
25-01-17 16:58:51 | I |     + error = [2.0208]
25-01-17 16:58:52 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:58:52 | I |       - range scale = [    1.0000]
25-01-17 16:58:52 | I |         sum  error  = [    0.6206]
25-01-17 16:58:52 | I |         best error  = [    0.6206]
25-01-17 16:58:52 | I |     + error = [0.6206]
25-01-17 16:58:53 | I |       - range scale = [    1.0000]
25-01-17 16:58:53 | I |         sum  error  = [    6.9795]
25-01-17 16:58:53 | I |         best error  = [    6.9795]
25-01-17 16:58:53 | I |     + error = [6.9795]
25-01-17 16:58:53 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:58:54 | I |       - range scale = [    1.0000]
25-01-17 16:58:54 | I |         sum  error  = [    0.0929]
25-01-17 16:58:54 | I |         best error  = [    0.0929]
25-01-17 16:58:54 | I |     + error = [0.0929]
25-01-17 16:58:55 | I |       - range scale = [    1.0000]
25-01-17 16:58:55 | I |         sum  error  = [    1.0102]
25-01-17 16:58:55 | I |         best error  = [    1.0102]
25-01-17 16:58:55 | I |     + error = [1.0102]
25-01-17 16:58:55 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:58:56 | I |       - range scale = [    1.0000]
25-01-17 16:58:56 | I |         sum  error  = [    2.0327]
25-01-17 16:58:56 | I |         best error  = [    2.0327]
25-01-17 16:58:56 | I |     + error = [2.0327]
25-01-17 16:58:56 | I |       - range scale = [    1.0000]
25-01-17 16:58:56 | I |         sum  error  = [   22.8819]
25-01-17 16:58:56 | I |         best error  = [   22.8819]
25-01-17 16:58:56 | I |     + error = [22.8819]
25-01-17 16:58:57 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:58:57 | I |       - range scale = [    1.0000]
25-01-17 16:58:57 | I |         sum  error  = [    2.2222]
25-01-17 16:58:57 | I |         best error  = [    2.2222]
25-01-17 16:58:57 | I |     + error = [2.2222]
25-01-17 16:58:58 | I |       - range scale = [    1.0000]
25-01-17 16:58:58 | I |         sum  error  = [   24.9769]
25-01-17 16:58:58 | I |         best error  = [   24.9769]
25-01-17 16:58:58 | I |     + error = [24.9769]
25-01-17 16:58:58 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:58:59 | I |       - range scale = [    1.0000]
25-01-17 16:58:59 | I |         sum  error  = [    0.1677]
25-01-17 16:58:59 | I |         best error  = [    0.1677]
25-01-17 16:58:59 | I |     + error = [0.1677]
25-01-17 16:59:00 | I |       - range scale = [    1.0000]
25-01-17 16:59:00 | I |         sum  error  = [    1.7193]
25-01-17 16:59:00 | I |         best error  = [    1.7193]
25-01-17 16:59:00 | I |     + error = [1.7193]
25-01-17 16:59:00 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:59:01 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:59:03 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:59:04 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:59:06 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:59:07 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:59:08 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:59:12 | I | quantizing activations for layer model.layers.4
25-01-17 16:59:12 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:12 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:12 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:12 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:14 | I | forward this layer
25-01-17 16:59:14 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/67.pt
25-01-17 16:59:14 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/67.pt
25-01-17 16:59:14 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:59:14 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:59:14 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:59:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:59:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:59:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:59:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:59:15 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:59:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:59:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:59:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:59:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:59:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:59:15 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:59:15 | I | [27] done with optimizer step
25-01-17 16:59:15 | I | epoch 001:     34 / 409600000 loss=1.67502e-05, loss_per_token=0.0343045, loss_sum=1124.09, wps=591.6, ups=0.02, wpb=32768, bsz=64, num_updates=28, lr=8.4e-05, gnorm=0.079, clip=0, loss_scale=2, train_wall=55, cuda_gb_allocated=12.3, cuda_gb_reserved=14, cuda_gb_free=11.4, wall=2370
25-01-17 16:59:15 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 16:59:15 | I | in layer model.layers.4
25-01-17 16:59:15 | I | quantizing weights for layer model.layers.4
25-01-17 16:59:15 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:15 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:15 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:15 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:16 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:59:16 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:59:16 | I |       - range scale = [    1.0000]
25-01-17 16:59:16 | I |         sum  error  = [    0.6078]
25-01-17 16:59:16 | I |         best error  = [    0.6078]
25-01-17 16:59:16 | I |     + error = [0.6078]
25-01-17 16:59:17 | I |       - range scale = [    1.0000]
25-01-17 16:59:17 | I |         sum  error  = [    4.5932]
25-01-17 16:59:17 | I |         best error  = [    4.5932]
25-01-17 16:59:17 | I |     + error = [4.5932]
25-01-17 16:59:17 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:59:18 | I |       - range scale = [    1.0000]
25-01-17 16:59:18 | I |         sum  error  = [    0.2934]
25-01-17 16:59:18 | I |         best error  = [    0.2934]
25-01-17 16:59:18 | I |     + error = [0.2934]
25-01-17 16:59:19 | I |       - range scale = [    1.0000]
25-01-17 16:59:19 | I |         sum  error  = [    2.3767]
25-01-17 16:59:19 | I |         best error  = [    2.3767]
25-01-17 16:59:19 | I |     + error = [2.3767]
25-01-17 16:59:19 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:59:20 | I |       - range scale = [    1.0000]
25-01-17 16:59:20 | I |         sum  error  = [    0.6157]
25-01-17 16:59:20 | I |         best error  = [    0.6157]
25-01-17 16:59:20 | I |     + error = [0.6157]
25-01-17 16:59:20 | I |       - range scale = [    1.0000]
25-01-17 16:59:20 | I |         sum  error  = [    6.8667]
25-01-17 16:59:20 | I |         best error  = [    6.8667]
25-01-17 16:59:20 | I |     + error = [6.8667]
25-01-17 16:59:20 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:59:21 | I |       - range scale = [    1.0000]
25-01-17 16:59:21 | I |         sum  error  = [    0.0986]
25-01-17 16:59:21 | I |         best error  = [    0.0986]
25-01-17 16:59:21 | I |     + error = [0.0986]
25-01-17 16:59:22 | I |       - range scale = [    1.0000]
25-01-17 16:59:22 | I |         sum  error  = [    1.0772]
25-01-17 16:59:22 | I |         best error  = [    1.0772]
25-01-17 16:59:22 | I |     + error = [1.0772]
25-01-17 16:59:22 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:59:23 | I |       - range scale = [    1.0000]
25-01-17 16:59:23 | I |         sum  error  = [    1.9859]
25-01-17 16:59:23 | I |         best error  = [    1.9859]
25-01-17 16:59:23 | I |     + error = [1.9859]
25-01-17 16:59:23 | I |       - range scale = [    1.0000]
25-01-17 16:59:23 | I |         sum  error  = [   22.3209]
25-01-17 16:59:23 | I |         best error  = [   22.3209]
25-01-17 16:59:23 | I |     + error = [22.3209]
25-01-17 16:59:24 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:59:24 | I |       - range scale = [    1.0000]
25-01-17 16:59:24 | I |         sum  error  = [    2.1735]
25-01-17 16:59:24 | I |         best error  = [    2.1735]
25-01-17 16:59:24 | I |     + error = [2.1735]
25-01-17 16:59:25 | I |       - range scale = [    1.0000]
25-01-17 16:59:25 | I |         sum  error  = [   24.3662]
25-01-17 16:59:25 | I |         best error  = [   24.3662]
25-01-17 16:59:25 | I |     + error = [24.3662]
25-01-17 16:59:25 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:59:26 | I |       - range scale = [    1.0000]
25-01-17 16:59:26 | I |         sum  error  = [    0.1669]
25-01-17 16:59:26 | I |         best error  = [    0.1669]
25-01-17 16:59:26 | I |     + error = [0.1669]
25-01-17 16:59:27 | I |       - range scale = [    1.0000]
25-01-17 16:59:27 | I |         sum  error  = [    1.7079]
25-01-17 16:59:27 | I |         best error  = [    1.7079]
25-01-17 16:59:27 | I |     + error = [1.7079]
25-01-17 16:59:27 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:59:28 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:59:30 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:59:31 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 16:59:32 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 16:59:34 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 16:59:35 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 16:59:39 | I | quantizing activations for layer model.layers.4
25-01-17 16:59:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:39 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:41 | I | forward this layer
25-01-17 16:59:41 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/68.pt
25-01-17 16:59:41 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/68.pt
25-01-17 16:59:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 16:59:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 16:59:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 16:59:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 16:59:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 16:59:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 16:59:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 16:59:41 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 16:59:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 16:59:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 16:59:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 16:59:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 16:59:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 16:59:41 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 16:59:41 | I | in layer model.layers.4
25-01-17 16:59:41 | I | quantizing weights for layer model.layers.4
25-01-17 16:59:42 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:42 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:42 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:42 | I | collecting calibration activations in model.layers.4
25-01-17 16:59:43 | I | - Quantizing decoder layer model.layers.4
25-01-17 16:59:43 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 16:59:43 | I |       - range scale = [    1.0000]
25-01-17 16:59:43 | I |         sum  error  = [    0.5680]
25-01-17 16:59:43 | I |         best error  = [    0.5680]
25-01-17 16:59:43 | I |     + error = [0.5680]
25-01-17 16:59:44 | I |       - range scale = [    1.0000]
25-01-17 16:59:44 | I |         sum  error  = [    4.2171]
25-01-17 16:59:44 | I |         best error  = [    4.2171]
25-01-17 16:59:44 | I |     + error = [4.2171]
25-01-17 16:59:44 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 16:59:45 | I |       - range scale = [    1.0000]
25-01-17 16:59:45 | I |         sum  error  = [    0.2503]
25-01-17 16:59:45 | I |         best error  = [    0.2503]
25-01-17 16:59:45 | I |     + error = [0.2503]
25-01-17 16:59:46 | I |       - range scale = [    1.0000]
25-01-17 16:59:46 | I |         sum  error  = [    2.0824]
25-01-17 16:59:46 | I |         best error  = [    2.0824]
25-01-17 16:59:46 | I |     + error = [2.0824]
25-01-17 16:59:46 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 16:59:47 | I |       - range scale = [    1.0000]
25-01-17 16:59:47 | I |         sum  error  = [    0.6111]
25-01-17 16:59:47 | I |         best error  = [    0.6111]
25-01-17 16:59:47 | I |     + error = [0.6111]
25-01-17 16:59:47 | I |       - range scale = [    1.0000]
25-01-17 16:59:47 | I |         sum  error  = [    6.8320]
25-01-17 16:59:47 | I |         best error  = [    6.8320]
25-01-17 16:59:47 | I |     + error = [6.8320]
25-01-17 16:59:47 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 16:59:48 | I |       - range scale = [    1.0000]
25-01-17 16:59:48 | I |         sum  error  = [    0.0951]
25-01-17 16:59:48 | I |         best error  = [    0.0951]
25-01-17 16:59:48 | I |     + error = [0.0951]
25-01-17 16:59:49 | I |       - range scale = [    1.0000]
25-01-17 16:59:49 | I |         sum  error  = [    1.0345]
25-01-17 16:59:49 | I |         best error  = [    1.0345]
25-01-17 16:59:49 | I |     + error = [1.0345]
25-01-17 16:59:49 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 16:59:50 | I |       - range scale = [    1.0000]
25-01-17 16:59:50 | I |         sum  error  = [    1.9931]
25-01-17 16:59:50 | I |         best error  = [    1.9931]
25-01-17 16:59:50 | I |     + error = [1.9931]
25-01-17 16:59:51 | I |       - range scale = [    1.0000]
25-01-17 16:59:51 | I |         sum  error  = [   22.4213]
25-01-17 16:59:51 | I |         best error  = [   22.4213]
25-01-17 16:59:51 | I |     + error = [22.4213]
25-01-17 16:59:51 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 16:59:52 | I |       - range scale = [    1.0000]
25-01-17 16:59:52 | I |         sum  error  = [    2.1805]
25-01-17 16:59:52 | I |         best error  = [    2.1805]
25-01-17 16:59:52 | I |     + error = [2.1805]
25-01-17 16:59:52 | I |       - range scale = [    1.0000]
25-01-17 16:59:52 | I |         sum  error  = [   24.4757]
25-01-17 16:59:52 | I |         best error  = [   24.4757]
25-01-17 16:59:52 | I |     + error = [24.4757]
25-01-17 16:59:53 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 16:59:53 | I |       - range scale = [    1.0000]
25-01-17 16:59:53 | I |         sum  error  = [    0.1661]
25-01-17 16:59:53 | I |         best error  = [    0.1661]
25-01-17 16:59:53 | I |     + error = [0.1661]
25-01-17 16:59:54 | I |       - range scale = [    1.0000]
25-01-17 16:59:54 | I |         sum  error  = [    1.7020]
25-01-17 16:59:54 | I |         best error  = [    1.7020]
25-01-17 16:59:54 | I |     + error = [1.7020]
25-01-17 16:59:54 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 16:59:56 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 16:59:57 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 16:59:59 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:00:00 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:00:02 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:00:03 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:00:07 | I | quantizing activations for layer model.layers.4
25-01-17 17:00:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:09 | I | forward this layer
25-01-17 17:00:09 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/69.pt
25-01-17 17:00:09 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/69.pt
25-01-17 17:00:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:00:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:00:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:00:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:00:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:00:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:00:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:00:09 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:00:09 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:00:09 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:00:09 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:00:09 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:00:09 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:00:09 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:00:09 | I | [28] done with optimizer step
25-01-17 17:00:09 | I | epoch 001:     35 / 409600000 loss=1.55728e-05, loss_per_token=0.0318931, loss_sum=1045.07, wps=596.9, ups=0.02, wpb=32768, bsz=64, num_updates=29, lr=8.7e-05, gnorm=0.1, clip=0, loss_scale=2, train_wall=55, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=2425
25-01-17 17:00:10 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:00:10 | I | in layer model.layers.4
25-01-17 17:00:10 | I | quantizing weights for layer model.layers.4
25-01-17 17:00:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:11 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:00:11 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:00:11 | I |       - range scale = [    1.0000]
25-01-17 17:00:11 | I |         sum  error  = [    0.5679]
25-01-17 17:00:11 | I |         best error  = [    0.5679]
25-01-17 17:00:11 | I |     + error = [0.5679]
25-01-17 17:00:12 | I |       - range scale = [    1.0000]
25-01-17 17:00:12 | I |         sum  error  = [    4.5511]
25-01-17 17:00:12 | I |         best error  = [    4.5511]
25-01-17 17:00:12 | I |     + error = [4.5511]
25-01-17 17:00:12 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:00:13 | I |       - range scale = [    1.0000]
25-01-17 17:00:13 | I |         sum  error  = [    0.2507]
25-01-17 17:00:13 | I |         best error  = [    0.2507]
25-01-17 17:00:13 | I |     + error = [0.2507]
25-01-17 17:00:14 | I |       - range scale = [    1.0000]
25-01-17 17:00:14 | I |         sum  error  = [    2.0987]
25-01-17 17:00:14 | I |         best error  = [    2.0987]
25-01-17 17:00:14 | I |     + error = [2.0987]
25-01-17 17:00:14 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:00:15 | I |       - range scale = [    1.0000]
25-01-17 17:00:15 | I |         sum  error  = [    0.6170]
25-01-17 17:00:15 | I |         best error  = [    0.6170]
25-01-17 17:00:15 | I |     + error = [0.6170]
25-01-17 17:00:15 | I |       - range scale = [    1.0000]
25-01-17 17:00:15 | I |         sum  error  = [    6.9310]
25-01-17 17:00:15 | I |         best error  = [    6.9310]
25-01-17 17:00:15 | I |     + error = [6.9310]
25-01-17 17:00:16 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:00:16 | I |       - range scale = [    1.0000]
25-01-17 17:00:16 | I |         sum  error  = [    0.0964]
25-01-17 17:00:16 | I |         best error  = [    0.0964]
25-01-17 17:00:16 | I |     + error = [0.0964]
25-01-17 17:00:17 | I |       - range scale = [    1.0000]
25-01-17 17:00:17 | I |         sum  error  = [    1.0545]
25-01-17 17:00:17 | I |         best error  = [    1.0545]
25-01-17 17:00:17 | I |     + error = [1.0545]
25-01-17 17:00:17 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:00:18 | I |       - range scale = [    1.0000]
25-01-17 17:00:18 | I |         sum  error  = [    2.0338]
25-01-17 17:00:18 | I |         best error  = [    2.0338]
25-01-17 17:00:18 | I |     + error = [2.0338]
25-01-17 17:00:19 | I |       - range scale = [    1.0000]
25-01-17 17:00:19 | I |         sum  error  = [   22.8939]
25-01-17 17:00:19 | I |         best error  = [   22.8939]
25-01-17 17:00:19 | I |     + error = [22.8939]
25-01-17 17:00:19 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:00:20 | I |       - range scale = [    1.0000]
25-01-17 17:00:20 | I |         sum  error  = [    2.2229]
25-01-17 17:00:20 | I |         best error  = [    2.2229]
25-01-17 17:00:20 | I |     + error = [2.2229]
25-01-17 17:00:20 | I |       - range scale = [    1.0000]
25-01-17 17:00:20 | I |         sum  error  = [   24.9811]
25-01-17 17:00:20 | I |         best error  = [   24.9811]
25-01-17 17:00:20 | I |     + error = [24.9811]
25-01-17 17:00:21 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:00:21 | I |       - range scale = [    1.0000]
25-01-17 17:00:21 | I |         sum  error  = [    0.1731]
25-01-17 17:00:21 | I |         best error  = [    0.1731]
25-01-17 17:00:21 | I |     + error = [0.1731]
25-01-17 17:00:22 | I |       - range scale = [    1.0000]
25-01-17 17:00:22 | I |         sum  error  = [    1.7736]
25-01-17 17:00:22 | I |         best error  = [    1.7736]
25-01-17 17:00:22 | I |     + error = [1.7736]
25-01-17 17:00:22 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:00:24 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:00:25 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:00:26 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:00:28 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:00:29 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:00:31 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:00:34 | I | quantizing activations for layer model.layers.4
25-01-17 17:00:34 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:34 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:34 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:35 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:36 | I | forward this layer
25-01-17 17:00:36 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/70.pt
25-01-17 17:00:36 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/70.pt
25-01-17 17:00:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:00:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:00:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:00:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:00:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:00:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:00:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:00:37 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:00:37 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:00:37 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:00:37 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:00:37 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:00:37 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:00:37 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:00:37 | I | in layer model.layers.4
25-01-17 17:00:37 | I | quantizing weights for layer model.layers.4
25-01-17 17:00:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:00:38 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:00:38 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:00:38 | I |       - range scale = [    1.0000]
25-01-17 17:00:38 | I |         sum  error  = [    0.5723]
25-01-17 17:00:38 | I |         best error  = [    0.5723]
25-01-17 17:00:38 | I |     + error = [0.5723]
25-01-17 17:00:39 | I |       - range scale = [    1.0000]
25-01-17 17:00:39 | I |         sum  error  = [    4.5504]
25-01-17 17:00:39 | I |         best error  = [    4.5504]
25-01-17 17:00:39 | I |     + error = [4.5504]
25-01-17 17:00:39 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:00:40 | I |       - range scale = [    1.0000]
25-01-17 17:00:40 | I |         sum  error  = [    0.2469]
25-01-17 17:00:40 | I |         best error  = [    0.2469]
25-01-17 17:00:40 | I |     + error = [0.2469]
25-01-17 17:00:41 | I |       - range scale = [    1.0000]
25-01-17 17:00:41 | I |         sum  error  = [    2.0293]
25-01-17 17:00:41 | I |         best error  = [    2.0293]
25-01-17 17:00:41 | I |     + error = [2.0293]
25-01-17 17:00:41 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:00:42 | I |       - range scale = [    1.0000]
25-01-17 17:00:42 | I |         sum  error  = [    0.6225]
25-01-17 17:00:42 | I |         best error  = [    0.6225]
25-01-17 17:00:42 | I |     + error = [0.6225]
25-01-17 17:00:42 | I |       - range scale = [    1.0000]
25-01-17 17:00:42 | I |         sum  error  = [    6.9133]
25-01-17 17:00:42 | I |         best error  = [    6.9133]
25-01-17 17:00:42 | I |     + error = [6.9133]
25-01-17 17:00:43 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:00:43 | I |       - range scale = [    1.0000]
25-01-17 17:00:43 | I |         sum  error  = [    0.0957]
25-01-17 17:00:43 | I |         best error  = [    0.0957]
25-01-17 17:00:43 | I |     + error = [0.0957]
25-01-17 17:00:44 | I |       - range scale = [    1.0000]
25-01-17 17:00:44 | I |         sum  error  = [    1.0459]
25-01-17 17:00:44 | I |         best error  = [    1.0459]
25-01-17 17:00:44 | I |     + error = [1.0459]
25-01-17 17:00:44 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:00:45 | I |       - range scale = [    1.0000]
25-01-17 17:00:45 | I |         sum  error  = [    2.0231]
25-01-17 17:00:45 | I |         best error  = [    2.0231]
25-01-17 17:00:45 | I |     + error = [2.0231]
25-01-17 17:00:46 | I |       - range scale = [    1.0000]
25-01-17 17:00:46 | I |         sum  error  = [   22.7813]
25-01-17 17:00:46 | I |         best error  = [   22.7813]
25-01-17 17:00:46 | I |     + error = [22.7813]
25-01-17 17:00:46 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:00:47 | I |       - range scale = [    1.0000]
25-01-17 17:00:47 | I |         sum  error  = [    2.2166]
25-01-17 17:00:47 | I |         best error  = [    2.2166]
25-01-17 17:00:47 | I |     + error = [2.2166]
25-01-17 17:00:47 | I |       - range scale = [    1.0000]
25-01-17 17:00:47 | I |         sum  error  = [   24.8641]
25-01-17 17:00:47 | I |         best error  = [   24.8641]
25-01-17 17:00:47 | I |     + error = [24.8641]
25-01-17 17:00:48 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:00:48 | I |       - range scale = [    1.0000]
25-01-17 17:00:48 | I |         sum  error  = [    0.1820]
25-01-17 17:00:48 | I |         best error  = [    0.1820]
25-01-17 17:00:48 | I |     + error = [0.1820]
25-01-17 17:00:49 | I |       - range scale = [    1.0000]
25-01-17 17:00:49 | I |         sum  error  = [    1.8744]
25-01-17 17:00:49 | I |         best error  = [    1.8744]
25-01-17 17:00:49 | I |     + error = [1.8744]
25-01-17 17:00:49 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:00:51 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:00:52 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:00:53 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:00:55 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:00:56 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:00:58 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:01:01 | I | quantizing activations for layer model.layers.4
25-01-17 17:01:01 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:01 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:02 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:02 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:04 | I | forward this layer
25-01-17 17:01:04 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/71.pt
25-01-17 17:01:04 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/71.pt
25-01-17 17:01:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:01:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:01:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:01:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:01:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:01:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:01:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:01:04 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:01:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:01:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:01:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:01:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:01:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:01:04 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:01:04 | I | [29] done with optimizer step
25-01-17 17:01:04 | I | epoch 001:     36 / 409600000 loss=1.69539e-05, loss_per_token=0.0347215, loss_sum=1137.75, wps=603.1, ups=0.02, wpb=32768, bsz=64, num_updates=30, lr=9e-05, gnorm=0.061, clip=0, loss_scale=2, train_wall=54, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=2480
25-01-17 17:01:04 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:01:04 | I | in layer model.layers.4
25-01-17 17:01:04 | I | quantizing weights for layer model.layers.4
25-01-17 17:01:04 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:05 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:05 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:05 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:05 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:01:05 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:01:06 | I |       - range scale = [    1.0000]
25-01-17 17:01:06 | I |         sum  error  = [    0.5965]
25-01-17 17:01:06 | I |         best error  = [    0.5965]
25-01-17 17:01:06 | I |     + error = [0.5965]
25-01-17 17:01:06 | I |       - range scale = [    1.0000]
25-01-17 17:01:06 | I |         sum  error  = [    4.7521]
25-01-17 17:01:06 | I |         best error  = [    4.7521]
25-01-17 17:01:06 | I |     + error = [4.7521]
25-01-17 17:01:07 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:01:07 | I |       - range scale = [    1.0000]
25-01-17 17:01:07 | I |         sum  error  = [    0.2786]
25-01-17 17:01:07 | I |         best error  = [    0.2786]
25-01-17 17:01:07 | I |     + error = [0.2786]
25-01-17 17:01:08 | I |       - range scale = [    1.0000]
25-01-17 17:01:08 | I |         sum  error  = [    2.2904]
25-01-17 17:01:08 | I |         best error  = [    2.2904]
25-01-17 17:01:08 | I |     + error = [2.2904]
25-01-17 17:01:08 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:01:09 | I |       - range scale = [    1.0000]
25-01-17 17:01:09 | I |         sum  error  = [    0.6202]
25-01-17 17:01:09 | I |         best error  = [    0.6202]
25-01-17 17:01:09 | I |     + error = [0.6202]
25-01-17 17:01:10 | I |       - range scale = [    1.0000]
25-01-17 17:01:10 | I |         sum  error  = [    6.9436]
25-01-17 17:01:10 | I |         best error  = [    6.9436]
25-01-17 17:01:10 | I |     + error = [6.9436]
25-01-17 17:01:10 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:01:10 | I |       - range scale = [    1.0000]
25-01-17 17:01:10 | I |         sum  error  = [    0.1076]
25-01-17 17:01:10 | I |         best error  = [    0.1076]
25-01-17 17:01:10 | I |     + error = [0.1076]
25-01-17 17:01:11 | I |       - range scale = [    1.0000]
25-01-17 17:01:11 | I |         sum  error  = [    1.1635]
25-01-17 17:01:11 | I |         best error  = [    1.1635]
25-01-17 17:01:11 | I |     + error = [1.1635]
25-01-17 17:01:11 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:01:12 | I |       - range scale = [    1.0000]
25-01-17 17:01:12 | I |         sum  error  = [    2.0094]
25-01-17 17:01:12 | I |         best error  = [    2.0094]
25-01-17 17:01:12 | I |     + error = [2.0094]
25-01-17 17:01:13 | I |       - range scale = [    1.0000]
25-01-17 17:01:13 | I |         sum  error  = [   22.6116]
25-01-17 17:01:13 | I |         best error  = [   22.6116]
25-01-17 17:01:13 | I |     + error = [22.6116]
25-01-17 17:01:13 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:01:14 | I |       - range scale = [    1.0000]
25-01-17 17:01:14 | I |         sum  error  = [    2.1926]
25-01-17 17:01:14 | I |         best error  = [    2.1926]
25-01-17 17:01:14 | I |     + error = [2.1926]
25-01-17 17:01:14 | I |       - range scale = [    1.0000]
25-01-17 17:01:14 | I |         sum  error  = [   24.6846]
25-01-17 17:01:14 | I |         best error  = [   24.6846]
25-01-17 17:01:14 | I |     + error = [24.6846]
25-01-17 17:01:15 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:01:15 | I |       - range scale = [    1.0000]
25-01-17 17:01:15 | I |         sum  error  = [    0.1711]
25-01-17 17:01:15 | I |         best error  = [    0.1711]
25-01-17 17:01:15 | I |     + error = [0.1711]
25-01-17 17:01:16 | I |       - range scale = [    1.0000]
25-01-17 17:01:16 | I |         sum  error  = [    1.7518]
25-01-17 17:01:16 | I |         best error  = [    1.7518]
25-01-17 17:01:16 | I |     + error = [1.7518]
25-01-17 17:01:16 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:01:18 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:01:19 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:01:21 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:01:22 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:01:23 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:01:25 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:01:28 | I | quantizing activations for layer model.layers.4
25-01-17 17:01:29 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:29 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:29 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:29 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:31 | I | forward this layer
25-01-17 17:01:31 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/72.pt
25-01-17 17:01:31 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/72.pt
25-01-17 17:01:31 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:01:31 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:01:31 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:01:31 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:01:31 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:01:31 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:01:31 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:01:31 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:01:31 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:01:31 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:01:31 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:01:31 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:01:31 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:01:31 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:01:31 | I | in layer model.layers.4
25-01-17 17:01:31 | I | quantizing weights for layer model.layers.4
25-01-17 17:01:31 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:32 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:32 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:32 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:32 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:01:32 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:01:33 | I |       - range scale = [    1.0000]
25-01-17 17:01:33 | I |         sum  error  = [    0.6192]
25-01-17 17:01:33 | I |         best error  = [    0.6192]
25-01-17 17:01:33 | I |     + error = [0.6192]
25-01-17 17:01:33 | I |       - range scale = [    1.0000]
25-01-17 17:01:33 | I |         sum  error  = [    5.0264]
25-01-17 17:01:33 | I |         best error  = [    5.0264]
25-01-17 17:01:33 | I |     + error = [5.0264]
25-01-17 17:01:34 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:01:34 | I |       - range scale = [    1.0000]
25-01-17 17:01:34 | I |         sum  error  = [    0.2745]
25-01-17 17:01:34 | I |         best error  = [    0.2745]
25-01-17 17:01:34 | I |     + error = [0.2745]
25-01-17 17:01:35 | I |       - range scale = [    1.0000]
25-01-17 17:01:35 | I |         sum  error  = [    2.2394]
25-01-17 17:01:35 | I |         best error  = [    2.2394]
25-01-17 17:01:35 | I |     + error = [2.2394]
25-01-17 17:01:35 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:01:36 | I |       - range scale = [    1.0000]
25-01-17 17:01:36 | I |         sum  error  = [    0.6184]
25-01-17 17:01:36 | I |         best error  = [    0.6184]
25-01-17 17:01:36 | I |     + error = [0.6184]
25-01-17 17:01:37 | I |       - range scale = [    1.0000]
25-01-17 17:01:37 | I |         sum  error  = [    6.9556]
25-01-17 17:01:37 | I |         best error  = [    6.9556]
25-01-17 17:01:37 | I |     + error = [6.9556]
25-01-17 17:01:37 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:01:37 | I |       - range scale = [    1.0000]
25-01-17 17:01:37 | I |         sum  error  = [    0.0943]
25-01-17 17:01:37 | I |         best error  = [    0.0943]
25-01-17 17:01:37 | I |     + error = [0.0943]
25-01-17 17:01:38 | I |       - range scale = [    1.0000]
25-01-17 17:01:38 | I |         sum  error  = [    1.0330]
25-01-17 17:01:38 | I |         best error  = [    1.0330]
25-01-17 17:01:38 | I |     + error = [1.0330]
25-01-17 17:01:38 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:01:39 | I |       - range scale = [    1.0000]
25-01-17 17:01:39 | I |         sum  error  = [    2.0143]
25-01-17 17:01:39 | I |         best error  = [    2.0143]
25-01-17 17:01:39 | I |     + error = [2.0143]
25-01-17 17:01:40 | I |       - range scale = [    1.0000]
25-01-17 17:01:40 | I |         sum  error  = [   22.6591]
25-01-17 17:01:40 | I |         best error  = [   22.6591]
25-01-17 17:01:40 | I |     + error = [22.6591]
25-01-17 17:01:40 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:01:41 | I |       - range scale = [    1.0000]
25-01-17 17:01:41 | I |         sum  error  = [    2.2036]
25-01-17 17:01:41 | I |         best error  = [    2.2036]
25-01-17 17:01:41 | I |     + error = [2.2036]
25-01-17 17:01:41 | I |       - range scale = [    1.0000]
25-01-17 17:01:41 | I |         sum  error  = [   24.7334]
25-01-17 17:01:41 | I |         best error  = [   24.7334]
25-01-17 17:01:41 | I |     + error = [24.7334]
25-01-17 17:01:42 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:01:42 | I |       - range scale = [    1.0000]
25-01-17 17:01:42 | I |         sum  error  = [    0.1708]
25-01-17 17:01:42 | I |         best error  = [    0.1708]
25-01-17 17:01:42 | I |     + error = [0.1708]
25-01-17 17:01:43 | I |       - range scale = [    1.0000]
25-01-17 17:01:43 | I |         sum  error  = [    1.7502]
25-01-17 17:01:43 | I |         best error  = [    1.7502]
25-01-17 17:01:43 | I |     + error = [1.7502]
25-01-17 17:01:43 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:01:45 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:01:46 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:01:47 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:01:49 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:01:50 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:01:52 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:01:55 | I | quantizing activations for layer model.layers.4
25-01-17 17:01:55 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:55 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:56 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:56 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:57 | I | forward this layer
25-01-17 17:01:57 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/73.pt
25-01-17 17:01:57 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/73.pt
25-01-17 17:01:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:01:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:01:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:01:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:01:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:01:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:01:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:01:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:01:58 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:01:58 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:01:58 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:01:58 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:01:58 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:01:58 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:01:58 | I | [30] done with optimizer step
25-01-17 17:01:58 | I | epoch 001:     37 / 409600000 loss=1.86066e-05, loss_per_token=0.0381063, loss_sum=1248.67, wps=608.1, ups=0.02, wpb=32768, bsz=64, num_updates=31, lr=9.3e-05, gnorm=0.077, clip=0, loss_scale=2, train_wall=54, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=2534
25-01-17 17:01:58 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:01:58 | I | in layer model.layers.4
25-01-17 17:01:58 | I | quantizing weights for layer model.layers.4
25-01-17 17:01:58 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:58 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:58 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:59 | I | collecting calibration activations in model.layers.4
25-01-17 17:01:59 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:01:59 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:02:00 | I |       - range scale = [    1.0000]
25-01-17 17:02:00 | I |         sum  error  = [    0.6170]
25-01-17 17:02:00 | I |         best error  = [    0.6170]
25-01-17 17:02:00 | I |     + error = [0.6170]
25-01-17 17:02:00 | I |       - range scale = [    1.0000]
25-01-17 17:02:00 | I |         sum  error  = [    4.5481]
25-01-17 17:02:00 | I |         best error  = [    4.5481]
25-01-17 17:02:00 | I |     + error = [4.5481]
25-01-17 17:02:00 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:02:01 | I |       - range scale = [    1.0000]
25-01-17 17:02:01 | I |         sum  error  = [    0.2680]
25-01-17 17:02:01 | I |         best error  = [    0.2680]
25-01-17 17:02:01 | I |     + error = [0.2680]
25-01-17 17:02:02 | I |       - range scale = [    1.0000]
25-01-17 17:02:02 | I |         sum  error  = [    2.2550]
25-01-17 17:02:02 | I |         best error  = [    2.2550]
25-01-17 17:02:02 | I |     + error = [2.2550]
25-01-17 17:02:02 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:02:03 | I |       - range scale = [    1.0000]
25-01-17 17:02:03 | I |         sum  error  = [    0.6169]
25-01-17 17:02:03 | I |         best error  = [    0.6169]
25-01-17 17:02:03 | I |     + error = [0.6169]
25-01-17 17:02:03 | I |       - range scale = [    1.0000]
25-01-17 17:02:03 | I |         sum  error  = [    6.8646]
25-01-17 17:02:03 | I |         best error  = [    6.8646]
25-01-17 17:02:03 | I |     + error = [6.8646]
25-01-17 17:02:03 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:02:04 | I |       - range scale = [    1.0000]
25-01-17 17:02:04 | I |         sum  error  = [    0.1082]
25-01-17 17:02:04 | I |         best error  = [    0.1082]
25-01-17 17:02:04 | I |     + error = [0.1082]
25-01-17 17:02:05 | I |       - range scale = [    1.0000]
25-01-17 17:02:05 | I |         sum  error  = [    1.1613]
25-01-17 17:02:05 | I |         best error  = [    1.1613]
25-01-17 17:02:05 | I |     + error = [1.1613]
25-01-17 17:02:05 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:02:06 | I |       - range scale = [    1.0000]
25-01-17 17:02:06 | I |         sum  error  = [    2.0355]
25-01-17 17:02:06 | I |         best error  = [    2.0355]
25-01-17 17:02:06 | I |     + error = [2.0355]
25-01-17 17:02:06 | I |       - range scale = [    1.0000]
25-01-17 17:02:06 | I |         sum  error  = [   22.9002]
25-01-17 17:02:06 | I |         best error  = [   22.9002]
25-01-17 17:02:06 | I |     + error = [22.9002]
25-01-17 17:02:07 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:02:07 | I |       - range scale = [    1.0000]
25-01-17 17:02:07 | I |         sum  error  = [    2.2232]
25-01-17 17:02:07 | I |         best error  = [    2.2232]
25-01-17 17:02:07 | I |     + error = [2.2232]
25-01-17 17:02:08 | I |       - range scale = [    1.0000]
25-01-17 17:02:08 | I |         sum  error  = [   24.9951]
25-01-17 17:02:08 | I |         best error  = [   24.9951]
25-01-17 17:02:08 | I |     + error = [24.9951]
25-01-17 17:02:08 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:02:09 | I |       - range scale = [    1.0000]
25-01-17 17:02:09 | I |         sum  error  = [    0.1726]
25-01-17 17:02:09 | I |         best error  = [    0.1726]
25-01-17 17:02:09 | I |     + error = [0.1726]
25-01-17 17:02:10 | I |       - range scale = [    1.0000]
25-01-17 17:02:10 | I |         sum  error  = [    1.7720]
25-01-17 17:02:10 | I |         best error  = [    1.7720]
25-01-17 17:02:10 | I |     + error = [1.7720]
25-01-17 17:02:10 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:02:11 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:02:13 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:02:14 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:02:15 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:02:17 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:02:18 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:02:22 | I | quantizing activations for layer model.layers.4
25-01-17 17:02:22 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:22 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:22 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:22 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:24 | I | forward this layer
25-01-17 17:02:24 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/74.pt
25-01-17 17:02:24 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/74.pt
25-01-17 17:02:24 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:02:24 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:02:24 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:02:24 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:02:24 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:02:24 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:02:24 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:02:24 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:02:24 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:02:24 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:02:24 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:02:24 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:02:24 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:02:24 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:02:24 | I | in layer model.layers.4
25-01-17 17:02:24 | I | quantizing weights for layer model.layers.4
25-01-17 17:02:25 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:25 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:25 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:25 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:26 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:02:26 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:02:26 | I |       - range scale = [    1.0000]
25-01-17 17:02:26 | I |         sum  error  = [    0.6000]
25-01-17 17:02:26 | I |         best error  = [    0.6000]
25-01-17 17:02:26 | I |     + error = [0.6000]
25-01-17 17:02:27 | I |       - range scale = [    1.0000]
25-01-17 17:02:27 | I |         sum  error  = [    4.9303]
25-01-17 17:02:27 | I |         best error  = [    4.9303]
25-01-17 17:02:27 | I |     + error = [4.9303]
25-01-17 17:02:27 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:02:28 | I |       - range scale = [    1.0000]
25-01-17 17:02:28 | I |         sum  error  = [    0.2634]
25-01-17 17:02:28 | I |         best error  = [    0.2634]
25-01-17 17:02:28 | I |     + error = [0.2634]
25-01-17 17:02:29 | I |       - range scale = [    1.0000]
25-01-17 17:02:29 | I |         sum  error  = [    2.2213]
25-01-17 17:02:29 | I |         best error  = [    2.2213]
25-01-17 17:02:29 | I |     + error = [2.2213]
25-01-17 17:02:29 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:02:30 | I |       - range scale = [    1.0000]
25-01-17 17:02:30 | I |         sum  error  = [    0.6228]
25-01-17 17:02:30 | I |         best error  = [    0.6228]
25-01-17 17:02:30 | I |     + error = [0.6228]
25-01-17 17:02:30 | I |       - range scale = [    1.0000]
25-01-17 17:02:30 | I |         sum  error  = [    6.9888]
25-01-17 17:02:30 | I |         best error  = [    6.9888]
25-01-17 17:02:30 | I |     + error = [6.9888]
25-01-17 17:02:31 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:02:31 | I |       - range scale = [    1.0000]
25-01-17 17:02:31 | I |         sum  error  = [    0.0950]
25-01-17 17:02:31 | I |         best error  = [    0.0950]
25-01-17 17:02:31 | I |     + error = [0.0950]
25-01-17 17:02:32 | I |       - range scale = [    1.0000]
25-01-17 17:02:32 | I |         sum  error  = [    1.0438]
25-01-17 17:02:32 | I |         best error  = [    1.0438]
25-01-17 17:02:32 | I |     + error = [1.0438]
25-01-17 17:02:32 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:02:33 | I |       - range scale = [    1.0000]
25-01-17 17:02:33 | I |         sum  error  = [    2.0195]
25-01-17 17:02:33 | I |         best error  = [    2.0195]
25-01-17 17:02:33 | I |     + error = [2.0195]
25-01-17 17:02:34 | I |       - range scale = [    1.0000]
25-01-17 17:02:34 | I |         sum  error  = [   22.7352]
25-01-17 17:02:34 | I |         best error  = [   22.7352]
25-01-17 17:02:34 | I |     + error = [22.7352]
25-01-17 17:02:34 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:02:35 | I |       - range scale = [    1.0000]
25-01-17 17:02:35 | I |         sum  error  = [    2.2118]
25-01-17 17:02:35 | I |         best error  = [    2.2118]
25-01-17 17:02:35 | I |     + error = [2.2118]
25-01-17 17:02:35 | I |       - range scale = [    1.0000]
25-01-17 17:02:35 | I |         sum  error  = [   24.8164]
25-01-17 17:02:35 | I |         best error  = [   24.8164]
25-01-17 17:02:35 | I |     + error = [24.8164]
25-01-17 17:02:36 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:02:36 | I |       - range scale = [    1.0000]
25-01-17 17:02:36 | I |         sum  error  = [    0.1661]
25-01-17 17:02:36 | I |         best error  = [    0.1661]
25-01-17 17:02:36 | I |     + error = [0.1661]
25-01-17 17:02:37 | I |       - range scale = [    1.0000]
25-01-17 17:02:37 | I |         sum  error  = [    1.6996]
25-01-17 17:02:37 | I |         best error  = [    1.6996]
25-01-17 17:02:37 | I |     + error = [1.6996]
25-01-17 17:02:37 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:02:39 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:02:41 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:02:42 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:02:44 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:02:46 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:02:48 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:02:51 | I | quantizing activations for layer model.layers.4
25-01-17 17:02:52 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:52 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:52 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:52 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:54 | I | forward this layer
25-01-17 17:02:54 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/75.pt
25-01-17 17:02:54 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/75.pt
25-01-17 17:02:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:02:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:02:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:02:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:02:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:02:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:02:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:02:54 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:02:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:02:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:02:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:02:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:02:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:02:54 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:02:54 | I | [31] done with optimizer step
25-01-17 17:02:54 | I | epoch 001:     38 / 409600000 loss=1.63698e-05, loss_per_token=0.0335254, loss_sum=1098.56, wps=582.6, ups=0.02, wpb=32768, bsz=64, num_updates=32, lr=9.6e-05, gnorm=0.079, clip=0, loss_scale=2, train_wall=56, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=2590
25-01-17 17:02:54 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:02:54 | I | in layer model.layers.4
25-01-17 17:02:54 | I | quantizing weights for layer model.layers.4
25-01-17 17:02:55 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:55 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:55 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:55 | I | collecting calibration activations in model.layers.4
25-01-17 17:02:55 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:02:55 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:02:56 | I |       - range scale = [    1.0000]
25-01-17 17:02:56 | I |         sum  error  = [    0.5908]
25-01-17 17:02:56 | I |         best error  = [    0.5908]
25-01-17 17:02:56 | I |     + error = [0.5908]
25-01-17 17:02:57 | I |       - range scale = [    1.0000]
25-01-17 17:02:57 | I |         sum  error  = [    4.4090]
25-01-17 17:02:57 | I |         best error  = [    4.4090]
25-01-17 17:02:57 | I |     + error = [4.4090]
25-01-17 17:02:57 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:02:57 | I |       - range scale = [    1.0000]
25-01-17 17:02:57 | I |         sum  error  = [    0.2739]
25-01-17 17:02:57 | I |         best error  = [    0.2739]
25-01-17 17:02:57 | I |     + error = [0.2739]
25-01-17 17:02:58 | I |       - range scale = [    1.0000]
25-01-17 17:02:58 | I |         sum  error  = [    2.2716]
25-01-17 17:02:58 | I |         best error  = [    2.2716]
25-01-17 17:02:58 | I |     + error = [2.2716]
25-01-17 17:02:58 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:02:59 | I |       - range scale = [    1.0000]
25-01-17 17:02:59 | I |         sum  error  = [    0.6157]
25-01-17 17:02:59 | I |         best error  = [    0.6157]
25-01-17 17:02:59 | I |     + error = [0.6157]
25-01-17 17:03:00 | I |       - range scale = [    1.0000]
25-01-17 17:03:00 | I |         sum  error  = [    6.8827]
25-01-17 17:03:00 | I |         best error  = [    6.8827]
25-01-17 17:03:00 | I |     + error = [6.8827]
25-01-17 17:03:00 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:03:01 | I |       - range scale = [    1.0000]
25-01-17 17:03:01 | I |         sum  error  = [    0.1018]
25-01-17 17:03:01 | I |         best error  = [    0.1018]
25-01-17 17:03:01 | I |     + error = [0.1018]
25-01-17 17:03:01 | I |       - range scale = [    1.0000]
25-01-17 17:03:01 | I |         sum  error  = [    1.0994]
25-01-17 17:03:01 | I |         best error  = [    1.0994]
25-01-17 17:03:01 | I |     + error = [1.0994]
25-01-17 17:03:02 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:03:02 | I |       - range scale = [    1.0000]
25-01-17 17:03:02 | I |         sum  error  = [    1.9938]
25-01-17 17:03:02 | I |         best error  = [    1.9938]
25-01-17 17:03:02 | I |     + error = [1.9938]
25-01-17 17:03:03 | I |       - range scale = [    1.0000]
25-01-17 17:03:03 | I |         sum  error  = [   22.4431]
25-01-17 17:03:03 | I |         best error  = [   22.4431]
25-01-17 17:03:03 | I |     + error = [22.4431]
25-01-17 17:03:03 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:03:04 | I |       - range scale = [    1.0000]
25-01-17 17:03:04 | I |         sum  error  = [    2.1795]
25-01-17 17:03:04 | I |         best error  = [    2.1795]
25-01-17 17:03:04 | I |     + error = [2.1795]
25-01-17 17:03:05 | I |       - range scale = [    1.0000]
25-01-17 17:03:05 | I |         sum  error  = [   24.5035]
25-01-17 17:03:05 | I |         best error  = [   24.5035]
25-01-17 17:03:05 | I |     + error = [24.5035]
25-01-17 17:03:05 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:03:06 | I |       - range scale = [    1.0000]
25-01-17 17:03:06 | I |         sum  error  = [    0.1691]
25-01-17 17:03:06 | I |         best error  = [    0.1691]
25-01-17 17:03:06 | I |     + error = [0.1691]
25-01-17 17:03:06 | I |       - range scale = [    1.0000]
25-01-17 17:03:06 | I |         sum  error  = [    1.7368]
25-01-17 17:03:06 | I |         best error  = [    1.7368]
25-01-17 17:03:06 | I |     + error = [1.7368]
25-01-17 17:03:07 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:03:08 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:03:09 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:03:11 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:03:12 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:03:14 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:03:15 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:03:18 | I | quantizing activations for layer model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:21 | I | forward this layer
25-01-17 17:03:21 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/76.pt
25-01-17 17:03:21 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/76.pt
25-01-17 17:03:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:03:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:03:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:03:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:03:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:03:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:03:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:03:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:03:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:03:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:03:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:03:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:03:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:03:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:03:21 | I | in layer model.layers.4
25-01-17 17:03:21 | I | quantizing weights for layer model.layers.4
25-01-17 17:03:22 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:22 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:22 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:22 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:22 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:03:22 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:03:23 | I |       - range scale = [    1.0000]
25-01-17 17:03:23 | I |         sum  error  = [    0.5482]
25-01-17 17:03:23 | I |         best error  = [    0.5482]
25-01-17 17:03:23 | I |     + error = [0.5482]
25-01-17 17:03:24 | I |       - range scale = [    1.0000]
25-01-17 17:03:24 | I |         sum  error  = [    4.3437]
25-01-17 17:03:24 | I |         best error  = [    4.3437]
25-01-17 17:03:24 | I |     + error = [4.3437]
25-01-17 17:03:24 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:03:25 | I |       - range scale = [    1.0000]
25-01-17 17:03:25 | I |         sum  error  = [    0.2825]
25-01-17 17:03:25 | I |         best error  = [    0.2825]
25-01-17 17:03:25 | I |     + error = [0.2825]
25-01-17 17:03:25 | I |       - range scale = [    1.0000]
25-01-17 17:03:25 | I |         sum  error  = [    2.2719]
25-01-17 17:03:25 | I |         best error  = [    2.2719]
25-01-17 17:03:25 | I |     + error = [2.2719]
25-01-17 17:03:26 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:03:26 | I |       - range scale = [    1.0000]
25-01-17 17:03:26 | I |         sum  error  = [    0.6103]
25-01-17 17:03:26 | I |         best error  = [    0.6103]
25-01-17 17:03:26 | I |     + error = [0.6103]
25-01-17 17:03:27 | I |       - range scale = [    1.0000]
25-01-17 17:03:27 | I |         sum  error  = [    6.8760]
25-01-17 17:03:27 | I |         best error  = [    6.8760]
25-01-17 17:03:27 | I |     + error = [6.8760]
25-01-17 17:03:27 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:03:28 | I |       - range scale = [    1.0000]
25-01-17 17:03:28 | I |         sum  error  = [    0.0996]
25-01-17 17:03:28 | I |         best error  = [    0.0996]
25-01-17 17:03:28 | I |     + error = [0.0996]
25-01-17 17:03:29 | I |       - range scale = [    1.0000]
25-01-17 17:03:29 | I |         sum  error  = [    1.0919]
25-01-17 17:03:29 | I |         best error  = [    1.0919]
25-01-17 17:03:29 | I |     + error = [1.0919]
25-01-17 17:03:29 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:03:30 | I |       - range scale = [    1.0000]
25-01-17 17:03:30 | I |         sum  error  = [    2.0332]
25-01-17 17:03:30 | I |         best error  = [    2.0332]
25-01-17 17:03:30 | I |     + error = [2.0332]
25-01-17 17:03:30 | I |       - range scale = [    1.0000]
25-01-17 17:03:30 | I |         sum  error  = [   22.8762]
25-01-17 17:03:30 | I |         best error  = [   22.8762]
25-01-17 17:03:30 | I |     + error = [22.8762]
25-01-17 17:03:31 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:03:31 | I |       - range scale = [    1.0000]
25-01-17 17:03:31 | I |         sum  error  = [    2.2230]
25-01-17 17:03:31 | I |         best error  = [    2.2230]
25-01-17 17:03:31 | I |     + error = [2.2230]
25-01-17 17:03:32 | I |       - range scale = [    1.0000]
25-01-17 17:03:32 | I |         sum  error  = [   24.9639]
25-01-17 17:03:32 | I |         best error  = [   24.9639]
25-01-17 17:03:32 | I |     + error = [24.9639]
25-01-17 17:03:32 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:03:33 | I |       - range scale = [    1.0000]
25-01-17 17:03:33 | I |         sum  error  = [    0.1664]
25-01-17 17:03:33 | I |         best error  = [    0.1664]
25-01-17 17:03:33 | I |     + error = [0.1664]
25-01-17 17:03:34 | I |       - range scale = [    1.0000]
25-01-17 17:03:34 | I |         sum  error  = [    1.6996]
25-01-17 17:03:34 | I |         best error  = [    1.6996]
25-01-17 17:03:34 | I |     + error = [1.6996]
25-01-17 17:03:34 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:03:36 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:03:37 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:03:38 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:03:40 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:03:41 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:03:43 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:03:46 | I | quantizing activations for layer model.layers.4
25-01-17 17:03:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:49 | I | forward this layer
25-01-17 17:03:49 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/77.pt
25-01-17 17:03:49 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/77.pt
25-01-17 17:03:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:03:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:03:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:03:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:03:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:03:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:03:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:03:49 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:03:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:03:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:03:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:03:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:03:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:03:49 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:03:49 | I | [32] done with optimizer step
25-01-17 17:03:49 | I | epoch 001:     39 / 409600000 loss=1.53732e-05, loss_per_token=0.0314844, loss_sum=1031.68, wps=597.2, ups=0.02, wpb=32768, bsz=64, num_updates=33, lr=9.9e-05, gnorm=0.053, clip=0, loss_scale=2, train_wall=55, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=2645
25-01-17 17:03:49 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:03:49 | I | in layer model.layers.4
25-01-17 17:03:49 | I | quantizing weights for layer model.layers.4
25-01-17 17:03:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:50 | I | collecting calibration activations in model.layers.4
25-01-17 17:03:50 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:03:50 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:03:51 | I |       - range scale = [    1.0000]
25-01-17 17:03:51 | I |         sum  error  = [    0.5343]
25-01-17 17:03:51 | I |         best error  = [    0.5343]
25-01-17 17:03:51 | I |     + error = [0.5343]
25-01-17 17:03:51 | I |       - range scale = [    1.0000]
25-01-17 17:03:51 | I |         sum  error  = [    4.2771]
25-01-17 17:03:51 | I |         best error  = [    4.2771]
25-01-17 17:03:51 | I |     + error = [4.2771]
25-01-17 17:03:52 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:03:52 | I |       - range scale = [    1.0000]
25-01-17 17:03:52 | I |         sum  error  = [    0.2537]
25-01-17 17:03:52 | I |         best error  = [    0.2537]
25-01-17 17:03:52 | I |     + error = [0.2537]
25-01-17 17:03:53 | I |       - range scale = [    1.0000]
25-01-17 17:03:53 | I |         sum  error  = [    2.1397]
25-01-17 17:03:53 | I |         best error  = [    2.1397]
25-01-17 17:03:53 | I |     + error = [2.1397]
25-01-17 17:03:53 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:03:54 | I |       - range scale = [    1.0000]
25-01-17 17:03:54 | I |         sum  error  = [    0.6155]
25-01-17 17:03:54 | I |         best error  = [    0.6155]
25-01-17 17:03:54 | I |     + error = [0.6155]
25-01-17 17:03:55 | I |       - range scale = [    1.0000]
25-01-17 17:03:55 | I |         sum  error  = [    6.9505]
25-01-17 17:03:55 | I |         best error  = [    6.9505]
25-01-17 17:03:55 | I |     + error = [6.9505]
25-01-17 17:03:55 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:03:56 | I |       - range scale = [    1.0000]
25-01-17 17:03:56 | I |         sum  error  = [    0.0988]
25-01-17 17:03:56 | I |         best error  = [    0.0988]
25-01-17 17:03:56 | I |     + error = [0.0988]
25-01-17 17:03:56 | I |       - range scale = [    1.0000]
25-01-17 17:03:56 | I |         sum  error  = [    1.0861]
25-01-17 17:03:56 | I |         best error  = [    1.0861]
25-01-17 17:03:56 | I |     + error = [1.0861]
25-01-17 17:03:57 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:03:57 | I |       - range scale = [    1.0000]
25-01-17 17:03:57 | I |         sum  error  = [    2.0482]
25-01-17 17:03:57 | I |         best error  = [    2.0482]
25-01-17 17:03:57 | I |     + error = [2.0482]
25-01-17 17:03:58 | I |       - range scale = [    1.0000]
25-01-17 17:03:58 | I |         sum  error  = [   23.0544]
25-01-17 17:03:58 | I |         best error  = [   23.0544]
25-01-17 17:03:58 | I |     + error = [23.0544]
25-01-17 17:03:58 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:03:59 | I |       - range scale = [    1.0000]
25-01-17 17:03:59 | I |         sum  error  = [    2.2407]
25-01-17 17:03:59 | I |         best error  = [    2.2407]
25-01-17 17:03:59 | I |     + error = [2.2407]
25-01-17 17:04:00 | I |       - range scale = [    1.0000]
25-01-17 17:04:00 | I |         sum  error  = [   25.1514]
25-01-17 17:04:00 | I |         best error  = [   25.1514]
25-01-17 17:04:00 | I |     + error = [25.1514]
25-01-17 17:04:00 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:04:01 | I |       - range scale = [    1.0000]
25-01-17 17:04:01 | I |         sum  error  = [    0.1689]
25-01-17 17:04:01 | I |         best error  = [    0.1689]
25-01-17 17:04:01 | I |     + error = [0.1689]
25-01-17 17:04:01 | I |       - range scale = [    1.0000]
25-01-17 17:04:01 | I |         sum  error  = [    1.7327]
25-01-17 17:04:01 | I |         best error  = [    1.7327]
25-01-17 17:04:01 | I |     + error = [1.7327]
25-01-17 17:04:02 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:04:03 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:04:04 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:04:06 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:04:07 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:04:09 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:04:10 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:04:13 | I | quantizing activations for layer model.layers.4
25-01-17 17:04:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:16 | I | forward this layer
25-01-17 17:04:16 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/78.pt
25-01-17 17:04:16 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/78.pt
25-01-17 17:04:16 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:04:16 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:04:16 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:04:16 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:04:16 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:04:16 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:04:16 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:04:16 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:04:16 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:04:16 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:04:16 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:04:16 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:04:16 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:04:16 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:04:16 | I | in layer model.layers.4
25-01-17 17:04:16 | I | quantizing weights for layer model.layers.4
25-01-17 17:04:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:17 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:04:17 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:04:18 | I |       - range scale = [    1.0000]
25-01-17 17:04:18 | I |         sum  error  = [    0.5406]
25-01-17 17:04:18 | I |         best error  = [    0.5406]
25-01-17 17:04:18 | I |     + error = [0.5406]
25-01-17 17:04:19 | I |       - range scale = [    1.0000]
25-01-17 17:04:19 | I |         sum  error  = [    4.3133]
25-01-17 17:04:19 | I |         best error  = [    4.3133]
25-01-17 17:04:19 | I |     + error = [4.3133]
25-01-17 17:04:19 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:04:19 | I |       - range scale = [    1.0000]
25-01-17 17:04:19 | I |         sum  error  = [    0.2711]
25-01-17 17:04:19 | I |         best error  = [    0.2711]
25-01-17 17:04:19 | I |     + error = [0.2711]
25-01-17 17:04:20 | I |       - range scale = [    1.0000]
25-01-17 17:04:20 | I |         sum  error  = [    2.1875]
25-01-17 17:04:20 | I |         best error  = [    2.1875]
25-01-17 17:04:20 | I |     + error = [2.1875]
25-01-17 17:04:20 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:04:21 | I |       - range scale = [    1.0000]
25-01-17 17:04:21 | I |         sum  error  = [    0.6104]
25-01-17 17:04:21 | I |         best error  = [    0.6104]
25-01-17 17:04:21 | I |     + error = [0.6104]
25-01-17 17:04:22 | I |       - range scale = [    1.0000]
25-01-17 17:04:22 | I |         sum  error  = [    6.8411]
25-01-17 17:04:22 | I |         best error  = [    6.8411]
25-01-17 17:04:22 | I |     + error = [6.8411]
25-01-17 17:04:22 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:04:23 | I |       - range scale = [    1.0000]
25-01-17 17:04:23 | I |         sum  error  = [    0.1045]
25-01-17 17:04:23 | I |         best error  = [    0.1045]
25-01-17 17:04:23 | I |     + error = [0.1045]
25-01-17 17:04:23 | I |       - range scale = [    1.0000]
25-01-17 17:04:23 | I |         sum  error  = [    1.1285]
25-01-17 17:04:23 | I |         best error  = [    1.1285]
25-01-17 17:04:23 | I |     + error = [1.1285]
25-01-17 17:04:24 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:04:24 | I |       - range scale = [    1.0000]
25-01-17 17:04:24 | I |         sum  error  = [    2.0510]
25-01-17 17:04:24 | I |         best error  = [    2.0510]
25-01-17 17:04:24 | I |     + error = [2.0510]
25-01-17 17:04:25 | I |       - range scale = [    1.0000]
25-01-17 17:04:25 | I |         sum  error  = [   23.0922]
25-01-17 17:04:25 | I |         best error  = [   23.0922]
25-01-17 17:04:25 | I |     + error = [23.0922]
25-01-17 17:04:25 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:04:26 | I |       - range scale = [    1.0000]
25-01-17 17:04:26 | I |         sum  error  = [    2.2424]
25-01-17 17:04:26 | I |         best error  = [    2.2424]
25-01-17 17:04:26 | I |     + error = [2.2424]
25-01-17 17:04:27 | I |       - range scale = [    1.0000]
25-01-17 17:04:27 | I |         sum  error  = [   25.1993]
25-01-17 17:04:27 | I |         best error  = [   25.1993]
25-01-17 17:04:27 | I |     + error = [25.1993]
25-01-17 17:04:27 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:04:27 | I |       - range scale = [    1.0000]
25-01-17 17:04:27 | I |         sum  error  = [    0.1662]
25-01-17 17:04:27 | I |         best error  = [    0.1662]
25-01-17 17:04:27 | I |     + error = [0.1662]
25-01-17 17:04:28 | I |       - range scale = [    1.0000]
25-01-17 17:04:28 | I |         sum  error  = [    1.7042]
25-01-17 17:04:28 | I |         best error  = [    1.7042]
25-01-17 17:04:28 | I |     + error = [1.7042]
25-01-17 17:04:28 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:04:30 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:04:31 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:04:33 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:04:34 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:04:35 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:04:37 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:04:40 | I | quantizing activations for layer model.layers.4
25-01-17 17:04:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:40 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:42 | I | forward this layer
25-01-17 17:04:42 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/79.pt
25-01-17 17:04:42 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/79.pt
25-01-17 17:04:43 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:04:43 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:04:43 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:04:43 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:04:43 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:04:43 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:04:43 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:04:43 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:04:43 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:04:43 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:04:43 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:04:43 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:04:43 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:04:43 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:04:43 | I | [33] done with optimizer step
25-01-17 17:04:43 | I | epoch 001:     40 / 409600000 loss=1.41142e-05, loss_per_token=0.0289058, loss_sum=947.187, wps=609.8, ups=0.02, wpb=32768, bsz=64, num_updates=34, lr=0.000102, gnorm=0.078, clip=0, loss_scale=2, train_wall=54, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=2699
25-01-17 17:04:43 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:04:43 | I | in layer model.layers.4
25-01-17 17:04:43 | I | quantizing weights for layer model.layers.4
25-01-17 17:04:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:43 | I | collecting calibration activations in model.layers.4
25-01-17 17:04:44 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:04:44 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:04:44 | I |       - range scale = [    1.0000]
25-01-17 17:04:44 | I |         sum  error  = [    0.5441]
25-01-17 17:04:44 | I |         best error  = [    0.5441]
25-01-17 17:04:44 | I |     + error = [0.5441]
25-01-17 17:04:45 | I |       - range scale = [    1.0000]
25-01-17 17:04:45 | I |         sum  error  = [    4.1377]
25-01-17 17:04:45 | I |         best error  = [    4.1377]
25-01-17 17:04:45 | I |     + error = [4.1377]
25-01-17 17:04:45 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:04:46 | I |       - range scale = [    1.0000]
25-01-17 17:04:46 | I |         sum  error  = [    0.2387]
25-01-17 17:04:46 | I |         best error  = [    0.2387]
25-01-17 17:04:46 | I |     + error = [0.2387]
25-01-17 17:04:47 | I |       - range scale = [    1.0000]
25-01-17 17:04:47 | I |         sum  error  = [    2.0448]
25-01-17 17:04:47 | I |         best error  = [    2.0448]
25-01-17 17:04:47 | I |     + error = [2.0448]
25-01-17 17:04:47 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:04:48 | I |       - range scale = [    1.0000]
25-01-17 17:04:48 | I |         sum  error  = [    0.6103]
25-01-17 17:04:48 | I |         best error  = [    0.6103]
25-01-17 17:04:48 | I |     + error = [0.6103]
25-01-17 17:04:48 | I |       - range scale = [    1.0000]
25-01-17 17:04:48 | I |         sum  error  = [    6.8565]
25-01-17 17:04:48 | I |         best error  = [    6.8565]
25-01-17 17:04:48 | I |     + error = [6.8565]
25-01-17 17:04:48 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:04:49 | I |       - range scale = [    1.0000]
25-01-17 17:04:49 | I |         sum  error  = [    0.0868]
25-01-17 17:04:49 | I |         best error  = [    0.0868]
25-01-17 17:04:49 | I |     + error = [0.0868]
25-01-17 17:04:50 | I |       - range scale = [    1.0000]
25-01-17 17:04:50 | I |         sum  error  = [    0.9443]
25-01-17 17:04:50 | I |         best error  = [    0.9443]
25-01-17 17:04:50 | I |     + error = [0.9443]
25-01-17 17:04:50 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:04:51 | I |       - range scale = [    1.0000]
25-01-17 17:04:51 | I |         sum  error  = [    1.9756]
25-01-17 17:04:51 | I |         best error  = [    1.9756]
25-01-17 17:04:51 | I |     + error = [1.9756]
25-01-17 17:04:52 | I |       - range scale = [    1.0000]
25-01-17 17:04:52 | I |         sum  error  = [   22.2865]
25-01-17 17:04:52 | I |         best error  = [   22.2865]
25-01-17 17:04:52 | I |     + error = [22.2865]
25-01-17 17:04:52 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:04:52 | I |       - range scale = [    1.0000]
25-01-17 17:04:52 | I |         sum  error  = [    2.1639]
25-01-17 17:04:52 | I |         best error  = [    2.1639]
25-01-17 17:04:52 | I |     + error = [2.1639]
25-01-17 17:04:53 | I |       - range scale = [    1.0000]
25-01-17 17:04:53 | I |         sum  error  = [   24.3291]
25-01-17 17:04:53 | I |         best error  = [   24.3291]
25-01-17 17:04:53 | I |     + error = [24.3291]
25-01-17 17:04:53 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:04:54 | I |       - range scale = [    1.0000]
25-01-17 17:04:54 | I |         sum  error  = [    0.1696]
25-01-17 17:04:54 | I |         best error  = [    0.1696]
25-01-17 17:04:54 | I |     + error = [0.1696]
25-01-17 17:04:55 | I |       - range scale = [    1.0000]
25-01-17 17:04:55 | I |         sum  error  = [    1.7381]
25-01-17 17:04:55 | I |         best error  = [    1.7381]
25-01-17 17:04:55 | I |     + error = [1.7381]
25-01-17 17:04:55 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:04:57 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:04:58 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:04:59 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:05:01 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:05:02 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:05:04 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:05:07 | I | quantizing activations for layer model.layers.4
25-01-17 17:05:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:10 | I | forward this layer
25-01-17 17:05:10 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/80.pt
25-01-17 17:05:10 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/80.pt
25-01-17 17:05:10 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:05:10 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:05:10 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:05:10 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:05:10 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:05:10 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:05:10 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:05:10 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:05:10 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:05:10 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:05:10 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:05:10 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:05:10 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:05:10 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:05:10 | I | in layer model.layers.4
25-01-17 17:05:10 | I | quantizing weights for layer model.layers.4
25-01-17 17:05:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:11 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:11 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:05:11 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:05:12 | I |       - range scale = [    1.0000]
25-01-17 17:05:12 | I |         sum  error  = [    0.5291]
25-01-17 17:05:12 | I |         best error  = [    0.5291]
25-01-17 17:05:12 | I |     + error = [0.5291]
25-01-17 17:05:12 | I |       - range scale = [    1.0000]
25-01-17 17:05:12 | I |         sum  error  = [    4.3840]
25-01-17 17:05:12 | I |         best error  = [    4.3840]
25-01-17 17:05:12 | I |     + error = [4.3840]
25-01-17 17:05:13 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:05:13 | I |       - range scale = [    1.0000]
25-01-17 17:05:13 | I |         sum  error  = [    0.2417]
25-01-17 17:05:13 | I |         best error  = [    0.2417]
25-01-17 17:05:13 | I |     + error = [0.2417]
25-01-17 17:05:14 | I |       - range scale = [    1.0000]
25-01-17 17:05:14 | I |         sum  error  = [    2.1167]
25-01-17 17:05:14 | I |         best error  = [    2.1167]
25-01-17 17:05:14 | I |     + error = [2.1167]
25-01-17 17:05:14 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:05:15 | I |       - range scale = [    1.0000]
25-01-17 17:05:15 | I |         sum  error  = [    0.6099]
25-01-17 17:05:15 | I |         best error  = [    0.6099]
25-01-17 17:05:15 | I |     + error = [0.6099]
25-01-17 17:05:16 | I |       - range scale = [    1.0000]
25-01-17 17:05:16 | I |         sum  error  = [    6.8362]
25-01-17 17:05:16 | I |         best error  = [    6.8362]
25-01-17 17:05:16 | I |     + error = [6.8362]
25-01-17 17:05:16 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:05:17 | I |       - range scale = [    1.0000]
25-01-17 17:05:17 | I |         sum  error  = [    0.0903]
25-01-17 17:05:17 | I |         best error  = [    0.0903]
25-01-17 17:05:17 | I |     + error = [0.0903]
25-01-17 17:05:17 | I |       - range scale = [    1.0000]
25-01-17 17:05:17 | I |         sum  error  = [    0.9782]
25-01-17 17:05:17 | I |         best error  = [    0.9782]
25-01-17 17:05:17 | I |     + error = [0.9782]
25-01-17 17:05:18 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:05:18 | I |       - range scale = [    1.0000]
25-01-17 17:05:18 | I |         sum  error  = [    2.0571]
25-01-17 17:05:18 | I |         best error  = [    2.0571]
25-01-17 17:05:18 | I |     + error = [2.0571]
25-01-17 17:05:19 | I |       - range scale = [    1.0000]
25-01-17 17:05:19 | I |         sum  error  = [   23.1692]
25-01-17 17:05:19 | I |         best error  = [   23.1692]
25-01-17 17:05:19 | I |     + error = [23.1692]
25-01-17 17:05:19 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:05:20 | I |       - range scale = [    1.0000]
25-01-17 17:05:20 | I |         sum  error  = [    2.2508]
25-01-17 17:05:20 | I |         best error  = [    2.2508]
25-01-17 17:05:20 | I |     + error = [2.2508]
25-01-17 17:05:21 | I |       - range scale = [    1.0000]
25-01-17 17:05:21 | I |         sum  error  = [   25.2885]
25-01-17 17:05:21 | I |         best error  = [   25.2885]
25-01-17 17:05:21 | I |     + error = [25.2885]
25-01-17 17:05:21 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:05:22 | I |       - range scale = [    1.0000]
25-01-17 17:05:22 | I |         sum  error  = [    0.1748]
25-01-17 17:05:22 | I |         best error  = [    0.1748]
25-01-17 17:05:22 | I |     + error = [0.1748]
25-01-17 17:05:23 | I |       - range scale = [    1.0000]
25-01-17 17:05:23 | I |         sum  error  = [    1.7877]
25-01-17 17:05:23 | I |         best error  = [    1.7877]
25-01-17 17:05:23 | I |     + error = [1.7877]
25-01-17 17:05:23 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:05:24 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:05:26 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:05:27 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:05:28 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:05:30 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:05:31 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:05:35 | I | quantizing activations for layer model.layers.4
25-01-17 17:05:35 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:35 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:35 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:36 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:37 | I | forward this layer
25-01-17 17:05:37 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/81.pt
25-01-17 17:05:37 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/81.pt
25-01-17 17:05:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:05:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:05:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:05:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:05:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:05:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:05:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:05:38 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:05:38 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:05:38 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:05:38 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:05:38 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:05:38 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:05:38 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:05:38 | I | [34] done with optimizer step
25-01-17 17:05:38 | I | epoch 001:     41 / 409600000 loss=1.45021e-05, loss_per_token=0.0297003, loss_sum=973.218, wps=594, ups=0.02, wpb=32768, bsz=64, num_updates=35, lr=0.000105, gnorm=0.074, clip=0, loss_scale=2, train_wall=55, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=2754
25-01-17 17:05:38 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:05:38 | I | in layer model.layers.4
25-01-17 17:05:38 | I | quantizing weights for layer model.layers.4
25-01-17 17:05:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:39 | I | collecting calibration activations in model.layers.4
25-01-17 17:05:39 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:05:39 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:05:40 | I |       - range scale = [    1.0000]
25-01-17 17:05:40 | I |         sum  error  = [    0.5466]
25-01-17 17:05:40 | I |         best error  = [    0.5466]
25-01-17 17:05:40 | I |     + error = [0.5466]
25-01-17 17:05:40 | I |       - range scale = [    1.0000]
25-01-17 17:05:40 | I |         sum  error  = [    4.2063]
25-01-17 17:05:40 | I |         best error  = [    4.2063]
25-01-17 17:05:40 | I |     + error = [4.2063]
25-01-17 17:05:41 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:05:41 | I |       - range scale = [    1.0000]
25-01-17 17:05:41 | I |         sum  error  = [    0.2434]
25-01-17 17:05:41 | I |         best error  = [    0.2434]
25-01-17 17:05:41 | I |     + error = [0.2434]
25-01-17 17:05:42 | I |       - range scale = [    1.0000]
25-01-17 17:05:42 | I |         sum  error  = [    2.0712]
25-01-17 17:05:42 | I |         best error  = [    2.0712]
25-01-17 17:05:42 | I |     + error = [2.0712]
25-01-17 17:05:42 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:05:43 | I |       - range scale = [    1.0000]
25-01-17 17:05:43 | I |         sum  error  = [    0.6057]
25-01-17 17:05:43 | I |         best error  = [    0.6057]
25-01-17 17:05:43 | I |     + error = [0.6057]
25-01-17 17:05:44 | I |       - range scale = [    1.0000]
25-01-17 17:05:44 | I |         sum  error  = [    6.7949]
25-01-17 17:05:44 | I |         best error  = [    6.7949]
25-01-17 17:05:44 | I |     + error = [6.7949]
25-01-17 17:05:44 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:05:45 | I |       - range scale = [    1.0000]
25-01-17 17:05:45 | I |         sum  error  = [    0.0971]
25-01-17 17:05:45 | I |         best error  = [    0.0971]
25-01-17 17:05:45 | I |     + error = [0.0971]
25-01-17 17:05:45 | I |       - range scale = [    1.0000]
25-01-17 17:05:45 | I |         sum  error  = [    1.0639]
25-01-17 17:05:45 | I |         best error  = [    1.0639]
25-01-17 17:05:45 | I |     + error = [1.0639]
25-01-17 17:05:45 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:05:46 | I |       - range scale = [    1.0000]
25-01-17 17:05:46 | I |         sum  error  = [    2.0500]
25-01-17 17:05:46 | I |         best error  = [    2.0500]
25-01-17 17:05:46 | I |     + error = [2.0500]
25-01-17 17:05:47 | I |       - range scale = [    1.0000]
25-01-17 17:05:47 | I |         sum  error  = [   23.0569]
25-01-17 17:05:47 | I |         best error  = [   23.0569]
25-01-17 17:05:47 | I |     + error = [23.0569]
25-01-17 17:05:47 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:05:48 | I |       - range scale = [    1.0000]
25-01-17 17:05:48 | I |         sum  error  = [    2.2386]
25-01-17 17:05:48 | I |         best error  = [    2.2386]
25-01-17 17:05:48 | I |     + error = [2.2386]
25-01-17 17:05:49 | I |       - range scale = [    1.0000]
25-01-17 17:05:49 | I |         sum  error  = [   25.1655]
25-01-17 17:05:49 | I |         best error  = [   25.1655]
25-01-17 17:05:49 | I |     + error = [25.1655]
25-01-17 17:05:49 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:05:49 | I |       - range scale = [    1.0000]
25-01-17 17:05:49 | I |         sum  error  = [    0.1739]
25-01-17 17:05:50 | I |         best error  = [    0.1739]
25-01-17 17:05:50 | I |     + error = [0.1739]
25-01-17 17:05:50 | I |       - range scale = [    1.0000]
25-01-17 17:05:50 | I |         sum  error  = [    1.7807]
25-01-17 17:05:50 | I |         best error  = [    1.7807]
25-01-17 17:05:50 | I |     + error = [1.7807]
25-01-17 17:05:51 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:05:52 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:05:53 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:05:55 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:05:56 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:05:57 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:05:59 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:06:02 | I | quantizing activations for layer model.layers.4
25-01-17 17:06:03 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:03 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:03 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:03 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:05 | I | forward this layer
25-01-17 17:06:05 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/82.pt
25-01-17 17:06:05 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/82.pt
25-01-17 17:06:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:06:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:06:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:06:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:06:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:06:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:06:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:06:05 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:06:05 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:06:05 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:06:05 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:06:05 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:06:05 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:06:05 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:06:05 | I | in layer model.layers.4
25-01-17 17:06:05 | I | quantizing weights for layer model.layers.4
25-01-17 17:06:06 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:06 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:06 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:06 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:06 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:06:06 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:06:07 | I |       - range scale = [    1.0000]
25-01-17 17:06:07 | I |         sum  error  = [    0.6160]
25-01-17 17:06:07 | I |         best error  = [    0.6160]
25-01-17 17:06:07 | I |     + error = [0.6160]
25-01-17 17:06:08 | I |       - range scale = [    1.0000]
25-01-17 17:06:08 | I |         sum  error  = [    4.5920]
25-01-17 17:06:08 | I |         best error  = [    4.5920]
25-01-17 17:06:08 | I |     + error = [4.5920]
25-01-17 17:06:08 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:06:09 | I |       - range scale = [    1.0000]
25-01-17 17:06:09 | I |         sum  error  = [    0.2711]
25-01-17 17:06:09 | I |         best error  = [    0.2711]
25-01-17 17:06:09 | I |     + error = [0.2711]
25-01-17 17:06:09 | I |       - range scale = [    1.0000]
25-01-17 17:06:09 | I |         sum  error  = [    2.1851]
25-01-17 17:06:09 | I |         best error  = [    2.1851]
25-01-17 17:06:09 | I |     + error = [2.1851]
25-01-17 17:06:10 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:06:10 | I |       - range scale = [    1.0000]
25-01-17 17:06:10 | I |         sum  error  = [    0.6076]
25-01-17 17:06:10 | I |         best error  = [    0.6076]
25-01-17 17:06:10 | I |     + error = [0.6076]
25-01-17 17:06:11 | I |       - range scale = [    1.0000]
25-01-17 17:06:11 | I |         sum  error  = [    6.8042]
25-01-17 17:06:11 | I |         best error  = [    6.8042]
25-01-17 17:06:11 | I |     + error = [6.8042]
25-01-17 17:06:11 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:06:12 | I |       - range scale = [    1.0000]
25-01-17 17:06:12 | I |         sum  error  = [    0.0995]
25-01-17 17:06:12 | I |         best error  = [    0.0995]
25-01-17 17:06:12 | I |     + error = [0.0995]
25-01-17 17:06:13 | I |       - range scale = [    1.0000]
25-01-17 17:06:13 | I |         sum  error  = [    1.0906]
25-01-17 17:06:13 | I |         best error  = [    1.0906]
25-01-17 17:06:13 | I |     + error = [1.0906]
25-01-17 17:06:13 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:06:14 | I |       - range scale = [    1.0000]
25-01-17 17:06:14 | I |         sum  error  = [    1.9976]
25-01-17 17:06:14 | I |         best error  = [    1.9976]
25-01-17 17:06:14 | I |     + error = [1.9976]
25-01-17 17:06:15 | I |       - range scale = [    1.0000]
25-01-17 17:06:15 | I |         sum  error  = [   22.4777]
25-01-17 17:06:15 | I |         best error  = [   22.4777]
25-01-17 17:06:15 | I |     + error = [22.4777]
25-01-17 17:06:15 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:06:15 | I |       - range scale = [    1.0000]
25-01-17 17:06:15 | I |         sum  error  = [    2.1820]
25-01-17 17:06:15 | I |         best error  = [    2.1820]
25-01-17 17:06:15 | I |     + error = [2.1820]
25-01-17 17:06:16 | I |       - range scale = [    1.0000]
25-01-17 17:06:16 | I |         sum  error  = [   24.5381]
25-01-17 17:06:16 | I |         best error  = [   24.5381]
25-01-17 17:06:16 | I |     + error = [24.5381]
25-01-17 17:06:16 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:06:17 | I |       - range scale = [    1.0000]
25-01-17 17:06:17 | I |         sum  error  = [    0.1752]
25-01-17 17:06:17 | I |         best error  = [    0.1752]
25-01-17 17:06:17 | I |     + error = [0.1752]
25-01-17 17:06:18 | I |       - range scale = [    1.0000]
25-01-17 17:06:18 | I |         sum  error  = [    1.7932]
25-01-17 17:06:18 | I |         best error  = [    1.7932]
25-01-17 17:06:18 | I |     + error = [1.7932]
25-01-17 17:06:18 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:06:20 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:06:21 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:06:22 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:06:24 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:06:25 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:06:27 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:06:30 | I | quantizing activations for layer model.layers.4
25-01-17 17:06:31 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:31 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:31 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:31 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:33 | I | forward this layer
25-01-17 17:06:33 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/83.pt
25-01-17 17:06:33 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/83.pt
25-01-17 17:06:33 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:06:33 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:06:33 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:06:33 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:06:33 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:06:33 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:06:33 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:06:33 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:06:33 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:06:33 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:06:33 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:06:33 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:06:33 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:06:33 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:06:33 | I | [35] done with optimizer step
25-01-17 17:06:33 | I | epoch 001:     42 / 409600000 loss=1.64815e-05, loss_per_token=0.0337541, loss_sum=1106.05, wps=592.2, ups=0.02, wpb=32768, bsz=64, num_updates=36, lr=0.000108, gnorm=0.053, clip=0, loss_scale=2, train_wall=55, cuda_gb_allocated=12.3, cuda_gb_reserved=13.8, cuda_gb_free=11.4, wall=2809
25-01-17 17:06:33 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:06:33 | I | in layer model.layers.4
25-01-17 17:06:33 | I | quantizing weights for layer model.layers.4
25-01-17 17:06:34 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:34 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:34 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:34 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:34 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:06:34 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:06:35 | I |       - range scale = [    1.0000]
25-01-17 17:06:35 | I |         sum  error  = [    0.5541]
25-01-17 17:06:35 | I |         best error  = [    0.5541]
25-01-17 17:06:35 | I |     + error = [0.5541]
25-01-17 17:06:36 | I |       - range scale = [    1.0000]
25-01-17 17:06:36 | I |         sum  error  = [    4.2411]
25-01-17 17:06:36 | I |         best error  = [    4.2411]
25-01-17 17:06:36 | I |     + error = [4.2411]
25-01-17 17:06:36 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:06:37 | I |       - range scale = [    1.0000]
25-01-17 17:06:37 | I |         sum  error  = [    0.2588]
25-01-17 17:06:37 | I |         best error  = [    0.2588]
25-01-17 17:06:37 | I |     + error = [0.2588]
25-01-17 17:06:38 | I |       - range scale = [    1.0000]
25-01-17 17:06:38 | I |         sum  error  = [    2.1660]
25-01-17 17:06:38 | I |         best error  = [    2.1660]
25-01-17 17:06:38 | I |     + error = [2.1660]
25-01-17 17:06:38 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:06:38 | I |       - range scale = [    1.0000]
25-01-17 17:06:38 | I |         sum  error  = [    0.6126]
25-01-17 17:06:38 | I |         best error  = [    0.6126]
25-01-17 17:06:38 | I |     + error = [0.6126]
25-01-17 17:06:39 | I |       - range scale = [    1.0000]
25-01-17 17:06:39 | I |         sum  error  = [    6.8727]
25-01-17 17:06:39 | I |         best error  = [    6.8727]
25-01-17 17:06:39 | I |     + error = [6.8727]
25-01-17 17:06:39 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:06:40 | I |       - range scale = [    1.0000]
25-01-17 17:06:40 | I |         sum  error  = [    0.0973]
25-01-17 17:06:40 | I |         best error  = [    0.0973]
25-01-17 17:06:40 | I |     + error = [0.0973]
25-01-17 17:06:41 | I |       - range scale = [    1.0000]
25-01-17 17:06:41 | I |         sum  error  = [    1.0593]
25-01-17 17:06:41 | I |         best error  = [    1.0593]
25-01-17 17:06:41 | I |     + error = [1.0593]
25-01-17 17:06:41 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:06:42 | I |       - range scale = [    1.0000]
25-01-17 17:06:42 | I |         sum  error  = [    2.0219]
25-01-17 17:06:42 | I |         best error  = [    2.0219]
25-01-17 17:06:42 | I |     + error = [2.0219]
25-01-17 17:06:42 | I |       - range scale = [    1.0000]
25-01-17 17:06:42 | I |         sum  error  = [   22.7819]
25-01-17 17:06:42 | I |         best error  = [   22.7819]
25-01-17 17:06:42 | I |     + error = [22.7819]
25-01-17 17:06:43 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:06:43 | I |       - range scale = [    1.0000]
25-01-17 17:06:43 | I |         sum  error  = [    2.2129]
25-01-17 17:06:43 | I |         best error  = [    2.2129]
25-01-17 17:06:43 | I |     + error = [2.2129]
25-01-17 17:06:44 | I |       - range scale = [    1.0000]
25-01-17 17:06:44 | I |         sum  error  = [   24.8737]
25-01-17 17:06:44 | I |         best error  = [   24.8737]
25-01-17 17:06:44 | I |     + error = [24.8737]
25-01-17 17:06:44 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:06:45 | I |       - range scale = [    1.0000]
25-01-17 17:06:45 | I |         sum  error  = [    0.1691]
25-01-17 17:06:45 | I |         best error  = [    0.1691]
25-01-17 17:06:45 | I |     + error = [0.1691]
25-01-17 17:06:46 | I |       - range scale = [    1.0000]
25-01-17 17:06:46 | I |         sum  error  = [    1.7348]
25-01-17 17:06:46 | I |         best error  = [    1.7348]
25-01-17 17:06:46 | I |     + error = [1.7348]
25-01-17 17:06:46 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:06:48 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:06:49 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:06:50 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:06:52 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:06:53 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:06:55 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:06:58 | I | quantizing activations for layer model.layers.4
25-01-17 17:06:58 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:58 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:58 | I | collecting calibration activations in model.layers.4
25-01-17 17:06:59 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:00 | I | forward this layer
25-01-17 17:07:00 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/84.pt
25-01-17 17:07:00 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/84.pt
25-01-17 17:07:01 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:07:01 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:07:01 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:07:01 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:07:01 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:07:01 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:07:01 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:07:01 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:07:01 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:07:01 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:07:01 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:07:01 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:07:01 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:07:01 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:07:01 | I | in layer model.layers.4
25-01-17 17:07:01 | I | quantizing weights for layer model.layers.4
25-01-17 17:07:01 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:01 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:01 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:01 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:02 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:07:02 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:07:02 | I |       - range scale = [    1.0000]
25-01-17 17:07:02 | I |         sum  error  = [    0.5630]
25-01-17 17:07:02 | I |         best error  = [    0.5630]
25-01-17 17:07:02 | I |     + error = [0.5630]
25-01-17 17:07:03 | I |       - range scale = [    1.0000]
25-01-17 17:07:03 | I |         sum  error  = [    4.3276]
25-01-17 17:07:03 | I |         best error  = [    4.3276]
25-01-17 17:07:03 | I |     + error = [4.3276]
25-01-17 17:07:03 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:07:04 | I |       - range scale = [    1.0000]
25-01-17 17:07:04 | I |         sum  error  = [    0.2622]
25-01-17 17:07:04 | I |         best error  = [    0.2622]
25-01-17 17:07:04 | I |     + error = [0.2622]
25-01-17 17:07:05 | I |       - range scale = [    1.0000]
25-01-17 17:07:05 | I |         sum  error  = [    2.2094]
25-01-17 17:07:05 | I |         best error  = [    2.2094]
25-01-17 17:07:05 | I |     + error = [2.2094]
25-01-17 17:07:05 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:07:06 | I |       - range scale = [    1.0000]
25-01-17 17:07:06 | I |         sum  error  = [    0.6171]
25-01-17 17:07:06 | I |         best error  = [    0.6171]
25-01-17 17:07:06 | I |     + error = [0.6171]
25-01-17 17:07:06 | I |       - range scale = [    1.0000]
25-01-17 17:07:06 | I |         sum  error  = [    6.8912]
25-01-17 17:07:06 | I |         best error  = [    6.8912]
25-01-17 17:07:06 | I |     + error = [6.8912]
25-01-17 17:07:07 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:07:07 | I |       - range scale = [    1.0000]
25-01-17 17:07:07 | I |         sum  error  = [    0.1027]
25-01-17 17:07:07 | I |         best error  = [    0.1027]
25-01-17 17:07:07 | I |     + error = [0.1027]
25-01-17 17:07:08 | I |       - range scale = [    1.0000]
25-01-17 17:07:08 | I |         sum  error  = [    1.1164]
25-01-17 17:07:08 | I |         best error  = [    1.1164]
25-01-17 17:07:08 | I |     + error = [1.1164]
25-01-17 17:07:08 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:07:09 | I |       - range scale = [    1.0000]
25-01-17 17:07:09 | I |         sum  error  = [    2.0144]
25-01-17 17:07:09 | I |         best error  = [    2.0144]
25-01-17 17:07:09 | I |     + error = [2.0144]
25-01-17 17:07:10 | I |       - range scale = [    1.0000]
25-01-17 17:07:10 | I |         sum  error  = [   22.6203]
25-01-17 17:07:10 | I |         best error  = [   22.6203]
25-01-17 17:07:10 | I |     + error = [22.6203]
25-01-17 17:07:10 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:07:10 | I |       - range scale = [    1.0000]
25-01-17 17:07:10 | I |         sum  error  = [    2.1990]
25-01-17 17:07:10 | I |         best error  = [    2.1990]
25-01-17 17:07:10 | I |     + error = [2.1990]
25-01-17 17:07:11 | I |       - range scale = [    1.0000]
25-01-17 17:07:11 | I |         sum  error  = [   24.6900]
25-01-17 17:07:11 | I |         best error  = [   24.6900]
25-01-17 17:07:11 | I |     + error = [24.6900]
25-01-17 17:07:11 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:07:12 | I |       - range scale = [    1.0000]
25-01-17 17:07:12 | I |         sum  error  = [    0.1703]
25-01-17 17:07:12 | I |         best error  = [    0.1703]
25-01-17 17:07:12 | I |     + error = [0.1703]
25-01-17 17:07:13 | I |       - range scale = [    1.0000]
25-01-17 17:07:13 | I |         sum  error  = [    1.7459]
25-01-17 17:07:13 | I |         best error  = [    1.7459]
25-01-17 17:07:13 | I |     + error = [1.7459]
25-01-17 17:07:13 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:07:15 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:07:16 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:07:17 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:07:19 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:07:20 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:07:22 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:07:25 | I | quantizing activations for layer model.layers.4
25-01-17 17:07:25 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:25 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:26 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:26 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:28 | I | forward this layer
25-01-17 17:07:28 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/85.pt
25-01-17 17:07:28 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/85.pt
25-01-17 17:07:28 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:07:28 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:07:28 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:07:28 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:07:28 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:07:28 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:07:28 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:07:28 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:07:28 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:07:28 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:07:28 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:07:28 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:07:28 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:07:28 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:07:28 | I | [36] done with optimizer step
25-01-17 17:07:28 | I | epoch 001:     43 / 409600000 loss=1.63109e-05, loss_per_token=0.0334048, loss_sum=1094.61, wps=599.4, ups=0.02, wpb=32768, bsz=64, num_updates=37, lr=0.000111, gnorm=0.061, clip=0, loss_scale=2, train_wall=55, cuda_gb_allocated=12.3, cuda_gb_reserved=13.8, cuda_gb_free=11.4, wall=2864
25-01-17 17:07:28 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:07:28 | I | in layer model.layers.4
25-01-17 17:07:28 | I | quantizing weights for layer model.layers.4
25-01-17 17:07:28 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:29 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:29 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:29 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:29 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:07:29 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:07:30 | I |       - range scale = [    1.0000]
25-01-17 17:07:30 | I |         sum  error  = [    0.5475]
25-01-17 17:07:30 | I |         best error  = [    0.5475]
25-01-17 17:07:30 | I |     + error = [0.5475]
25-01-17 17:07:31 | I |       - range scale = [    1.0000]
25-01-17 17:07:31 | I |         sum  error  = [    4.2875]
25-01-17 17:07:31 | I |         best error  = [    4.2875]
25-01-17 17:07:31 | I |     + error = [4.2875]
25-01-17 17:07:31 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:07:31 | I |       - range scale = [    1.0000]
25-01-17 17:07:31 | I |         sum  error  = [    0.2660]
25-01-17 17:07:31 | I |         best error  = [    0.2660]
25-01-17 17:07:31 | I |     + error = [0.2660]
25-01-17 17:07:32 | I |       - range scale = [    1.0000]
25-01-17 17:07:32 | I |         sum  error  = [    2.2338]
25-01-17 17:07:32 | I |         best error  = [    2.2338]
25-01-17 17:07:32 | I |     + error = [2.2338]
25-01-17 17:07:32 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:07:33 | I |       - range scale = [    1.0000]
25-01-17 17:07:33 | I |         sum  error  = [    0.6188]
25-01-17 17:07:33 | I |         best error  = [    0.6188]
25-01-17 17:07:33 | I |     + error = [0.6188]
25-01-17 17:07:34 | I |       - range scale = [    1.0000]
25-01-17 17:07:34 | I |         sum  error  = [    6.9636]
25-01-17 17:07:34 | I |         best error  = [    6.9636]
25-01-17 17:07:34 | I |     + error = [6.9636]
25-01-17 17:07:34 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:07:35 | I |       - range scale = [    1.0000]
25-01-17 17:07:35 | I |         sum  error  = [    0.0911]
25-01-17 17:07:35 | I |         best error  = [    0.0911]
25-01-17 17:07:35 | I |     + error = [0.0911]
25-01-17 17:07:35 | I |       - range scale = [    1.0000]
25-01-17 17:07:35 | I |         sum  error  = [    0.9910]
25-01-17 17:07:35 | I |         best error  = [    0.9910]
25-01-17 17:07:35 | I |     + error = [0.9910]
25-01-17 17:07:36 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:07:36 | I |       - range scale = [    1.0000]
25-01-17 17:07:36 | I |         sum  error  = [    2.0499]
25-01-17 17:07:36 | I |         best error  = [    2.0499]
25-01-17 17:07:36 | I |     + error = [2.0499]
25-01-17 17:07:37 | I |       - range scale = [    1.0000]
25-01-17 17:07:37 | I |         sum  error  = [   23.0750]
25-01-17 17:07:37 | I |         best error  = [   23.0750]
25-01-17 17:07:37 | I |     + error = [23.0750]
25-01-17 17:07:37 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:07:38 | I |       - range scale = [    1.0000]
25-01-17 17:07:38 | I |         sum  error  = [    2.2451]
25-01-17 17:07:38 | I |         best error  = [    2.2451]
25-01-17 17:07:38 | I |     + error = [2.2451]
25-01-17 17:07:39 | I |       - range scale = [    1.0000]
25-01-17 17:07:39 | I |         sum  error  = [   25.1993]
25-01-17 17:07:39 | I |         best error  = [   25.1993]
25-01-17 17:07:39 | I |     + error = [25.1993]
25-01-17 17:07:39 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:07:40 | I |       - range scale = [    1.0000]
25-01-17 17:07:40 | I |         sum  error  = [    0.1691]
25-01-17 17:07:40 | I |         best error  = [    0.1691]
25-01-17 17:07:40 | I |     + error = [0.1691]
25-01-17 17:07:41 | I |       - range scale = [    1.0000]
25-01-17 17:07:41 | I |         sum  error  = [    1.7360]
25-01-17 17:07:41 | I |         best error  = [    1.7360]
25-01-17 17:07:41 | I |     + error = [1.7360]
25-01-17 17:07:41 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:07:42 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:07:44 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:07:46 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:07:47 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:07:49 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:07:51 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:07:55 | I | quantizing activations for layer model.layers.4
25-01-17 17:07:56 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:56 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:56 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:56 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:58 | I | forward this layer
25-01-17 17:07:58 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/86.pt
25-01-17 17:07:58 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/86.pt
25-01-17 17:07:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:07:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:07:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:07:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:07:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:07:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:07:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:07:58 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:07:58 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:07:58 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:07:58 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:07:58 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:07:58 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:07:58 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:07:58 | I | in layer model.layers.4
25-01-17 17:07:58 | I | quantizing weights for layer model.layers.4
25-01-17 17:07:59 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:59 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:59 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:59 | I | collecting calibration activations in model.layers.4
25-01-17 17:07:59 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:07:59 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:08:00 | I |       - range scale = [    1.0000]
25-01-17 17:08:00 | I |         sum  error  = [    0.5809]
25-01-17 17:08:00 | I |         best error  = [    0.5809]
25-01-17 17:08:00 | I |     + error = [0.5809]
25-01-17 17:08:01 | I |       - range scale = [    1.0000]
25-01-17 17:08:01 | I |         sum  error  = [    4.1508]
25-01-17 17:08:01 | I |         best error  = [    4.1508]
25-01-17 17:08:01 | I |     + error = [4.1508]
25-01-17 17:08:01 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:08:01 | I |       - range scale = [    1.0000]
25-01-17 17:08:01 | I |         sum  error  = [    0.2372]
25-01-17 17:08:01 | I |         best error  = [    0.2372]
25-01-17 17:08:01 | I |     + error = [0.2372]
25-01-17 17:08:02 | I |       - range scale = [    1.0000]
25-01-17 17:08:02 | I |         sum  error  = [    1.9737]
25-01-17 17:08:02 | I |         best error  = [    1.9737]
25-01-17 17:08:02 | I |     + error = [1.9737]
25-01-17 17:08:02 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:08:03 | I |       - range scale = [    1.0000]
25-01-17 17:08:03 | I |         sum  error  = [    0.6156]
25-01-17 17:08:03 | I |         best error  = [    0.6156]
25-01-17 17:08:03 | I |     + error = [0.6156]
25-01-17 17:08:04 | I |       - range scale = [    1.0000]
25-01-17 17:08:04 | I |         sum  error  = [    6.9248]
25-01-17 17:08:04 | I |         best error  = [    6.9248]
25-01-17 17:08:04 | I |     + error = [6.9248]
25-01-17 17:08:04 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:08:05 | I |       - range scale = [    1.0000]
25-01-17 17:08:05 | I |         sum  error  = [    0.0953]
25-01-17 17:08:05 | I |         best error  = [    0.0953]
25-01-17 17:08:05 | I |     + error = [0.0953]
25-01-17 17:08:05 | I |       - range scale = [    1.0000]
25-01-17 17:08:05 | I |         sum  error  = [    1.0462]
25-01-17 17:08:05 | I |         best error  = [    1.0462]
25-01-17 17:08:05 | I |     + error = [1.0462]
25-01-17 17:08:06 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:08:06 | I |       - range scale = [    1.0000]
25-01-17 17:08:06 | I |         sum  error  = [    2.0138]
25-01-17 17:08:06 | I |         best error  = [    2.0138]
25-01-17 17:08:06 | I |     + error = [2.0138]
25-01-17 17:08:07 | I |       - range scale = [    1.0000]
25-01-17 17:08:07 | I |         sum  error  = [   22.6561]
25-01-17 17:08:07 | I |         best error  = [   22.6561]
25-01-17 17:08:07 | I |     + error = [22.6561]
25-01-17 17:08:07 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:08:08 | I |       - range scale = [    1.0000]
25-01-17 17:08:08 | I |         sum  error  = [    2.2014]
25-01-17 17:08:08 | I |         best error  = [    2.2014]
25-01-17 17:08:08 | I |     + error = [2.2014]
25-01-17 17:08:09 | I |       - range scale = [    1.0000]
25-01-17 17:08:09 | I |         sum  error  = [   24.7403]
25-01-17 17:08:09 | I |         best error  = [   24.7403]
25-01-17 17:08:09 | I |     + error = [24.7403]
25-01-17 17:08:09 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:08:10 | I |       - range scale = [    1.0000]
25-01-17 17:08:10 | I |         sum  error  = [    0.1669]
25-01-17 17:08:10 | I |         best error  = [    0.1669]
25-01-17 17:08:10 | I |     + error = [0.1669]
25-01-17 17:08:10 | I |       - range scale = [    1.0000]
25-01-17 17:08:10 | I |         sum  error  = [    1.7080]
25-01-17 17:08:10 | I |         best error  = [    1.7080]
25-01-17 17:08:10 | I |     + error = [1.7080]
25-01-17 17:08:11 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:08:12 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:08:13 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:08:15 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:08:16 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:08:18 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:08:19 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:08:23 | I | quantizing activations for layer model.layers.4
25-01-17 17:08:23 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:23 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:23 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:23 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:25 | I | forward this layer
25-01-17 17:08:25 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/87.pt
25-01-17 17:08:25 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/87.pt
25-01-17 17:08:25 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:08:25 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:08:25 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:08:25 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:08:25 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:08:25 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:08:25 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:08:25 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:08:25 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:08:25 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:08:25 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:08:25 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:08:25 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:08:25 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:08:25 | I | [37] done with optimizer step
25-01-17 17:08:25 | I | epoch 001:     44 / 409600000 loss=1.53502e-05, loss_per_token=0.0314373, loss_sum=1030.14, wps=568.8, ups=0.02, wpb=32768, bsz=64, num_updates=38, lr=0.000114, gnorm=0.049, clip=0, loss_scale=2, train_wall=57, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=2921
25-01-17 17:08:26 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:08:26 | I | in layer model.layers.4
25-01-17 17:08:26 | I | quantizing weights for layer model.layers.4
25-01-17 17:08:26 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:26 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:26 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:26 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:27 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:08:27 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:08:27 | I |       - range scale = [    1.0000]
25-01-17 17:08:27 | I |         sum  error  = [    0.5795]
25-01-17 17:08:27 | I |         best error  = [    0.5795]
25-01-17 17:08:27 | I |     + error = [0.5795]
25-01-17 17:08:28 | I |       - range scale = [    1.0000]
25-01-17 17:08:28 | I |         sum  error  = [    4.2134]
25-01-17 17:08:28 | I |         best error  = [    4.2134]
25-01-17 17:08:28 | I |     + error = [4.2134]
25-01-17 17:08:28 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:08:29 | I |       - range scale = [    1.0000]
25-01-17 17:08:29 | I |         sum  error  = [    0.2449]
25-01-17 17:08:29 | I |         best error  = [    0.2449]
25-01-17 17:08:29 | I |     + error = [0.2449]
25-01-17 17:08:30 | I |       - range scale = [    1.0000]
25-01-17 17:08:30 | I |         sum  error  = [    2.1708]
25-01-17 17:08:30 | I |         best error  = [    2.1708]
25-01-17 17:08:30 | I |     + error = [2.1708]
25-01-17 17:08:30 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:08:31 | I |       - range scale = [    1.0000]
25-01-17 17:08:31 | I |         sum  error  = [    0.6194]
25-01-17 17:08:31 | I |         best error  = [    0.6194]
25-01-17 17:08:31 | I |     + error = [0.6194]
25-01-17 17:08:31 | I |       - range scale = [    1.0000]
25-01-17 17:08:31 | I |         sum  error  = [    6.9289]
25-01-17 17:08:31 | I |         best error  = [    6.9289]
25-01-17 17:08:31 | I |     + error = [6.9289]
25-01-17 17:08:31 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:08:32 | I |       - range scale = [    1.0000]
25-01-17 17:08:32 | I |         sum  error  = [    0.1023]
25-01-17 17:08:32 | I |         best error  = [    0.1023]
25-01-17 17:08:32 | I |     + error = [0.1023]
25-01-17 17:08:33 | I |       - range scale = [    1.0000]
25-01-17 17:08:33 | I |         sum  error  = [    1.1047]
25-01-17 17:08:33 | I |         best error  = [    1.1047]
25-01-17 17:08:33 | I |     + error = [1.1047]
25-01-17 17:08:33 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:08:34 | I |       - range scale = [    1.0000]
25-01-17 17:08:34 | I |         sum  error  = [    2.0068]
25-01-17 17:08:34 | I |         best error  = [    2.0068]
25-01-17 17:08:34 | I |     + error = [2.0068]
25-01-17 17:08:35 | I |       - range scale = [    1.0000]
25-01-17 17:08:35 | I |         sum  error  = [   22.5568]
25-01-17 17:08:35 | I |         best error  = [   22.5568]
25-01-17 17:08:35 | I |     + error = [22.5568]
25-01-17 17:08:35 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:08:35 | I |       - range scale = [    1.0000]
25-01-17 17:08:35 | I |         sum  error  = [    2.1910]
25-01-17 17:08:35 | I |         best error  = [    2.1910]
25-01-17 17:08:35 | I |     + error = [2.1910]
25-01-17 17:08:36 | I |       - range scale = [    1.0000]
25-01-17 17:08:36 | I |         sum  error  = [   24.6213]
25-01-17 17:08:36 | I |         best error  = [   24.6213]
25-01-17 17:08:36 | I |     + error = [24.6213]
25-01-17 17:08:36 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:08:37 | I |       - range scale = [    1.0000]
25-01-17 17:08:37 | I |         sum  error  = [    0.1677]
25-01-17 17:08:37 | I |         best error  = [    0.1677]
25-01-17 17:08:37 | I |     + error = [0.1677]
25-01-17 17:08:38 | I |       - range scale = [    1.0000]
25-01-17 17:08:38 | I |         sum  error  = [    1.7183]
25-01-17 17:08:38 | I |         best error  = [    1.7183]
25-01-17 17:08:38 | I |     + error = [1.7183]
25-01-17 17:08:38 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:08:40 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:08:41 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:08:43 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:08:44 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:08:46 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:08:47 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:08:50 | I | quantizing activations for layer model.layers.4
25-01-17 17:08:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:51 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:53 | I | forward this layer
25-01-17 17:08:53 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/88.pt
25-01-17 17:08:53 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/88.pt
25-01-17 17:08:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:08:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:08:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:08:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:08:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:08:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:08:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:08:53 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:08:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:08:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:08:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:08:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:08:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:08:53 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:08:53 | I | in layer model.layers.4
25-01-17 17:08:53 | I | quantizing weights for layer model.layers.4
25-01-17 17:08:54 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:54 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:54 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:54 | I | collecting calibration activations in model.layers.4
25-01-17 17:08:54 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:08:54 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:08:55 | I |       - range scale = [    1.0000]
25-01-17 17:08:55 | I |         sum  error  = [    0.5871]
25-01-17 17:08:55 | I |         best error  = [    0.5871]
25-01-17 17:08:55 | I |     + error = [0.5871]
25-01-17 17:08:56 | I |       - range scale = [    1.0000]
25-01-17 17:08:56 | I |         sum  error  = [    4.4805]
25-01-17 17:08:56 | I |         best error  = [    4.4805]
25-01-17 17:08:56 | I |     + error = [4.4805]
25-01-17 17:08:56 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:08:57 | I |       - range scale = [    1.0000]
25-01-17 17:08:57 | I |         sum  error  = [    0.2579]
25-01-17 17:08:57 | I |         best error  = [    0.2579]
25-01-17 17:08:57 | I |     + error = [0.2579]
25-01-17 17:08:57 | I |       - range scale = [    1.0000]
25-01-17 17:08:57 | I |         sum  error  = [    2.1671]
25-01-17 17:08:57 | I |         best error  = [    2.1671]
25-01-17 17:08:57 | I |     + error = [2.1671]
25-01-17 17:08:58 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:08:58 | I |       - range scale = [    1.0000]
25-01-17 17:08:58 | I |         sum  error  = [    0.6158]
25-01-17 17:08:58 | I |         best error  = [    0.6158]
25-01-17 17:08:58 | I |     + error = [0.6158]
25-01-17 17:08:59 | I |       - range scale = [    1.0000]
25-01-17 17:08:59 | I |         sum  error  = [    6.9017]
25-01-17 17:08:59 | I |         best error  = [    6.9017]
25-01-17 17:08:59 | I |     + error = [6.9017]
25-01-17 17:08:59 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:09:00 | I |       - range scale = [    1.0000]
25-01-17 17:09:00 | I |         sum  error  = [    0.0947]
25-01-17 17:09:00 | I |         best error  = [    0.0947]
25-01-17 17:09:00 | I |     + error = [0.0947]
25-01-17 17:09:01 | I |       - range scale = [    1.0000]
25-01-17 17:09:01 | I |         sum  error  = [    1.0257]
25-01-17 17:09:01 | I |         best error  = [    1.0257]
25-01-17 17:09:01 | I |     + error = [1.0257]
25-01-17 17:09:01 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:09:01 | I |       - range scale = [    1.0000]
25-01-17 17:09:01 | I |         sum  error  = [    2.0280]
25-01-17 17:09:01 | I |         best error  = [    2.0280]
25-01-17 17:09:01 | I |     + error = [2.0280]
25-01-17 17:09:02 | I |       - range scale = [    1.0000]
25-01-17 17:09:02 | I |         sum  error  = [   22.8302]
25-01-17 17:09:02 | I |         best error  = [   22.8302]
25-01-17 17:09:02 | I |     + error = [22.8302]
25-01-17 17:09:02 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:09:03 | I |       - range scale = [    1.0000]
25-01-17 17:09:03 | I |         sum  error  = [    2.2197]
25-01-17 17:09:03 | I |         best error  = [    2.2197]
25-01-17 17:09:03 | I |     + error = [2.2197]
25-01-17 17:09:04 | I |       - range scale = [    1.0000]
25-01-17 17:09:04 | I |         sum  error  = [   24.9256]
25-01-17 17:09:04 | I |         best error  = [   24.9256]
25-01-17 17:09:04 | I |     + error = [24.9256]
25-01-17 17:09:04 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:09:05 | I |       - range scale = [    1.0000]
25-01-17 17:09:05 | I |         sum  error  = [    0.1725]
25-01-17 17:09:05 | I |         best error  = [    0.1725]
25-01-17 17:09:05 | I |     + error = [0.1725]
25-01-17 17:09:06 | I |       - range scale = [    1.0000]
25-01-17 17:09:06 | I |         sum  error  = [    1.7653]
25-01-17 17:09:06 | I |         best error  = [    1.7653]
25-01-17 17:09:06 | I |     + error = [1.7653]
25-01-17 17:09:06 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:09:07 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:09:09 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:09:10 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:09:12 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:09:13 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:09:14 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:09:18 | I | quantizing activations for layer model.layers.4
25-01-17 17:09:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:20 | I | forward this layer
25-01-17 17:09:20 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/89.pt
25-01-17 17:09:20 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/89.pt
25-01-17 17:09:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:09:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:09:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:09:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:09:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:09:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:09:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:09:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:09:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:09:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:09:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:09:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:09:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:09:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:09:21 | I | [38] done with optimizer step
25-01-17 17:09:21 | I | epoch 001:     45 / 409600000 loss=1.60756e-05, loss_per_token=0.0329228, loss_sum=1078.81, wps=592.8, ups=0.02, wpb=32768, bsz=64, num_updates=39, lr=0.000117, gnorm=0.079, clip=0, loss_scale=2, train_wall=55, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=2977
25-01-17 17:09:21 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:09:21 | I | in layer model.layers.4
25-01-17 17:09:21 | I | quantizing weights for layer model.layers.4
25-01-17 17:09:21 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:21 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:22 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:22 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:22 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:09:22 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:09:23 | I |       - range scale = [    1.0000]
25-01-17 17:09:23 | I |         sum  error  = [    0.6129]
25-01-17 17:09:23 | I |         best error  = [    0.6129]
25-01-17 17:09:23 | I |     + error = [0.6129]
25-01-17 17:09:23 | I |       - range scale = [    1.0000]
25-01-17 17:09:23 | I |         sum  error  = [    4.9921]
25-01-17 17:09:23 | I |         best error  = [    4.9921]
25-01-17 17:09:23 | I |     + error = [4.9921]
25-01-17 17:09:24 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:09:24 | I |       - range scale = [    1.0000]
25-01-17 17:09:24 | I |         sum  error  = [    0.2960]
25-01-17 17:09:24 | I |         best error  = [    0.2960]
25-01-17 17:09:24 | I |     + error = [0.2960]
25-01-17 17:09:25 | I |       - range scale = [    1.0000]
25-01-17 17:09:25 | I |         sum  error  = [    2.3956]
25-01-17 17:09:25 | I |         best error  = [    2.3956]
25-01-17 17:09:25 | I |     + error = [2.3956]
25-01-17 17:09:25 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:09:26 | I |       - range scale = [    1.0000]
25-01-17 17:09:26 | I |         sum  error  = [    0.6261]
25-01-17 17:09:26 | I |         best error  = [    0.6261]
25-01-17 17:09:26 | I |     + error = [0.6261]
25-01-17 17:09:27 | I |       - range scale = [    1.0000]
25-01-17 17:09:27 | I |         sum  error  = [    7.0633]
25-01-17 17:09:27 | I |         best error  = [    7.0633]
25-01-17 17:09:27 | I |     + error = [7.0633]
25-01-17 17:09:27 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:09:28 | I |       - range scale = [    1.0000]
25-01-17 17:09:28 | I |         sum  error  = [    0.1037]
25-01-17 17:09:28 | I |         best error  = [    0.1037]
25-01-17 17:09:28 | I |     + error = [0.1037]
25-01-17 17:09:28 | I |       - range scale = [    1.0000]
25-01-17 17:09:28 | I |         sum  error  = [    1.1269]
25-01-17 17:09:28 | I |         best error  = [    1.1269]
25-01-17 17:09:28 | I |     + error = [1.1269]
25-01-17 17:09:28 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:09:29 | I |       - range scale = [    1.0000]
25-01-17 17:09:29 | I |         sum  error  = [    2.0361]
25-01-17 17:09:29 | I |         best error  = [    2.0361]
25-01-17 17:09:29 | I |     + error = [2.0361]
25-01-17 17:09:30 | I |       - range scale = [    1.0000]
25-01-17 17:09:30 | I |         sum  error  = [   22.8814]
25-01-17 17:09:30 | I |         best error  = [   22.8814]
25-01-17 17:09:30 | I |     + error = [22.8814]
25-01-17 17:09:30 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:09:31 | I |       - range scale = [    1.0000]
25-01-17 17:09:31 | I |         sum  error  = [    2.2248]
25-01-17 17:09:31 | I |         best error  = [    2.2248]
25-01-17 17:09:31 | I |     + error = [2.2248]
25-01-17 17:09:32 | I |       - range scale = [    1.0000]
25-01-17 17:09:32 | I |         sum  error  = [   24.9901]
25-01-17 17:09:32 | I |         best error  = [   24.9901]
25-01-17 17:09:32 | I |     + error = [24.9901]
25-01-17 17:09:32 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:09:33 | I |       - range scale = [    1.0000]
25-01-17 17:09:33 | I |         sum  error  = [    0.1686]
25-01-17 17:09:33 | I |         best error  = [    0.1686]
25-01-17 17:09:33 | I |     + error = [0.1686]
25-01-17 17:09:33 | I |       - range scale = [    1.0000]
25-01-17 17:09:33 | I |         sum  error  = [    1.7258]
25-01-17 17:09:33 | I |         best error  = [    1.7258]
25-01-17 17:09:33 | I |     + error = [1.7258]
25-01-17 17:09:34 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:09:35 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:09:37 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:09:38 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:09:39 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:09:41 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:09:42 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:09:45 | I | quantizing activations for layer model.layers.4
25-01-17 17:09:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:48 | I | forward this layer
25-01-17 17:09:48 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/90.pt
25-01-17 17:09:48 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/90.pt
25-01-17 17:09:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:09:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:09:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:09:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:09:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:09:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:09:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:09:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:09:48 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:09:48 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:09:48 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:09:48 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:09:48 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:09:48 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:09:48 | I | in layer model.layers.4
25-01-17 17:09:48 | I | quantizing weights for layer model.layers.4
25-01-17 17:09:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:09:50 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:09:50 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:09:50 | I |       - range scale = [    1.0000]
25-01-17 17:09:50 | I |         sum  error  = [    0.5653]
25-01-17 17:09:50 | I |         best error  = [    0.5653]
25-01-17 17:09:50 | I |     + error = [0.5653]
25-01-17 17:09:51 | I |       - range scale = [    1.0000]
25-01-17 17:09:51 | I |         sum  error  = [    4.3237]
25-01-17 17:09:51 | I |         best error  = [    4.3237]
25-01-17 17:09:51 | I |     + error = [4.3237]
25-01-17 17:09:51 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:09:52 | I |       - range scale = [    1.0000]
25-01-17 17:09:52 | I |         sum  error  = [    0.2511]
25-01-17 17:09:52 | I |         best error  = [    0.2511]
25-01-17 17:09:52 | I |     + error = [0.2511]
25-01-17 17:09:53 | I |       - range scale = [    1.0000]
25-01-17 17:09:53 | I |         sum  error  = [    2.1748]
25-01-17 17:09:53 | I |         best error  = [    2.1748]
25-01-17 17:09:53 | I |     + error = [2.1748]
25-01-17 17:09:53 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:09:54 | I |       - range scale = [    1.0000]
25-01-17 17:09:54 | I |         sum  error  = [    0.6118]
25-01-17 17:09:54 | I |         best error  = [    0.6118]
25-01-17 17:09:54 | I |     + error = [0.6118]
25-01-17 17:09:54 | I |       - range scale = [    1.0000]
25-01-17 17:09:54 | I |         sum  error  = [    6.8405]
25-01-17 17:09:54 | I |         best error  = [    6.8405]
25-01-17 17:09:54 | I |     + error = [6.8405]
25-01-17 17:09:54 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:09:55 | I |       - range scale = [    1.0000]
25-01-17 17:09:55 | I |         sum  error  = [    0.0921]
25-01-17 17:09:55 | I |         best error  = [    0.0921]
25-01-17 17:09:55 | I |     + error = [0.0921]
25-01-17 17:09:56 | I |       - range scale = [    1.0000]
25-01-17 17:09:56 | I |         sum  error  = [    1.0036]
25-01-17 17:09:56 | I |         best error  = [    1.0036]
25-01-17 17:09:56 | I |     + error = [1.0036]
25-01-17 17:09:56 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:09:57 | I |       - range scale = [    1.0000]
25-01-17 17:09:57 | I |         sum  error  = [    1.9774]
25-01-17 17:09:57 | I |         best error  = [    1.9774]
25-01-17 17:09:57 | I |     + error = [1.9774]
25-01-17 17:09:58 | I |       - range scale = [    1.0000]
25-01-17 17:09:58 | I |         sum  error  = [   22.2380]
25-01-17 17:09:58 | I |         best error  = [   22.2380]
25-01-17 17:09:58 | I |     + error = [22.2380]
25-01-17 17:09:58 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:09:59 | I |       - range scale = [    1.0000]
25-01-17 17:09:59 | I |         sum  error  = [    2.1609]
25-01-17 17:09:59 | I |         best error  = [    2.1609]
25-01-17 17:09:59 | I |     + error = [2.1609]
25-01-17 17:09:59 | I |       - range scale = [    1.0000]
25-01-17 17:09:59 | I |         sum  error  = [   24.2809]
25-01-17 17:09:59 | I |         best error  = [   24.2809]
25-01-17 17:09:59 | I |     + error = [24.2809]
25-01-17 17:10:00 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:10:00 | I |       - range scale = [    1.0000]
25-01-17 17:10:00 | I |         sum  error  = [    0.1637]
25-01-17 17:10:00 | I |         best error  = [    0.1637]
25-01-17 17:10:00 | I |     + error = [0.1637]
25-01-17 17:10:01 | I |       - range scale = [    1.0000]
25-01-17 17:10:01 | I |         sum  error  = [    1.6782]
25-01-17 17:10:01 | I |         best error  = [    1.6782]
25-01-17 17:10:01 | I |     + error = [1.6782]
25-01-17 17:10:01 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:10:03 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:10:04 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:10:06 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:10:07 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:10:09 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:10:10 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:10:13 | I | quantizing activations for layer model.layers.4
25-01-17 17:10:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:16 | I | forward this layer
25-01-17 17:10:16 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/91.pt
25-01-17 17:10:16 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/91.pt
25-01-17 17:10:16 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:10:16 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:10:16 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:10:16 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:10:16 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:10:16 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:10:16 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:10:16 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:10:16 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:10:16 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:10:16 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:10:16 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:10:16 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:10:16 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:10:16 | I | [39] done with optimizer step
25-01-17 17:10:16 | I | epoch 001:     46 / 409600000 loss=1.52122e-05, loss_per_token=0.0311545, loss_sum=1020.87, wps=588.3, ups=0.02, wpb=32768, bsz=64, num_updates=40, lr=0.00012, gnorm=0.059, clip=0, loss_scale=2, train_wall=56, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=3032
25-01-17 17:10:16 | I | begin validation on "valid" subset on rank 0
25-01-17 17:10:16 | I | got valid iterator on "valid" subset on rank 0
25-01-17 17:10:16 | I | Valid: Start iterating over samples
25-01-17 17:10:16 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:10:16 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:10:16 | I | - Evaluator: gptq
25-01-17 17:10:16 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:10:16 | I | - Batch_size: 8
25-01-17 17:10:16 | I |   + Max_seq_length: 2048
25-01-17 17:10:34 | I |     - Results:
25-01-17 17:10:34 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:10:34 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:10:34 | I |       |wikitext |      1|word_perplexity|7.7128|±  |7.7128|
25-01-17 17:10:34 | I |       |val_valid|      1|word_perplexity|7.4270|±  |7.4270|
25-01-17 17:10:34 | I |       
25-01-17 17:10:34 | I | in valid, quantize current layer weights
25-01-17 17:10:35 | W | Repo card metadata block was not found. Setting CardData to empty.
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:47 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:48 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:10:50 | I |       - range scale = [    1.0000]
25-01-17 17:10:50 | I |         sum  error  = [    1.5580]
25-01-17 17:10:50 | I |         best error  = [    1.5580]
25-01-17 17:10:50 | I |     + error = [1.5580]
25-01-17 17:10:51 | I |       - range scale = [    1.0000]
25-01-17 17:10:51 | I |         sum  error  = [   11.8497]
25-01-17 17:10:51 | I |         best error  = [   11.8497]
25-01-17 17:10:51 | I |     + error = [11.8497]
25-01-17 17:10:52 | I |       - range scale = [    1.0000]
25-01-17 17:10:52 | I |         sum  error  = [    0.6590]
25-01-17 17:10:52 | I |         best error  = [    0.6590]
25-01-17 17:10:52 | I |     + error = [0.6590]
25-01-17 17:10:53 | I |       - range scale = [    1.0000]
25-01-17 17:10:53 | I |         sum  error  = [    5.6649]
25-01-17 17:10:53 | I |         best error  = [    5.6649]
25-01-17 17:10:53 | I |     + error = [5.6649]
25-01-17 17:10:54 | I |       - range scale = [    1.0000]
25-01-17 17:10:54 | I |         sum  error  = [    0.6109]
25-01-17 17:10:54 | I |         best error  = [    0.6109]
25-01-17 17:10:54 | I |     + error = [0.6109]
25-01-17 17:10:55 | I |       - range scale = [    1.0000]
25-01-17 17:10:55 | I |         sum  error  = [    6.8347]
25-01-17 17:10:55 | I |         best error  = [    6.8347]
25-01-17 17:10:55 | I |     + error = [6.8347]
25-01-17 17:10:56 | I |       - range scale = [    1.0000]
25-01-17 17:10:56 | I |         sum  error  = [    0.0828]
25-01-17 17:10:56 | I |         best error  = [    0.0828]
25-01-17 17:10:56 | I |     + error = [0.0828]
25-01-17 17:10:57 | I |       - range scale = [    1.0000]
25-01-17 17:10:57 | I |         sum  error  = [    0.9038]
25-01-17 17:10:57 | I |         best error  = [    0.9038]
25-01-17 17:10:57 | I |     + error = [0.9038]
25-01-17 17:10:57 | I |       - range scale = [    1.0000]
25-01-17 17:10:57 | I |         sum  error  = [    1.9623]
25-01-17 17:10:57 | I |         best error  = [    1.9623]
25-01-17 17:10:57 | I |     + error = [1.9623]
25-01-17 17:10:58 | I |       - range scale = [    1.0000]
25-01-17 17:10:58 | I |         sum  error  = [   22.1103]
25-01-17 17:10:58 | I |         best error  = [   22.1103]
25-01-17 17:10:58 | I |     + error = [22.1103]
25-01-17 17:10:59 | I |       - range scale = [    1.0000]
25-01-17 17:10:59 | I |         sum  error  = [    2.1445]
25-01-17 17:10:59 | I |         best error  = [    2.1445]
25-01-17 17:10:59 | I |     + error = [2.1445]
25-01-17 17:11:00 | I |       - range scale = [    1.0000]
25-01-17 17:11:00 | I |         sum  error  = [   24.1196]
25-01-17 17:11:00 | I |         best error  = [   24.1196]
25-01-17 17:11:00 | I |     + error = [24.1196]
25-01-17 17:11:01 | I |       - range scale = [    1.0000]
25-01-17 17:11:01 | I |         sum  error  = [    0.1664]
25-01-17 17:11:01 | I |         best error  = [    0.1664]
25-01-17 17:11:01 | I |     + error = [0.1664]
25-01-17 17:11:01 | I |       - range scale = [    1.0000]
25-01-17 17:11:01 | I |         sum  error  = [    1.7056]
25-01-17 17:11:01 | I |         best error  = [    1.7056]
25-01-17 17:11:01 | I |     + error = [1.7056]
25-01-17 17:11:14 | I | in valid, quantize current layer acts
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:16 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:20 | I | use gptq_eval(lmquant) to calculate ppl, partly quanted
25-01-17 17:11:20 | W |   `pretrained` model kwarg is not of type `str`. Many other model arguments may be ignored. Please do not launch via accelerate or use `parallelize=True` if passing an existing model this way.
25-01-17 17:11:20 | W |   Passed an already-initialized model through `pretrained`, assuming single-process call to evaluate() or custom distributed integration
25-01-17 17:11:20 | I | - Evaluator: gptq
25-01-17 17:11:20 | I | - Tasks: ['wikitext', 'val_valid']
25-01-17 17:11:20 | I | - Batch_size: 8
25-01-17 17:11:20 | I |   + Max_seq_length: 2048
25-01-17 17:11:40 | I |     - Results:
25-01-17 17:11:40 | I |       |  Task   |Version|    Metric     |Value |   |Stderr|
25-01-17 17:11:40 | I |       |---------|------:|---------------|-----:|---|-----:|
25-01-17 17:11:40 | I |       |wikitext |      1|word_perplexity|7.7364|±  |7.7364|
25-01-17 17:11:40 | I |       |val_valid|      1|word_perplexity|7.4456|±  |7.4456|
25-01-17 17:11:40 | I |       
25-01-17 17:11:53 | I | epoch 001 | valid on 'valid' subset:    102 / 819200000 loss_valid=2.619, lmquant_ppl_result_val=-1, lmquant_ppl_result_wikitext=-1, ppl=6.14, wps=36482, wpb=4058.2, bsz=2, num_updates=40, lmquant_ppl_wikitext_all_quanted=7.71279, lmquant_ppl_val_all_quanted=7.42696, lmquant_ppl_wikitext_partly_quanted=7.73642, lmquant_ppl_val_partly_quanted=7.44559
25-01-17 17:11:53 | I | epoch 001 | valid on 'valid' subset | loss_valid 2.619 | lmquant_ppl_result_val -1 | lmquant_ppl_result_wikitext -1 | ppl 6.14 | wps 36482 | wpb 4058.2 | bsz 2 | num_updates 40 | lmquant_ppl_wikitext_all_quanted 7.71279 | lmquant_ppl_val_all_quanted 7.42696 | lmquant_ppl_wikitext_partly_quanted 7.73642 | lmquant_ppl_val_partly_quanted 7.44559
25-01-17 17:11:53 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:11:53 | I | in layer model.layers.4
25-01-17 17:11:53 | I | quantizing weights for layer model.layers.4
25-01-17 17:11:54 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:54 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:54 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:54 | I | collecting calibration activations in model.layers.4
25-01-17 17:11:54 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:11:54 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:11:55 | I |       - range scale = [    1.0000]
25-01-17 17:11:55 | I |         sum  error  = [    0.5677]
25-01-17 17:11:55 | I |         best error  = [    0.5677]
25-01-17 17:11:55 | I |     + error = [0.5677]
25-01-17 17:11:56 | I |       - range scale = [    1.0000]
25-01-17 17:11:56 | I |         sum  error  = [    4.2394]
25-01-17 17:11:56 | I |         best error  = [    4.2394]
25-01-17 17:11:56 | I |     + error = [4.2394]
25-01-17 17:11:56 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:11:57 | I |       - range scale = [    1.0000]
25-01-17 17:11:57 | I |         sum  error  = [    0.2488]
25-01-17 17:11:57 | I |         best error  = [    0.2488]
25-01-17 17:11:57 | I |     + error = [0.2488]
25-01-17 17:11:58 | I |       - range scale = [    1.0000]
25-01-17 17:11:58 | I |         sum  error  = [    2.1195]
25-01-17 17:11:58 | I |         best error  = [    2.1195]
25-01-17 17:11:58 | I |     + error = [2.1195]
25-01-17 17:11:58 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:11:58 | I |       - range scale = [    1.0000]
25-01-17 17:11:58 | I |         sum  error  = [    0.6110]
25-01-17 17:11:58 | I |         best error  = [    0.6110]
25-01-17 17:11:58 | I |     + error = [0.6110]
25-01-17 17:11:59 | I |       - range scale = [    1.0000]
25-01-17 17:11:59 | I |         sum  error  = [    6.8497]
25-01-17 17:11:59 | I |         best error  = [    6.8497]
25-01-17 17:11:59 | I |     + error = [6.8497]
25-01-17 17:11:59 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:12:00 | I |       - range scale = [    1.0000]
25-01-17 17:12:00 | I |         sum  error  = [    0.0974]
25-01-17 17:12:00 | I |         best error  = [    0.0974]
25-01-17 17:12:00 | I |     + error = [0.0974]
25-01-17 17:12:01 | I |       - range scale = [    1.0000]
25-01-17 17:12:01 | I |         sum  error  = [    1.0503]
25-01-17 17:12:01 | I |         best error  = [    1.0503]
25-01-17 17:12:01 | I |     + error = [1.0503]
25-01-17 17:12:01 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:12:02 | I |       - range scale = [    1.0000]
25-01-17 17:12:02 | I |         sum  error  = [    2.0050]
25-01-17 17:12:02 | I |         best error  = [    2.0050]
25-01-17 17:12:02 | I |     + error = [2.0050]
25-01-17 17:12:02 | I |       - range scale = [    1.0000]
25-01-17 17:12:02 | I |         sum  error  = [   22.5717]
25-01-17 17:12:02 | I |         best error  = [   22.5717]
25-01-17 17:12:02 | I |     + error = [22.5717]
25-01-17 17:12:03 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:12:03 | I |       - range scale = [    1.0000]
25-01-17 17:12:03 | I |         sum  error  = [    2.1897]
25-01-17 17:12:03 | I |         best error  = [    2.1897]
25-01-17 17:12:03 | I |     + error = [2.1897]
25-01-17 17:12:04 | I |       - range scale = [    1.0000]
25-01-17 17:12:04 | I |         sum  error  = [   24.6385]
25-01-17 17:12:04 | I |         best error  = [   24.6385]
25-01-17 17:12:04 | I |     + error = [24.6385]
25-01-17 17:12:04 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:12:05 | I |       - range scale = [    1.0000]
25-01-17 17:12:05 | I |         sum  error  = [    0.1684]
25-01-17 17:12:05 | I |         best error  = [    0.1684]
25-01-17 17:12:05 | I |     + error = [0.1684]
25-01-17 17:12:06 | I |       - range scale = [    1.0000]
25-01-17 17:12:06 | I |         sum  error  = [    1.7285]
25-01-17 17:12:06 | I |         best error  = [    1.7285]
25-01-17 17:12:06 | I |     + error = [1.7285]
25-01-17 17:12:06 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:12:08 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:12:09 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:12:10 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:12:12 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:12:13 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:12:15 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:12:18 | I | quantizing activations for layer model.layers.4
25-01-17 17:12:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:18 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:19 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:21 | I | forward this layer
25-01-17 17:12:21 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/92.pt
25-01-17 17:12:21 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/92.pt
25-01-17 17:12:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:12:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:12:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:12:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:12:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:12:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:12:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:12:21 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:12:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:12:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:12:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:12:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:12:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:12:21 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:12:21 | I | in layer model.layers.4
25-01-17 17:12:21 | I | quantizing weights for layer model.layers.4
25-01-17 17:12:21 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:21 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:21 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:22 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:22 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:12:22 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:12:23 | I |       - range scale = [    1.0000]
25-01-17 17:12:23 | I |         sum  error  = [    0.5477]
25-01-17 17:12:23 | I |         best error  = [    0.5477]
25-01-17 17:12:23 | I |     + error = [0.5477]
25-01-17 17:12:23 | I |       - range scale = [    1.0000]
25-01-17 17:12:23 | I |         sum  error  = [    4.2946]
25-01-17 17:12:23 | I |         best error  = [    4.2946]
25-01-17 17:12:23 | I |     + error = [4.2946]
25-01-17 17:12:24 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:12:24 | I |       - range scale = [    1.0000]
25-01-17 17:12:24 | I |         sum  error  = [    0.2381]
25-01-17 17:12:24 | I |         best error  = [    0.2381]
25-01-17 17:12:24 | I |     + error = [0.2381]
25-01-17 17:12:25 | I |       - range scale = [    1.0000]
25-01-17 17:12:25 | I |         sum  error  = [    2.0833]
25-01-17 17:12:25 | I |         best error  = [    2.0833]
25-01-17 17:12:25 | I |     + error = [2.0833]
25-01-17 17:12:25 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:12:26 | I |       - range scale = [    1.0000]
25-01-17 17:12:26 | I |         sum  error  = [    0.6146]
25-01-17 17:12:26 | I |         best error  = [    0.6146]
25-01-17 17:12:26 | I |     + error = [0.6146]
25-01-17 17:12:26 | I |       - range scale = [    1.0000]
25-01-17 17:12:26 | I |         sum  error  = [    6.8533]
25-01-17 17:12:26 | I |         best error  = [    6.8533]
25-01-17 17:12:26 | I |     + error = [6.8533]
25-01-17 17:12:27 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:12:27 | I |       - range scale = [    1.0000]
25-01-17 17:12:27 | I |         sum  error  = [    0.0979]
25-01-17 17:12:27 | I |         best error  = [    0.0979]
25-01-17 17:12:27 | I |     + error = [0.0979]
25-01-17 17:12:28 | I |       - range scale = [    1.0000]
25-01-17 17:12:28 | I |         sum  error  = [    1.0648]
25-01-17 17:12:28 | I |         best error  = [    1.0648]
25-01-17 17:12:28 | I |     + error = [1.0648]
25-01-17 17:12:28 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:12:29 | I |       - range scale = [    1.0000]
25-01-17 17:12:29 | I |         sum  error  = [    2.0394]
25-01-17 17:12:29 | I |         best error  = [    2.0394]
25-01-17 17:12:29 | I |     + error = [2.0394]
25-01-17 17:12:30 | I |       - range scale = [    1.0000]
25-01-17 17:12:30 | I |         sum  error  = [   22.9482]
25-01-17 17:12:30 | I |         best error  = [   22.9482]
25-01-17 17:12:30 | I |     + error = [22.9482]
25-01-17 17:12:30 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:12:30 | I |       - range scale = [    1.0000]
25-01-17 17:12:30 | I |         sum  error  = [    2.2323]
25-01-17 17:12:30 | I |         best error  = [    2.2323]
25-01-17 17:12:30 | I |     + error = [2.2323]
25-01-17 17:12:31 | I |       - range scale = [    1.0000]
25-01-17 17:12:31 | I |         sum  error  = [   25.0567]
25-01-17 17:12:31 | I |         best error  = [   25.0567]
25-01-17 17:12:31 | I |     + error = [25.0567]
25-01-17 17:12:31 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:12:32 | I |       - range scale = [    1.0000]
25-01-17 17:12:32 | I |         sum  error  = [    0.1746]
25-01-17 17:12:32 | I |         best error  = [    0.1746]
25-01-17 17:12:32 | I |     + error = [0.1746]
25-01-17 17:12:33 | I |       - range scale = [    1.0000]
25-01-17 17:12:33 | I |         sum  error  = [    1.7851]
25-01-17 17:12:33 | I |         best error  = [    1.7851]
25-01-17 17:12:33 | I |     + error = [1.7851]
25-01-17 17:12:33 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:12:35 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:12:36 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:12:37 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:12:39 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:12:40 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:12:42 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:12:45 | I | quantizing activations for layer model.layers.4
25-01-17 17:12:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:46 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:48 | I | forward this layer
25-01-17 17:12:48 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/93.pt
25-01-17 17:12:48 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/93.pt
25-01-17 17:12:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:12:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:12:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:12:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:12:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:12:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:12:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:12:48 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:12:48 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:12:48 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:12:48 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:12:48 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:12:48 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:12:48 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:12:48 | I | [40] done with optimizer step
25-01-17 17:12:48 | I | epoch 001:     47 / 409600000 loss=1.69231e-05, loss_per_token=0.0346585, loss_sum=1135.69, wps=215.9, ups=0.01, wpb=32768, bsz=64, num_updates=41, lr=0.000123, gnorm=0.067, clip=0, loss_scale=2, train_wall=55, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=3184
25-01-17 17:12:48 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:12:48 | I | in layer model.layers.4
25-01-17 17:12:48 | I | quantizing weights for layer model.layers.4
25-01-17 17:12:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:49 | I | collecting calibration activations in model.layers.4
25-01-17 17:12:50 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:12:50 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:12:50 | I |       - range scale = [    1.0000]
25-01-17 17:12:50 | I |         sum  error  = [    0.5487]
25-01-17 17:12:50 | I |         best error  = [    0.5487]
25-01-17 17:12:50 | I |     + error = [0.5487]
25-01-17 17:12:51 | I |       - range scale = [    1.0000]
25-01-17 17:12:51 | I |         sum  error  = [    4.4723]
25-01-17 17:12:51 | I |         best error  = [    4.4723]
25-01-17 17:12:51 | I |     + error = [4.4723]
25-01-17 17:12:51 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:12:52 | I |       - range scale = [    1.0000]
25-01-17 17:12:52 | I |         sum  error  = [    0.2433]
25-01-17 17:12:52 | I |         best error  = [    0.2433]
25-01-17 17:12:52 | I |     + error = [0.2433]
25-01-17 17:12:53 | I |       - range scale = [    1.0000]
25-01-17 17:12:53 | I |         sum  error  = [    2.1476]
25-01-17 17:12:53 | I |         best error  = [    2.1476]
25-01-17 17:12:53 | I |     + error = [2.1476]
25-01-17 17:12:53 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:12:54 | I |       - range scale = [    1.0000]
25-01-17 17:12:54 | I |         sum  error  = [    0.6188]
25-01-17 17:12:54 | I |         best error  = [    0.6188]
25-01-17 17:12:54 | I |     + error = [0.6188]
25-01-17 17:12:54 | I |       - range scale = [    1.0000]
25-01-17 17:12:54 | I |         sum  error  = [    6.9349]
25-01-17 17:12:54 | I |         best error  = [    6.9349]
25-01-17 17:12:54 | I |     + error = [6.9349]
25-01-17 17:12:55 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:12:55 | I |       - range scale = [    1.0000]
25-01-17 17:12:55 | I |         sum  error  = [    0.0900]
25-01-17 17:12:55 | I |         best error  = [    0.0900]
25-01-17 17:12:55 | I |     + error = [0.0900]
25-01-17 17:12:56 | I |       - range scale = [    1.0000]
25-01-17 17:12:56 | I |         sum  error  = [    0.9730]
25-01-17 17:12:56 | I |         best error  = [    0.9730]
25-01-17 17:12:56 | I |     + error = [0.9730]
25-01-17 17:12:56 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:12:57 | I |       - range scale = [    1.0000]
25-01-17 17:12:57 | I |         sum  error  = [    2.0403]
25-01-17 17:12:57 | I |         best error  = [    2.0403]
25-01-17 17:12:57 | I |     + error = [2.0403]
25-01-17 17:12:58 | I |       - range scale = [    1.0000]
25-01-17 17:12:58 | I |         sum  error  = [   23.0121]
25-01-17 17:12:58 | I |         best error  = [   23.0121]
25-01-17 17:12:58 | I |     + error = [23.0121]
25-01-17 17:12:58 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:12:59 | I |       - range scale = [    1.0000]
25-01-17 17:12:59 | I |         sum  error  = [    2.2375]
25-01-17 17:12:59 | I |         best error  = [    2.2375]
25-01-17 17:12:59 | I |     + error = [2.2375]
25-01-17 17:13:00 | I |       - range scale = [    1.0000]
25-01-17 17:13:00 | I |         sum  error  = [   25.1393]
25-01-17 17:13:00 | I |         best error  = [   25.1393]
25-01-17 17:13:00 | I |     + error = [25.1393]
25-01-17 17:13:00 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:13:00 | I |       - range scale = [    1.0000]
25-01-17 17:13:00 | I |         sum  error  = [    0.1630]
25-01-17 17:13:00 | I |         best error  = [    0.1630]
25-01-17 17:13:00 | I |     + error = [0.1630]
25-01-17 17:13:01 | I |       - range scale = [    1.0000]
25-01-17 17:13:01 | I |         sum  error  = [    1.6740]
25-01-17 17:13:01 | I |         best error  = [    1.6740]
25-01-17 17:13:01 | I |     + error = [1.6740]
25-01-17 17:13:02 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:13:03 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:13:05 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:13:06 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:13:08 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:13:09 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:13:10 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:13:14 | I | quantizing activations for layer model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:14 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:15 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:16 | I | forward this layer
25-01-17 17:13:16 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/94.pt
25-01-17 17:13:16 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/94.pt
25-01-17 17:13:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:13:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:13:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:13:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:13:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:13:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:13:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:13:17 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:13:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:13:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:13:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:13:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:13:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:13:17 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:13:17 | I | in layer model.layers.4
25-01-17 17:13:17 | I | quantizing weights for layer model.layers.4
25-01-17 17:13:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:17 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:18 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:13:18 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:13:19 | I |       - range scale = [    1.0000]
25-01-17 17:13:19 | I |         sum  error  = [    0.5342]
25-01-17 17:13:19 | I |         best error  = [    0.5342]
25-01-17 17:13:19 | I |     + error = [0.5342]
25-01-17 17:13:19 | I |       - range scale = [    1.0000]
25-01-17 17:13:19 | I |         sum  error  = [    4.3113]
25-01-17 17:13:19 | I |         best error  = [    4.3113]
25-01-17 17:13:19 | I |     + error = [4.3113]
25-01-17 17:13:19 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:13:20 | I |       - range scale = [    1.0000]
25-01-17 17:13:20 | I |         sum  error  = [    0.2354]
25-01-17 17:13:20 | I |         best error  = [    0.2354]
25-01-17 17:13:20 | I |     + error = [0.2354]
25-01-17 17:13:21 | I |       - range scale = [    1.0000]
25-01-17 17:13:21 | I |         sum  error  = [    2.0612]
25-01-17 17:13:21 | I |         best error  = [    2.0612]
25-01-17 17:13:21 | I |     + error = [2.0612]
25-01-17 17:13:21 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:13:22 | I |       - range scale = [    1.0000]
25-01-17 17:13:22 | I |         sum  error  = [    0.6149]
25-01-17 17:13:22 | I |         best error  = [    0.6149]
25-01-17 17:13:22 | I |     + error = [0.6149]
25-01-17 17:13:22 | I |       - range scale = [    1.0000]
25-01-17 17:13:22 | I |         sum  error  = [    6.9123]
25-01-17 17:13:22 | I |         best error  = [    6.9123]
25-01-17 17:13:22 | I |     + error = [6.9123]
25-01-17 17:13:23 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:13:23 | I |       - range scale = [    1.0000]
25-01-17 17:13:23 | I |         sum  error  = [    0.0899]
25-01-17 17:13:23 | I |         best error  = [    0.0899]
25-01-17 17:13:23 | I |     + error = [0.0899]
25-01-17 17:13:24 | I |       - range scale = [    1.0000]
25-01-17 17:13:24 | I |         sum  error  = [    0.9735]
25-01-17 17:13:24 | I |         best error  = [    0.9735]
25-01-17 17:13:24 | I |     + error = [0.9735]
25-01-17 17:13:24 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:13:25 | I |       - range scale = [    1.0000]
25-01-17 17:13:25 | I |         sum  error  = [    2.0403]
25-01-17 17:13:25 | I |         best error  = [    2.0403]
25-01-17 17:13:25 | I |     + error = [2.0403]
25-01-17 17:13:26 | I |       - range scale = [    1.0000]
25-01-17 17:13:26 | I |         sum  error  = [   22.9947]
25-01-17 17:13:26 | I |         best error  = [   22.9947]
25-01-17 17:13:26 | I |     + error = [22.9947]
25-01-17 17:13:26 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:13:27 | I |       - range scale = [    1.0000]
25-01-17 17:13:27 | I |         sum  error  = [    2.2359]
25-01-17 17:13:27 | I |         best error  = [    2.2359]
25-01-17 17:13:27 | I |     + error = [2.2359]
25-01-17 17:13:27 | I |       - range scale = [    1.0000]
25-01-17 17:13:27 | I |         sum  error  = [   25.1108]
25-01-17 17:13:27 | I |         best error  = [   25.1108]
25-01-17 17:13:27 | I |     + error = [25.1108]
25-01-17 17:13:28 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:13:28 | I |       - range scale = [    1.0000]
25-01-17 17:13:28 | I |         sum  error  = [    0.1633]
25-01-17 17:13:28 | I |         best error  = [    0.1633]
25-01-17 17:13:28 | I |     + error = [0.1633]
25-01-17 17:13:29 | I |       - range scale = [    1.0000]
25-01-17 17:13:29 | I |         sum  error  = [    1.6760]
25-01-17 17:13:29 | I |         best error  = [    1.6760]
25-01-17 17:13:29 | I |     + error = [1.6760]
25-01-17 17:13:29 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:13:31 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:13:32 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:13:34 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:13:35 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:13:37 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:13:38 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:13:41 | I | quantizing activations for layer model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:42 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:44 | I | forward this layer
25-01-17 17:13:44 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/95.pt
25-01-17 17:13:44 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/95.pt
25-01-17 17:13:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:13:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:13:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:13:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:13:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:13:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:13:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:13:44 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:13:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:13:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:13:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:13:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:13:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:13:44 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:13:44 | I | [41] done with optimizer step
25-01-17 17:13:44 | I | epoch 001:     48 / 409600000 loss=1.30465e-05, loss_per_token=0.0267193, loss_sum=875.538, wps=582.6, ups=0.02, wpb=32768, bsz=64, num_updates=42, lr=0.000126, gnorm=0.063, clip=0, loss_scale=2, train_wall=56, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=3240
25-01-17 17:13:45 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:13:45 | I | in layer model.layers.4
25-01-17 17:13:45 | I | quantizing weights for layer model.layers.4
25-01-17 17:13:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:45 | I | collecting calibration activations in model.layers.4
25-01-17 17:13:46 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:13:46 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:13:46 | I |       - range scale = [    1.0000]
25-01-17 17:13:46 | I |         sum  error  = [    0.5597]
25-01-17 17:13:46 | I |         best error  = [    0.5597]
25-01-17 17:13:46 | I |     + error = [0.5597]
25-01-17 17:13:47 | I |       - range scale = [    1.0000]
25-01-17 17:13:47 | I |         sum  error  = [    4.4961]
25-01-17 17:13:47 | I |         best error  = [    4.4961]
25-01-17 17:13:47 | I |     + error = [4.4961]
25-01-17 17:13:47 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:13:48 | I |       - range scale = [    1.0000]
25-01-17 17:13:48 | I |         sum  error  = [    0.2422]
25-01-17 17:13:48 | I |         best error  = [    0.2422]
25-01-17 17:13:48 | I |     + error = [0.2422]
25-01-17 17:13:49 | I |       - range scale = [    1.0000]
25-01-17 17:13:49 | I |         sum  error  = [    2.1131]
25-01-17 17:13:49 | I |         best error  = [    2.1131]
25-01-17 17:13:49 | I |     + error = [2.1131]
25-01-17 17:13:49 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:13:50 | I |       - range scale = [    1.0000]
25-01-17 17:13:50 | I |         sum  error  = [    0.6204]
25-01-17 17:13:50 | I |         best error  = [    0.6204]
25-01-17 17:13:50 | I |     + error = [0.6204]
25-01-17 17:13:50 | I |       - range scale = [    1.0000]
25-01-17 17:13:50 | I |         sum  error  = [    6.9490]
25-01-17 17:13:50 | I |         best error  = [    6.9490]
25-01-17 17:13:50 | I |     + error = [6.9490]
25-01-17 17:13:51 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:13:51 | I |       - range scale = [    1.0000]
25-01-17 17:13:51 | I |         sum  error  = [    0.0932]
25-01-17 17:13:51 | I |         best error  = [    0.0932]
25-01-17 17:13:51 | I |     + error = [0.0932]
25-01-17 17:13:52 | I |       - range scale = [    1.0000]
25-01-17 17:13:52 | I |         sum  error  = [    1.0003]
25-01-17 17:13:52 | I |         best error  = [    1.0003]
25-01-17 17:13:52 | I |     + error = [1.0003]
25-01-17 17:13:52 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:13:53 | I |       - range scale = [    1.0000]
25-01-17 17:13:53 | I |         sum  error  = [    2.0630]
25-01-17 17:13:53 | I |         best error  = [    2.0630]
25-01-17 17:13:53 | I |     + error = [2.0630]
25-01-17 17:13:54 | I |       - range scale = [    1.0000]
25-01-17 17:13:54 | I |         sum  error  = [   23.2425]
25-01-17 17:13:54 | I |         best error  = [   23.2425]
25-01-17 17:13:54 | I |     + error = [23.2425]
25-01-17 17:13:54 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:13:55 | I |       - range scale = [    1.0000]
25-01-17 17:13:55 | I |         sum  error  = [    2.2621]
25-01-17 17:13:55 | I |         best error  = [    2.2621]
25-01-17 17:13:55 | I |     + error = [2.2621]
25-01-17 17:13:56 | I |       - range scale = [    1.0000]
25-01-17 17:13:56 | I |         sum  error  = [   25.3931]
25-01-17 17:13:56 | I |         best error  = [   25.3931]
25-01-17 17:13:56 | I |     + error = [25.3931]
25-01-17 17:13:56 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:13:57 | I |       - range scale = [    1.0000]
25-01-17 17:13:57 | I |         sum  error  = [    0.1712]
25-01-17 17:13:57 | I |         best error  = [    0.1712]
25-01-17 17:13:57 | I |     + error = [0.1712]
25-01-17 17:13:57 | I |       - range scale = [    1.0000]
25-01-17 17:13:57 | I |         sum  error  = [    1.7562]
25-01-17 17:13:57 | I |         best error  = [    1.7562]
25-01-17 17:13:57 | I |     + error = [1.7562]
25-01-17 17:13:58 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:13:59 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:14:00 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:14:02 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:14:03 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:14:05 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:14:06 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:14:09 | I | quantizing activations for layer model.layers.4
25-01-17 17:14:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:10 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:12 | I | forward this layer
25-01-17 17:14:12 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/96.pt
25-01-17 17:14:12 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/96.pt
25-01-17 17:14:12 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:14:12 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:14:12 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:14:12 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:14:12 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:14:12 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:14:12 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:14:12 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:14:12 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:14:12 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:14:12 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:14:12 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:14:12 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:14:12 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:14:12 | I | in layer model.layers.4
25-01-17 17:14:12 | I | quantizing weights for layer model.layers.4
25-01-17 17:14:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:13 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:13 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:14:13 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:14:14 | I |       - range scale = [    1.0000]
25-01-17 17:14:14 | I |         sum  error  = [    0.5449]
25-01-17 17:14:14 | I |         best error  = [    0.5449]
25-01-17 17:14:14 | I |     + error = [0.5449]
25-01-17 17:14:15 | I |       - range scale = [    1.0000]
25-01-17 17:14:15 | I |         sum  error  = [    4.5132]
25-01-17 17:14:15 | I |         best error  = [    4.5132]
25-01-17 17:14:15 | I |     + error = [4.5132]
25-01-17 17:14:15 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:14:16 | I |       - range scale = [    1.0000]
25-01-17 17:14:16 | I |         sum  error  = [    0.2385]
25-01-17 17:14:16 | I |         best error  = [    0.2385]
25-01-17 17:14:16 | I |     + error = [0.2385]
25-01-17 17:14:17 | I |       - range scale = [    1.0000]
25-01-17 17:14:17 | I |         sum  error  = [    2.0777]
25-01-17 17:14:17 | I |         best error  = [    2.0777]
25-01-17 17:14:17 | I |     + error = [2.0777]
25-01-17 17:14:17 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:14:17 | I |       - range scale = [    1.0000]
25-01-17 17:14:17 | I |         sum  error  = [    0.6191]
25-01-17 17:14:17 | I |         best error  = [    0.6191]
25-01-17 17:14:17 | I |     + error = [0.6191]
25-01-17 17:14:18 | I |       - range scale = [    1.0000]
25-01-17 17:14:18 | I |         sum  error  = [    6.9774]
25-01-17 17:14:18 | I |         best error  = [    6.9774]
25-01-17 17:14:18 | I |     + error = [6.9774]
25-01-17 17:14:18 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:14:19 | I |       - range scale = [    1.0000]
25-01-17 17:14:19 | I |         sum  error  = [    0.0901]
25-01-17 17:14:19 | I |         best error  = [    0.0901]
25-01-17 17:14:19 | I |     + error = [0.0901]
25-01-17 17:14:20 | I |       - range scale = [    1.0000]
25-01-17 17:14:20 | I |         sum  error  = [    0.9848]
25-01-17 17:14:20 | I |         best error  = [    0.9848]
25-01-17 17:14:20 | I |     + error = [0.9848]
25-01-17 17:14:20 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:14:21 | I |       - range scale = [    1.0000]
25-01-17 17:14:21 | I |         sum  error  = [    2.0482]
25-01-17 17:14:21 | I |         best error  = [    2.0482]
25-01-17 17:14:21 | I |     + error = [2.0482]
25-01-17 17:14:22 | I |       - range scale = [    1.0000]
25-01-17 17:14:22 | I |         sum  error  = [   23.0908]
25-01-17 17:14:22 | I |         best error  = [   23.0908]
25-01-17 17:14:22 | I |     + error = [23.0908]
25-01-17 17:14:22 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:14:23 | I |       - range scale = [    1.0000]
25-01-17 17:14:23 | I |         sum  error  = [    2.2461]
25-01-17 17:14:23 | I |         best error  = [    2.2461]
25-01-17 17:14:23 | I |     + error = [2.2461]
25-01-17 17:14:23 | I |       - range scale = [    1.0000]
25-01-17 17:14:23 | I |         sum  error  = [   25.2247]
25-01-17 17:14:23 | I |         best error  = [   25.2247]
25-01-17 17:14:23 | I |     + error = [25.2247]
25-01-17 17:14:24 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:14:24 | I |       - range scale = [    1.0000]
25-01-17 17:14:24 | I |         sum  error  = [    0.1671]
25-01-17 17:14:24 | I |         best error  = [    0.1671]
25-01-17 17:14:24 | I |     + error = [0.1671]
25-01-17 17:14:25 | I |       - range scale = [    1.0000]
25-01-17 17:14:25 | I |         sum  error  = [    1.7138]
25-01-17 17:14:25 | I |         best error  = [    1.7138]
25-01-17 17:14:25 | I |     + error = [1.7138]
25-01-17 17:14:25 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:14:27 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:14:28 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:14:29 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:14:31 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:14:32 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:14:34 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:14:37 | I | quantizing activations for layer model.layers.4
25-01-17 17:14:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:38 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:40 | I | forward this layer
25-01-17 17:14:40 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/97.pt
25-01-17 17:14:40 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/97.pt
25-01-17 17:14:40 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:14:40 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:14:40 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:14:40 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:14:40 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:14:40 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:14:40 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:14:40 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:14:40 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:14:40 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:14:40 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:14:40 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:14:40 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:14:40 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:14:40 | I | [42] done with optimizer step
25-01-17 17:14:40 | I | epoch 001:     49 / 409600000 loss=1.34283e-05, loss_per_token=0.0275011, loss_sum=901.155, wps=590.4, ups=0.02, wpb=32768, bsz=64, num_updates=43, lr=0.000129, gnorm=0.05, clip=0, loss_scale=2, train_wall=55, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=3296
25-01-17 17:14:40 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:14:40 | I | in layer model.layers.4
25-01-17 17:14:40 | I | quantizing weights for layer model.layers.4
25-01-17 17:14:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:41 | I | collecting calibration activations in model.layers.4
25-01-17 17:14:41 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:14:41 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:14:42 | I |       - range scale = [    1.0000]
25-01-17 17:14:42 | I |         sum  error  = [    0.5333]
25-01-17 17:14:42 | I |         best error  = [    0.5333]
25-01-17 17:14:42 | I |     + error = [0.5333]
25-01-17 17:14:43 | I |       - range scale = [    1.0000]
25-01-17 17:14:43 | I |         sum  error  = [    4.3758]
25-01-17 17:14:43 | I |         best error  = [    4.3758]
25-01-17 17:14:43 | I |     + error = [4.3758]
25-01-17 17:14:43 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:14:44 | I |       - range scale = [    1.0000]
25-01-17 17:14:44 | I |         sum  error  = [    0.2300]
25-01-17 17:14:44 | I |         best error  = [    0.2300]
25-01-17 17:14:44 | I |     + error = [0.2300]
25-01-17 17:14:44 | I |       - range scale = [    1.0000]
25-01-17 17:14:44 | I |         sum  error  = [    2.0115]
25-01-17 17:14:44 | I |         best error  = [    2.0115]
25-01-17 17:14:44 | I |     + error = [2.0115]
25-01-17 17:14:45 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:14:45 | I |       - range scale = [    1.0000]
25-01-17 17:14:45 | I |         sum  error  = [    0.6118]
25-01-17 17:14:45 | I |         best error  = [    0.6118]
25-01-17 17:14:45 | I |     + error = [0.6118]
25-01-17 17:14:46 | I |       - range scale = [    1.0000]
25-01-17 17:14:46 | I |         sum  error  = [    6.9487]
25-01-17 17:14:46 | I |         best error  = [    6.9487]
25-01-17 17:14:46 | I |     + error = [6.9487]
25-01-17 17:14:46 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:14:47 | I |       - range scale = [    1.0000]
25-01-17 17:14:47 | I |         sum  error  = [    0.0910]
25-01-17 17:14:47 | I |         best error  = [    0.0910]
25-01-17 17:14:47 | I |     + error = [0.0910]
25-01-17 17:14:48 | I |       - range scale = [    1.0000]
25-01-17 17:14:48 | I |         sum  error  = [    0.9868]
25-01-17 17:14:48 | I |         best error  = [    0.9868]
25-01-17 17:14:48 | I |     + error = [0.9868]
25-01-17 17:14:48 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:14:48 | I |       - range scale = [    1.0000]
25-01-17 17:14:48 | I |         sum  error  = [    2.0582]
25-01-17 17:14:48 | I |         best error  = [    2.0582]
25-01-17 17:14:48 | I |     + error = [2.0582]
25-01-17 17:14:49 | I |       - range scale = [    1.0000]
25-01-17 17:14:49 | I |         sum  error  = [   23.1786]
25-01-17 17:14:49 | I |         best error  = [   23.1786]
25-01-17 17:14:49 | I |     + error = [23.1786]
25-01-17 17:14:49 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:14:50 | I |       - range scale = [    1.0000]
25-01-17 17:14:50 | I |         sum  error  = [    2.2529]
25-01-17 17:14:50 | I |         best error  = [    2.2529]
25-01-17 17:14:50 | I |     + error = [2.2529]
25-01-17 17:14:51 | I |       - range scale = [    1.0000]
25-01-17 17:14:51 | I |         sum  error  = [   25.3302]
25-01-17 17:14:51 | I |         best error  = [   25.3302]
25-01-17 17:14:51 | I |     + error = [25.3302]
25-01-17 17:14:51 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:14:52 | I |       - range scale = [    1.0000]
25-01-17 17:14:52 | I |         sum  error  = [    0.1724]
25-01-17 17:14:52 | I |         best error  = [    0.1724]
25-01-17 17:14:52 | I |     + error = [0.1724]
25-01-17 17:14:53 | I |       - range scale = [    1.0000]
25-01-17 17:14:53 | I |         sum  error  = [    1.7666]
25-01-17 17:14:53 | I |         best error  = [    1.7666]
25-01-17 17:14:53 | I |     + error = [1.7666]
25-01-17 17:14:53 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:14:54 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:14:56 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:14:57 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:14:58 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:15:00 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:15:01 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:15:05 | I | quantizing activations for layer model.layers.4
25-01-17 17:15:05 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:05 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:05 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:05 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:07 | I | forward this layer
25-01-17 17:15:07 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/98.pt
25-01-17 17:15:07 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/98.pt
25-01-17 17:15:07 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:15:07 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:15:07 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:15:07 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:15:07 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:15:07 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:15:07 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:15:07 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:15:07 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:15:07 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:15:07 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:15:07 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:15:07 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:15:07 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:15:07 | I | in layer model.layers.4
25-01-17 17:15:07 | I | quantizing weights for layer model.layers.4
25-01-17 17:15:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:08 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:09 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:15:09 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:15:09 | I |       - range scale = [    1.0000]
25-01-17 17:15:09 | I |         sum  error  = [    0.5391]
25-01-17 17:15:09 | I |         best error  = [    0.5391]
25-01-17 17:15:09 | I |     + error = [0.5391]
25-01-17 17:15:10 | I |       - range scale = [    1.0000]
25-01-17 17:15:10 | I |         sum  error  = [    4.5426]
25-01-17 17:15:10 | I |         best error  = [    4.5426]
25-01-17 17:15:10 | I |     + error = [4.5426]
25-01-17 17:15:10 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:15:11 | I |       - range scale = [    1.0000]
25-01-17 17:15:11 | I |         sum  error  = [    0.2424]
25-01-17 17:15:11 | I |         best error  = [    0.2424]
25-01-17 17:15:11 | I |     + error = [0.2424]
25-01-17 17:15:12 | I |       - range scale = [    1.0000]
25-01-17 17:15:12 | I |         sum  error  = [    2.0585]
25-01-17 17:15:12 | I |         best error  = [    2.0585]
25-01-17 17:15:12 | I |     + error = [2.0585]
25-01-17 17:15:12 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:15:13 | I |       - range scale = [    1.0000]
25-01-17 17:15:13 | I |         sum  error  = [    0.6154]
25-01-17 17:15:13 | I |         best error  = [    0.6154]
25-01-17 17:15:13 | I |     + error = [0.6154]
25-01-17 17:15:13 | I |       - range scale = [    1.0000]
25-01-17 17:15:13 | I |         sum  error  = [    6.9358]
25-01-17 17:15:13 | I |         best error  = [    6.9358]
25-01-17 17:15:13 | I |     + error = [6.9358]
25-01-17 17:15:14 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:15:14 | I |       - range scale = [    1.0000]
25-01-17 17:15:14 | I |         sum  error  = [    0.0929]
25-01-17 17:15:14 | I |         best error  = [    0.0929]
25-01-17 17:15:14 | I |     + error = [0.0929]
25-01-17 17:15:15 | I |       - range scale = [    1.0000]
25-01-17 17:15:15 | I |         sum  error  = [    1.0067]
25-01-17 17:15:15 | I |         best error  = [    1.0067]
25-01-17 17:15:15 | I |     + error = [1.0067]
25-01-17 17:15:15 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:15:16 | I |       - range scale = [    1.0000]
25-01-17 17:15:16 | I |         sum  error  = [    2.0387]
25-01-17 17:15:16 | I |         best error  = [    2.0387]
25-01-17 17:15:16 | I |     + error = [2.0387]
25-01-17 17:15:17 | I |       - range scale = [    1.0000]
25-01-17 17:15:17 | I |         sum  error  = [   22.9762]
25-01-17 17:15:17 | I |         best error  = [   22.9762]
25-01-17 17:15:17 | I |     + error = [22.9762]
25-01-17 17:15:17 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:15:18 | I |       - range scale = [    1.0000]
25-01-17 17:15:18 | I |         sum  error  = [    2.2313]
25-01-17 17:15:18 | I |         best error  = [    2.2313]
25-01-17 17:15:18 | I |     + error = [2.2313]
25-01-17 17:15:18 | I |       - range scale = [    1.0000]
25-01-17 17:15:18 | I |         sum  error  = [   25.0968]
25-01-17 17:15:18 | I |         best error  = [   25.0968]
25-01-17 17:15:18 | I |     + error = [25.0968]
25-01-17 17:15:19 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:15:19 | I |       - range scale = [    1.0000]
25-01-17 17:15:19 | I |         sum  error  = [    0.1674]
25-01-17 17:15:19 | I |         best error  = [    0.1674]
25-01-17 17:15:19 | I |     + error = [0.1674]
25-01-17 17:15:20 | I |       - range scale = [    1.0000]
25-01-17 17:15:20 | I |         sum  error  = [    1.7099]
25-01-17 17:15:20 | I |         best error  = [    1.7099]
25-01-17 17:15:20 | I |     + error = [1.7099]
25-01-17 17:15:20 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:15:22 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:15:23 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:15:25 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:15:26 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:15:28 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:15:29 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:15:33 | I | quantizing activations for layer model.layers.4
25-01-17 17:15:33 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:33 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:33 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:33 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:36 | I | forward this layer
25-01-17 17:15:36 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/99.pt
25-01-17 17:15:36 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/99.pt
25-01-17 17:15:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:15:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:15:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:15:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:15:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:15:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:15:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:15:36 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:15:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:15:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:15:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:15:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:15:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:15:36 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:15:36 | I | [43] done with optimizer step
25-01-17 17:15:36 | I | epoch 001:     50 / 409600000 loss=1.24202e-05, loss_per_token=0.0254366, loss_sum=833.508, wps=586.8, ups=0.02, wpb=32768, bsz=64, num_updates=44, lr=0.000132, gnorm=0.047, clip=0, loss_scale=2, train_wall=56, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=3352
25-01-17 17:15:36 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:15:36 | I | in layer model.layers.4
25-01-17 17:15:36 | I | quantizing weights for layer model.layers.4
25-01-17 17:15:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:37 | I | collecting calibration activations in model.layers.4
25-01-17 17:15:37 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:15:37 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:15:38 | I |       - range scale = [    1.0000]
25-01-17 17:15:38 | I |         sum  error  = [    0.5305]
25-01-17 17:15:38 | I |         best error  = [    0.5305]
25-01-17 17:15:38 | I |     + error = [0.5305]
25-01-17 17:15:39 | I |       - range scale = [    1.0000]
25-01-17 17:15:39 | I |         sum  error  = [    4.3869]
25-01-17 17:15:39 | I |         best error  = [    4.3869]
25-01-17 17:15:39 | I |     + error = [4.3869]
25-01-17 17:15:39 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:15:40 | I |       - range scale = [    1.0000]
25-01-17 17:15:40 | I |         sum  error  = [    0.2250]
25-01-17 17:15:40 | I |         best error  = [    0.2250]
25-01-17 17:15:40 | I |     + error = [0.2250]
25-01-17 17:15:40 | I |       - range scale = [    1.0000]
25-01-17 17:15:40 | I |         sum  error  = [    1.9754]
25-01-17 17:15:40 | I |         best error  = [    1.9754]
25-01-17 17:15:40 | I |     + error = [1.9754]
25-01-17 17:15:41 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:15:41 | I |       - range scale = [    1.0000]
25-01-17 17:15:41 | I |         sum  error  = [    0.6141]
25-01-17 17:15:41 | I |         best error  = [    0.6141]
25-01-17 17:15:41 | I |     + error = [0.6141]
25-01-17 17:15:42 | I |       - range scale = [    1.0000]
25-01-17 17:15:42 | I |         sum  error  = [    6.9186]
25-01-17 17:15:42 | I |         best error  = [    6.9186]
25-01-17 17:15:42 | I |     + error = [6.9186]
25-01-17 17:15:42 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:15:43 | I |       - range scale = [    1.0000]
25-01-17 17:15:43 | I |         sum  error  = [    0.0921]
25-01-17 17:15:43 | I |         best error  = [    0.0921]
25-01-17 17:15:43 | I |     + error = [0.0921]
25-01-17 17:15:44 | I |       - range scale = [    1.0000]
25-01-17 17:15:44 | I |         sum  error  = [    1.0027]
25-01-17 17:15:44 | I |         best error  = [    1.0027]
25-01-17 17:15:44 | I |     + error = [1.0027]
25-01-17 17:15:44 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:15:44 | I |       - range scale = [    1.0000]
25-01-17 17:15:44 | I |         sum  error  = [    2.0558]
25-01-17 17:15:44 | I |         best error  = [    2.0558]
25-01-17 17:15:44 | I |     + error = [2.0558]
25-01-17 17:15:45 | I |       - range scale = [    1.0000]
25-01-17 17:15:45 | I |         sum  error  = [   23.1475]
25-01-17 17:15:45 | I |         best error  = [   23.1475]
25-01-17 17:15:45 | I |     + error = [23.1475]
25-01-17 17:15:45 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:15:46 | I |       - range scale = [    1.0000]
25-01-17 17:15:46 | I |         sum  error  = [    2.2512]
25-01-17 17:15:46 | I |         best error  = [    2.2512]
25-01-17 17:15:46 | I |     + error = [2.2512]
25-01-17 17:15:47 | I |       - range scale = [    1.0000]
25-01-17 17:15:47 | I |         sum  error  = [   25.2898]
25-01-17 17:15:47 | I |         best error  = [   25.2898]
25-01-17 17:15:47 | I |     + error = [25.2898]
25-01-17 17:15:47 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:15:48 | I |       - range scale = [    1.0000]
25-01-17 17:15:48 | I |         sum  error  = [    0.1697]
25-01-17 17:15:48 | I |         best error  = [    0.1697]
25-01-17 17:15:48 | I |     + error = [0.1697]
25-01-17 17:15:49 | I |       - range scale = [    1.0000]
25-01-17 17:15:49 | I |         sum  error  = [    1.7402]
25-01-17 17:15:49 | I |         best error  = [    1.7402]
25-01-17 17:15:49 | I |     + error = [1.7402]
25-01-17 17:15:49 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:15:51 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:15:52 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:15:54 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:15:56 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:15:57 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:15:59 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:16:03 | I | quantizing activations for layer model.layers.4
25-01-17 17:16:04 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:04 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:04 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:04 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:06 | I | forward this layer
25-01-17 17:16:06 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/100.pt
25-01-17 17:16:06 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/100.pt
25-01-17 17:16:06 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:16:06 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:16:06 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:16:06 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:16:06 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:16:06 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:16:06 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:16:06 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:16:06 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:16:06 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:16:06 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:16:06 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:16:06 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:16:06 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:16:06 | I | in layer model.layers.4
25-01-17 17:16:06 | I | quantizing weights for layer model.layers.4
25-01-17 17:16:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:07 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:07 | I | - Quantizing decoder layer model.layers.4
25-01-17 17:16:07 | I |   - Calibrating model.layers.4.self_attn.q_proj.weight
25-01-17 17:16:08 | I |       - range scale = [    1.0000]
25-01-17 17:16:08 | I |         sum  error  = [    0.5356]
25-01-17 17:16:08 | I |         best error  = [    0.5356]
25-01-17 17:16:08 | I |     + error = [0.5356]
25-01-17 17:16:09 | I |       - range scale = [    1.0000]
25-01-17 17:16:09 | I |         sum  error  = [    4.5310]
25-01-17 17:16:09 | I |         best error  = [    4.5310]
25-01-17 17:16:09 | I |     + error = [4.5310]
25-01-17 17:16:09 | I |   - Calibrating model.layers.4.self_attn.k_proj.weight
25-01-17 17:16:10 | I |       - range scale = [    1.0000]
25-01-17 17:16:10 | I |         sum  error  = [    0.2302]
25-01-17 17:16:10 | I |         best error  = [    0.2302]
25-01-17 17:16:10 | I |     + error = [0.2302]
25-01-17 17:16:10 | I |       - range scale = [    1.0000]
25-01-17 17:16:10 | I |         sum  error  = [    2.0024]
25-01-17 17:16:10 | I |         best error  = [    2.0024]
25-01-17 17:16:10 | I |     + error = [2.0024]
25-01-17 17:16:11 | I |   - Calibrating model.layers.4.self_attn.v_proj.weight
25-01-17 17:16:11 | I |       - range scale = [    1.0000]
25-01-17 17:16:11 | I |         sum  error  = [    0.6141]
25-01-17 17:16:11 | I |         best error  = [    0.6141]
25-01-17 17:16:11 | I |     + error = [0.6141]
25-01-17 17:16:12 | I |       - range scale = [    1.0000]
25-01-17 17:16:12 | I |         sum  error  = [    6.9246]
25-01-17 17:16:12 | I |         best error  = [    6.9246]
25-01-17 17:16:12 | I |     + error = [6.9246]
25-01-17 17:16:12 | I |   - Calibrating model.layers.4.self_attn.o_proj.weight
25-01-17 17:16:13 | I |       - range scale = [    1.0000]
25-01-17 17:16:13 | I |         sum  error  = [    0.0956]
25-01-17 17:16:13 | I |         best error  = [    0.0956]
25-01-17 17:16:13 | I |     + error = [0.0956]
25-01-17 17:16:14 | I |       - range scale = [    1.0000]
25-01-17 17:16:14 | I |         sum  error  = [    1.0439]
25-01-17 17:16:14 | I |         best error  = [    1.0439]
25-01-17 17:16:14 | I |     + error = [1.0439]
25-01-17 17:16:14 | I |   - Calibrating model.layers.4.mlp.up_proj.weight
25-01-17 17:16:15 | I |       - range scale = [    1.0000]
25-01-17 17:16:15 | I |         sum  error  = [    2.0621]
25-01-17 17:16:15 | I |         best error  = [    2.0621]
25-01-17 17:16:15 | I |     + error = [2.0621]
25-01-17 17:16:15 | I |       - range scale = [    1.0000]
25-01-17 17:16:15 | I |         sum  error  = [   23.1963]
25-01-17 17:16:15 | I |         best error  = [   23.1963]
25-01-17 17:16:15 | I |     + error = [23.1963]
25-01-17 17:16:16 | I |   - Calibrating model.layers.4.mlp.gate_proj.weight
25-01-17 17:16:16 | I |       - range scale = [    1.0000]
25-01-17 17:16:16 | I |         sum  error  = [    2.2563]
25-01-17 17:16:16 | I |         best error  = [    2.2563]
25-01-17 17:16:16 | I |     + error = [2.2563]
25-01-17 17:16:17 | I |       - range scale = [    1.0000]
25-01-17 17:16:17 | I |         sum  error  = [   25.3501]
25-01-17 17:16:17 | I |         best error  = [   25.3501]
25-01-17 17:16:17 | I |     + error = [25.3501]
25-01-17 17:16:17 | I |   - Calibrating model.layers.4.mlp.down_proj.weight
25-01-17 17:16:18 | I |       - range scale = [    1.0000]
25-01-17 17:16:18 | I |         sum  error  = [    0.1723]
25-01-17 17:16:18 | I |         best error  = [    0.1723]
25-01-17 17:16:18 | I |     + error = [0.1723]
25-01-17 17:16:19 | I |       - range scale = [    1.0000]
25-01-17 17:16:19 | I |         sum  error  = [    1.7659]
25-01-17 17:16:19 | I |         best error  = [    1.7659]
25-01-17 17:16:19 | I |     + error = [1.7659]
25-01-17 17:16:19 | I |   - Quantizing model.layers.4.self_attn.q_proj.weight
25-01-17 17:16:20 | I |   - Quantizing model.layers.4.self_attn.k_proj.weight
25-01-17 17:16:22 | I |   - Quantizing model.layers.4.self_attn.v_proj.weight
25-01-17 17:16:23 | I |   - Quantizing model.layers.4.self_attn.o_proj.weight
25-01-17 17:16:25 | I |   - Quantizing model.layers.4.mlp.up_proj.weight
25-01-17 17:16:26 | I |   - Quantizing model.layers.4.mlp.gate_proj.weight
25-01-17 17:16:27 | I |   - Quantizing model.layers.4.mlp.down_proj.weight
25-01-17 17:16:31 | I | quantizing activations for layer model.layers.4
25-01-17 17:16:31 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:31 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:31 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:32 | I | collecting calibration activations in model.layers.4
25-01-17 17:16:34 | I | forward this layer
25-01-17 17:16:34 | I | input_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_input_args_layer_4/101.pt
25-01-17 17:16:34 | I | output_file: /data/gyy/lmquant-main/lmquant/data/data_without_preprocess_llama_1.1b/shard/val_teacher_output_layer_4/101.pt
25-01-17 17:16:34 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has nan: False
25-01-17 17:16:34 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.q_proj has inf: False
25-01-17 17:16:34 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has nan: False
25-01-17 17:16:34 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.k_proj has inf: False
25-01-17 17:16:34 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has nan: False
25-01-17 17:16:34 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.v_proj has inf: False
25-01-17 17:16:34 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has nan: False
25-01-17 17:16:34 | I | In layer model.layers.4, gradient of model.layers.4.self_attn.o_proj has inf: False
25-01-17 17:16:34 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has nan: False
25-01-17 17:16:34 | I | In layer model.layers.4, gradient of model.layers.4.mlp.up_proj has inf: False
25-01-17 17:16:34 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has nan: False
25-01-17 17:16:34 | I | In layer model.layers.4, gradient of model.layers.4.mlp.gate_proj has inf: False
25-01-17 17:16:34 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has nan: False
25-01-17 17:16:34 | I | In layer model.layers.4, gradient of model.layers.4.mlp.down_proj has inf: False
25-01-17 17:16:34 | I | [44] done with optimizer step
25-01-17 17:16:34 | I | epoch 001:     51 / 409600000 loss=1.1809e-05, loss_per_token=0.0241847, loss_sum=792.486, wps=564.8, ups=0.02, wpb=32768, bsz=64, num_updates=45, lr=0.000135, gnorm=0.08, clip=0, loss_scale=2, train_wall=58, cuda_gb_allocated=12.3, cuda_gb_reserved=13.7, cuda_gb_free=11.4, wall=3410
25-01-17 17:16:34 | I | TRAIN CURRENT LAYER_IDX = 4
25-01-17 17:16:34 | I | in layer model.layers.4
25-01-17 17:16:34 | I | quantizing weights for layer model.layers.4
